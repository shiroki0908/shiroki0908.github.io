<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Solitude主题魔改教程(24) - 修复分类、标签和归档页面统计图显示控制问题</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(24)-%E4%BF%AE%E5%A4%8D%E5%88%86%E7%B1%BB%E3%80%81%E6%A0%87%E7%AD%BE%E5%92%8C%E5%BD%92%E6%A1%A3%E9%A1%B5%E9%9D%A2%E7%BB%9F%E8%AE%A1%E5%9B%BE%E6%98%BE%E7%A4%BA%E6%8E%A7%E5%88%B6%E9%97%AE%E9%A2%98/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(24)-%E4%BF%AE%E5%A4%8D%E5%88%86%E7%B1%BB%E3%80%81%E6%A0%87%E7%AD%BE%E5%92%8C%E5%BD%92%E6%A1%A3%E9%A1%B5%E9%9D%A2%E7%BB%9F%E8%AE%A1%E5%9B%BE%E6%98%BE%E7%A4%BA%E6%8E%A7%E5%88%B6%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Hexo博客中，统计图表是展示数据的重要方式。Solitude主题提供了分类统计饼图、标签统计柱状图和文章统计曲线图，但在页面跳转和后退操作中存在显示问题。本教程将详细介绍如何解决这些问题，实现统计图的智能显示控制。</p><h2 id="一、修改原因">一、修改原因</h2><h3 id="1-1-问题背景">1.1 问题背景</h3><p>在Solitude主题中，分类页面、标签页面和归档页面都包含统计图表：</p><ul><li><strong>分类页面</strong>：显示分类统计饼图（categories-chart）</li><li><strong>标签页面</strong>：显示标签统计柱状图（tags-chart）</li><li><strong>归档页面</strong>：显示文章统计曲线图（posts-chart）</li></ul><p>这些统计图通过ECharts渲染，支持点击跳转到具体的分类、标签或月份页面。但在实际使用中发现了以下问题：</p><ol><li><strong>具体分类/标签/月份页面显示统计图</strong>：用户点击统计图跳转到具体页面时，页面仍然显示统计图，占用不必要的空间</li><li><strong>后退按钮后统计图不显示</strong>：从具体页面后退到主页面时，统计图可能不显示或显示异常</li><li><strong>PJAX兼容性问题</strong>：使用PJAX进行页面切换时，ECharts图表无法正确重新初始化</li><li><strong>归档页面特殊问题</strong>：具体月份页面的文章数显示不正确，年份显示格式不符合预期</li></ol><h3 id="1-2-解决方案思路">1.2 解决方案思路</h3><p>采用&quot;从源头解决问题&quot;的思路：</p><ul><li><strong>具体分类/标签页面</strong>：完全移除统计图元素，而不是通过CSS隐藏</li><li><strong>分类/标签页面</strong>：确保统计图正确显示，支持PJAX重新初始化</li><li><strong>智能检测</strong>：根据页面类型自动控制统计图的显示状态</li></ul><h2 id="二、问题分析">二、问题分析</h2><h3 id="2-1-分类页面问题">2.1 分类页面问题</h3><h4 id="问题场景：">问题场景：</h4><ol><li><strong>分类页面</strong> (<code>/categories/</code>) - 显示统计饼图 ✅</li><li><strong>通过统计图跳转</strong> → 具体分类页面 (<code>/categories/魔改教程/</code>) - 显示统计图 ❌</li><li><strong>通过分类标签跳转</strong> → 具体分类页面 (<code>/categories/魔改教程/</code>) - 显示统计图 ❌</li><li><strong>后退按钮</strong> → 分类页面 - 统计图不显示 ❌</li></ol><h4 id="根本原因：">根本原因：</h4><ul><li>具体分类页面模板中硬编码了统计图元素</li><li>PJAX环境下ECharts无法正确重新初始化</li></ul><h3 id="2-2-标签页面问题">2.2 标签页面问题</h3><h4 id="问题场景：-2">问题场景：</h4><ol><li><strong>标签页面</strong> (<code>/tags/</code>) - 显示统计柱状图 ✅</li><li><strong>通过统计图跳转</strong> → 具体标签页面 (<code>/tags/JavaScript/</code>) - 显示统计图 ❌</li><li><strong>通过标签跳转</strong> → 具体标签页面 (<code>/tags/JavaScript/</code>) - 显示统计图 ❌</li><li><strong>后退按钮</strong> → 标签页面 - 统计图不显示 ❌</li></ol><h4 id="根本原因：-2">根本原因：</h4><ul><li>具体标签页面模板中硬编码了统计图元素</li><li>PJAX环境下ECharts无法正确重新初始化</li></ul><h3 id="2-3-归档页面问题">2.3 归档页面问题</h3><h4 id="问题场景：-3">问题场景：</h4><ol><li><strong>归档页面</strong> (<code>/archives/</code>) - 显示统计曲线图 ✅</li><li><strong>通过统计图跳转</strong> → 具体月份页面 (<code>/archives/2024/10/</code>) - 显示统计图 ❌</li><li><strong>后退按钮</strong> → 归档页面 - 统计图不显示 ❌</li><li><strong>文章数显示</strong> - 显示总文章数而不是筛选后的文章数 ❌</li><li><strong>年份显示</strong> - 显示年份而不是年份-月份格式 ❌</li></ol><h4 id="根本原因：-3">根本原因：</h4><ul><li>归档页面模板中硬编码了统计图元素，所有页面都显示</li><li>文章数显示逻辑不正确</li><li>年份显示格式不符合预期</li><li>PJAX环境下ECharts无法正确重新初始化</li></ul><h2 id="三、修改后的样式效果">三、修改后的样式效果</h2><h3 id="3-1-分类页面效果">3.1 分类页面效果</h3><ul><li><strong>分类页面</strong> (<code>/categories/</code>) - 显示统计饼图，可点击跳转 ✅</li><li><strong>具体分类页面</strong> (<code>/categories/魔改教程/</code>) - 完全不显示统计图，不占空间 ✅</li><li><strong>后退按钮</strong> - 正确显示统计图，可点击 ✅</li><li><strong>PJAX页面切换</strong> - 正确处理统计图状态 ✅</li></ul><h3 id="3-2-标签页面效果">3.2 标签页面效果</h3><ul><li><strong>标签页面</strong> (<code>/tags/</code>) - 显示统计柱状图，可点击跳转 ✅</li><li><strong>具体标签页面</strong> (<code>/tags/JavaScript/</code>) - 完全不显示统计图，不占空间 ✅</li><li><strong>后退按钮</strong> - 正确显示统计图，可点击 ✅</li><li><strong>PJAX页面切换</strong> - 正确处理统计图状态 ✅</li></ul><h3 id="3-3-归档页面效果">3.3 归档页面效果</h3><ul><li>✅ <strong>归档页面</strong> (<code>/archives/</code>) - 显示统计曲线图，可点击跳转</li><li>✅ <strong>具体月份页面</strong> (<code>/archives/2024/10/</code>) - 完全不显示统计图，不占空间</li><li>✅ <strong>后退按钮</strong> - 正确显示统计图，可点击</li><li>✅ <strong>PJAX页面切换</strong> - 正确处理统计图状态</li><li>✅ <strong>文章数显示</strong> - 正确显示筛选后的文章数</li><li>✅ <strong>年份显示</strong> - 正确显示年份-月份格式</li></ul><h2 id="四、代码分析与修改思路">四、代码分析与修改思路</h2><h3 id="4-1-文件结构分析">4.1 文件结构分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">themes/solitude/</span><br><span class="line">├── layout/</span><br><span class="line">│   ├── category.pug                    # 具体分类页面模板</span><br><span class="line">│   ├── tag.pug                        # 具体标签页面模板</span><br><span class="line">│   ├── archive.pug                    # 归档页面模板</span><br><span class="line">│   └── includes/</span><br><span class="line">│       ├── page/</span><br><span class="line">│       │   ├── categories.pug         # 分类页面模板</span><br><span class="line">│       │   └── tags.pug              # 标签页面模板</span><br><span class="line">│       └── mixins/</span><br><span class="line">│           └── articleSort.pug        # 文章排序mixin</span><br><span class="line">│       ├── head.pug                   # 头部模板</span><br><span class="line">│       └── inject/</span><br><span class="line">│           └── body.pug               # 底部脚本注入</span><br><span class="line">├── source/</span><br><span class="line">│   ├── css/custom/</span><br><span class="line">│   │   ├── categories-chart-control.css  # 分类统计图控制样式</span><br><span class="line">│   │   ├── tags-chart-control.css        # 标签统计图控制样式</span><br><span class="line">│   │   └── posts-chart-control.css       # 文章统计图控制样式</span><br><span class="line">│   └── js/custom/</span><br><span class="line">│       ├── categories-chart-control.js   # 分类统计图控制脚本</span><br><span class="line">│       ├── tags-chart-control.js         # 标签统计图控制脚本</span><br><span class="line">│       └── posts-chart-control.js        # 文章统计图控制脚本</span><br><span class="line">└── scripts/helper/</span><br><span class="line">    └── charts.js                      # ECharts图表生成脚本</span><br></pre></td></tr></table></figure><h3 id="4-2-修改思路">4.2 修改思路</h3><h4 id="4-2-1-模板层面修改">4.2.1 模板层面修改</h4><ol><li><strong>移除具体页面的统计图元素</strong>：从源头解决问题</li><li><strong>保留主页面的统计图元素</strong>：确保正常显示</li><li><strong>归档页面特殊处理</strong>：通过JavaScript控制显示/隐藏，修正文章数和年份显示</li></ol><h4 id="4-2-2-JavaScript层面修改">4.2.2 JavaScript层面修改</h4><ol><li><strong>页面类型检测</strong>：智能识别当前页面类型</li><li><strong>图表重新创建</strong>：支持PJAX环境下的图表重新初始化</li><li><strong>事件监听</strong>：监听页面变化和用户操作</li></ol><h4 id="4-2-3-CSS层面修改">4.2.3 CSS层面修改</h4><ol><li><strong>基本样式</strong>：确保统计图正确显示</li><li><strong>响应式设计</strong>：支持不同屏幕尺寸</li></ol><h4 id="4-2-4-条件加载">4.2.4 条件加载</h4><ol><li><strong>CSS条件加载</strong>：只在需要的页面加载样式</li><li><strong>JS条件加载</strong>：只在需要的页面加载脚本</li></ol><h2 id="五、完整修改代码">五、完整修改代码</h2><h3 id="5-1-分类页面修改">5.1 分类页面修改</h3><h4 id="5-1-1-修改具体分类页面模板">5.1.1 修改具体分类页面模板</h4><p><strong>文件：<code>themes/solitude/layout/category.pug</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner</span><br><span class="line">        #category.category-page</span><br><span class="line">            #category-bar</span><br><span class="line">                include includes/widgets/home/categoryBar</span><br><span class="line">            .recent-posts#recent-posts</span><br><span class="line">                each post,index in page.posts.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">                    include includes/widgets/home/postList</span><br><span class="line">                include includes/mixins/pagination</span><br><span class="line">            if theme.comment.hot_tip.enable</span><br><span class="line">                include ./includes/widgets/third-party/hot/index.pug</span><br><span class="line">        include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong></p><ul><li>移除了 <code>&lt;div id=&quot;categories-chart&quot; data-parent=&quot;false&quot; style=&quot;height: 300px; padding: 10px;&quot;&gt;&lt;/div&gt;</code></li><li>保留了其他页面元素不变</li></ul><h4 id="5-1-2-创建分类统计图控制脚本">5.1.2 创建分类统计图控制脚本</h4><p><strong>文件：<code>themes/solitude/source/js/custom/categories-chart-control.js</code></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分类统计图显示控制脚本</span></span><br><span class="line"><span class="comment"> * 根据页面类型和用户行为控制统计图的显示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检测当前页面类型</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">detectPageType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> path = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 分类页面 (/categories/)</span></span><br><span class="line">        <span class="keyword">if</span> (path === <span class="string">&#x27;/categories/&#x27;</span> || path === <span class="string">&#x27;/categories&#x27;</span> || path === <span class="string">&#x27;/categories/index.html&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;categories-index&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 具体分类页面 (/categories/魔改教程/)</span></span><br><span class="line">        <span class="keyword">if</span> (path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/categories/&#x27;</span>) &amp;&amp; path !== <span class="string">&#x27;/categories/&#x27;</span> &amp;&amp; path !== <span class="string">&#x27;/categories&#x27;</span> &amp;&amp; path !== <span class="string">&#x27;/categories/index.html&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;category-page&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;other&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 控制统计图显示</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">controlChartDisplay</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> pageType = <span class="title function_">detectPageType</span>();</span><br><span class="line">        <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;categories-chart&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;控制统计图显示:&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>,</span><br><span class="line">            <span class="attr">pageType</span>: pageType,</span><br><span class="line">            <span class="attr">chartElement</span>: !!chartElement</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!chartElement) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;统计图元素不存在 - 可能是具体分类页面&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (pageType === <span class="string">&#x27;categories-index&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// 分类页面：确保统计图完全显示</span></span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;300px&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;显示统计图 - 分类页面:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 重新创建分类统计图</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">recreateCategoriesChart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;categories-chart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!chartElement || <span class="keyword">typeof</span> echarts === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;无法重新创建图表：元素不存在或ECharts未加载&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否已经有图表脚本</span></span><br><span class="line">        <span class="keyword">const</span> existingScript = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;categoriesChart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (existingScript) &#123;</span><br><span class="line">            existingScript.<span class="title function_">remove</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 重新获取分类数据并创建图表</span></span><br><span class="line">        <span class="title function_">fetch</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>())</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">html</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> parser = <span class="keyword">new</span> <span class="title class_">DOMParser</span>();</span><br><span class="line">                <span class="keyword">const</span> doc = parser.<span class="title function_">parseFromString</span>(html, <span class="string">&#x27;text/html&#x27;</span>);</span><br><span class="line">                <span class="keyword">const</span> chartScript = doc.<span class="title function_">getElementById</span>(<span class="string">&#x27;categoriesChart&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (chartScript) &#123;</span><br><span class="line">                    <span class="comment">// 将脚本添加到当前页面</span></span><br><span class="line">                    <span class="keyword">const</span> newScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">                    newScript.<span class="property">id</span> = <span class="string">&#x27;categoriesChart&#x27;</span>;</span><br><span class="line">                    newScript.<span class="property">textContent</span> = chartScript.<span class="property">textContent</span>;</span><br><span class="line">                    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(newScript);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;分类统计图已重新创建&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;未找到图表脚本&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;重新创建图表失败:&#x27;</span>, error);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听页面变化（PJAX支持）</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handlePageChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;页面变化检测:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 延迟执行，确保DOM完全更新</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 重新初始化ECharts（如果需要）</span></span><br><span class="line">            <span class="keyword">const</span> pageType = <span class="title function_">detectPageType</span>();</span><br><span class="line">            <span class="keyword">if</span> (pageType === <span class="string">&#x27;categories-index&#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">// 在分类页面，确保ECharts正确显示</span></span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// 尝试重新初始化图表</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">categoriesChart</span> &amp;&amp; <span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">categoriesChart</span>.<span class="property">resize</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">categoriesChart</span>.<span class="title function_">resize</span>();</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ECharts图表已调整大小&#x27;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 如果图表实例不存在，重新创建图表</span></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;图表实例不存在，尝试重新创建&#x27;</span>);</span><br><span class="line">                        <span class="title function_">recreateCategoriesChart</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, <span class="number">200</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听浏览器后退/前进</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;popstate&#x27;</span>, handlePageChange);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听PJAX事件（如果使用PJAX）</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">pjax</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, handlePageChange);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:success&#x27;</span>, handlePageChange);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听所有可能的页面变化事件</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, handlePageChange);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, handlePageChange);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听自定义图表重新初始化事件</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;chart-reinit&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;收到图表重新初始化事件&#x27;</span>);</span><br><span class="line">        <span class="title function_">recreateCategoriesChart</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 页面加载完成后执行</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, controlChartDisplay);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 立即执行一次，确保页面加载时就能正确显示</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(controlChartDisplay, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 暴露控制函数供外部调用</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">categoriesChartControl</span> = &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;categories-chart&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (chartElement) &#123;</span><br><span class="line">                <span class="comment">// 重置样式确保完全显示</span></span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;300px&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">refresh</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">recreate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">recreateCategoriesChart</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="5-1-3-创建分类统计图控制样式">5.1.3 创建分类统计图控制样式</h4><p><strong>文件：<code>themes/solitude/source/css/custom/categories-chart-control.css</code></strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分类统计图显示控制</span></span><br><span class="line"><span class="comment"> * 根据页面类型控制统计图的显示和隐藏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 默认显示统计图（分类页面 /categories/） */</span></span><br><span class="line"><span class="selector-id">#categories-chart</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#categories-chart</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">250px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">8px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#categories-chart</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-标签页面修改">5.2 标签页面修改</h3><h4 id="5-2-1-修改具体标签页面模板">5.2.1 修改具体标签页面模板</h4><p><strong>文件：<code>themes/solitude/layout/tag.pug</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner</span><br><span class="line">        #tag</span><br><span class="line">            #tag-page-tags</span><br><span class="line">                each tag in site.tags.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">                    a(id=tag.name class=(tag.name === page.tag ? &#x27;select&#x27; : &#x27;&#x27;) href=url_for(tag.path))</span><br><span class="line">                        span.tags-punctuation</span><br><span class="line">                            i.solitude.fas.fa-hashtag</span><br><span class="line">                            =tag.name</span><br><span class="line">                            span.tagsPageCount=tag.length</span><br><span class="line">            .recent-posts#recent-posts</span><br><span class="line">                each post,index in page.posts.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">                    include includes/widgets/home/postList</span><br><span class="line">                include includes/mixins/pagination</span><br><span class="line">            if theme.comment.hot_tip.enable</span><br><span class="line">                include ./includes/widgets/third-party/hot/index.pug</span><br><span class="line">        include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong></p><ul><li>移除了 <code>&lt;div id=&quot;tags-chart&quot; data-length=&quot;10&quot; style=&quot;height: 300px; padding: 10px;&quot;&gt;&lt;/div&gt;</code></li><li>保留了其他页面元素不变</li></ul><h4 id="5-2-2-创建标签统计图控制脚本">5.2.2 创建标签统计图控制脚本</h4><p><strong>文件：<code>themes/solitude/source/js/custom/tags-chart-control.js</code></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 标签统计图显示控制脚本</span></span><br><span class="line"><span class="comment"> * 根据页面类型和用户行为控制统计图的显示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检测当前页面类型</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">detectPageType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> path = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 标签页面 (/tags/)</span></span><br><span class="line">        <span class="keyword">if</span> (path === <span class="string">&#x27;/tags/&#x27;</span> || path === <span class="string">&#x27;/tags&#x27;</span> || path === <span class="string">&#x27;/tags/index.html&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;tags-index&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 具体标签页面 (/tags/标签名/)</span></span><br><span class="line">        <span class="keyword">if</span> (path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/tags/&#x27;</span>) &amp;&amp; path !== <span class="string">&#x27;/tags/&#x27;</span> &amp;&amp; path !== <span class="string">&#x27;/tags&#x27;</span> &amp;&amp; path !== <span class="string">&#x27;/tags/index.html&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;tag-page&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;other&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 控制统计图显示</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">controlChartDisplay</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> pageType = <span class="title function_">detectPageType</span>();</span><br><span class="line">        <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tags-chart&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;控制标签统计图显示:&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>,</span><br><span class="line">            <span class="attr">pageType</span>: pageType,</span><br><span class="line">            <span class="attr">chartElement</span>: !!chartElement</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!chartElement) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;标签统计图元素不存在 - 可能是具体标签页面&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (pageType === <span class="string">&#x27;tags-index&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// 标签页面：确保统计图完全显示</span></span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;300px&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;显示标签统计图 - 标签页面:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 重新创建标签统计图</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">recreateTagsChart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tags-chart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!chartElement || <span class="keyword">typeof</span> echarts === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;无法重新创建标签图表：元素不存在或ECharts未加载&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否已经有图表脚本</span></span><br><span class="line">        <span class="keyword">const</span> existingScript = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tagsChart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (existingScript) &#123;</span><br><span class="line">            existingScript.<span class="title function_">remove</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 重新获取标签数据并创建图表</span></span><br><span class="line">        <span class="title function_">fetch</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>())</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">html</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> parser = <span class="keyword">new</span> <span class="title class_">DOMParser</span>();</span><br><span class="line">                <span class="keyword">const</span> doc = parser.<span class="title function_">parseFromString</span>(html, <span class="string">&#x27;text/html&#x27;</span>);</span><br><span class="line">                <span class="keyword">const</span> chartScript = doc.<span class="title function_">getElementById</span>(<span class="string">&#x27;tagsChart&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (chartScript) &#123;</span><br><span class="line">                    <span class="comment">// 将脚本添加到当前页面</span></span><br><span class="line">                    <span class="keyword">const</span> newScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">                    newScript.<span class="property">id</span> = <span class="string">&#x27;tagsChart&#x27;</span>;</span><br><span class="line">                    newScript.<span class="property">textContent</span> = chartScript.<span class="property">textContent</span>;</span><br><span class="line">                    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(newScript);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;标签统计图已重新创建&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;未找到标签图表脚本&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;重新创建标签图表失败:&#x27;</span>, error);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听页面变化（PJAX支持）</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handlePageChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;标签页面变化检测:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 延迟执行，确保DOM完全更新</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 重新初始化ECharts（如果需要）</span></span><br><span class="line">            <span class="keyword">const</span> pageType = <span class="title function_">detectPageType</span>();</span><br><span class="line">            <span class="keyword">if</span> (pageType === <span class="string">&#x27;tags-index&#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">// 在标签页面，确保ECharts正确显示</span></span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// 尝试重新初始化图表</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">tagsChart</span> &amp;&amp; <span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">tagsChart</span>.<span class="property">resize</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">tagsChart</span>.<span class="title function_">resize</span>();</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ECharts标签图表已调整大小&#x27;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 如果图表实例不存在，重新创建图表</span></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;标签图表实例不存在，尝试重新创建&#x27;</span>);</span><br><span class="line">                        <span class="title function_">recreateTagsChart</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, <span class="number">200</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听浏览器后退/前进</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;popstate&#x27;</span>, handlePageChange);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听PJAX事件（如果使用PJAX）</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">pjax</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, handlePageChange);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:success&#x27;</span>, handlePageChange);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听所有可能的页面变化事件</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, handlePageChange);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, handlePageChange);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听自定义图表重新初始化事件</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;tags-chart-reinit&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;收到标签图表重新初始化事件&#x27;</span>);</span><br><span class="line">        <span class="title function_">recreateTagsChart</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 页面加载完成后执行</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, controlChartDisplay);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 立即执行一次，确保页面加载时就能正确显示</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(controlChartDisplay, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 暴露控制函数供外部调用</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">tagsChartControl</span> = &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tags-chart&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (chartElement) &#123;</span><br><span class="line">                <span class="comment">// 重置样式确保完全显示</span></span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;300px&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">refresh</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">recreate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">recreateTagsChart</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="5-2-3-创建标签统计图控制样式">5.2.3 创建标签统计图控制样式</h4><p><strong>文件：<code>themes/solitude/source/css/custom/tags-chart-control.css</code></strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 标签统计图显示控制</span></span><br><span class="line"><span class="comment"> * 根据页面类型控制统计图的显示和隐藏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 默认显示统计图（标签页面 /tags/） */</span></span><br><span class="line"><span class="selector-id">#tags-chart</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#tags-chart</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">250px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">8px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#tags-chart</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-3-归档页面修改">5.3 归档页面修改</h3><h4 id="5-3-1-修改归档页面模板">5.3.1 修改归档页面模板</h4><p><strong>文件：<code>themes/solitude/layout/archive.pug</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner</span><br><span class="line">        #archive</span><br><span class="line">            &lt;div id=&quot;posts-chart&quot; data-start=&quot;2021-01&quot; style=&quot;height: 300px; padding: 10px;&quot;&gt;&lt;/div&gt;</span><br><span class="line">            .article-sort-title #&#123;__(&#x27;page.archives&#x27;)&#125;&lt;sup&gt;#&#123;page.year ? page.posts.length : site.posts.find(&#123;parent: &#123;$exists: false&#125;&#125;).length&#125;&lt;/sup&gt;</span><br><span class="line">            case theme.page.archives</span><br><span class="line">                when 0</span><br><span class="line">                    .article-sort</span><br><span class="line">                        include includes/mixins/articleSort</span><br><span class="line">                    include includes/mixins/pagination</span><br><span class="line">                when 1</span><br><span class="line">                    .recent-posts#recent-posts</span><br><span class="line">                        each post,index in page.posts.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">                            include includes/widgets/home/postList</span><br><span class="line">                        include includes/mixins/pagination</span><br><span class="line">                    if theme.comment.hot_tip.enable</span><br><span class="line">                        include ./includes/widgets/third-party/hot/index.pug</span><br><span class="line">        include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong></p><ul><li>始终包含统计图元素，通过JavaScript控制显示/隐藏</li><li>文章数显示：根据是否有 <code>page.year</code> 来显示筛选后的数量或总数量</li></ul><h4 id="5-3-2-修改文章排序mixin">5.3.2 修改文章排序mixin</h4><p><strong>文件：<code>themes/solitude/layout/includes/mixins/articleSort.pug</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- let year</span><br><span class="line">each post in page.posts.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">    if(year !== post.date.year())</span><br><span class="line">        - year = post.date.year()</span><br><span class="line">        if page.year</span><br><span class="line">            .article-sort-item.year #&#123;page.year&#125;-#&#123;page.month&#125;</span><br><span class="line">        else</span><br><span class="line">            .article-sort-item.year #&#123;year&#125;</span><br><span class="line">    .article-sort-item</span><br><span class="line">        a.article-sort-item-img(href=url_for(post.path) title=post.title)</span><br><span class="line">            img(src=url_for(post.cover) alt=post.title)</span><br><span class="line">        .article-sort-item-info</span><br><span class="line">            a.article-sort-item-title(href=url_for(post.path) title=post.title onclick=&quot;window.event.cancelBubble=true;&quot;) #&#123;post.title&#125;</span><br><span class="line">            .article-sort-item-tags</span><br><span class="line">                each tags in post.tags.data</span><br><span class="line">                    a.article-meta__tags(href=url_for(tags.path) onclick=&quot;window.event.cancelBubble=true;&quot;)</span><br><span class="line">                        span.tags-punctuation</span><br><span class="line">                            i.solitude.fas.fa-hashtag</span><br><span class="line">                            =tags.name</span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong></p><ul><li>具体月份页面：显示 <code>#&#123;page.year&#125;-#&#123;page.month&#125;</code> (如2025-10)</li><li>主归档页面：显示 <code>#&#123;year&#125;</code> (如2025)</li></ul><h4 id="5-3-3-创建文章统计图控制脚本">5.3.3 创建文章统计图控制脚本</h4><p><strong>文件：<code>themes/solitude/source/js/custom/posts-chart-control.js</code></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文章统计图显示控制脚本</span></span><br><span class="line"><span class="comment"> * 根据页面类型和用户行为控制统计图的显示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检测当前页面类型</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">detectPageType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> path = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 归档页面 (/archives/)</span></span><br><span class="line">        <span class="keyword">if</span> (path === <span class="string">&#x27;/archives/&#x27;</span> || path === <span class="string">&#x27;/archives&#x27;</span> || path === <span class="string">&#x27;/archives/index.html&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;archives-index&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 具体月份页面 (/archives/2024/10/)</span></span><br><span class="line">        <span class="keyword">if</span> (path.<span class="title function_">startsWith</span>(<span class="string">&#x27;/archives/&#x27;</span>) &amp;&amp; path !== <span class="string">&#x27;/archives/&#x27;</span> &amp;&amp; path !== <span class="string">&#x27;/archives&#x27;</span> &amp;&amp; path !== <span class="string">&#x27;/archives/index.html&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;archive-page&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;other&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 控制统计图显示</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">controlChartDisplay</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> pageType = <span class="title function_">detectPageType</span>();</span><br><span class="line">        <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;posts-chart&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;控制文章统计图显示:&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>,</span><br><span class="line">            <span class="attr">pageType</span>: pageType,</span><br><span class="line">            <span class="attr">chartElement</span>: !!chartElement</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!chartElement) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;文章统计图元素不存在 - 可能是具体月份页面&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (pageType === <span class="string">&#x27;archives-index&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// 归档页面：确保统计图完全显示</span></span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;300px&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;显示文章统计图 - 归档页面:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pageType === <span class="string">&#x27;archive-page&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// 具体月份页面：隐藏统计图</span></span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">            chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;隐藏文章统计图 - 具体月份页面:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 重新创建文章统计图</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">recreatePostsChart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;posts-chart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!chartElement || <span class="keyword">typeof</span> echarts === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;无法重新创建文章图表：元素不存在或ECharts未加载&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否已经有图表脚本</span></span><br><span class="line">        <span class="keyword">const</span> existingScript = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;postsChart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (existingScript) &#123;</span><br><span class="line">            existingScript.<span class="title function_">remove</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 重新获取文章数据并创建图表</span></span><br><span class="line">        <span class="title function_">fetch</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>())</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">html</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> parser = <span class="keyword">new</span> <span class="title class_">DOMParser</span>();</span><br><span class="line">                <span class="keyword">const</span> doc = parser.<span class="title function_">parseFromString</span>(html, <span class="string">&#x27;text/html&#x27;</span>);</span><br><span class="line">                <span class="keyword">const</span> chartScript = doc.<span class="title function_">getElementById</span>(<span class="string">&#x27;postsChart&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (chartScript) &#123;</span><br><span class="line">                    <span class="comment">// 将脚本添加到当前页面</span></span><br><span class="line">                    <span class="keyword">const</span> newScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">                    newScript.<span class="property">id</span> = <span class="string">&#x27;postsChart&#x27;</span>;</span><br><span class="line">                    newScript.<span class="property">textContent</span> = chartScript.<span class="property">textContent</span>;</span><br><span class="line">                    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(newScript);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;文章统计图已重新创建&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;未找到文章图表脚本&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;重新创建文章图表失败:&#x27;</span>, error);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听页面变化（PJAX支持）</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handlePageChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;文章页面变化检测:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 延迟执行，确保DOM完全更新</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 重新初始化ECharts（如果需要）</span></span><br><span class="line">            <span class="keyword">const</span> pageType = <span class="title function_">detectPageType</span>();</span><br><span class="line">            <span class="keyword">if</span> (pageType === <span class="string">&#x27;archives-index&#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">// 在归档页面，确保ECharts正确显示</span></span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// 尝试重新初始化图表</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">postsChart</span> &amp;&amp; <span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">postsChart</span>.<span class="property">resize</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">postsChart</span>.<span class="title function_">resize</span>();</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ECharts文章图表已调整大小&#x27;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 如果图表实例不存在，重新创建图表</span></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;文章图表实例不存在，尝试重新创建&#x27;</span>);</span><br><span class="line">                        <span class="title function_">recreatePostsChart</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, <span class="number">200</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听浏览器后退/前进</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;popstate&#x27;</span>, handlePageChange);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听PJAX事件（如果使用PJAX）</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">pjax</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, handlePageChange);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:success&#x27;</span>, handlePageChange);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听所有可能的页面变化事件</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, handlePageChange);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, handlePageChange);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听自定义图表重新初始化事件</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;posts-chart-reinit&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;收到文章图表重新初始化事件&#x27;</span>);</span><br><span class="line">        <span class="title function_">recreatePostsChart</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 页面加载完成后执行</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, controlChartDisplay);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 立即执行一次，确保页面加载时就能正确显示</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(controlChartDisplay, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 暴露控制函数供外部调用</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">postsChartControl</span> = &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> chartElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;posts-chart&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (chartElement) &#123;</span><br><span class="line">                <span class="comment">// 重置样式确保完全显示</span></span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;300px&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&#x27;10px&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">margin</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">                chartElement.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;visible&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">refresh</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">controlChartDisplay</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">recreate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">recreatePostsChart</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="5-3-4-创建文章统计图控制样式">5.3.4 创建文章统计图控制样式</h4><p><strong>文件：<code>themes/solitude/source/css/custom/posts-chart-control.css</code></strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文章统计图显示控制</span></span><br><span class="line"><span class="comment"> * 根据页面类型控制统计图的显示和隐藏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 默认显示统计图（归档页面 /archives/） */</span></span><br><span class="line"><span class="selector-id">#posts-chart</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#posts-chart</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">250px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">8px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#posts-chart</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-4-条件加载配置">5.4 条件加载配置</h3><h4 id="5-4-1-更新头部模板">5.4.1 更新头部模板</h4><p><strong>文件：<code>themes/solitude/layout/includes/head.pug</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// categories chart control css</span><br><span class="line">if page.type === &#x27;categories&#x27; || is_category()</span><br><span class="line">  link(rel=&quot;stylesheet&quot;, href=url_for(&#x27;/css/custom/categories-chart-control.css&#x27;))</span><br><span class="line"></span><br><span class="line">// tags chart control css</span><br><span class="line">if page.type === &#x27;tags&#x27; || is_tag()</span><br><span class="line">  link(rel=&quot;stylesheet&quot;, href=url_for(&#x27;/css/custom/tags-chart-control.css&#x27;))</span><br><span class="line"></span><br><span class="line">// posts chart control css</span><br><span class="line">if page.type === &#x27;archives&#x27; || is_archive()</span><br><span class="line">  link(rel=&quot;stylesheet&quot;, href=url_for(&#x27;/css/custom/posts-chart-control.css&#x27;))</span><br></pre></td></tr></table></figure><h4 id="5-4-2-更新底部脚本注入">5.4.2 更新底部脚本注入</h4><p><strong>文件：<code>themes/solitude/layout/includes/inject/body.pug</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// categories chart control js</span><br><span class="line">if page.type === &#x27;categories&#x27; || is_category()</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/categories-chart-control.js&#x27;))</span><br><span class="line"></span><br><span class="line">// tags chart control js</span><br><span class="line">if page.type === &#x27;tags&#x27; || is_tag()</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/tags-chart-control.js&#x27;))</span><br><span class="line"></span><br><span class="line">// posts chart control js</span><br><span class="line">if page.type === &#x27;archives&#x27; || is_archive()</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/posts-chart-control.js&#x27;))</span><br></pre></td></tr></table></figure><h2 id="六、技术要点总结">六、技术要点总结</h2><h3 id="6-1-核心思路">6.1 核心思路</h3><ol><li><strong>从源头解决问题</strong>：不在具体页面生成统计图元素，而不是生成后再隐藏</li><li><strong>智能页面检测</strong>：根据URL路径自动识别页面类型</li><li><strong>PJAX兼容</strong>：支持PJAX环境下的图表重新初始化</li><li><strong>条件加载</strong>：只在需要的页面加载相关资源</li></ol><h3 id="6-2-关键技术">6.2 关键技术</h3><ol><li><strong>页面类型检测</strong>：通过URL路径判断当前页面类型</li><li><strong>图表重新创建</strong>：使用fetch获取页面内容，提取并重新注入ECharts脚本</li><li><strong>事件监听</strong>：监听多种页面变化事件，确保兼容性</li><li><strong>延迟执行</strong>：使用setTimeout确保DOM完全更新后再执行</li></ol><h3 id="6-3-性能优化">6.3 性能优化</h3><ol><li><strong>条件加载</strong>：只在相关页面加载控制脚本和样式</li><li><strong>智能检测</strong>：先尝试调整现有图表，不存在时才重新创建</li><li><strong>错误处理</strong>：完善的错误处理和日志记录</li><li><strong>响应式设计</strong>：支持不同屏幕尺寸的适配</li></ol><h2 id="七、使用说明">七、使用说明</h2><h3 id="7-1-功能特性">7.1 功能特性</h3><ul><li>✅ <strong>分类页面</strong>：显示统计饼图，支持点击跳转</li><li>✅ <strong>具体分类页面</strong>：不显示统计图，不占空间</li><li>✅ <strong>标签页面</strong>：显示统计柱状图，支持点击跳转</li><li>✅ <strong>具体标签页面</strong>：不显示统计图，不占空间</li><li>✅ <strong>归档页面</strong>：显示统计曲线图，支持点击跳转</li><li>✅ <strong>具体月份页面</strong>：不显示统计图，不占空间，正确显示文章数和年份-月份</li><li>✅ <strong>后退按钮</strong>：正确显示统计图，支持点击</li><li>✅ <strong>PJAX兼容</strong>：支持无刷新页面切换</li></ul><h3 id="7-2-调试功能">7.2 调试功能</h3><p>脚本提供了详细的console.log输出，可以在浏览器开发者工具中查看：</p><ul><li>页面类型检测结果</li><li>统计图元素存在状态</li><li>图表重新创建过程</li><li>错误信息</li></ul><h3 id="7-3-外部调用">7.3 外部调用</h3><p>提供了全局控制函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分类统计图控制</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">categoriesChartControl</span>.<span class="title function_">show</span>();    <span class="comment">// 显示统计图</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">categoriesChartControl</span>.<span class="title function_">refresh</span>(); <span class="comment">// 刷新控制</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">categoriesChartControl</span>.<span class="title function_">recreate</span>(); <span class="comment">// 重新创建图表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签统计图控制</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">tagsChartControl</span>.<span class="title function_">show</span>();    <span class="comment">// 显示统计图</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">tagsChartControl</span>.<span class="title function_">refresh</span>(); <span class="comment">// 刷新控制</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">tagsChartControl</span>.<span class="title function_">recreate</span>(); <span class="comment">// 重新创建图表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文章统计图控制</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">postsChartControl</span>.<span class="title function_">show</span>();    <span class="comment">// 显示统计图</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">postsChartControl</span>.<span class="title function_">refresh</span>(); <span class="comment">// 刷新控制</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">postsChartControl</span>.<span class="title function_">recreate</span>(); <span class="comment">// 重新创建图表</span></span><br></pre></td></tr></table></figure><h2 id="八、总结">八、总结</h2><p>本次魔改成功解决了Solitude主题中分类、标签和归档页面统计图的显示控制问题。通过从源头解决问题的方式，实现了：</p><ol><li><strong>用户体验优化</strong>：具体页面不再显示不必要的统计图</li><li><strong>功能完整性</strong>：后退操作后统计图正确显示</li><li><strong>技术兼容性</strong>：支持PJAX无刷新页面切换</li><li><strong>代码可维护性</strong>：清晰的代码结构和完善的错误处理</li><li><strong>归档页面特殊处理</strong>：正确显示文章数和年份-月份格式</li></ol><p>这种解决方案不仅适用于分类、标签和归档页面，也可以作为其他类似问题的解决思路。通过智能检测、条件加载和动态创建的方式，实现了统计图的完美控制。</p><hr><p><strong>注意事项：</strong></p><ol><li>修改前请备份相关文件</li><li>确保ECharts库已正确加载</li><li>如果使用CDN，请确保网络连接正常</li><li>建议在测试环境中先验证功能正常</li></ol><p><strong>相关文件：</strong></p><ul><li>分类页面：<code>themes/solitude/layout/category.pug</code></li><li>标签页面：<code>themes/solitude/layout/tag.pug</code></li><li>归档页面：<code>themes/solitude/layout/archive.pug</code></li><li>文章排序：<code>themes/solitude/layout/includes/mixins/articleSort.pug</code></li><li>控制脚本：<code>themes/solitude/source/js/custom/</code></li><li>控制样式：<code>themes/solitude/source/css/custom/</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
            <tag> 问题修复 </tag>
            
            <tag> ECharts </tag>
            
            <tag> 分类页面 </tag>
            
            <tag> 标签页面 </tag>
            
            <tag> 归档页面 </tag>
            
            <tag> 统计图 </tag>
            
            <tag> PJAX </tag>
            
            <tag> 页面控制 </tag>
            
            <tag> Pug模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(25) - 页脚赛博养鱼功能实现</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(25)-%E9%A1%B5%E8%84%9A%E8%B5%9B%E5%8D%9A%E5%85%BB%E9%B1%BC%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(25)-%E9%A1%B5%E8%84%9A%E8%B5%9B%E5%8D%9A%E5%85%BB%E9%B1%BC%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Solitude主题中，页脚区域通常是静态的，缺乏一些生动有趣的元素。为了让博客更加生动有趣，我们可以添加一个&quot;赛博养鱼&quot;功能，在页脚区域显示游动的鱼儿动画效果。这个功能不仅能够增加页面的趣味性，还能让访客在浏览完文章后有一个愉悦的视觉体验。</p><h2 id="一、功能特点">一、功能特点</h2><h3 id="1-1-核心特性">1.1 核心特性</h3><ul><li><strong>动态鱼儿动画</strong>：在页脚区域显示游动的鱼儿</li><li><strong>透明背景</strong>：不影响页脚原有内容的显示</li><li><strong>响应式设计</strong>：支持移动端和桌面端</li><li><strong>层级管理</strong>：合理的z-index设置，避免遮挡其他功能</li><li><strong>性能优化</strong>：使用Canvas绘制，性能良好</li></ul><h3 id="1-2-技术优势">1.2 技术优势</h3><ul><li><strong>Canvas渲染</strong>：使用HTML5 Canvas技术，性能优异</li><li><strong>智能定位</strong>：合理的CSS定位，不影响页面布局</li><li><strong>兼容性好</strong>：支持现代浏览器，响应式适配</li><li><strong>易于维护</strong>：清晰的代码结构，便于后续修改</li></ul><h2 id="二、实现步骤">二、实现步骤</h2><h3 id="2-1-第一步：创建CSS样式文件">2.1 第一步：创建CSS样式文件</h3><p>首先，我们需要创建一个专门的CSS文件来定义鱼儿容器的样式。</p><p><strong>文件路径</strong>：<code>themes/solitude/source/css/custom/fish.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页脚养鱼样式 */</span></span><br><span class="line"><span class="selector-id">#jsi-flying-fish-container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span> <span class="meta">!important</span>; <span class="comment">/* 增加高度，从160px改为200px，填掉水边和底部的空白 */</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>; <span class="comment">/* 透明背景 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">100</span> <span class="meta">!important</span>; <span class="comment">/* 降低z-index，避免遮挡音乐播放器 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#jsi-flying-fish-container</span> <span class="selector-tag">canvas</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 确保页脚内容不被遮挡 */</span></span><br><span class="line"><span class="selector-id">#footer-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 调整footer-bar-links的上边缘，让其与footer-bar保持一致 */</span></span><br><span class="line"><span class="selector-id">#footer-bar</span> <span class="selector-class">.footer-bar-links</span> &#123;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#jsi-flying-fish-container</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">180px</span> <span class="meta">!important</span>; <span class="comment">/* 移动端稍微减小高度 */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-第二步：修改页脚模板">2.2 第二步：修改页脚模板</h3><p>接下来，我们需要在页脚模板中添加鱼儿容器。</p><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/footer.pug</code></p><p>在适当的位置添加以下代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 页脚养鱼容器 - 放在footer-bar-links上方</span><br><span class="line">#jsi-flying-fish-container.container</span><br><span class="line"></span><br><span class="line">div#footer-bar</span><br><span class="line">    div.footer-bar-links</span><br><span class="line">        // ... 原有的页脚内容 ...</span><br></pre></td></tr></table></figure><h3 id="2-3-第三步：配置主题文件">2.3 第三步：配置主题文件</h3><p>最后，我们需要在主题配置文件中引入相关的CSS和JavaScript文件。</p><p><strong>文件路径</strong>：<code>_config.solitude.yml</code></p><p>在<code>extends</code>部分添加以下配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extends:</span></span><br><span class="line">  <span class="comment"># Insert in head</span></span><br><span class="line">  <span class="comment"># 插入到 head</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># ... 其他样式文件 ...</span></span><br><span class="line">    <span class="comment"># 页脚养鱼</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom/fish.css&quot;&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Insert in body</span></span><br><span class="line">  <span class="comment"># 插入到 body</span></span><br><span class="line">  <span class="attr">body:</span></span><br><span class="line">    <span class="comment"># ... 其他脚本文件 ...</span></span><br><span class="line">    <span class="comment"># 页脚养鱼</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fish.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="三、技术要点解析">三、技术要点解析</h2><h3 id="3-1-CSS样式设计">3.1 CSS样式设计</h3><h4 id="3-1-1-容器定位">3.1.1 容器定位</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#jsi-flying-fish-container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>使用<code>position: relative</code>确保容器在文档流中的正常位置</li><li>设置<code>width: 100%</code>让容器占满父容器的宽度</li><li>设置<code>height: 200px</code>为鱼儿动画提供足够的显示空间</li></ul><h4 id="3-1-2-层级管理">3.1.2 层级管理</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">z-index</span>: <span class="number">100</span> <span class="meta">!important</span>; <span class="comment">/* 降低z-index，避免遮挡音乐播放器 */</span></span><br></pre></td></tr></table></figure><ul><li>设置合适的z-index值，确保鱼儿容器不会遮挡其他重要功能</li><li>音乐播放器通常使用更高的z-index值（如9999）</li><li>页脚内容使用z-index: 1000，确保在鱼儿容器之上</li></ul><h4 id="3-1-3-背景透明">3.1.3 背景透明</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background</span>: transparent <span class="meta">!important</span>; <span class="comment">/* 透明背景 */</span></span><br></pre></td></tr></table></figure><ul><li>使用透明背景，让页脚原有内容能够正常显示</li><li>鱼儿动画作为装饰层，不干扰主要内容的阅读</li><li>保持页面的视觉层次和功能完整性</li></ul><h3 id="3-2-响应式设计">3.2 响应式设计</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#jsi-flying-fish-container</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">180px</span> <span class="meta">!important</span>; <span class="comment">/* 移动端稍微减小高度 */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在移动端设备上，适当减小容器高度</li><li>确保在不同屏幕尺寸下都有良好的显示效果</li><li>优化移动端用户体验</li></ul><h3 id="3-3-模板结构">3.3 模板结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 页脚养鱼容器 - 放在footer-bar-links上方</span><br><span class="line">#jsi-flying-fish-container.container</span><br><span class="line"></span><br><span class="line">div#footer-bar</span><br><span class="line">    div.footer-bar-links</span><br><span class="line">        // ... 页脚内容 ...</span><br></pre></td></tr></table></figure><ul><li>将鱼儿容器放置在<code>footer-bar</code>之前</li><li>确保鱼儿动画在页脚内容上方显示</li><li>保持页脚原有布局结构不变</li></ul><h2 id="四、样式优化建议">四、样式优化建议</h2><h3 id="4-1-高度调整">4.1 高度调整</h3><p>根据实际需要，可以调整容器高度：</p><ul><li>桌面端：200px（当前设置）</li><li>移动端：180px（当前设置）</li><li>可以根据页脚内容高度进行微调</li></ul><h3 id="4-2-层级优化">4.2 层级优化</h3><p>如果发现与其他元素有层级冲突，可以调整z-index值：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">z-index</span>: <span class="number">50</span> <span class="meta">!important</span>; <span class="comment">/* 进一步降低层级 */</span></span><br></pre></td></tr></table></figure><h3 id="4-3-边距调整">4.3 边距调整</h3><p>如果需要鱼儿容器与页脚内容之间有间距，可以添加margin：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">10px</span> <span class="meta">!important</span>; <span class="comment">/* 添加底部间距 */</span></span><br></pre></td></tr></table></figure><h2 id="五、高级功能扩展">五、高级功能扩展</h2><h3 id="5-1-自定义鱼儿数量">5.1 自定义鱼儿数量</h3><p>可以通过修改JavaScript文件来调整鱼儿的数量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">FISH_COUNT</span>: <span class="number">5</span>, <span class="comment">// 增加鱼儿数量</span></span><br></pre></td></tr></table></figure><h3 id="5-2-鱼儿颜色定制">5.2 鱼儿颜色定制</h3><p>可以修改鱼儿的颜色和样式，让它们更加个性化。</p><h3 id="5-3-交互功能">5.3 交互功能</h3><p>可以添加点击事件，让访客与鱼儿进行互动。</p><h2 id="六、注意事项">六、注意事项</h2><h3 id="6-1-性能考虑">6.1 性能考虑</h3><ul><li>鱼儿动画使用Canvas绘制，性能较好</li><li>如果鱼儿数量过多，可能会影响页面性能</li><li>建议在移动端适当减少鱼儿数量</li></ul><h3 id="6-2-兼容性">6.2 兼容性</h3><ul><li>确保jQuery库正确加载</li><li>检查CDN链接的可用性</li><li>支持现代浏览器，IE9以下可能不兼容</li></ul><h3 id="6-3-层级冲突">6.3 层级冲突</h3><ul><li>定期检查z-index设置，避免与其他功能冲突</li><li>特别是音乐播放器、返回顶部按钮等浮动元素</li><li>建议使用较低的z-index值（100以下）</li></ul><h2 id="七、故障排除">七、故障排除</h2><h3 id="7-1-问题1：鱼儿不显示">7.1 问题1：鱼儿不显示</h3><p><strong>解决方案</strong>：</p><ol><li>检查CSS文件是否正确加载</li><li>确认容器ID是否正确</li><li>检查JavaScript文件是否正常加载</li><li>查看浏览器控制台是否有错误信息</li></ol><h3 id="7-2-问题2：鱼儿遮挡其他内容">7.2 问题2：鱼儿遮挡其他内容</h3><p><strong>解决方案</strong>：</p><ol><li>降低z-index值</li><li>调整容器位置</li><li>检查其他元素的z-index设置</li><li>确保页脚内容有足够的z-index值</li></ol><h3 id="7-3-问题3：移动端显示异常">7.3 问题3：移动端显示异常</h3><p><strong>解决方案</strong>：</p><ol><li>检查响应式CSS规则</li><li>调整移动端的高度设置</li><li>测试不同设备尺寸</li><li>优化移动端性能</li></ol><h2 id="八、效果预览">八、效果预览</h2><p>实现完成后，页脚区域将会显示：</p><ul><li>游动的鱼儿动画效果</li><li>透明背景，不影响页脚内容</li><li>响应式设计，适配各种设备</li><li>合理的层级管理，无遮挡问题</li></ul><h2 id="九、总结">九、总结</h2><p>通过这次魔改，我们成功为Solitude主题添加了页脚赛博养鱼功能。这个功能不仅增加了页面的趣味性，还展示了如何通过CSS和JavaScript来增强主题的视觉效果。</p><h3 id="9-1-关键要点">9.1 关键要点</h3><ol><li><strong>合理的CSS结构</strong>：确保样式文件组织清晰</li><li><strong>正确的层级管理</strong>：避免z-index冲突</li><li><strong>响应式设计</strong>：适配不同设备</li><li><strong>性能优化</strong>：使用Canvas绘制动画</li></ol><h3 id="9-2-技术收获">9.2 技术收获</h3><ul><li>掌握了CSS层级管理技巧</li><li>了解了响应式设计实现方法</li><li>学会了Pug模板的修改技巧</li><li>掌握了主题配置文件的修改方法</li></ul><h3 id="9-3-应用价值">9.3 应用价值</h3><ul><li>提升博客的视觉吸引力</li><li>增加用户交互体验</li><li>展示前端技术能力</li><li>为其他功能开发提供参考</li></ul><p>希望这篇教程能够帮助大家更好地理解和实现页脚养鱼功能！如果遇到问题，欢迎在评论区讨论。</p><hr><p><strong>相关链接</strong>：</p><ul><li><a href="https://solitude.js.org">Solitude主题官方文档</a></li><li><a href="https://hexo.io/docs/">Hexo官方文档</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">Canvas API文档</a></li></ul><p><strong>注意事项：</strong></p><ol><li>修改前请备份相关文件</li><li>确保jQuery库已正确加载</li><li>如果使用CDN，请确保网络连接正常</li><li>建议在测试环境中先验证功能正常</li></ol><p><strong>相关文件：</strong></p><ul><li>CSS样式：<code>themes/solitude/source/css/custom/fish.css</code></li><li>页脚模板：<code>themes/solitude/layout/includes/footer.pug</code></li><li>主题配置：<code>_config.solitude.yml</code></li><li>鱼儿脚本：CDN链接（可下载到本地）</li></ul><p><strong>标签</strong>：#Solitude #Hexo #页脚养鱼 #赛博养鱼 #动画效果 #CSS #主题魔改</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> 动画效果 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
            <tag> Pug模板 </tag>
            
            <tag> 页脚养鱼 </tag>
            
            <tag> 赛博养鱼 </tag>
            
            <tag> 主题魔改 </tag>
            
            <tag> 页面美化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(23) - 侧边栏那年今日魔改教程</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(23)-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E9%82%A3%E5%B9%B4%E4%BB%8A%E6%97%A5%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(23)-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E9%82%A3%E5%B9%B4%E4%BB%8A%E6%97%A5%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Solitude主题的侧边栏魔改中，那年今日是一个重要的信息展示元素：</p><ul><li>展示历史上的今天发生的重要事件</li><li>增强网站的文化内涵和趣味性</li><li>提供丰富的历史知识内容</li><li>支持多种数据源和展示方式</li></ul><p>本文将详细介绍如何实现个性化的那年今日功能，包括历史事件展示、样式美化、交互效果和响应式设计。</p><h2 id="第一步：理解现有架构">第一步：理解现有架构</h2><h3 id="🔍-现有那年今日结构分析">🔍 现有那年今日结构分析</h3><p>在开始魔改之前，我们需要先了解Solitude主题现有的那年今日结构：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 现有文件结构</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── custom/</span><br><span class="line">│   │       └── history-today.css         <span class="comment"># 那年今日样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── custom/</span><br><span class="line">│           └── history-today.js          <span class="comment"># 那年今日逻辑</span></span><br><span class="line">└── <span class="built_in">source</span>/_data/</span><br><span class="line">    └── aside.yml                        <span class="comment"># 侧边栏配置文件</span></span><br></pre></td></tr></table></figure><h3 id="📋-现有那年今日特点">📋 现有那年今日特点</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 现有那年今日的主要特点</span></span><br><span class="line"><span class="number">1.</span> 基于静态配置的历史事件</span><br><span class="line"><span class="number">2.</span> 简单的文本展示</span><br><span class="line"><span class="number">3.</span> 基础的样式设计</span><br><span class="line"><span class="number">4.</span> 有限的交互功能</span><br><span class="line"><span class="number">5.</span> 缺乏动态数据更新</span><br></pre></td></tr></table></figure><h2 id="第二步：设计那年今日架构">第二步：设计那年今日架构</h2><h3 id="🎯-设计目标">🎯 设计目标</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 那年今日系统设计目标</span></span><br><span class="line"><span class="string">目标1:</span> <span class="string">实现动态历史事件展示</span></span><br><span class="line"><span class="string">目标2:</span> <span class="string">支持多种数据源集成</span></span><br><span class="line"><span class="string">目标3:</span> <span class="string">提供丰富的交互效果</span></span><br><span class="line"><span class="string">目标4:</span> <span class="string">实现美观的视觉设计</span></span><br><span class="line"><span class="string">目标5:</span> <span class="string">支持响应式布局</span></span><br><span class="line"><span class="string">目标6:</span> <span class="string">提供配置化选项</span></span><br></pre></td></tr></table></figure><h3 id="🏗️-架构设计方案">🏗️ 架构设计方案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新的文件结构设计</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── custom/</span><br><span class="line">│   │       ├── history-today.css         <span class="comment"># 基础样式</span></span><br><span class="line">│   │       └── history-animations.css    <span class="comment"># 动画效果样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── custom/</span><br><span class="line">│           ├── history-today.js          <span class="comment"># 基础逻辑</span></span><br><span class="line">│           └── history-enhancer.js       <span class="comment"># 增强功能</span></span><br><span class="line">└── <span class="built_in">source</span>/_data/</span><br><span class="line">    ├── aside.yml                        <span class="comment"># 侧边栏配置</span></span><br><span class="line">    └── history-config.yml               <span class="comment"># 历史事件配置</span></span><br></pre></td></tr></table></figure><h2 id="第三步：创建那年今日核心文件">第三步：创建那年今日核心文件</h2><h3 id="📝-1-创建历史事件配置文件">📝 1. 创建历史事件配置文件</h3><p><strong>文件路径</strong>：<code>source/_data/history-config.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 那年今日历史事件配置</span></span><br><span class="line"><span class="attr">history_today:</span></span><br><span class="line">  <span class="comment"># 基础配置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">data_source:</span> <span class="string">&quot;mixed&quot;</span>  <span class="comment"># 可选值: local, api, mixed</span></span><br><span class="line">  <span class="attr">update_interval:</span> <span class="number">3600000</span>  <span class="comment"># 更新间隔(毫秒)</span></span><br><span class="line">  <span class="attr">max_events:</span> <span class="number">5</span>  <span class="comment"># 最大显示事件数量</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 数据源配置</span></span><br><span class="line">  <span class="attr">data_sources:</span></span><br><span class="line">    <span class="attr">local:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">file:</span> <span class="string">&quot;local-history.yml&quot;</span></span><br><span class="line">    <span class="attr">api:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">&quot;https://api.example.com/history&quot;</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="number">5000</span></span><br><span class="line">    <span class="attr">baidu:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">fallback:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 样式配置</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="attr">container_height:</span> <span class="number">200</span></span><br><span class="line">    <span class="attr">item_height:</span> <span class="number">40</span></span><br><span class="line">    <span class="attr">font_size_title:</span> <span class="number">14</span></span><br><span class="line">    <span class="attr">font_size_time:</span> <span class="number">12</span></span><br><span class="line">    <span class="attr">font_size_content:</span> <span class="number">13</span></span><br><span class="line">    <span class="attr">line_height:</span> <span class="number">1.4</span></span><br><span class="line">    <span class="attr">margin_bottom:</span> <span class="number">8</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 颜色配置</span></span><br><span class="line">  <span class="attr">colors:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">&quot;#007bff&quot;</span></span><br><span class="line">    <span class="attr">time:</span> <span class="string">&quot;#6c757d&quot;</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">&quot;#333333&quot;</span></span><br><span class="line">    <span class="attr">background:</span> <span class="string">&quot;transparent&quot;</span></span><br><span class="line">    <span class="attr">border:</span> <span class="string">&quot;#e9ecef&quot;</span></span><br><span class="line">    <span class="attr">hover:</span> <span class="string">&quot;#f8f9fa&quot;</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 动画配置</span></span><br><span class="line">  <span class="attr">animation:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">duration:</span> <span class="number">0.3</span></span><br><span class="line">    <span class="attr">easing:</span> <span class="string">&quot;ease-in-out&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;fade&quot;</span>  <span class="comment"># 可选值: fade, slide, bounce</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 交互配置</span></span><br><span class="line">  <span class="attr">interaction:</span></span><br><span class="line">    <span class="attr">enable_hover:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">enable_click:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">show_details:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">external_link:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 响应式配置</span></span><br><span class="line">  <span class="attr">responsive:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">mobile:</span></span><br><span class="line">      <span class="attr">container_height:</span> <span class="number">150</span></span><br><span class="line">      <span class="attr">item_height:</span> <span class="number">35</span></span><br><span class="line">      <span class="attr">font_size_title:</span> <span class="number">13</span></span><br><span class="line">      <span class="attr">font_size_time:</span> <span class="number">11</span></span><br><span class="line">      <span class="attr">font_size_content:</span> <span class="number">12</span></span><br><span class="line">    <span class="attr">tablet:</span></span><br><span class="line">      <span class="attr">container_height:</span> <span class="number">180</span></span><br><span class="line">      <span class="attr">item_height:</span> <span class="number">38</span></span><br><span class="line">      <span class="attr">font_size_title:</span> <span class="number">13</span></span><br><span class="line">      <span class="attr">font_size_time:</span> <span class="number">11</span></span><br><span class="line">      <span class="attr">font_size_content:</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地历史事件数据</span></span><br><span class="line"><span class="attr">local_events:</span></span><br><span class="line">  <span class="attr">&quot;01-01&quot;:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">&quot;元旦节&quot;</span></span><br><span class="line">      <span class="attr">time:</span> <span class="string">&quot;公元前45年&quot;</span></span><br><span class="line">      <span class="attr">content:</span> <span class="string">&quot;古罗马儒略历开始使用，1月1日被定为新年第一天&quot;</span></span><br><span class="line">      <span class="attr">category:</span> <span class="string">&quot;节日&quot;</span></span><br><span class="line">      <span class="attr">importance:</span> <span class="string">&quot;high&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">&quot;中华人民共和国成立&quot;</span></span><br><span class="line">      <span class="attr">time:</span> <span class="string">&quot;1949年&quot;</span></span><br><span class="line">      <span class="attr">content:</span> <span class="string">&quot;毛泽东主席在天安门城楼上庄严宣告中华人民共和国成立&quot;</span></span><br><span class="line">      <span class="attr">category:</span> <span class="string">&quot;历史&quot;</span></span><br><span class="line">      <span class="attr">importance:</span> <span class="string">&quot;high&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">&quot;01-02&quot;:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">&quot;伽利略逝世&quot;</span></span><br><span class="line">      <span class="attr">time:</span> <span class="string">&quot;1642年&quot;</span></span><br><span class="line">      <span class="attr">content:</span> <span class="string">&quot;意大利物理学家、天文学家伽利略·伽利莱逝世&quot;</span></span><br><span class="line">      <span class="attr">category:</span> <span class="string">&quot;人物&quot;</span></span><br><span class="line">      <span class="attr">importance:</span> <span class="string">&quot;medium&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">&quot;01-03&quot;:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">&quot;苹果公司成立&quot;</span></span><br><span class="line">      <span class="attr">time:</span> <span class="string">&quot;1977年&quot;</span></span><br><span class="line">      <span class="attr">content:</span> <span class="string">&quot;史蒂夫·乔布斯、史蒂夫·沃兹尼亚克和罗纳德·韦恩创立苹果公司&quot;</span></span><br><span class="line">      <span class="attr">category:</span> <span class="string">&quot;科技&quot;</span></span><br><span class="line">      <span class="attr">importance:</span> <span class="string">&quot;high&quot;</span></span><br></pre></td></tr></table></figure><h3 id="🎨-2-创建那年今日基础样式">🎨 2. 创建那年今日基础样式</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/css/custom/history-today.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 那年今日基础样式</span></span><br><span class="line"><span class="comment"> * 实现历史事件的展示和布局</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 那年今日容器样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">2px</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 标题样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.item-headline</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">16px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">0.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">0.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 历史事件容器样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">scrollbar-width</span>: thin;</span><br><span class="line">    <span class="attribute">scrollbar-color</span>: <span class="built_in">var</span>(--efu-main) transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span>::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span>::-webkit-scrollbar-track &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span>::-webkit-scrollbar-thumb &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 历史事件项样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">12px</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.05</span>);</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, transparent, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>), transparent);</span><br><span class="line">    <span class="attribute">transition</span>: left <span class="number">0.5s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">4px</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 事件标题样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    -webkit-<span class="selector-tag">line</span>-clamp: <span class="number">2</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 事件时间样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-time</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-secondtext);</span><br><span class="line">    <span class="attribute">font-style</span>: italic;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 事件内容样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-content</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-fontcolor);</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    -webkit-<span class="selector-tag">line</span>-clamp: <span class="number">2</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 事件分类标签样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-category</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">align-self</span>: flex-start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 重要性指示器样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.importance-indicator</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#6c757d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.importance-high</span> <span class="selector-class">.importance-indicator</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#dc3545</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">220</span>, <span class="number">53</span>, <span class="number">69</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.importance-medium</span> <span class="selector-class">.importance-indicator</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ffc107</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">193</span>, <span class="number">7</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 加载状态样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.loading</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-secondtext);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.loading</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">animation</span>: spin <span class="number">1s</span> linear infinite;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> spin &#123;</span><br><span class="line">    <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>); &#125;</span><br><span class="line">    <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 错误状态样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.error</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#dc3545</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 空状态样式 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.empty</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-secondtext);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">12px</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-title</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-time</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">11px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-content</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">120px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">4px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-title</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-time</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-content</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">11px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 暗色模式适配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.05</span>);</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎭-3-创建那年今日动画样式">🎭 3. 创建那年今日动画样式</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/css/custom/history-animations.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 那年今日动画效果</span></span><br><span class="line"><span class="comment"> * 提供丰富的动画效果和交互体验</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 动画变量定义 */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--history-animation-duration</span>: <span class="number">0.3s</span>;</span><br><span class="line">    <span class="attr">--history-animation-easing</span>: ease-in-out;</span><br><span class="line">    <span class="attr">--history-color-primary</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">    <span class="attr">--history-color-secondary</span>: <span class="built_in">var</span>(--efu-secondtext);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 淡入动画 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> fadeInUp &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> fadeInDown &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">20px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> fadeInLeft &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">20px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> fadeInRight &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">20px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 滑动动画 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> slideInUp &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">100%</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> slideInDown &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">100%</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 弹跳动画 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> bounceIn &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.3</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">70%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.9</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 旋转动画 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> rotateIn &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>) <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 缩放动画 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> zoomIn &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.8</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 应用动画类 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.fade-in-up</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeInUp <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.fade-in-down</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeInDown <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.fade-in-left</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeInLeft <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.fade-in-right</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeInRight <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.slide-in-up</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: slideInUp <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.slide-in-down</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: slideInDown <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.bounce-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: bounceIn <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.rotate-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: rotateIn <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.zoom-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: zoomIn <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 悬停动画效果 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">4px</span>) <span class="built_in">scale</span>(<span class="number">1.02</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 点击动画效果 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">2px</span>) <span class="built_in">scale</span>(<span class="number">0.98</span>);</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.1s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 加载动画 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.loading</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: pulse <span class="number">2s</span> infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> pulse &#123;</span><br><span class="line">    <span class="number">0%</span>, <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 闪烁动画 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> blink &#123;</span><br><span class="line">    <span class="number">0%</span>, <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">51%</span>, <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0.3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.importance-indicator</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: blink <span class="number">2s</span> infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 进度条动画 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.progress-bar</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--history-color-primary);</span><br><span class="line">    <span class="attribute">animation</span>: progress <span class="number">3s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> progress &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">0%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 文字打字机效果 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> typewriter &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> <span class="selector-class">.event-title</span><span class="selector-class">.typewriter</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--history-color-primary);</span><br><span class="line">    <span class="attribute">animation</span>: typewriter <span class="number">2s</span> <span class="built_in">steps</span>(<span class="number">40</span>, end), blink-caret <span class="number">0.75s</span> step-end infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> blink-caret &#123;</span><br><span class="line">    <span class="selector-tag">from</span>, <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">border-color</span>: transparent;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">border-color</span>: <span class="built_in">var</span>(--history-color-primary);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 容器进入动画 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span><span class="selector-class">.animate-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeInUp <span class="number">0.5s</span> ease-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 列表项延迟动画 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">0.1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">0.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) &#123;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>) &#123;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式动画调整 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">        <span class="attribute">animation-duration</span>: <span class="number">0.2s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">2px</span>) <span class="built_in">scale</span>(<span class="number">1.01</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">        <span class="attribute">animation-duration</span>: <span class="number">0.15s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">1px</span>) <span class="built_in">scale</span>(<span class="number">1.005</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="⚙️-4-创建那年今日基础逻辑">⚙️ 4. 创建那年今日基础逻辑</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/js/custom/history-today.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 那年今日基础逻辑</span></span><br><span class="line"><span class="comment"> * 实现历史事件的展示和基本交互</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HistoryToday</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">config</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">events</span> = [];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">currentDate</span> = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">loadConfig</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#aside-content .card-history .history-container&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">container</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">loadHistoryEvents</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">startAutoUpdate</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">loadConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/data/history-config.yml&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> yamlText = <span class="keyword">await</span> response.<span class="title function_">text</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">config</span> = <span class="variable language_">this</span>.<span class="title function_">parseYaml</span>(yamlText);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;History Today: 配置加载完成&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;History Today: 配置加载失败&#x27;</span>, error);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">loadDefaultConfig</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">parseYaml</span>(<span class="params">yamlText</span>) &#123;</span><br><span class="line">        <span class="comment">// 简化的YAML解析器</span></span><br><span class="line">        <span class="keyword">const</span> lines = yamlText.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line">        <span class="keyword">let</span> currentSection = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">let</span> currentSubSection = <span class="literal">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> line <span class="keyword">of</span> lines) &#123;</span><br><span class="line">            <span class="keyword">const</span> trimmedLine = line.<span class="title function_">trim</span>();</span><br><span class="line">            <span class="keyword">if</span> (trimmedLine.<span class="title function_">startsWith</span>(<span class="string">&#x27;#&#x27;</span>) || trimmedLine === <span class="string">&#x27;&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (trimmedLine.<span class="title function_">endsWith</span>(<span class="string">&#x27;:&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">const</span> key = trimmedLine.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (key.<span class="title function_">includes</span>(<span class="string">&#x27; &#x27;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">const</span> parts = key.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (parts.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">                        currentSection = parts[<span class="number">0</span>];</span><br><span class="line">                        currentSubSection = parts[<span class="number">1</span>];</span><br><span class="line">                        <span class="keyword">if</span> (!result[currentSection]) &#123;</span><br><span class="line">                            result[currentSection] = &#123;&#125;;</span><br><span class="line">                        &#125;</span><br><span class="line">                        result[currentSection][currentSubSection] = &#123;&#125;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    currentSection = key;</span><br><span class="line">                    result[currentSection] = &#123;&#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentSection &amp;&amp; trimmedLine.<span class="title function_">includes</span>(<span class="string">&#x27;:&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">const</span> [key, value] = trimmedLine.<span class="title function_">split</span>(<span class="string">&#x27;:&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">s</span> =&gt;</span> s.<span class="title function_">trim</span>());</span><br><span class="line">                <span class="keyword">const</span> cleanValue = value.<span class="title function_">replace</span>(<span class="regexp">/[&#x27;&quot;]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (currentSubSection) &#123;</span><br><span class="line">                    result[currentSection][currentSubSection][key] = <span class="variable language_">this</span>.<span class="title function_">parseValue</span>(cleanValue);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    result[currentSection][key] = <span class="variable language_">this</span>.<span class="title function_">parseValue</span>(cleanValue);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">parseValue</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (value === <span class="string">&#x27;true&#x27;</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (value === <span class="string">&#x27;false&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(value) &amp;&amp; !<span class="built_in">isNaN</span>(<span class="built_in">parseFloat</span>(value))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">parseFloat</span>(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">loadDefaultConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">config</span> = &#123;</span><br><span class="line">            <span class="attr">history_today</span>: &#123;</span><br><span class="line">                <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">data_source</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">                <span class="attr">update_interval</span>: <span class="number">3600000</span>,</span><br><span class="line">                <span class="attr">max_events</span>: <span class="number">5</span>,</span><br><span class="line">                <span class="attr">style</span>: &#123;</span><br><span class="line">                    <span class="attr">container_height</span>: <span class="number">200</span>,</span><br><span class="line">                    <span class="attr">item_height</span>: <span class="number">40</span>,</span><br><span class="line">                    <span class="attr">font_size_title</span>: <span class="number">14</span>,</span><br><span class="line">                    <span class="attr">font_size_time</span>: <span class="number">12</span>,</span><br><span class="line">                    <span class="attr">font_size_content</span>: <span class="number">13</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">colors</span>: &#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;#007bff&quot;</span>,</span><br><span class="line">                    <span class="attr">time</span>: <span class="string">&quot;#6c757d&quot;</span>,</span><br><span class="line">                    <span class="attr">content</span>: <span class="string">&quot;#333333&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">animation</span>: &#123;</span><br><span class="line">                    <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">0.3</span>,</span><br><span class="line">                    <span class="attr">easing</span>: <span class="string">&quot;ease-in-out&quot;</span>,</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&quot;fade&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">loadHistoryEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isLoading</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">showLoading</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> today = <span class="variable language_">this</span>.<span class="title function_">getTodayString</span>();</span><br><span class="line">            <span class="keyword">const</span> events = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getEventsForDate</span>(today);</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">events</span> = events.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>.<span class="property">max_events</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">renderEvents</span>();</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;History Today: 加载历史事件失败&#x27;</span>, error);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">showError</span>(<span class="string">&#x27;加载历史事件失败&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getTodayString</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> month = <span class="title class_">String</span>(<span class="variable language_">this</span>.<span class="property">currentDate</span>.<span class="title function_">getMonth</span>() + <span class="number">1</span>).<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> day = <span class="title class_">String</span>(<span class="variable language_">this</span>.<span class="property">currentDate</span>.<span class="title function_">getDate</span>()).<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;day&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getEventsForDate</span>(<span class="params">dateString</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 优先使用本地数据</span></span><br><span class="line">        <span class="keyword">if</span> (config.<span class="property">data_sources</span>.<span class="property">local</span>.<span class="property">enable</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> localEvents = <span class="variable language_">this</span>.<span class="title function_">getLocalEvents</span>(dateString);</span><br><span class="line">            <span class="keyword">if</span> (localEvents.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> localEvents;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 尝试API数据源</span></span><br><span class="line">        <span class="keyword">if</span> (config.<span class="property">data_sources</span>.<span class="property">api</span>.<span class="property">enable</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> apiEvents = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getApiEvents</span>(dateString);</span><br><span class="line">                <span class="keyword">if</span> (apiEvents.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> apiEvents;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;History Today: API数据源失败&#x27;</span>, error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 使用百度百科作为备用数据源</span></span><br><span class="line">        <span class="keyword">if</span> (config.<span class="property">data_sources</span>.<span class="property">baidu</span>.<span class="property">enable</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> baiduEvents = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getBaiduEvents</span>(dateString);</span><br><span class="line">                <span class="keyword">if</span> (baiduEvents.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> baiduEvents;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;History Today: 百度数据源失败&#x27;</span>, error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getLocalEvents</span>(<span class="params">dateString</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> localEvents = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">local_events</span> || &#123;&#125;;</span><br><span class="line">        <span class="keyword">return</span> localEvents[dateString] || [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getApiEvents</span>(<span class="params">dateString</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>.<span class="property">data_sources</span>.<span class="property">api</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`<span class="subst">$&#123;config.url&#125;</span>?date=<span class="subst">$&#123;dateString&#125;</span>`</span>, &#123;</span><br><span class="line">            <span class="attr">timeout</span>: config.<span class="property">timeout</span></span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`API请求失败: <span class="subst">$&#123;response.status&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">        <span class="keyword">return</span> data.<span class="property">events</span> || [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getBaiduEvents</span>(<span class="params">dateString</span>) &#123;</span><br><span class="line">        <span class="comment">// 模拟百度百科数据获取</span></span><br><span class="line">        <span class="comment">// 实际实现中需要调用真实的API或爬虫</span></span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;历史上的今天&quot;</span>,</span><br><span class="line">                <span class="attr">time</span>: <span class="string">&quot;今天&quot;</span>,</span><br><span class="line">                <span class="attr">content</span>: <span class="string">&quot;今天是一个特殊的日子，让我们回顾历史&quot;</span>,</span><br><span class="line">                <span class="attr">category</span>: <span class="string">&quot;历史&quot;</span>,</span><br><span class="line">                <span class="attr">importance</span>: <span class="string">&quot;medium&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">renderEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">events</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">showEmpty</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">events</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">event, index</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> eventElement = <span class="variable language_">this</span>.<span class="title function_">createEventElement</span>(event, index);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(eventElement);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">addAnimationClasses</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">createEventElement</span>(<span class="params">event, index</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> eventDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        eventDiv.<span class="property">className</span> = <span class="string">`history-item importance-<span class="subst">$&#123;event.importance || <span class="string">&#x27;medium&#x27;</span>&#125;</span>`</span>;</span><br><span class="line">        eventDiv.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;importance-indicator&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;event-title&quot;&gt;<span class="subst">$&#123;event.title&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;event-time&quot;&gt;<span class="subst">$&#123;event.time&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;event-content&quot;&gt;<span class="subst">$&#123;event.content&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">            <span class="subst">$&#123;event.category ? <span class="string">`&lt;div class=&quot;event-category&quot;&gt;<span class="subst">$&#123;event.category&#125;</span>&lt;/div&gt;`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加点击事件</span></span><br><span class="line">        eventDiv.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">handleEventClick</span>(event);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> eventDiv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">addAnimationClasses</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!config.<span class="property">animation</span>.<span class="property">enable</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> items = <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.history-item&#x27;</span>);</span><br><span class="line">        items.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 添加延迟</span></span><br><span class="line">            item.<span class="property">style</span>.<span class="property">animationDelay</span> = <span class="string">`<span class="subst">$&#123;index * <span class="number">0.1</span>&#125;</span>s`</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 添加动画类</span></span><br><span class="line">            <span class="keyword">const</span> animationType = config.<span class="property">animation</span>.<span class="property">type</span>;</span><br><span class="line">            item.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">`<span class="subst">$&#123;animationType&#125;</span>-in`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">handleEventClick</span>(<span class="params">event</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (config.<span class="property">interaction</span>.<span class="property">show_details</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">showEventDetails</span>(event);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (config.<span class="property">interaction</span>.<span class="property">external_link</span> &amp;&amp; event.<span class="property">link</span>) &#123;</span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">open</span>(event.<span class="property">link</span>, <span class="string">&#x27;_blank&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">showEventDetails</span>(<span class="params">event</span>) &#123;</span><br><span class="line">        <span class="comment">// 创建详情弹窗</span></span><br><span class="line">        <span class="keyword">const</span> modal = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        modal.<span class="property">className</span> = <span class="string">&#x27;history-modal&#x27;</span>;</span><br><span class="line">        modal.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;modal-content&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;modal-header&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;h3&gt;<span class="subst">$&#123;event.title&#125;</span>&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                    &lt;button class=&quot;modal-close&quot;&gt;&amp;times;&lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;modal-body&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-time&quot;&gt;<span class="subst">$&#123;event.time&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-content&quot;&gt;<span class="subst">$&#123;event.content&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    <span class="subst">$&#123;event.category ? <span class="string">`&lt;div class=&quot;event-category&quot;&gt;<span class="subst">$&#123;event.category&#125;</span>&lt;/div&gt;`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(modal);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 绑定关闭事件</span></span><br><span class="line">        modal.<span class="title function_">querySelector</span>(<span class="string">&#x27;.modal-close&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            modal.<span class="title function_">remove</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        modal.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.<span class="property">target</span> === modal) &#123;</span><br><span class="line">                modal.<span class="title function_">remove</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">showLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;loading&quot;&gt;加载中...&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">showError</span>(<span class="params">message</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">innerHTML</span> = <span class="string">`&lt;div class=&quot;error&quot;&gt;<span class="subst">$&#123;message&#125;</span>&lt;/div&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">showEmpty</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;empty&quot;&gt;暂无历史事件&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">startAutoUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (config.<span class="property">update_interval</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">loadHistoryEvents</span>();</span><br><span class="line">            &#125;, config.<span class="property">update_interval</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 销毁方法</span></span><br><span class="line">    <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">config</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">events</span> = [];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">historyToday</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initHistoryToday</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">historyToday</span>) &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">historyToday</span> = <span class="keyword">new</span> <span class="title class_">HistoryToday</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面加载完成后初始化</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">initHistoryToday</span>();</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出类供其他脚本使用</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">module</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">exports</span>) &#123;</span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">HistoryToday</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第四步：配置主题启用那年今日">第四步：配置主题启用那年今日</h2><h3 id="⚙️-1-修改侧边栏配置文件">⚙️ 1. 修改侧边栏配置文件</h3><p><strong>文件路径</strong>：<code>source/_data/aside.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">history</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">那年今日</span> </span><br><span class="line">  <span class="attr">class:</span> <span class="string">card-history</span></span><br><span class="line">  <span class="attr">id:</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-history</span></span><br><span class="line">  <span class="attr">content_class:</span></span><br><span class="line">  <span class="attr">content_id:</span> <span class="string">history-baidu</span></span><br><span class="line">  <span class="attr">content_css:</span> <span class="string">&#x27;height:200px;overflow:hidden&#x27;</span></span><br><span class="line">  <span class="attr">content_html:</span> <span class="string">&#x27;&lt;div class=&quot;history-container&quot; id=&quot;history-container&quot; style=&quot;width: 100%;height: 100%;margin-top: 6px&quot;&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">  <span class="comment"># 新增那年今日配置</span></span><br><span class="line">  <span class="attr">history_today:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">data_source:</span> <span class="string">&quot;mixed&quot;</span></span><br><span class="line">    <span class="attr">animation:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">max_events:</span> <span class="number">5</span></span><br><span class="line">    <span class="attr">auto_update:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="🔧-2-修改主题配置文件">🔧 2. 修改主题配置文件</h3><p><strong>文件路径</strong>：<code>_config.solitude.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在配置文件中添加那年今日配置</span></span><br><span class="line"><span class="attr">history_today:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">config_file:</span> <span class="string">history-config.yml</span></span><br><span class="line">  <span class="attr">data_source:</span> <span class="string">mixed</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">responsive:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_update:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">max_events:</span> <span class="number">5</span></span><br></pre></td></tr></table></figure><h3 id="📦-3-引入样式和脚本文件">📦 3. 引入样式和脚本文件</h3><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/head.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//- 在head部分添加那年今日样式</span><br><span class="line">if theme.history_today &amp;&amp; theme.history_today.enable</span><br><span class="line">  link(rel=&#x27;stylesheet&#x27;, href=url_for(&#x27;/css/custom/history-today.css&#x27;))</span><br><span class="line">  if theme.history_today.animation</span><br><span class="line">    link(rel=&#x27;stylesheet&#x27;, href=url_for(&#x27;/css/custom/history-animations.css&#x27;))</span><br></pre></td></tr></table></figure><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/inject/body.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//- 在body部分添加那年今日脚本</span><br><span class="line">if theme.history_today &amp;&amp; theme.history_today.enable</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/history-today.js&#x27;))</span><br><span class="line">  if theme.history_today.enhanced</span><br><span class="line">    script(src=url_for(&#x27;/js/custom/history-enhancer.js&#x27;))</span><br></pre></td></tr></table></figure><h2 id="第五步：实现那年今日的关键技术">第五步：实现那年今日的关键技术</h2><h3 id="🎯-1-多数据源集成技术">🎯 1. 多数据源集成技术</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：支持多种数据源</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">getEventsForDate</span>(<span class="params">dateString</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">history_today</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 优先使用本地数据</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">data_sources</span>.<span class="property">local</span>.<span class="property">enable</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> localEvents = <span class="variable language_">this</span>.<span class="title function_">getLocalEvents</span>(dateString);</span><br><span class="line">        <span class="keyword">if</span> (localEvents.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> localEvents;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 尝试API数据源</span></span><br><span class="line">    <span class="keyword">if</span> (config.<span class="property">data_sources</span>.<span class="property">api</span>.<span class="property">enable</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> apiEvents = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getApiEvents</span>(dateString);</span><br><span class="line">            <span class="keyword">if</span> (apiEvents.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> apiEvents;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;API数据源失败&#x27;</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用备用数据源</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getFallbackEvents</span>(dateString);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔒-2-动态内容渲染技术">🔒 2. 动态内容渲染技术</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：动态创建和渲染历史事件</span></span><br><span class="line"><span class="title function_">createEventElement</span>(<span class="params">event, index</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> eventDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    eventDiv.<span class="property">className</span> = <span class="string">`history-item importance-<span class="subst">$&#123;event.importance || <span class="string">&#x27;medium&#x27;</span>&#125;</span>`</span>;</span><br><span class="line">    eventDiv.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;importance-indicator&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;event-title&quot;&gt;<span class="subst">$&#123;event.title&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;event-time&quot;&gt;<span class="subst">$&#123;event.time&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;event-content&quot;&gt;<span class="subst">$&#123;event.content&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;event.category ? <span class="string">`&lt;div class=&quot;event-category&quot;&gt;<span class="subst">$&#123;event.category&#125;</span>&lt;/div&gt;`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加交互事件</span></span><br><span class="line">    eventDiv.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">handleEventClick</span>(event);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> eventDiv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-3-动画效果系统">🎨 3. 动画效果系统</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：多种动画效果支持 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> fadeInUp &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span><span class="selector-class">.fade-in-up</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeInUp <span class="built_in">var</span>(--history-animation-duration) <span class="built_in">var</span>(--history-animation-easing);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔄-4-响应式设计适配">🔄 4. 响应式设计适配</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：响应式布局适配 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-container</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#aside-content</span> <span class="selector-class">.card-history</span> <span class="selector-class">.history-item</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">12px</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第六步：高级功能扩展">第六步：高级功能扩展</h2><h3 id="🎵-1-数据源扩展">🎵 1. 数据源扩展</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持更多数据源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HistoryToday</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getEventsForDate</span>(<span class="params">dateString</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> sources = [</span><br><span class="line">            <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">getLocalEvents</span>(dateString),</span><br><span class="line">            <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">getApiEvents</span>(dateString),</span><br><span class="line">            <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">getBaiduEvents</span>(dateString),</span><br><span class="line">            <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">getWikipediaEvents</span>(dateString),</span><br><span class="line">            <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">getCustomEvents</span>(dateString)</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> source <span class="keyword">of</span> sources) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> events = <span class="keyword">await</span> <span class="title function_">source</span>();</span><br><span class="line">                <span class="keyword">if</span> (events.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> events;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;数据源失败:&#x27;</span>, error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-2-主题定制支持">🎨 2. 主题定制支持</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持多种主题样式</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HistoryToday</span> &#123;</span><br><span class="line">    <span class="title function_">applyTheme</span>(<span class="params">theme</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> themes = &#123;</span><br><span class="line">            <span class="attr">classic</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#007bff&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">modern</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#28a745&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">dark</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#ffc107&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#adb5bd&#x27;</span> &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> themeColors = themes[theme] || themes.<span class="property">classic</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">applyColorScheme</span>(themeColors);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔧-3-配置化设计">🔧 3. 配置化设计</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持丰富的配置选项</span></span><br><span class="line"><span class="attr">history_today:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">data_source:</span> <span class="string">mixed</span></span><br><span class="line">  <span class="attr">animation:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">fade</span></span><br><span class="line">    <span class="attr">duration:</span> <span class="number">0.3</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="attr">theme:</span> <span class="string">classic</span></span><br><span class="line">    <span class="attr">layout:</span> <span class="string">vertical</span></span><br><span class="line">    <span class="attr">max_events:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">interaction:</span></span><br><span class="line">    <span class="attr">enable_hover:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">enable_click:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">show_details:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="第七步：测试验证">第七步：测试验证</h2><h3 id="🧪-1-功能测试">🧪 1. 功能测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试步骤</span></span><br><span class="line">1. 启用那年今日配置</span><br><span class="line">2. 重新生成网站: npm run build</span><br><span class="line">3. 测试历史事件显示</span><br><span class="line">4. 测试动画效果</span><br><span class="line">5. 测试响应式设计</span><br><span class="line">6. 测试数据源切换</span><br><span class="line">7. 测试交互功能</span><br></pre></td></tr></table></figure><h3 id="🔍-2-兼容性测试">🔍 2. 兼容性测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试项目</span></span><br><span class="line">✅ 历史事件正常显示</span><br><span class="line">✅ 动画效果流畅</span><br><span class="line">✅ 响应式设计正常</span><br><span class="line">✅ 数据源切换正常</span><br><span class="line">✅ 交互功能正常</span><br><span class="line">✅ 主题切换正常</span><br><span class="line">✅ 性能表现良好</span><br></pre></td></tr></table></figure><h3 id="🐛-3-问题排查">🐛 3. 问题排查</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常见问题排查</span></span><br><span class="line"><span class="number">1.</span> 检查配置文件是否正确加载</span><br><span class="line"><span class="number">2.</span> 检查数据源是否可用</span><br><span class="line"><span class="number">3.</span> 检查<span class="variable constant_">DOM</span>元素是否正确创建</span><br><span class="line"><span class="number">4.</span> 检查<span class="variable constant_">CSS</span>样式是否正确加载</span><br><span class="line"><span class="number">5.</span> 检查<span class="title class_">JavaScript</span>是否正确执行</span><br><span class="line"><span class="number">6.</span> 检查动画效果是否流畅</span><br></pre></td></tr></table></figure><h2 id="总结与经验">总结与经验</h2><h3 id="🎯-关键设计要点">🎯 关键设计要点</h3><ol><li><strong>多数据源集成</strong>：支持本地、API、第三方等多种数据源</li><li><strong>动态内容渲染</strong>：根据配置动态创建和展示历史事件</li><li><strong>动画效果系统</strong>：提供丰富的动画效果，增强用户体验</li><li><strong>响应式设计</strong>：适配不同屏幕尺寸，确保在各种设备上正常显示</li><li><strong>配置化管理</strong>：通过配置文件灵活控制功能和行为</li></ol><h3 id="🔧-技术实现要点">🔧 技术实现要点</h3><ol><li><strong>异步数据加载</strong>：使用async/await处理异步数据获取</li><li><strong>错误处理机制</strong>：完善的错误处理和降级方案</li><li><strong>动画系统</strong>：CSS动画和JavaScript控制结合</li><li><strong>响应式适配</strong>：媒体查询和动态样式调整</li><li><strong>模块化设计</strong>：清晰的代码结构，便于维护和扩展</li></ol><h3 id="🚀-扩展应用">🚀 扩展应用</h3><p>这个那年今日系统的设计思路可以应用到其他场景：</p><ul><li><strong>新闻资讯展示</strong></li><li><strong>动态内容管理</strong></li><li><strong>数据可视化</strong></li><li><strong>信息聚合系统</strong></li></ul><h3 id="💡-最佳实践">💡 最佳实践</h3><ol><li><strong>数据源管理</strong>：建立完善的数据源优先级和降级机制</li><li><strong>性能优化</strong>：合理使用缓存和异步加载</li><li><strong>用户体验</strong>：确保动画效果不会影响内容阅读</li><li><strong>兼容性</strong>：确保在不同浏览器和设备上正常工作</li><li><strong>可维护性</strong>：保持代码结构清晰，便于后续维护</li></ol><hr><p>通过本次完整的那年今日系统实现，我们不仅成功创建了丰富的历史事件展示功能，还学会了如何设计可扩展的数据源系统和动画效果。这种设计思路可以帮助我们构建更加智能和动态的内容展示系统！</p><p><strong>下期预告</strong>：我们将探索更多Solitude主题的高级魔改技巧，敬请期待！</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
            <tag> 侧边栏 </tag>
            
            <tag> 那年今日 </tag>
            
            <tag> 历史事件 </tag>
            
            <tag> 数据展示 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(22) - 侧边栏个性时钟魔改教程</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(22)-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E4%B8%AA%E6%80%A7%E6%97%B6%E9%92%9F%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(22)-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E4%B8%AA%E6%80%A7%E6%97%B6%E9%92%9F%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Solitude主题的侧边栏魔改中，个性时钟是一个重要的装饰元素：</p><ul><li>提供实时时间显示功能</li><li>增强页面的动态视觉效果</li><li>展示个性化的设计风格</li><li>支持多种时钟样式和动画效果</li></ul><p>本文将详细介绍如何实现个性化的侧边栏数码时钟，包括纵列数字显示、动态滚动效果、样式美化和响应式设计。</p><h2 id="第一步：理解现有架构">第一步：理解现有架构</h2><h3 id="🔍-现有数码时钟结构分析">🔍 现有数码时钟结构分析</h3><p>在开始魔改之前，我们需要先了解Solitude主题现有的数码时钟结构：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 现有文件结构</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── custom/</span><br><span class="line">│   │       └── digit-clock.css          <span class="comment"># 数码时钟样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── custom/</span><br><span class="line">│           └── digit-clock.js           <span class="comment"># 数码时钟逻辑</span></span><br><span class="line">└── <span class="built_in">source</span>/_data/</span><br><span class="line">    └── aside.yml                        <span class="comment"># 侧边栏配置文件</span></span><br></pre></td></tr></table></figure><h3 id="📋-现有数码时钟特点">📋 现有数码时钟特点</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 现有数码时钟的主要特点</span></span><br><span class="line"><span class="number">1.</span> 基于数字旋转的显示效果</span><br><span class="line"><span class="number">2.</span> 简单的数字切换动画</span><br><span class="line"><span class="number">3.</span> 基础的样式设计</span><br><span class="line"><span class="number">4.</span> 固定的显示位置</span><br><span class="line"><span class="number">5.</span> 有限的个性化功能</span><br></pre></td></tr></table></figure><h2 id="第二步：设计个性时钟架构">第二步：设计个性时钟架构</h2><h3 id="🎯-设计目标">🎯 设计目标</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 个性时钟系统设计目标</span></span><br><span class="line"><span class="string">目标1:</span> <span class="string">实现纵列数字显示效果</span></span><br><span class="line"><span class="string">目标2:</span> <span class="string">当前时间加粗显示在中间</span></span><br><span class="line"><span class="string">目标3:</span> <span class="string">数字跟随时间变化上下移动</span></span><br><span class="line"><span class="string">目标4:</span> <span class="string">超出显示框的部分隐藏</span></span><br><span class="line"><span class="string">目标5:</span> <span class="string">支持多种动画效果</span></span><br><span class="line"><span class="string">目标6:</span> <span class="string">响应式设计适配</span></span><br></pre></td></tr></table></figure><h3 id="🏗️-架构设计方案">🏗️ 架构设计方案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新的文件结构设计</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── custom/</span><br><span class="line">│   │       ├── digit-clock.css             <span class="comment"># 基础样式</span></span><br><span class="line">│   │       └── digit-clock-animations.css  <span class="comment"># 动画效果样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── custom/</span><br><span class="line">│           ├── digit-clock.js              <span class="comment"># 基础逻辑</span></span><br><span class="line">│           └── digit-clock-enhancer.js     <span class="comment"># 增强功能</span></span><br><span class="line">└── <span class="built_in">source</span>/_data/</span><br><span class="line">    ├── aside.yml                           <span class="comment"># 侧边栏配置</span></span><br><span class="line">    └── clock-config.yml                    <span class="comment"># 时钟配置</span></span><br></pre></td></tr></table></figure><h2 id="第三步：创建个性时钟核心文件">第三步：创建个性时钟核心文件</h2><h3 id="📝-1-创建时钟配置文件">📝 1. 创建时钟配置文件</h3><p><strong>文件路径</strong>：<code>source/_data/clock-config.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 个性时钟配置</span></span><br><span class="line"><span class="attr">digit_clock:</span></span><br><span class="line">  <span class="comment"># 基础配置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">display_format:</span> <span class="string">&quot;HH:MM:SS&quot;</span>  <span class="comment"># 显示格式</span></span><br><span class="line">  <span class="attr">update_interval:</span> <span class="number">1000</span>       <span class="comment"># 更新间隔(毫秒)</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 样式配置</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="attr">container_height:</span> <span class="number">100</span>     <span class="comment"># 容器高度(px)</span></span><br><span class="line">    <span class="attr">digit_width:</span> <span class="number">25</span>          <span class="comment"># 数字宽度(px)</span></span><br><span class="line">    <span class="attr">digit_height:</span> <span class="number">15</span>         <span class="comment"># 数字高度(px)</span></span><br><span class="line">    <span class="attr">digit_spacing:</span> <span class="number">12</span>        <span class="comment"># 数字间距(px)</span></span><br><span class="line">    <span class="attr">font_size_current:</span> <span class="number">18</span>    <span class="comment"># 当前数字字体大小(px)</span></span><br><span class="line">    <span class="attr">font_size_other:</span> <span class="number">14</span>      <span class="comment"># 其他数字字体大小(px)</span></span><br><span class="line">    <span class="attr">font_weight_current:</span> <span class="string">bold</span> <span class="comment"># 当前数字字体粗细</span></span><br><span class="line">    <span class="attr">font_weight_other:</span> <span class="string">normal</span> <span class="comment"># 其他数字字体粗细</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 颜色配置</span></span><br><span class="line">  <span class="attr">colors:</span></span><br><span class="line">    <span class="attr">current_digit:</span> <span class="string">&quot;#007bff&quot;</span>    <span class="comment"># 当前数字颜色</span></span><br><span class="line">    <span class="attr">other_digit:</span> <span class="string">&quot;#6c757d&quot;</span>      <span class="comment"># 其他数字颜色</span></span><br><span class="line">    <span class="attr">colon:</span> <span class="string">&quot;#007bff&quot;</span>            <span class="comment"># 冒号颜色</span></span><br><span class="line">    <span class="attr">background:</span> <span class="string">&quot;transparent&quot;</span>   <span class="comment"># 背景颜色</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 动画配置</span></span><br><span class="line">  <span class="attr">animation:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">duration:</span> <span class="number">0.4</span>              <span class="comment"># 动画持续时间(秒)</span></span><br><span class="line">    <span class="attr">easing:</span> <span class="string">&quot;cubic-bezier(0.4, 0, 0.2, 1)&quot;</span>  <span class="comment"># 缓动函数</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">&quot;slide&quot;</span>              <span class="comment"># 动画类型: slide, fade, bounce, rotate</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 透明度配置</span></span><br><span class="line">  <span class="attr">opacity:</span></span><br><span class="line">    <span class="attr">current_digit:</span> <span class="number">1.0</span>         <span class="comment"># 当前数字透明度</span></span><br><span class="line">    <span class="attr">other_digit:</span> <span class="number">0.4</span>           <span class="comment"># 其他数字透明度</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment"># 响应式配置</span></span><br><span class="line">  <span class="attr">responsive:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">mobile:</span></span><br><span class="line">      <span class="attr">container_height:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">digit_width:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">digit_height:</span> <span class="number">12</span></span><br><span class="line">      <span class="attr">digit_spacing:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">font_size_current:</span> <span class="number">16</span></span><br><span class="line">      <span class="attr">font_size_other:</span> <span class="number">12</span></span><br><span class="line">    <span class="attr">tablet:</span></span><br><span class="line">      <span class="attr">container_height:</span> <span class="number">90</span></span><br><span class="line">      <span class="attr">digit_width:</span> <span class="number">22</span></span><br><span class="line">      <span class="attr">digit_height:</span> <span class="number">14</span></span><br><span class="line">      <span class="attr">digit_spacing:</span> <span class="number">11</span></span><br><span class="line">      <span class="attr">font_size_current:</span> <span class="number">17</span></span><br><span class="line">      <span class="attr">font_size_other:</span> <span class="number">13</span></span><br></pre></td></tr></table></figure><h3 id="🎨-2-创建数码时钟基础样式">🎨 2. 创建数码时钟基础样式</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/css/custom/digit-clock.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 个性数码时钟基础样式</span></span><br><span class="line"><span class="comment"> * 实现纵列数字显示和动态滚动效果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 时钟容器样式 */</span></span><br><span class="line"><span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>; <span class="comment">/* 与显示框高度一致 */</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden; <span class="comment">/* 隐藏超出部分 */</span></span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 时钟主体样式 */</span></span><br><span class="line"><span class="selector-id">#clock</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: grid;</span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr auto <span class="number">1</span>fr auto <span class="number">1</span>fr;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数字组样式 */</span></span><br><span class="line"><span class="selector-class">.digit-group</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 冒号样式 */</span></span><br><span class="line"><span class="selector-class">.digit-group</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:last-child</span>)<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#007bff</span>;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;:&quot;</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold; <span class="comment">/* 冒号加粗 */</span></span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数字容器样式 */</span></span><br><span class="line"><span class="selector-class">.digit</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>; <span class="comment">/* 与显示框高度一致 */</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden; <span class="comment">/* 隐藏超出部分 */</span></span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数字样式 */</span></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: inherit;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">15px</span>; <span class="comment">/* 每个数字的行高，适应较小容器 */</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>; <span class="comment">/* 从中间开始定位 */</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>); <span class="comment">/* 初始位置在中间 */</span></span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="number">0.4s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.4</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">1</span>), </span><br><span class="line">                font-size <span class="number">0.3s</span> ease, </span><br><span class="line">                font-weight <span class="number">0.3s</span> ease, </span><br><span class="line">                opacity <span class="number">0.3s</span> ease;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.4</span>; <span class="comment">/* 非当前数字更透明 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 当前数字样式 */</span></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bright</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: inherit;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold; <span class="comment">/* 当前时间加粗 */</span></span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>; <span class="comment">/* 当前数字完全不透明 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 纵列数字显示效果 */</span></span><br></pre></td></tr></table></figure><h3 id="🎭-3-创建数码时钟动画样式">🎭 3. 创建数码时钟动画样式</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/css/custom/digit-clock-animations.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 个性数码时钟动画效果</span></span><br><span class="line"><span class="comment"> * 提供多种动画效果和主题支持</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 动画变量定义 */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--clock-animation-duration</span>: <span class="number">0.4s</span>;</span><br><span class="line">    <span class="attr">--clock-animation-easing</span>: <span class="built_in">cubic-bezier</span>(<span class="number">0.4</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="attr">--clock-color-primary</span>: <span class="number">#007bff</span>;</span><br><span class="line">    <span class="attr">--clock-color-secondary</span>: <span class="number">#6c757d</span>;</span><br><span class="line">    <span class="attr">--clock-bg-gradient</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>), <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.05</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 基础动画关键帧 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> slideUp &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">100%</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> slideDown &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">100%</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> fadeIn &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> bounceIn &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.3</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">70%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.9</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> rotateIn &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>) <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数字滚动动画 */</span></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.slide-up</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: slideUp <span class="built_in">var</span>(--clock-animation-duration) <span class="built_in">var</span>(--clock-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.slide-down</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: slideDown <span class="built_in">var</span>(--clock-animation-duration) <span class="built_in">var</span>(--clock-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.fade-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: fadeIn <span class="built_in">var</span>(--clock-animation-duration) <span class="built_in">var</span>(--clock-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bounce-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: bounceIn <span class="built_in">var</span>(--clock-animation-duration) <span class="built_in">var</span>(--clock-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.rotate-in</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: rotateIn <span class="built_in">var</span>(--clock-animation-duration) <span class="built_in">var</span>(--clock-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 时钟容器装饰效果 */</span></span><br><span class="line"><span class="selector-id">#card-digit-clock</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--clock-bg-gradient);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: opacity <span class="number">0.3s</span> ease;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#card-digit-clock</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 时钟容器悬停效果 */</span></span><br><span class="line"><span class="selector-id">#card-digit-clock</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">2px</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数字发光效果 */</span></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bright</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">drop-shadow</span>(<span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.3</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 冒号闪烁效果 */</span></span><br><span class="line"><span class="selector-class">.digit-group</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:last-child</span>)<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: blink <span class="number">2s</span> infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> blink &#123;</span><br><span class="line">    <span class="number">0%</span>, <span class="number">50%</span> &#123; <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="number">51%</span>, <span class="number">100%</span> &#123; <span class="attribute">opacity</span>: <span class="number">0.3</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#clock</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span> &#123;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">12px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bright</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit-group</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:last-child</span>)<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">70px</span>;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#clock</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">18px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">70px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span> &#123;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bright</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit-group</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:last-child</span>)<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">14px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 暗色模式适配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>), <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>));</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#card-digit-clock</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">var</span>(--clock-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bright</span> &#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.8</span>);</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">drop-shadow</span>(<span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.5</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 主题色彩变体 */</span></span><br><span class="line"><span class="selector-class">.theme-blue</span> <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attr">--clock-color-primary</span>: <span class="number">#007bff</span>;</span><br><span class="line">    <span class="attr">--clock-color-secondary</span>: <span class="number">#6c757d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.theme-green</span> <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attr">--clock-color-primary</span>: <span class="number">#28a745</span>;</span><br><span class="line">    <span class="attr">--clock-color-secondary</span>: <span class="number">#6c757d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.theme-purple</span> <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attr">--clock-color-primary</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">    <span class="attr">--clock-color-secondary</span>: <span class="number">#6c757d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.theme-orange</span> <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attr">--clock-color-primary</span>: <span class="number">#fd7e14</span>;</span><br><span class="line">    <span class="attr">--clock-color-secondary</span>: <span class="number">#6c757d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.theme-red</span> <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">    <span class="attr">--clock-color-primary</span>: <span class="number">#dc3545</span>;</span><br><span class="line">    <span class="attr">--clock-color-secondary</span>: <span class="number">#6c757d</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="⚙️-4-创建数码时钟基础逻辑">⚙️ 4. 创建数码时钟基础逻辑</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/js/custom/digit-clock.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 个性数码时钟基础逻辑</span></span><br><span class="line"><span class="comment"> * 实现纵列数字显示和动态滚动效果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等待DOM加载完成后再初始化数字时钟</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">initDigitClock</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理PJAX页面跳转</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 清理可能存在的旧时钟</span></span><br><span class="line">    <span class="keyword">const</span> existingClock = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;clock&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (existingClock) &#123;</span><br><span class="line">        existingClock.<span class="title function_">remove</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">initDigitClock</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initDigitClock</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 检查数字时钟容器是否存在</span></span><br><span class="line">    <span class="keyword">const</span> clockContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;card-digit-clock&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!clockContainer) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检查是否已经初始化过，防止重复初始化</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;clock&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建一个包含10个元素的数组，每个元素的值为索引  </span></span><br><span class="line">    <span class="keyword">var</span> _time10 = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="title class_">Array</span>(<span class="number">10</span>)).<span class="title function_">map</span>(<span class="function">(<span class="params">n, i</span>) =&gt;</span> i);</span><br><span class="line">    <span class="comment">// 创建一个包含前6个元素的数组，作为时间的小时和分钟  </span></span><br><span class="line">    <span class="keyword">var</span> _time6 = _time10.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">    <span class="comment">// 创建一个包含前3个元素的数组，作为时间的秒钟  </span></span><br><span class="line">    <span class="keyword">var</span> _time3 = _time10.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="comment">// 创建一个包含3个子数组的二维数组，用于表示时钟的结构  </span></span><br><span class="line">    <span class="keyword">var</span> _Structure = [</span><br><span class="line">        [_time3, _time10],</span><br><span class="line">        [_time6, _time10],</span><br><span class="line">        [_time6, _time10]</span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建一个div元素作为时钟的容器，并设置id为&#x27;clock&#x27;  </span></span><br><span class="line">    <span class="keyword">var</span> clock = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    clock.<span class="property">id</span> = <span class="string">&#x27;clock&#x27;</span>;</span><br><span class="line">    <span class="comment">// 将时钟容器添加到元素中元素中  </span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;card-digit-clock&quot;</span>).<span class="title function_">appendChild</span>(clock);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建一个数组用于存储每个数字组的div元素  </span></span><br><span class="line">    <span class="keyword">var</span> digitGroups = [];</span><br><span class="line">    <span class="comment">// 请求动画帧并调用update函数  </span></span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(update);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 遍历_Structure数组  </span></span><br><span class="line">    _Structure.<span class="title function_">forEach</span>(<span class="function"><span class="params">digits</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 创建一个div元素作为数字组的容器，并添加类名&#x27;digit-group&#x27;  </span></span><br><span class="line">        <span class="keyword">var</span> digitGroup = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        digitGroup.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;digit-group&#x27;</span>);</span><br><span class="line">        <span class="comment">// 将数字组的容器添加到时钟容器中，并将其添加到digitGroups数组中  </span></span><br><span class="line">        clock.<span class="title function_">appendChild</span>(digitGroup);</span><br><span class="line">        digitGroups.<span class="title function_">push</span>(digitGroup);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 遍历digits数组  </span></span><br><span class="line">        digits.<span class="title function_">forEach</span>(<span class="function"><span class="params">digitList</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 创建一个div元素作为数字的容器，并添加类名&#x27;digit&#x27;  </span></span><br><span class="line">            <span class="keyword">var</span> digit = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">            digit.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;digit&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 遍历digitList数组  </span></span><br><span class="line">            digitList.<span class="title function_">forEach</span>(<span class="function"><span class="params">n</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 创建一个div元素作为数字的子元素，并添加类名&#x27;digit-number&#x27;，设置文本内容为n  </span></span><br><span class="line">                <span class="keyword">var</span> ele = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">                ele.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;digit-number&#x27;</span>);</span><br><span class="line">                ele.<span class="property">innerText</span> = n;</span><br><span class="line">                <span class="comment">// 将数字的子元素添加到数字的容器中  </span></span><br><span class="line">                digit.<span class="title function_">appendChild</span>(ele);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// 将数字的容器添加到数字组的容器中  </span></span><br><span class="line">            digitGroup.<span class="title function_">appendChild</span>(digit);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 定义update函数  </span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 请求动画帧并调用update函数  </span></span><br><span class="line">        <span class="title function_">requestAnimationFrame</span>(update);</span><br><span class="line">        <span class="comment">// 创建一个Date对象表示当前时间  </span></span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="comment">// 获取当前时间的小时、分钟和秒钟，并将它们转换为两位数的字符串数组  </span></span><br><span class="line">        <span class="keyword">var</span> time = [date.<span class="title function_">getHours</span>(), date.<span class="title function_">getMinutes</span>(), date.<span class="title function_">getSeconds</span>()].</span><br><span class="line">            <span class="title function_">map</span>(<span class="function"><span class="params">n</span> =&gt;</span> <span class="string">`0<span class="subst">$&#123;n&#125;</span>`</span>.<span class="title function_">slice</span>(-<span class="number">2</span>).<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">e</span> =&gt;</span> +e)).</span><br><span class="line">            <span class="title function_">reduce</span>(<span class="function">(<span class="params">p, n</span>) =&gt;</span> p.<span class="title function_">concat</span>(n), []);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 遍历time数组  </span></span><br><span class="line">        time.<span class="title function_">forEach</span>(<span class="function">(<span class="params">n, i</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> digit = digitGroups[<span class="title class_">Math</span>.<span class="title function_">floor</span>(i * <span class="number">0.5</span>)].<span class="property">children</span>[i % <span class="number">2</span>].<span class="property">children</span>;</span><br><span class="line">            <span class="comment">// 遍历数字组的子元素  </span></span><br><span class="line">            <span class="title class_">Array</span>.<span class="title function_">from</span>(digit).<span class="title function_">forEach</span>(<span class="function">(<span class="params">e, i2</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (i2 === n) &#123;</span><br><span class="line">                    <span class="comment">// 当前数字：加粗显示在中间</span></span><br><span class="line">                    e.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;bright&#x27;</span>);</span><br><span class="line">                    e.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateY(-50%)&#x27;</span>; <span class="comment">// 保持在中间位置</span></span><br><span class="line">                    e.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 非当前数字：显示在纵列中，根据位置调整透明度</span></span><br><span class="line">                    e.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;bright&#x27;</span>);</span><br><span class="line">                    e.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0.4&#x27;</span>;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// 计算每个数字在纵列中的位置</span></span><br><span class="line">                    <span class="comment">// 当前数字在中间（translateY(-50%)），其他数字按顺序排列</span></span><br><span class="line">                    <span class="keyword">var</span> offset = (i2 - n) * <span class="number">12</span>; <span class="comment">// 每个数字间隔12px，适应更小容器</span></span><br><span class="line">                    e.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`translateY(calc(-50% + <span class="subst">$&#123;offset&#125;</span>px))`</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🚀-5-创建数码时钟增强功能">🚀 5. 创建数码时钟增强功能</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/js/custom/digit-clock-enhancer.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 个性数码时钟增强功能</span></span><br><span class="line"><span class="comment"> * 提供配置化、主题切换、动画效果等高级功能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitClockEnhancer</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">config</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationType</span> = <span class="string">&#x27;slide&#x27;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">theme</span> = <span class="string">&#x27;default&#x27;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isInitialized</span> = <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">loadConfig</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;card-digit-clock&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">clockContainer</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">applyConfig</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">bindEvents</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">detectTheme</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isInitialized</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">loadConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 从配置文件加载时钟配置</span></span><br><span class="line">            <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/data/clock-config.yml&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> yamlText = <span class="keyword">await</span> response.<span class="title function_">text</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 简单的YAML解析</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">config</span> = <span class="variable language_">this</span>.<span class="title function_">parseYaml</span>(yamlText);</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Digit Clock Enhancer: 配置加载完成&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Digit Clock Enhancer: 配置加载失败&#x27;</span>, error);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">loadDefaultConfig</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">parseYaml</span>(<span class="params">yamlText</span>) &#123;</span><br><span class="line">        <span class="comment">// 简化的YAML解析器</span></span><br><span class="line">        <span class="keyword">const</span> lines = yamlText.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line">        <span class="keyword">let</span> currentSection = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">let</span> currentSubSection = <span class="literal">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> line <span class="keyword">of</span> lines) &#123;</span><br><span class="line">            <span class="keyword">const</span> trimmedLine = line.<span class="title function_">trim</span>();</span><br><span class="line">            <span class="keyword">if</span> (trimmedLine.<span class="title function_">startsWith</span>(<span class="string">&#x27;#&#x27;</span>) || trimmedLine === <span class="string">&#x27;&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (trimmedLine.<span class="title function_">endsWith</span>(<span class="string">&#x27;:&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">const</span> key = trimmedLine.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (key.<span class="title function_">includes</span>(<span class="string">&#x27; &#x27;</span>)) &#123;</span><br><span class="line">                    <span class="comment">// 子配置项</span></span><br><span class="line">                    <span class="keyword">const</span> parts = key.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (parts.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">                        currentSection = parts[<span class="number">0</span>];</span><br><span class="line">                        currentSubSection = parts[<span class="number">1</span>];</span><br><span class="line">                        <span class="keyword">if</span> (!result[currentSection]) &#123;</span><br><span class="line">                            result[currentSection] = &#123;&#125;;</span><br><span class="line">                        &#125;</span><br><span class="line">                        result[currentSection][currentSubSection] = &#123;&#125;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    currentSection = key;</span><br><span class="line">                    result[currentSection] = &#123;&#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentSection &amp;&amp; trimmedLine.<span class="title function_">includes</span>(<span class="string">&#x27;:&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">const</span> [key, value] = trimmedLine.<span class="title function_">split</span>(<span class="string">&#x27;:&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">s</span> =&gt;</span> s.<span class="title function_">trim</span>());</span><br><span class="line">                <span class="keyword">const</span> cleanValue = value.<span class="title function_">replace</span>(<span class="regexp">/[&#x27;&quot;]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (currentSubSection) &#123;</span><br><span class="line">                    result[currentSection][currentSubSection][key] = <span class="variable language_">this</span>.<span class="title function_">parseValue</span>(cleanValue);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    result[currentSection][key] = <span class="variable language_">this</span>.<span class="title function_">parseValue</span>(cleanValue);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">parseValue</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="comment">// 解析不同类型的值</span></span><br><span class="line">        <span class="keyword">if</span> (value === <span class="string">&#x27;true&#x27;</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (value === <span class="string">&#x27;false&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(value) &amp;&amp; !<span class="built_in">isNaN</span>(<span class="built_in">parseFloat</span>(value))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">parseFloat</span>(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">loadDefaultConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">config</span> = &#123;</span><br><span class="line">            <span class="attr">digit_clock</span>: &#123;</span><br><span class="line">                <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">display_format</span>: <span class="string">&quot;HH:MM:SS&quot;</span>,</span><br><span class="line">                <span class="attr">update_interval</span>: <span class="number">1000</span>,</span><br><span class="line">                <span class="attr">style</span>: &#123;</span><br><span class="line">                    <span class="attr">container_height</span>: <span class="number">100</span>,</span><br><span class="line">                    <span class="attr">digit_width</span>: <span class="number">25</span>,</span><br><span class="line">                    <span class="attr">digit_height</span>: <span class="number">15</span>,</span><br><span class="line">                    <span class="attr">digit_spacing</span>: <span class="number">12</span>,</span><br><span class="line">                    <span class="attr">font_size_current</span>: <span class="number">18</span>,</span><br><span class="line">                    <span class="attr">font_size_other</span>: <span class="number">14</span>,</span><br><span class="line">                    <span class="attr">font_weight_current</span>: <span class="string">&#x27;bold&#x27;</span>,</span><br><span class="line">                    <span class="attr">font_weight_other</span>: <span class="string">&#x27;normal&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">colors</span>: &#123;</span><br><span class="line">                    <span class="attr">current_digit</span>: <span class="string">&quot;#007bff&quot;</span>,</span><br><span class="line">                    <span class="attr">other_digit</span>: <span class="string">&quot;#6c757d&quot;</span>,</span><br><span class="line">                    <span class="attr">colon</span>: <span class="string">&quot;#007bff&quot;</span>,</span><br><span class="line">                    <span class="attr">background</span>: <span class="string">&quot;transparent&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">animation</span>: &#123;</span><br><span class="line">                    <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">0.4</span>,</span><br><span class="line">                    <span class="attr">easing</span>: <span class="string">&quot;cubic-bezier(0.4, 0, 0.2, 1)&quot;</span>,</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&quot;slide&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">opacity</span>: &#123;</span><br><span class="line">                    <span class="attr">current_digit</span>: <span class="number">1.0</span>,</span><br><span class="line">                    <span class="attr">other_digit</span>: <span class="number">0.4</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">responsive</span>: &#123;</span><br><span class="line">                    <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">mobile</span>: &#123;</span><br><span class="line">                        <span class="attr">container_height</span>: <span class="number">80</span>,</span><br><span class="line">                        <span class="attr">digit_width</span>: <span class="number">20</span>,</span><br><span class="line">                        <span class="attr">digit_height</span>: <span class="number">12</span>,</span><br><span class="line">                        <span class="attr">digit_spacing</span>: <span class="number">10</span>,</span><br><span class="line">                        <span class="attr">font_size_current</span>: <span class="number">16</span>,</span><br><span class="line">                        <span class="attr">font_size_other</span>: <span class="number">12</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">tablet</span>: &#123;</span><br><span class="line">                        <span class="attr">container_height</span>: <span class="number">90</span>,</span><br><span class="line">                        <span class="attr">digit_width</span>: <span class="number">22</span>,</span><br><span class="line">                        <span class="attr">digit_height</span>: <span class="number">14</span>,</span><br><span class="line">                        <span class="attr">digit_spacing</span>: <span class="number">11</span>,</span><br><span class="line">                        <span class="attr">font_size_current</span>: <span class="number">17</span>,</span><br><span class="line">                        <span class="attr">font_size_other</span>: <span class="number">13</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">applyConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">config</span> || !<span class="variable language_">this</span>.<span class="property">clockContainer</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">digit_clock</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用容器样式</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;config.style.container_height&#125;</span>px`</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">background</span> = config.<span class="property">colors</span>.<span class="property">background</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用数字样式</span></span><br><span class="line">        <span class="keyword">const</span> digits = <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit&#x27;</span>);</span><br><span class="line">        digits.<span class="title function_">forEach</span>(<span class="function"><span class="params">digit</span> =&gt;</span> &#123;</span><br><span class="line">            digit.<span class="property">style</span>.<span class="property">width</span> = <span class="string">`<span class="subst">$&#123;config.style.digit_width&#125;</span>px`</span>;</span><br><span class="line">            digit.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;config.style.container_height&#125;</span>px`</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> digitNumbers = digit.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit-number&#x27;</span>);</span><br><span class="line">            digitNumbers.<span class="title function_">forEach</span>(<span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">lineHeight</span> = <span class="string">`<span class="subst">$&#123;config.style.digit_height&#125;</span>px`</span>;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;config.style.digit_height&#125;</span>px`</span>;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">`<span class="subst">$&#123;config.style.font_size_other&#125;</span>px`</span>;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">color</span> = config.<span class="property">colors</span>.<span class="property">other_digit</span>;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">opacity</span> = config.<span class="property">opacity</span>.<span class="property">other_digit</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 设置动画</span></span><br><span class="line">                <span class="keyword">if</span> (config.<span class="property">animation</span>.<span class="property">enable</span>) &#123;</span><br><span class="line">                    number.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">`transform <span class="subst">$&#123;config.animation.duration&#125;</span>s <span class="subst">$&#123;config.animation.easing&#125;</span>, </span></span><br><span class="line"><span class="string">                                             font-size 0.3s ease, </span></span><br><span class="line"><span class="string">                                             font-weight 0.3s ease, </span></span><br><span class="line"><span class="string">                                             opacity 0.3s ease`</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用当前数字样式</span></span><br><span class="line">        <span class="keyword">const</span> brightNumbers = <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit-number.bright&#x27;</span>);</span><br><span class="line">        brightNumbers.<span class="title function_">forEach</span>(<span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">            number.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">`<span class="subst">$&#123;config.style.font_size_current&#125;</span>px`</span>;</span><br><span class="line">            number.<span class="property">style</span>.<span class="property">fontWeight</span> = config.<span class="property">style</span>.<span class="property">font_weight_current</span>;</span><br><span class="line">            number.<span class="property">style</span>.<span class="property">color</span> = config.<span class="property">colors</span>.<span class="property">current_digit</span>;</span><br><span class="line">            number.<span class="property">style</span>.<span class="property">opacity</span> = config.<span class="property">opacity</span>.<span class="property">current_digit</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用冒号样式</span></span><br><span class="line">        <span class="keyword">const</span> colons = <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit-group:not(:last-child):after&#x27;</span>);</span><br><span class="line">        colons.<span class="title function_">forEach</span>(<span class="function"><span class="params">colon</span> =&gt;</span> &#123;</span><br><span class="line">            colon.<span class="property">style</span>.<span class="property">color</span> = config.<span class="property">colors</span>.<span class="property">colon</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 设置动画类型</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationType</span> = config.<span class="property">animation</span>.<span class="property">type</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">bindEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 点击切换动画效果</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">switchAnimationType</span>();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 鼠标悬停效果</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseenter&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">addHoverEffect</span>();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">removeHoverEffect</span>();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 监听主题切换</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;themeChange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">detectTheme</span>();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 监听窗口大小变化</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">handleResize</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">switchAnimationType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> animationTypes = [<span class="string">&#x27;slide&#x27;</span>, <span class="string">&#x27;fade&#x27;</span>, <span class="string">&#x27;bounce&#x27;</span>, <span class="string">&#x27;rotate&#x27;</span>];</span><br><span class="line">        <span class="keyword">const</span> currentIndex = animationTypes.<span class="title function_">indexOf</span>(<span class="variable language_">this</span>.<span class="property">animationType</span>);</span><br><span class="line">        <span class="keyword">const</span> nextIndex = (currentIndex + <span class="number">1</span>) % animationTypes.<span class="property">length</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationType</span> = animationTypes[nextIndex];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">applyAnimationType</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 显示切换提示</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">showAnimationTip</span>(<span class="variable language_">this</span>.<span class="property">animationType</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">applyAnimationType</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> digitNumbers = <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit-number&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 移除之前的动画类</span></span><br><span class="line">        digitNumbers.<span class="title function_">forEach</span>(<span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">            number.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;slide-up&#x27;</span>, <span class="string">&#x27;slide-down&#x27;</span>, <span class="string">&#x27;fade-in&#x27;</span>, <span class="string">&#x27;bounce-in&#x27;</span>, <span class="string">&#x27;rotate-in&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加新的动画类</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            digitNumbers.<span class="title function_">forEach</span>(<span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (number.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;bright&#x27;</span>)) &#123;</span><br><span class="line">                    number.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.animationType&#125;</span>-in`</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">addHoverEffect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateY(-2px)&#x27;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">boxShadow</span> = <span class="string">&#x27;0 8px 25px rgba(0, 123, 255, 0.15)&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">removeHoverEffect</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateY(0)&#x27;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">boxShadow</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">detectTheme</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> theme = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">theme</span> = theme || <span class="string">&#x27;default&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用主题样式</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">applyThemeStyles</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">applyThemeStyles</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">digit_clock</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">theme</span> === <span class="string">&#x27;dark&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">background</span> = <span class="string">&#x27;linear-gradient(135deg, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.1))&#x27;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&#x27;1px solid rgba(255, 255, 255, 0.1)&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">background</span> = config.<span class="property">colors</span>.<span class="property">background</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">handleResize</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">digit_clock</span>.<span class="property">responsive</span>.<span class="property">enable</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> width = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">        <span class="keyword">let</span> responsiveConfig = <span class="literal">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (width &lt;= <span class="number">480</span>) &#123;</span><br><span class="line">            responsiveConfig = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">digit_clock</span>.<span class="property">responsive</span>.<span class="property">mobile</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (width &lt;= <span class="number">768</span>) &#123;</span><br><span class="line">            responsiveConfig = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">digit_clock</span>.<span class="property">responsive</span>.<span class="property">tablet</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (responsiveConfig) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">applyResponsiveConfig</span>(responsiveConfig);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">applyResponsiveConfig</span>(<span class="params">config</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;config.container_height&#125;</span>px`</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> digits = <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit&#x27;</span>);</span><br><span class="line">        digits.<span class="title function_">forEach</span>(<span class="function"><span class="params">digit</span> =&gt;</span> &#123;</span><br><span class="line">            digit.<span class="property">style</span>.<span class="property">width</span> = <span class="string">`<span class="subst">$&#123;config.digit_width&#125;</span>px`</span>;</span><br><span class="line">            digit.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;config.container_height&#125;</span>px`</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> digitNumbers = digit.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.digit-number&#x27;</span>);</span><br><span class="line">            digitNumbers.<span class="title function_">forEach</span>(<span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">lineHeight</span> = <span class="string">`<span class="subst">$&#123;config.digit_height&#125;</span>px`</span>;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;config.digit_height&#125;</span>px`</span>;</span><br><span class="line">                number.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">`<span class="subst">$&#123;config.font_size_other&#125;</span>px`</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (number.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;bright&#x27;</span>)) &#123;</span><br><span class="line">                    number.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">`<span class="subst">$&#123;config.font_size_current&#125;</span>px`</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">showAnimationTip</span>(<span class="params">animationType</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> tip = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        tip.<span class="property">className</span> = <span class="string">&#x27;clock-animation-tip&#x27;</span>;</span><br><span class="line">        tip.<span class="property">textContent</span> = <span class="string">`动画效果: <span class="subst">$&#123;animationType&#125;</span>`</span>;</span><br><span class="line">        tip.<span class="property">style</span>.<span class="property">cssText</span> = <span class="string">`</span></span><br><span class="line"><span class="string">            position: fixed;</span></span><br><span class="line"><span class="string">            top: 20px;</span></span><br><span class="line"><span class="string">            right: 20px;</span></span><br><span class="line"><span class="string">            background: rgba(0, 0, 0, 0.8);</span></span><br><span class="line"><span class="string">            color: white;</span></span><br><span class="line"><span class="string">            padding: 8px 16px;</span></span><br><span class="line"><span class="string">            border-radius: 4px;</span></span><br><span class="line"><span class="string">            font-size: 12px;</span></span><br><span class="line"><span class="string">            z-index: 1000;</span></span><br><span class="line"><span class="string">            opacity: 0;</span></span><br><span class="line"><span class="string">            transition: opacity 0.3s ease;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(tip);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 显示提示</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            tip.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 隐藏提示</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            tip.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (tip.<span class="property">parentNode</span>) &#123;</span><br><span class="line">                    tip.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(tip);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">300</span>);</span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 销毁方法</span></span><br><span class="line">    <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">clockContainer</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="variable language_">this</span>.<span class="property">switchAnimationType</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mouseenter&#x27;</span>, <span class="variable language_">this</span>.<span class="property">addHoverEffect</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">clockContainer</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, <span class="variable language_">this</span>.<span class="property">removeHoverEffect</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleResize</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;themeChange&#x27;</span>, <span class="variable language_">this</span>.<span class="property">detectTheme</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">config</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">clockContainer</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isInitialized</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">digitClockEnhancer</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initDigitClockEnhancer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">digitClockEnhancer</span>) &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">digitClockEnhancer</span> = <span class="keyword">new</span> <span class="title class_">DigitClockEnhancer</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面加载完成后初始化</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 延迟初始化，确保基础时钟已加载</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">initDigitClockEnhancer</span>();</span><br><span class="line">    &#125;, <span class="number">1500</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听主题切换事件</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;themeChange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">digitClockEnhancer</span>) &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">digitClockEnhancer</span>.<span class="title function_">detectTheme</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出类供其他脚本使用</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">module</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">exports</span>) &#123;</span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">DigitClockEnhancer</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第四步：配置主题启用个性时钟">第四步：配置主题启用个性时钟</h2><h3 id="⚙️-1-修改侧边栏配置文件">⚙️ 1. 修改侧边栏配置文件</h3><p><strong>文件路径</strong>：<code>source/_data/aside.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">digit-clock</span></span><br><span class="line">  <span class="attr">title:</span></span><br><span class="line">  <span class="attr">class:</span> <span class="string">card-digit-clock</span></span><br><span class="line">  <span class="attr">id:</span> <span class="string">card-digit-clock</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">  <span class="attr">content_class:</span></span><br><span class="line">  <span class="attr">content_id:</span> </span><br><span class="line">  <span class="attr">content_html:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># 新增个性时钟配置</span></span><br><span class="line">  <span class="attr">digit_clock:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">&quot;enhanced&quot;</span>  <span class="comment"># 可选值: basic, enhanced</span></span><br><span class="line">    <span class="attr">animation:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">responsive:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">theme:</span> <span class="string">&quot;default&quot;</span>   <span class="comment"># 可选值: default, blue, green, purple, orange, red</span></span><br></pre></td></tr></table></figure><h3 id="🔧-2-修改主题配置文件">🔧 2. 修改主题配置文件</h3><p><strong>文件路径</strong>：<code>_config.solitude.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在配置文件中添加个性时钟配置</span></span><br><span class="line"><span class="attr">digit_clock:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">config_file:</span> <span class="string">clock-config.yml</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">enhanced</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">responsive:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">auto_enhance:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="📦-3-引入样式和脚本文件">📦 3. 引入样式和脚本文件</h3><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/head.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//- 在head部分添加个性时钟样式</span><br><span class="line">if theme.digit_clock &amp;&amp; theme.digit_clock.enable</span><br><span class="line">  link(rel=&#x27;stylesheet&#x27;, href=url_for(&#x27;/css/custom/digit-clock.css&#x27;))</span><br><span class="line">  if theme.digit_clock.style == &#x27;enhanced&#x27;</span><br><span class="line">    link(rel=&#x27;stylesheet&#x27;, href=url_for(&#x27;/css/custom/digit-clock-animations.css&#x27;))</span><br></pre></td></tr></table></figure><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/inject/body.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//- 在body部分添加个性时钟脚本</span><br><span class="line">if theme.digit_clock &amp;&amp; theme.digit_clock.enable</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/digit-clock.js&#x27;))</span><br><span class="line">  if theme.digit_clock.style == &#x27;enhanced&#x27;</span><br><span class="line">    script(src=url_for(&#x27;/js/custom/digit-clock-enhancer.js&#x27;))</span><br></pre></td></tr></table></figure><h2 id="第五步：实现个性时钟的关键技术">第五步：实现个性时钟的关键技术</h2><h3 id="🎯-1-纵列数字显示技术">🎯 1. 纵列数字显示技术</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：实现纵列数字显示效果</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(update);</span><br><span class="line">    <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">var</span> time = [date.<span class="title function_">getHours</span>(), date.<span class="title function_">getMinutes</span>(), date.<span class="title function_">getSeconds</span>()].</span><br><span class="line">        <span class="title function_">map</span>(<span class="function"><span class="params">n</span> =&gt;</span> <span class="string">`0<span class="subst">$&#123;n&#125;</span>`</span>.<span class="title function_">slice</span>(-<span class="number">2</span>).<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">e</span> =&gt;</span> +e)).</span><br><span class="line">        <span class="title function_">reduce</span>(<span class="function">(<span class="params">p, n</span>) =&gt;</span> p.<span class="title function_">concat</span>(n), []);</span><br><span class="line">    </span><br><span class="line">    time.<span class="title function_">forEach</span>(<span class="function">(<span class="params">n, i</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> digit = digitGroups[<span class="title class_">Math</span>.<span class="title function_">floor</span>(i * <span class="number">0.5</span>)].<span class="property">children</span>[i % <span class="number">2</span>].<span class="property">children</span>;</span><br><span class="line">        <span class="title class_">Array</span>.<span class="title function_">from</span>(digit).<span class="title function_">forEach</span>(<span class="function">(<span class="params">e, i2</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (i2 === n) &#123;</span><br><span class="line">                <span class="comment">// 当前数字：加粗显示在中间</span></span><br><span class="line">                e.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;bright&#x27;</span>);</span><br><span class="line">                e.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateY(-50%)&#x27;</span>;</span><br><span class="line">                e.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 非当前数字：显示在纵列中</span></span><br><span class="line">                e.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;bright&#x27;</span>);</span><br><span class="line">                e.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0.4&#x27;</span>;</span><br><span class="line">                <span class="keyword">var</span> offset = (i2 - n) * <span class="number">12</span>;</span><br><span class="line">                e.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`translateY(calc(-50% + <span class="subst">$&#123;offset&#125;</span>px))`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔒-2-CSS-Grid布局技术">🔒 2. CSS Grid布局技术</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：使用CSS Grid实现完美对齐 */</span></span><br><span class="line"><span class="selector-id">#clock</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: grid;</span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr auto <span class="number">1</span>fr auto <span class="number">1</span>fr;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.digit-group</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-3-动画效果系统">🎨 3. 动画效果系统</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：多种动画效果支持 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> slideUp &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">100%</span>); <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>); <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> bounceIn &#123;</span><br><span class="line">    <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.3</span>); <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="number">50%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>); &#125;</span><br><span class="line">    <span class="number">70%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.9</span>); &#125;</span><br><span class="line">    <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>); <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.slide-up</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: slideUp <span class="built_in">var</span>(--clock-animation-duration) <span class="built_in">var</span>(--clock-animation-easing);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔄-4-响应式设计适配">🔄 4. 响应式设计适配</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：响应式布局适配 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#card-digit-clock</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.digit</span> <span class="selector-class">.digit-number</span><span class="selector-class">.bright</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第六步：高级功能扩展">第六步：高级功能扩展</h2><h3 id="🎵-1-主题色彩系统">🎵 1. 主题色彩系统</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持多种主题色彩</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitClockEnhancer</span> &#123;</span><br><span class="line">    <span class="title function_">applyThemeStyles</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> themes = &#123;</span><br><span class="line">            <span class="attr">blue</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#007bff&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">green</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#28a745&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">purple</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#6f42c1&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">orange</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#fd7e14&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">red</span>: &#123; <span class="attr">primary</span>: <span class="string">&#x27;#dc3545&#x27;</span>, <span class="attr">secondary</span>: <span class="string">&#x27;#6c757d&#x27;</span> &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> theme = themes[<span class="variable language_">this</span>.<span class="property">theme</span>] || themes.<span class="property">blue</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">applyColorScheme</span>(theme);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-2-自定义动画效果">🎨 2. 自定义动画效果</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持自定义动画效果</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitClockEnhancer</span> &#123;</span><br><span class="line">    <span class="title function_">addCustomAnimation</span>(<span class="params">name, keyframes</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> style = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>);</span><br><span class="line">        style.<span class="property">textContent</span> = <span class="string">`</span></span><br><span class="line"><span class="string">            @keyframes <span class="subst">$&#123;name&#125;</span> &#123;</span></span><br><span class="line"><span class="string">                <span class="subst">$&#123;keyframes&#125;</span></span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(style);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔧-3-配置化设计">🔧 3. 配置化设计</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持丰富的配置选项</span></span><br><span class="line"><span class="attr">digit_clock:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">enhanced</span></span><br><span class="line">  <span class="attr">animation:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">slide</span></span><br><span class="line">    <span class="attr">duration:</span> <span class="number">0.4</span></span><br><span class="line">    <span class="attr">easing:</span> <span class="string">&quot;cubic-bezier(0.4, 0, 0.2, 1)&quot;</span></span><br><span class="line">  <span class="attr">colors:</span></span><br><span class="line">    <span class="attr">current_digit:</span> <span class="string">&quot;#007bff&quot;</span></span><br><span class="line">    <span class="attr">other_digit:</span> <span class="string">&quot;#6c757d&quot;</span></span><br><span class="line">    <span class="attr">colon:</span> <span class="string">&quot;#007bff&quot;</span></span><br><span class="line">  <span class="attr">responsive:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">breakpoints:</span></span><br><span class="line">      <span class="attr">mobile:</span> <span class="number">480</span></span><br><span class="line">      <span class="attr">tablet:</span> <span class="number">768</span></span><br></pre></td></tr></table></figure><h2 id="第七步：测试验证">第七步：测试验证</h2><h3 id="🧪-1-功能测试">🧪 1. 功能测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试步骤</span></span><br><span class="line">1. 启用个性时钟配置</span><br><span class="line">2. 重新生成网站: npm run build</span><br><span class="line">3. 测试时钟显示功能</span><br><span class="line">4. 测试动画效果</span><br><span class="line">5. 测试响应式设计</span><br><span class="line">6. 测试主题切换</span><br><span class="line">7. 测试配置化功能</span><br></pre></td></tr></table></figure><h3 id="🔍-2-兼容性测试">🔍 2. 兼容性测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试项目</span></span><br><span class="line">✅ 时钟正常显示</span><br><span class="line">✅ 纵列数字效果正常</span><br><span class="line">✅ 动画效果流畅</span><br><span class="line">✅ 响应式设计正常</span><br><span class="line">✅ 主题切换正常</span><br><span class="line">✅ 配置化功能正常</span><br><span class="line">✅ 性能表现良好</span><br></pre></td></tr></table></figure><h3 id="🐛-3-问题排查">🐛 3. 问题排查</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常见问题排查</span></span><br><span class="line"><span class="number">1.</span> 检查配置文件是否正确加载</span><br><span class="line"><span class="number">2.</span> 检查<span class="variable constant_">DOM</span>元素是否正确创建</span><br><span class="line"><span class="number">3.</span> 检查<span class="variable constant_">CSS</span>样式是否正确加载</span><br><span class="line"><span class="number">4.</span> 检查<span class="title class_">JavaScript</span>是否正确执行</span><br><span class="line"><span class="number">5.</span> 检查动画效果是否流畅</span><br><span class="line"><span class="number">6.</span> 检查响应式设计是否正常</span><br></pre></td></tr></table></figure><h2 id="总结与经验">总结与经验</h2><h3 id="🎯-关键设计要点">🎯 关键设计要点</h3><ol><li><strong>纵列数字显示</strong>：使用CSS定位和JavaScript动态计算实现纵列效果</li><li><strong>当前时间突出</strong>：通过加粗、大字体、高透明度突出当前时间</li><li><strong>动画效果系统</strong>：提供多种动画效果，增强视觉体验</li><li><strong>响应式设计</strong>：适配不同屏幕尺寸，确保在各种设备上正常显示</li><li><strong>配置化管理</strong>：通过配置文件灵活控制样式和行为</li></ol><h3 id="🔧-技术实现要点">🔧 技术实现要点</h3><ol><li><strong>CSS Grid布局</strong>：使用Grid实现完美的水平对齐</li><li><strong>动态样式计算</strong>：JavaScript动态计算数字位置和样式</li><li><strong>动画系统</strong>：CSS动画和JavaScript控制结合</li><li><strong>响应式适配</strong>：媒体查询和JavaScript动态调整</li><li><strong>主题系统</strong>：支持多种主题色彩和样式</li></ol><h3 id="🚀-扩展应用">🚀 扩展应用</h3><p>这个个性时钟系统的设计思路可以应用到其他场景：</p><ul><li><strong>数字计数器动画</strong></li><li><strong>进度条显示</strong></li><li><strong>数据可视化</strong></li><li><strong>游戏界面元素</strong></li></ul><h3 id="💡-最佳实践">💡 最佳实践</h3><ol><li><strong>性能优化</strong>：合理使用requestAnimationFrame和CSS动画</li><li><strong>用户体验</strong>：确保动画效果不会影响可读性</li><li><strong>兼容性</strong>：确保在不同浏览器和设备上正常工作</li><li><strong>可维护性</strong>：保持代码结构清晰，便于后续维护</li><li><strong>可扩展性</strong>：设计灵活的配置系统，支持功能扩展</li></ol><hr><p>通过本次完整的个性时钟系统实现，我们不仅成功创建了美观的纵列数字显示效果，还学会了如何设计可扩展的动画系统和配置管理。这种设计思路可以帮助我们构建更加动态和个性化的用户界面！</p><p><strong>下期预告</strong>：我们将探索更多Solitude主题的高级魔改技巧，敬请期待！</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> 动画效果 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
            <tag> 侧边栏 </tag>
            
            <tag> 个性时钟 </tag>
            
            <tag> 数码时钟 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(21) - 侧边栏来访者欢迎信息魔改教程</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(21)-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E6%9D%A5%E8%AE%BF%E8%80%85%E6%AC%A2%E8%BF%8E%E4%BF%A1%E6%81%AF%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(21)-%E4%BE%A7%E8%BE%B9%E6%A0%8F%E6%9D%A5%E8%AE%BF%E8%80%85%E6%AC%A2%E8%BF%8E%E4%BF%A1%E6%81%AF%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Solitude主题的侧边栏魔改中，来访者欢迎信息是一个重要的个性化元素：</p><ul><li>展示网站的人性化关怀</li><li>提供个性化的访问体验</li><li>增强用户与网站的互动感</li><li>支持多种欢迎信息展示方式</li></ul><p>本文将详细介绍如何实现个性化的侧边栏来访者欢迎信息，包括动态内容生成、样式美化、交互效果和响应式设计。</p><h2 id="第一步：理解现有架构">第一步：理解现有架构</h2><h3 id="🔍-现有来访者欢迎信息结构分析">🔍 现有来访者欢迎信息结构分析</h3><p>在开始魔改之前，我们需要先了解Solitude主题现有的来访者欢迎信息结构：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 现有文件结构</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── layout/</span><br><span class="line">│   └── includes/</span><br><span class="line">│       └── widgets/</span><br><span class="line">│           └── third-party/</span><br><span class="line">│               └── welcome.pug          <span class="comment"># 来访者欢迎信息模板</span></span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── custom/</span><br><span class="line">│   │       └── card-welcome.css         <span class="comment"># 来访者卡片样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── custom/</span><br><span class="line">│           └── card-welcome.js          <span class="comment"># 来访者卡片逻辑</span></span><br><span class="line">└── <span class="built_in">source</span>/_data/</span><br><span class="line">    └── aside.yml                        <span class="comment"># 侧边栏配置文件</span></span><br></pre></td></tr></table></figure><h3 id="📋-现有来访者欢迎信息特点">📋 现有来访者欢迎信息特点</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 现有来访者欢迎信息的主要特点</span></span><br><span class="line"><span class="number">1.</span> 基于静态配置的欢迎信息</span><br><span class="line"><span class="number">2.</span> 简单的文本展示</span><br><span class="line"><span class="number">3.</span> 基础的样式设计</span><br><span class="line"><span class="number">4.</span> 有限的个性化功能</span><br><span class="line"><span class="number">5.</span> 缺乏动态交互效果</span><br></pre></td></tr></table></figure><h2 id="第二步：设计个性化欢迎信息架构">第二步：设计个性化欢迎信息架构</h2><h3 id="🎯-设计目标">🎯 设计目标</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 个性化欢迎信息系统设计目标</span></span><br><span class="line"><span class="string">目标1:</span> <span class="string">动态生成个性化欢迎信息</span></span><br><span class="line"><span class="string">目标2:</span> <span class="string">支持多种欢迎信息类型</span></span><br><span class="line"><span class="string">目标3:</span> <span class="string">实现美观的视觉效果</span></span><br><span class="line"><span class="string">目标4:</span> <span class="string">添加交互式动画效果</span></span><br><span class="line"><span class="string">目标5:</span> <span class="string">支持响应式设计</span></span><br><span class="line"><span class="string">目标6:</span> <span class="string">提供配置化选项</span></span><br></pre></td></tr></table></figure><h3 id="🏗️-架构设计方案">🏗️ 架构设计方案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新的文件结构设计</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── layout/</span><br><span class="line">│   └── includes/</span><br><span class="line">│       └── widgets/</span><br><span class="line">│           └── third-party/</span><br><span class="line">│               └── welcome.pug              <span class="comment"># 来访者欢迎信息模板</span></span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── custom/</span><br><span class="line">│   │       ├── card-welcome.css             <span class="comment"># 基础样式</span></span><br><span class="line">│   │       └── welcome-animations.css       <span class="comment"># 动画效果样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── custom/</span><br><span class="line">│           ├── card-welcome.js              <span class="comment"># 基础逻辑</span></span><br><span class="line">│           └── welcome-personalizer.js      <span class="comment"># 个性化逻辑</span></span><br><span class="line">└── <span class="built_in">source</span>/_data/</span><br><span class="line">    ├── aside.yml                            <span class="comment"># 侧边栏配置</span></span><br><span class="line">    └── welcome-messages.yml                 <span class="comment"># 欢迎信息配置</span></span><br></pre></td></tr></table></figure><h2 id="第三步：创建个性化欢迎信息核心文件">第三步：创建个性化欢迎信息核心文件</h2><h3 id="📝-1-创建欢迎信息配置文件">📝 1. 创建欢迎信息配置文件</h3><p><strong>文件路径</strong>：<code>source/_data/welcome-messages.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 个性化欢迎信息配置</span></span><br><span class="line"><span class="attr">welcome_messages:</span></span><br><span class="line">  <span class="comment"># 基础欢迎信息</span></span><br><span class="line">  <span class="attr">basic:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;欢迎来到我的博客！&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;很高兴见到你！&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;欢迎访问我的小站！&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;感谢你的来访！&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 时间相关欢迎信息</span></span><br><span class="line">  <span class="attr">time_based:</span></span><br><span class="line">    <span class="attr">morning:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;早上好！新的一天开始了！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;早安！愿你今天充满活力！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;清晨的阳光为你带来好心情！&quot;</span></span><br><span class="line">    <span class="attr">afternoon:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;下午好！工作学习辛苦了！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;午后时光，来杯咖啡吧！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;下午的阳光很温暖呢！&quot;</span></span><br><span class="line">    <span class="attr">evening:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;晚上好！今天过得怎么样？&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;夜幕降临，愿你有个美好的夜晚！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;晚上是思考的好时光！&quot;</span></span><br><span class="line">    <span class="attr">night:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;夜深了，注意休息哦！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;夜猫子，还在学习吗？&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;深夜来访，欢迎你！&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 天气相关欢迎信息</span></span><br><span class="line">  <span class="attr">weather_based:</span></span><br><span class="line">    <span class="attr">sunny:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;今天阳光明媚，心情也格外好！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;阳光正好，微风不燥！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;晴天总是让人心情愉悦！&quot;</span></span><br><span class="line">    <span class="attr">rainy:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;下雨天，适合宅在家里学习！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;雨声淅沥，思绪万千！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;雨天也有雨天的美好！&quot;</span></span><br><span class="line">    <span class="attr">cloudy:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;多云天气，适合思考人生！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;云卷云舒，岁月静好！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;阴天也有阴天的韵味！&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 节日相关欢迎信息</span></span><br><span class="line">  <span class="attr">festival:</span></span><br><span class="line">    <span class="attr">new_year:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;新年快乐！愿新的一年充满希望！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;辞旧迎新，祝你新年快乐！&quot;</span></span><br><span class="line">    <span class="attr">spring_festival:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;春节快乐！恭喜发财！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;新年新气象，祝你万事如意！&quot;</span></span><br><span class="line">    <span class="attr">valentine:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;情人节快乐！愿有情人终成眷属！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;爱意满满的情人节！&quot;</span></span><br><span class="line">    <span class="attr">christmas:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;圣诞快乐！愿你的世界充满温暖！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;铃儿响叮当，圣诞快乐！&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 个性化欢迎信息</span></span><br><span class="line">  <span class="attr">personalized:</span></span><br><span class="line">    <span class="attr">first_visit:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;初次见面，请多指教！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;欢迎新朋友！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;很高兴认识你！&quot;</span></span><br><span class="line">    <span class="attr">returning_visitor:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;老朋友，又见面了！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;欢迎回来！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;再次见到你真好！&quot;</span></span><br><span class="line">    <span class="attr">frequent_visitor:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;常客来了！欢迎欢迎！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;又见面了，老朋友！&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;你的支持是我最大的动力！&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 欢迎信息显示配置</span></span><br><span class="line"><span class="attr">display_config:</span></span><br><span class="line">  <span class="attr">animation_duration:</span> <span class="number">0.5</span>  <span class="comment"># 动画持续时间(秒)</span></span><br><span class="line">  <span class="attr">auto_switch_interval:</span> <span class="number">5</span>  <span class="comment"># 自动切换间隔(秒)</span></span><br><span class="line">  <span class="attr">enable_weather:</span> <span class="literal">true</span>     <span class="comment"># 是否启用天气信息</span></span><br><span class="line">  <span class="attr">enable_time:</span> <span class="literal">true</span>        <span class="comment"># 是否启用时间信息</span></span><br><span class="line">  <span class="attr">enable_personalization:</span> <span class="literal">true</span>  <span class="comment"># 是否启用个性化</span></span><br><span class="line">  <span class="attr">max_messages:</span> <span class="number">3</span>          <span class="comment"># 最大显示消息数量</span></span><br></pre></td></tr></table></figure><h3 id="🎨-2-创建欢迎信息动画样式">🎨 2. 创建欢迎信息动画样式</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/css/custom/welcome-animations.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 来访者欢迎信息动画效果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 基础动画变量 */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--welcome-animation-duration</span>: <span class="number">0.5s</span>;</span><br><span class="line">  <span class="attr">--welcome-animation-easing</span>: <span class="built_in">cubic-bezier</span>(<span class="number">0.4</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="attr">--welcome-color-primary</span>: <span class="built_in">var</span>(--efu-main);</span><br><span class="line">  <span class="attr">--welcome-color-secondary</span>: <span class="built_in">var</span>(--efu-secondtext);</span><br><span class="line">  <span class="attr">--welcome-bg-gradient</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>), <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.05</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 欢迎信息容器动画 */</span></span><br><span class="line"><span class="selector-class">.welcome-message-container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--welcome-bg-gradient);</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">10px</span>);</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="built_in">var</span>(--welcome-animation-duration) <span class="built_in">var</span>(--welcome-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.welcome-message-container</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">2px</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.15</span>);</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">var</span>(--welcome-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 欢迎信息文本动画 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">16px</span> <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.6</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-fontcolor);</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="built_in">var</span>(--welcome-animation-duration) <span class="built_in">var</span>(--welcome-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.show</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.hide</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">20px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 打字机效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.typewriter</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--welcome-color-primary);</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">animation</span>: typing <span class="number">2s</span> <span class="built_in">steps</span>(<span class="number">40</span>, end), blink-caret <span class="number">0.75s</span> step-end infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> typing &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123; <span class="attribute">width</span>: <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123; <span class="attribute">width</span>: <span class="number">100%</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> blink-caret &#123;</span><br><span class="line">  <span class="selector-tag">from</span>, <span class="selector-tag">to</span> &#123; <span class="attribute">border-color</span>: transparent; &#125;</span><br><span class="line">  <span class="number">50%</span> &#123; <span class="attribute">border-color</span>: <span class="built_in">var</span>(--welcome-color-primary); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 淡入淡出效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.fade</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: fadeInOut <span class="number">3s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> fadeInOut &#123;</span><br><span class="line">  <span class="number">0%</span>, <span class="number">100%</span> &#123; <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="number">50%</span> &#123; <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 滑动效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.slide</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: slideInOut <span class="number">4s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> slideInOut &#123;</span><br><span class="line">  <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>); <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="number">25%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>); <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">  <span class="number">75%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>); <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">  <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>); <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 弹跳效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.bounce</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: bounceIn <span class="number">0.8s</span> ease-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> bounceIn &#123;</span><br><span class="line">  <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.3</span>); <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="number">50%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>); &#125;</span><br><span class="line">  <span class="number">70%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.9</span>); &#125;</span><br><span class="line">  <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>); <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 旋转效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.rotate</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: rotateIn <span class="number">1s</span> ease-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> rotateIn &#123;</span><br><span class="line">  <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>) <span class="built_in">scale</span>(<span class="number">0.5</span>); <span class="attribute">opacity</span>: <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>) <span class="built_in">scale</span>(<span class="number">1</span>); <span class="attribute">opacity</span>: <span class="number">1</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 欢迎信息装饰元素 */</span></span><br><span class="line"><span class="selector-class">.welcome-decoration</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.welcome-decoration</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, transparent, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>), transparent);</span><br><span class="line">  <span class="attribute">animation</span>: shimmer <span class="number">3s</span> infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> shimmer &#123;</span><br><span class="line">  <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>) <span class="built_in">translateY</span>(-<span class="number">100%</span>) <span class="built_in">rotate</span>(<span class="number">45deg</span>); &#125;</span><br><span class="line">  <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>) <span class="built_in">translateY</span>(<span class="number">100%</span>) <span class="built_in">rotate</span>(<span class="number">45deg</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 欢迎信息图标 */</span></span><br><span class="line"><span class="selector-class">.welcome-icon</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--welcome-color-primary);</span><br><span class="line">  <span class="attribute">animation</span>: iconPulse <span class="number">2s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> iconPulse &#123;</span><br><span class="line">  <span class="number">0%</span>, <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>); &#125;</span><br><span class="line">  <span class="number">50%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 欢迎信息时间显示 */</span></span><br><span class="line"><span class="selector-class">.welcome-time</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--welcome-color-secondary);</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 欢迎信息天气显示 */</span></span><br><span class="line"><span class="selector-class">.welcome-weather</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--welcome-color-secondary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.welcome-weather-icon</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.welcome-message</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">12px</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.welcome-icon</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.welcome-time</span>,</span><br><span class="line">  <span class="selector-class">.welcome-weather</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">11px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 暗色模式适配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.welcome-message-container</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>), <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>));</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.welcome-message-container</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">var</span>(--welcome-color-primary);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="⚙️-3-创建个性化欢迎信息逻辑">⚙️ 3. 创建个性化欢迎信息逻辑</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/js/custom/welcome-personalizer.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 来访者欢迎信息个性化系统</span></span><br><span class="line"><span class="comment"> * 支持动态内容生成、时间感知、天气信息等</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WelcomePersonalizer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messages</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">config</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentMessageIndex</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">animationTimer</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">weatherData</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">visitHistory</span> = <span class="variable language_">this</span>.<span class="title function_">getVisitHistory</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">init</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">loadConfig</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">createWelcomeElement</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">bindEvents</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">startMessageRotation</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 异步加载天气信息</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">enable_weather</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">loadWeatherData</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">loadConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 从配置文件加载欢迎信息</span></span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/data/welcome-messages.yml&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> yamlText = <span class="keyword">await</span> response.<span class="title function_">text</span>()</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 简单的YAML解析（实际项目中建议使用专业的YAML解析库）</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">messages</span> = <span class="variable language_">this</span>.<span class="title function_">parseYaml</span>(yamlText)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">config</span> = <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">display_config</span> || &#123;&#125;</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Welcome Personalizer: 配置加载完成&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Welcome Personalizer: 配置加载失败&#x27;</span>, error)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">loadDefaultConfig</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">parseYaml</span>(<span class="params">yamlText</span>) &#123;</span><br><span class="line">    <span class="comment">// 简化的YAML解析器（仅用于演示）</span></span><br><span class="line">    <span class="comment">// 实际项目中建议使用 js-yaml 等专业库</span></span><br><span class="line">    <span class="keyword">const</span> lines = yamlText.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> result = &#123;&#125;</span><br><span class="line">    <span class="keyword">let</span> currentSection = <span class="literal">null</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> line <span class="keyword">of</span> lines) &#123;</span><br><span class="line">      <span class="keyword">const</span> trimmedLine = line.<span class="title function_">trim</span>()</span><br><span class="line">      <span class="keyword">if</span> (trimmedLine.<span class="title function_">startsWith</span>(<span class="string">&#x27;#&#x27;</span>) || trimmedLine === <span class="string">&#x27;&#x27;</span>) <span class="keyword">continue</span></span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (trimmedLine.<span class="title function_">endsWith</span>(<span class="string">&#x27;:&#x27;</span>)) &#123;</span><br><span class="line">        currentSection = trimmedLine.<span class="title function_">slice</span>(<span class="number">0</span>, -<span class="number">1</span>)</span><br><span class="line">        result[currentSection] = &#123;&#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentSection &amp;&amp; trimmedLine.<span class="title function_">startsWith</span>(<span class="string">&#x27;- &#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!result[currentSection].<span class="property">messages</span>) &#123;</span><br><span class="line">          result[currentSection].<span class="property">messages</span> = []</span><br><span class="line">        &#125;</span><br><span class="line">        result[currentSection].<span class="property">messages</span>.<span class="title function_">push</span>(trimmedLine.<span class="title function_">slice</span>(<span class="number">2</span>).<span class="title function_">replace</span>(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">loadDefaultConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messages</span> = &#123;</span><br><span class="line">      <span class="attr">basic</span>: &#123;</span><br><span class="line">        <span class="attr">messages</span>: [</span><br><span class="line">          <span class="string">&quot;欢迎来到我的博客！&quot;</span>,</span><br><span class="line">          <span class="string">&quot;很高兴见到你！&quot;</span>,</span><br><span class="line">          <span class="string">&quot;欢迎访问我的小站！&quot;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">config</span> = &#123;</span><br><span class="line">      <span class="attr">animation_duration</span>: <span class="number">0.5</span>,</span><br><span class="line">      <span class="attr">auto_switch_interval</span>: <span class="number">5</span>,</span><br><span class="line">      <span class="attr">enable_weather</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">enable_time</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">enable_personalization</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">max_messages</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">createWelcomeElement</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> welcomeContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#welcome-info&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!welcomeContainer) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建欢迎信息容器</span></span><br><span class="line">    <span class="keyword">const</span> messageContainer = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    messageContainer.<span class="property">className</span> = <span class="string">&#x27;welcome-message-container&#x27;</span></span><br><span class="line">    messageContainer.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;welcome-decoration&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;welcome-message show&quot; id=&quot;welcome-message&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;span class=&quot;welcome-icon&quot;&gt;👋&lt;/span&gt;</span></span><br><span class="line"><span class="string">        &lt;span class=&quot;welcome-text&quot;&gt;欢迎来到我的博客！&lt;/span&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;welcome-time&quot; id=&quot;welcome-time&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;welcome-weather&quot; id=&quot;welcome-weather&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    welcomeContainer.<span class="title function_">appendChild</span>(messageContainer)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 保存引用</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageContainer</span> = messageContainer</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageElement</span> = messageContainer.<span class="title function_">querySelector</span>(<span class="string">&#x27;#welcome-message&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timeElement</span> = messageContainer.<span class="title function_">querySelector</span>(<span class="string">&#x27;#welcome-time&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">weatherElement</span> = messageContainer.<span class="title function_">querySelector</span>(<span class="string">&#x27;#welcome-weather&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">bindEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 点击切换消息</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageContainer</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">switchToNextMessage</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 鼠标悬停暂停自动切换</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageContainer</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseenter&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">pauseMessageRotation</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageContainer</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">resumeMessageRotation</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听主题切换</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;themeChange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateThemeStyles</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">startMessageRotation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateWelcomeMessage</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateTimeDisplay</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">auto_switch_interval</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">animationTimer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">switchToNextMessage</span>()</span><br><span class="line">      &#125;, <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">auto_switch_interval</span> * <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateWelcomeMessage</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">messages</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> message = <span class="variable language_">this</span>.<span class="title function_">getPersonalizedMessage</span>()</span><br><span class="line">    <span class="keyword">const</span> icon = <span class="variable language_">this</span>.<span class="title function_">getTimeBasedIcon</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">animateMessageChange</span>(message, icon)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getPersonalizedMessage</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> messages = <span class="variable language_">this</span>.<span class="title function_">getAvailableMessages</span>()</span><br><span class="line">    <span class="keyword">if</span> (messages.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span> <span class="string">&quot;欢迎来到我的博客！&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据访问历史选择个性化消息</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">enable_personalization</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> personalizedMessage = <span class="variable language_">this</span>.<span class="title function_">getPersonalizedMessageByHistory</span>()</span><br><span class="line">      <span class="keyword">if</span> (personalizedMessage) <span class="keyword">return</span> personalizedMessage</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 随机选择消息</span></span><br><span class="line">    <span class="keyword">const</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * messages.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">return</span> messages[randomIndex]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getAvailableMessages</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> allMessages = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 基础消息</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">basic</span>?.<span class="property">messages</span>) &#123;</span><br><span class="line">      allMessages.<span class="title function_">push</span>(...<span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">basic</span>.<span class="property">messages</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 时间相关消息</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">enable_time</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> timeMessages = <span class="variable language_">this</span>.<span class="title function_">getTimeBasedMessages</span>()</span><br><span class="line">      allMessages.<span class="title function_">push</span>(...timeMessages)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 节日消息</span></span><br><span class="line">    <span class="keyword">const</span> festivalMessages = <span class="variable language_">this</span>.<span class="title function_">getFestivalMessages</span>()</span><br><span class="line">    allMessages.<span class="title function_">push</span>(...festivalMessages)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> allMessages</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getTimeBasedMessages</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">    <span class="keyword">let</span> timePeriod = <span class="string">&#x27;morning&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (hour &gt;= <span class="number">6</span> &amp;&amp; hour &lt; <span class="number">12</span>) timePeriod = <span class="string">&#x27;morning&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (hour &gt;= <span class="number">12</span> &amp;&amp; hour &lt; <span class="number">18</span>) timePeriod = <span class="string">&#x27;afternoon&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (hour &gt;= <span class="number">18</span> &amp;&amp; hour &lt; <span class="number">22</span>) timePeriod = <span class="string">&#x27;evening&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> timePeriod = <span class="string">&#x27;night&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">time_based</span>?.[timePeriod]?.<span class="property">messages</span> || []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getFestivalMessages</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> today = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">const</span> month = today.<span class="title function_">getMonth</span>() + <span class="number">1</span></span><br><span class="line">    <span class="keyword">const</span> day = today.<span class="title function_">getDate</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 简单的节日检测</span></span><br><span class="line">    <span class="keyword">if</span> (month === <span class="number">1</span> &amp;&amp; day === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">festival</span>?.<span class="property">new_year</span>?.<span class="property">messages</span> || []</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (month === <span class="number">2</span> &amp;&amp; day === <span class="number">14</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">festival</span>?.<span class="property">valentine</span>?.<span class="property">messages</span> || []</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (month === <span class="number">12</span> &amp;&amp; day === <span class="number">25</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">festival</span>?.<span class="property">christmas</span>?.<span class="property">messages</span> || []</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getPersonalizedMessageByHistory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> visitCount = <span class="variable language_">this</span>.<span class="property">visitHistory</span>.<span class="property">visitCount</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (visitCount === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> messages = <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">personalized</span>?.<span class="property">first_visit</span>?.<span class="property">messages</span> || []</span><br><span class="line">      <span class="keyword">return</span> messages[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * messages.<span class="property">length</span>)]</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (visitCount &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> messages = <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">personalized</span>?.<span class="property">returning_visitor</span>?.<span class="property">messages</span> || []</span><br><span class="line">      <span class="keyword">return</span> messages[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * messages.<span class="property">length</span>)]</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> messages = <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="property">personalized</span>?.<span class="property">frequent_visitor</span>?.<span class="property">messages</span> || []</span><br><span class="line">      <span class="keyword">return</span> messages[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * messages.<span class="property">length</span>)]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getTimeBasedIcon</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (hour &gt;= <span class="number">6</span> &amp;&amp; hour &lt; <span class="number">12</span>) <span class="keyword">return</span> <span class="string">&#x27;🌅&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (hour &gt;= <span class="number">12</span> &amp;&amp; hour &lt; <span class="number">18</span>) <span class="keyword">return</span> <span class="string">&#x27;☀️&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (hour &gt;= <span class="number">18</span> &amp;&amp; hour &lt; <span class="number">22</span>) <span class="keyword">return</span> <span class="string">&#x27;🌆&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="string">&#x27;🌙&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">animateMessageChange</span>(<span class="params">message, icon</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> textElement = <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.welcome-text&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> iconElement = <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.welcome-icon&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加退出动画</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;hide&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 更新内容</span></span><br><span class="line">      textElement.<span class="property">textContent</span> = message</span><br><span class="line">      iconElement.<span class="property">textContent</span> = icon</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 添加进入动画</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;hide&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 添加随机动画效果</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">addRandomAnimation</span>()</span><br><span class="line">      </span><br><span class="line">    &#125;, <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">animation_duration</span> * <span class="number">1000</span> / <span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addRandomAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> animations = [<span class="string">&#x27;bounce&#x27;</span>, <span class="string">&#x27;rotate&#x27;</span>, <span class="string">&#x27;fade&#x27;</span>, <span class="string">&#x27;slide&#x27;</span>]</span><br><span class="line">    <span class="keyword">const</span> randomAnimation = animations[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * animations.<span class="property">length</span>)]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 移除之前的动画类</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;bounce&#x27;</span>, <span class="string">&#x27;rotate&#x27;</span>, <span class="string">&#x27;fade&#x27;</span>, <span class="string">&#x27;slide&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加新的动画类</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">messageElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(randomAnimation)</span><br><span class="line">    &#125;, <span class="number">100</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">switchToNextMessage</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateWelcomeMessage</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateVisitHistory</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateTimeDisplay</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">enable_time</span> || !<span class="variable language_">this</span>.<span class="property">timeElement</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">updateTime</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">      <span class="keyword">const</span> timeString = now.<span class="title function_">toLocaleTimeString</span>(<span class="string">&#x27;zh-CN&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">hour</span>: <span class="string">&#x27;2-digit&#x27;</span>,</span><br><span class="line">        <span class="attr">minute</span>: <span class="string">&#x27;2-digit&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">timeElement</span>.<span class="property">textContent</span> = <span class="string">`当前时间: <span class="subst">$&#123;timeString&#125;</span>`</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">updateTime</span>()</span><br><span class="line">    <span class="built_in">setInterval</span>(updateTime, <span class="number">60000</span>) <span class="comment">// 每分钟更新一次</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">loadWeatherData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 这里可以集成真实的天气API</span></span><br><span class="line">      <span class="comment">// 为了演示，我们使用模拟数据</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">weatherData</span> = &#123;</span><br><span class="line">        <span class="attr">temperature</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">15</span>) + <span class="number">15</span>,</span><br><span class="line">        <span class="attr">condition</span>: [<span class="string">&#x27;晴天&#x27;</span>, <span class="string">&#x27;多云&#x27;</span>, <span class="string">&#x27;小雨&#x27;</span>, <span class="string">&#x27;阴天&#x27;</span>][<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">4</span>)],</span><br><span class="line">        <span class="attr">icon</span>: [<span class="string">&#x27;☀️&#x27;</span>, <span class="string">&#x27;⛅&#x27;</span>, <span class="string">&#x27;🌧️&#x27;</span>, <span class="string">&#x27;☁️&#x27;</span>][<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">4</span>)]</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateWeatherDisplay</span>()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Welcome Personalizer: 天气数据加载失败&#x27;</span>, error)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateWeatherDisplay</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">weatherData</span> || !<span class="variable language_">this</span>.<span class="property">weatherElement</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">weatherElement</span>.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;span class=&quot;welcome-weather-icon&quot;&gt;<span class="subst">$&#123;<span class="variable language_">this</span>.weatherData.icon&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">      &lt;span&gt;<span class="subst">$&#123;<span class="variable language_">this</span>.weatherData.temperature&#125;</span>°C <span class="subst">$&#123;<span class="variable language_">this</span>.weatherData.condition&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">weatherElement</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;inline-flex&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getVisitHistory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> history = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;welcome_visit_history&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (history) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(history)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">visitCount</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">lastVisit</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">firstVisit</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateVisitHistory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">visitHistory</span>.<span class="property">visitCount</span>++</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">visitHistory</span>.<span class="property">lastVisit</span> = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;welcome_visit_history&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">visitHistory</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">pauseMessageRotation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">animationTimer</span>) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">animationTimer</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">animationTimer</span> = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">resumeMessageRotation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">auto_switch_interval</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">animationTimer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">switchToNextMessage</span>()</span><br><span class="line">      &#125;, <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">auto_switch_interval</span> * <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateThemeStyles</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 主题切换时更新样式</span></span><br><span class="line">    <span class="keyword">const</span> container = <span class="variable language_">this</span>.<span class="property">messageContainer</span></span><br><span class="line">    <span class="keyword">if</span> (container) &#123;</span><br><span class="line">      container.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;dark-theme&#x27;</span>, <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 销毁方法</span></span><br><span class="line">  <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">animationTimer</span>) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">animationTimer</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">animationTimer</span> = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">messageContainer</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">messageContainer</span>.<span class="property">parentNode</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">messageContainer</span>.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">messageContainer</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messages</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">config</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">weatherData</span> = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">welcomePersonalizer</span> = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initWelcomePersonalizer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">welcomePersonalizer</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">welcomePersonalizer</span> = <span class="keyword">new</span> <span class="title class_">WelcomePersonalizer</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面加载完成后初始化</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 延迟初始化，确保DOM完全加载</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">initWelcomePersonalizer</span>()</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听主题切换事件</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;themeChange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">welcomePersonalizer</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">welcomePersonalizer</span>.<span class="title function_">updateThemeStyles</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出类供其他脚本使用</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">module</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">exports</span>) &#123;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">WelcomePersonalizer</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第四步：配置主题启用个性化欢迎信息">第四步：配置主题启用个性化欢迎信息</h2><h3 id="⚙️-1-修改侧边栏配置文件">⚙️ 1. 修改侧边栏配置文件</h3><p><strong>文件路径</strong>：<code>source/_data/aside.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">welcome</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">来访者</span></span><br><span class="line">  <span class="attr">class:</span> <span class="string">card-welcome</span></span><br><span class="line">  <span class="attr">id:</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">fas</span> <span class="string">fa-location-dot</span></span><br><span class="line">  <span class="attr">content_id:</span> <span class="string">welcome-info</span></span><br><span class="line">  <span class="attr">content_css:</span> <span class="string">&#x27;height:160px;overflow:hidden&#x27;</span></span><br><span class="line">  <span class="attr">content_html:</span> <span class="string">&#x27;&lt;div class=&quot;welcome_swiper-container&quot; id=&quot;welcome-container&quot; style=&quot;width: 100%;height: 100%;margin-top: 6px&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div id=&quot;welcome_container_wrapper&quot; class=&quot;swiper-wrapper&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;&#x27;</span></span><br><span class="line">  <span class="comment"># 新增个性化配置</span></span><br><span class="line">  <span class="attr">personalization:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">animation_type:</span> <span class="string">random</span>  <span class="comment"># 可选值: random, fade, slide, bounce, rotate</span></span><br><span class="line">    <span class="attr">auto_switch:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">show_time:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">show_weather:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">max_messages:</span> <span class="number">5</span></span><br></pre></td></tr></table></figure><h3 id="🔧-2-修改主题配置文件">🔧 2. 修改主题配置文件</h3><p><strong>文件路径</strong>：<code>_config.solitude.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在配置文件中添加个性化欢迎信息配置</span></span><br><span class="line"><span class="attr">welcome_personalizer:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">config_file:</span> <span class="string">welcome-messages.yml</span></span><br><span class="line">  <span class="attr">animation_duration:</span> <span class="number">0.5</span></span><br><span class="line">  <span class="attr">auto_switch_interval:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">enable_weather:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">enable_time:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_personalization:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">max_messages:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">responsive:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="📦-3-引入样式和脚本文件">📦 3. 引入样式和脚本文件</h3><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/head.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//- 在head部分添加个性化欢迎信息样式</span><br><span class="line">if theme.welcome_personalizer &amp;&amp; theme.welcome_personalizer.enable</span><br><span class="line">  link(rel=&#x27;stylesheet&#x27;, href=url_for(&#x27;/css/custom/welcome-animations.css&#x27;))</span><br></pre></td></tr></table></figure><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/inject/body.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//- 在body部分添加个性化欢迎信息脚本</span><br><span class="line">if theme.welcome_personalizer &amp;&amp; theme.welcome_personalizer.enable</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/welcome-personalizer.js&#x27;))</span><br></pre></td></tr></table></figure><h2 id="第五步：实现个性化功能的关键技术">第五步：实现个性化功能的关键技术</h2><h3 id="🎯-1-动态内容生成">🎯 1. 动态内容生成</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：基于多种条件生成个性化内容</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WelcomePersonalizer</span> &#123;</span><br><span class="line">  <span class="title function_">getPersonalizedMessage</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 1. 访问历史个性化</span></span><br><span class="line">    <span class="keyword">const</span> historyMessage = <span class="variable language_">this</span>.<span class="title function_">getPersonalizedMessageByHistory</span>()</span><br><span class="line">    <span class="keyword">if</span> (historyMessage) <span class="keyword">return</span> historyMessage</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. 时间感知个性化</span></span><br><span class="line">    <span class="keyword">const</span> timeMessage = <span class="variable language_">this</span>.<span class="title function_">getTimeBasedMessage</span>()</span><br><span class="line">    <span class="keyword">if</span> (timeMessage) <span class="keyword">return</span> timeMessage</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. 节日感知个性化</span></span><br><span class="line">    <span class="keyword">const</span> festivalMessage = <span class="variable language_">this</span>.<span class="title function_">getFestivalMessage</span>()</span><br><span class="line">    <span class="keyword">if</span> (festivalMessage) <span class="keyword">return</span> festivalMessage</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4. 随机选择基础消息</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getRandomBasicMessage</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔒-2-本地存储管理">🔒 2. 本地存储管理</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：使用localStorage管理访问历史</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WelcomePersonalizer</span> &#123;</span><br><span class="line">  <span class="title function_">getVisitHistory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> history = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;welcome_visit_history&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> history ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(history) : <span class="variable language_">this</span>.<span class="title function_">createDefaultHistory</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">updateVisitHistory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">visitHistory</span>.<span class="property">visitCount</span>++</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">visitHistory</span>.<span class="property">lastVisit</span> = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;welcome_visit_history&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">visitHistory</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-3-动画效果系统">🎨 3. 动画效果系统</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：多种动画效果支持 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="built_in">var</span>(--welcome-animation-duration) <span class="built_in">var</span>(--welcome-animation-easing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 淡入淡出效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.fade</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: fadeInOut <span class="number">3s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 滑动效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.slide</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: slideInOut <span class="number">4s</span> ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 弹跳效果 */</span></span><br><span class="line"><span class="selector-class">.welcome-message</span><span class="selector-class">.bounce</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: bounceIn <span class="number">0.8s</span> ease-out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔄-4-响应式设计适配">🔄 4. 响应式设计适配</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关键设计：响应式布局适配 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.welcome-message</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">12px</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.welcome-icon</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 暗色模式适配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.welcome-message-container</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>), <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>));</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第六步：高级功能扩展">第六步：高级功能扩展</h2><h3 id="🎵-1-天气信息集成">🎵 1. 天气信息集成</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 集成真实天气API</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">loadWeatherData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 获取用户位置</span></span><br><span class="line">    <span class="keyword">const</span> position = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getCurrentPosition</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 调用天气API</span></span><br><span class="line">    <span class="keyword">const</span> weatherResponse = <span class="keyword">await</span> <span class="title function_">fetch</span>(</span><br><span class="line">      <span class="string">`https://api.openweathermap.org/data/2.5/weather?lat=<span class="subst">$&#123;position.lat&#125;</span>&amp;lon=<span class="subst">$&#123;position.lon&#125;</span>&amp;appid=<span class="subst">$&#123;API_KEY&#125;</span>&amp;units=metric&amp;lang=zh_cn`</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> weatherData = <span class="keyword">await</span> weatherResponse.<span class="title function_">json</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">weatherData</span> = &#123;</span><br><span class="line">      <span class="attr">temperature</span>: <span class="title class_">Math</span>.<span class="title function_">round</span>(weatherData.<span class="property">main</span>.<span class="property">temp</span>),</span><br><span class="line">      <span class="attr">condition</span>: weatherData.<span class="property">weather</span>[<span class="number">0</span>].<span class="property">description</span>,</span><br><span class="line">      <span class="attr">icon</span>: <span class="variable language_">this</span>.<span class="title function_">getWeatherIcon</span>(weatherData.<span class="property">weather</span>[<span class="number">0</span>].<span class="property">icon</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateWeatherDisplay</span>()</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;天气数据加载失败:&#x27;</span>, error)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-2-主题定制支持">🎨 2. 主题定制支持</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持多种欢迎信息主题</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WelcomePersonalizer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">theme = <span class="string">&#x27;default&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">theme</span> = theme</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">init</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">createWelcomeElement</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> themes = &#123;</span><br><span class="line">      <span class="attr">default</span>: <span class="variable language_">this</span>.<span class="title function_">createDefaultTheme</span>(),</span><br><span class="line">      <span class="attr">minimal</span>: <span class="variable language_">this</span>.<span class="title function_">createMinimalTheme</span>(),</span><br><span class="line">      <span class="attr">colorful</span>: <span class="variable language_">this</span>.<span class="title function_">createColorfulTheme</span>(),</span><br><span class="line">      <span class="attr">retro</span>: <span class="variable language_">this</span>.<span class="title function_">createRetroTheme</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> themes[<span class="variable language_">this</span>.<span class="property">theme</span>] || themes.<span class="property">default</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔧-3-配置化设计">🔧 3. 配置化设计</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持丰富的配置选项</span></span><br><span class="line"><span class="attr">welcome_personalizer:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">default</span>  <span class="comment"># 可选: default, minimal, colorful, retro</span></span><br><span class="line">  <span class="attr">animation_type:</span> <span class="string">random</span>  <span class="comment"># 可选: random, fade, slide, bounce, rotate</span></span><br><span class="line">  <span class="attr">auto_switch:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_switch_interval:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">enable_weather:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_time:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_personalization:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">max_messages:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">responsive:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">custom_messages:</span>  <span class="comment"># 自定义消息</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;这是我的自定义欢迎信息！&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;欢迎来到我的世界！&quot;</span></span><br></pre></td></tr></table></figure><h2 id="第七步：测试验证">第七步：测试验证</h2><h3 id="🧪-1-功能测试">🧪 1. 功能测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试步骤</span></span><br><span class="line">1. 启用个性化欢迎信息配置</span><br><span class="line">2. 重新生成网站: npm run build</span><br><span class="line">3. 测试欢迎信息显示</span><br><span class="line">4. 测试动画效果</span><br><span class="line">5. 测试响应式设计</span><br><span class="line">6. 测试暗色模式切换</span><br><span class="line">7. 测试个性化功能</span><br></pre></td></tr></table></figure><h3 id="🔍-2-兼容性测试">🔍 2. 兼容性测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试项目</span></span><br><span class="line">✅ 欢迎信息正常显示</span><br><span class="line">✅ 动画效果流畅</span><br><span class="line">✅ 个性化功能正常</span><br><span class="line">✅ 响应式设计正常</span><br><span class="line">✅ 暗色模式正常</span><br><span class="line">✅ 主题切换正常</span><br><span class="line">✅ 本地存储正常</span><br></pre></td></tr></table></figure><h3 id="🐛-3-问题排查">🐛 3. 问题排查</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常见问题排查</span></span><br><span class="line"><span class="number">1.</span> 检查配置文件是否正确加载</span><br><span class="line"><span class="number">2.</span> 检查<span class="variable constant_">DOM</span>元素是否正确创建</span><br><span class="line"><span class="number">3.</span> 检查<span class="variable constant_">CSS</span>样式是否正确加载</span><br><span class="line"><span class="number">4.</span> 检查<span class="title class_">JavaScript</span>是否正确执行</span><br><span class="line"><span class="number">5.</span> 检查<span class="variable language_">localStorage</span>是否可用</span><br><span class="line"><span class="number">6.</span> 检查动画效果是否流畅</span><br></pre></td></tr></table></figure><h2 id="总结与经验">总结与经验</h2><h3 id="🎯-关键设计要点">🎯 关键设计要点</h3><ol><li><strong>个性化内容生成</strong>：基于访问历史、时间、节日等多维度生成个性化内容</li><li><strong>动画效果系统</strong>：提供多种动画效果，增强用户体验</li><li><strong>响应式设计</strong>：适配不同屏幕尺寸和主题模式</li><li><strong>配置化管理</strong>：通过配置文件灵活控制功能开关</li><li><strong>本地存储</strong>：使用localStorage管理用户访问历史</li></ol><h3 id="🔧-技术实现要点">🔧 技术实现要点</h3><ol><li><strong>模块化设计</strong>：将功能拆分为独立的模块</li><li><strong>异步加载</strong>：支持异步加载配置和天气数据</li><li><strong>事件管理</strong>：正确绑定和清理事件监听器</li><li><strong>性能优化</strong>：合理使用定时器和动画</li><li><strong>错误处理</strong>：完善的错误处理和降级方案</li></ol><h3 id="🚀-扩展应用">🚀 扩展应用</h3><p>这个个性化欢迎信息系统的设计思路可以应用到其他场景：</p><ul><li><strong>个性化推荐系统</strong></li><li><strong>动态内容展示</strong></li><li><strong>用户行为分析</strong></li><li><strong>智能交互设计</strong></li></ul><h3 id="💡-最佳实践">💡 最佳实践</h3><ol><li><strong>内容策略</strong>：提供丰富多样的欢迎信息内容</li><li><strong>性能优化</strong>：合理控制动画频率和复杂度</li><li><strong>用户体验</strong>：确保动画效果不会影响阅读体验</li><li><strong>兼容性</strong>：确保在不同浏览器和设备上正常工作</li><li><strong>可维护性</strong>：保持代码结构清晰，便于后续维护</li></ol><hr><p>通过本次完整的个性化欢迎信息系统实现，我们不仅成功创建了丰富的用户体验，还学会了如何设计可扩展的个性化系统。这种设计思路可以帮助我们构建更加智能和人性化的网站交互！</p><p><strong>下期预告</strong>：我们将探索更多Solitude主题的高级魔改技巧，敬请期待！</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
            <tag> 来访者 </tag>
            
            <tag> 欢迎信息 </tag>
            
            <tag> 侧边栏 </tag>
            
            <tag> 个性化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(20) - mini-player双样式实现与shoka-player集成</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(20)-mini-player%E5%8F%8C%E6%A0%B7%E5%BC%8F%E5%AE%9E%E7%8E%B0%E4%B8%8Eshoka-player%E9%9B%86%E6%88%90/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(20)-mini-player%E5%8F%8C%E6%A0%B7%E5%BC%8F%E5%AE%9E%E7%8E%B0%E4%B8%8Eshoka-player%E9%9B%86%E6%88%90/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Solitude主题的音乐播放器魔改中，我们经常会遇到这样的需求：</p><ul><li>保留原有的mini-player功能</li><li>同时添加新的shoka-player样式</li><li>实现两种播放器的样式分离</li><li>确保不影响其他页面元素的显示</li></ul><p>本文将详细介绍如何实现mini-player的双样式系统，重点介绍shoka-player的集成方案和样式分离的设计思路。</p><h2 id="第一步：理解现有架构">第一步：理解现有架构</h2><h3 id="🔍-现有mini-player结构分析">🔍 现有mini-player结构分析</h3><p>在开始魔改之前，我们需要先了解Solitude主题现有的mini-player结构：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 现有文件结构</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── layout/</span><br><span class="line">│   └── includes/</span><br><span class="line">│       └── widgets/</span><br><span class="line">│           └── third-party/</span><br><span class="line">│               └── music.pug          <span class="comment"># 原生mini-player模板</span></span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── _components/</span><br><span class="line">│   │       └── capsule.styl           <span class="comment"># 原生mini-player样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       └── music.js                   <span class="comment"># 原生mini-player逻辑</span></span><br></pre></td></tr></table></figure><h3 id="📋-原生mini-player特点">📋 原生mini-player特点</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原生mini-player的主要特点</span></span><br><span class="line"><span class="number">1.</span> 基于<span class="title class_">APlayer</span>播放器</span><br><span class="line"><span class="number">2.</span> 固定在页面底部</span><br><span class="line"><span class="number">3.</span> 支持播放列表切换</span><br><span class="line"><span class="number">4.</span> 响应式设计</span><br><span class="line"><span class="number">5.</span> 与主题深度集成</span><br></pre></td></tr></table></figure><h2 id="第二步：设计双样式架构">第二步：设计双样式架构</h2><h3 id="🎯-设计目标">🎯 设计目标</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 双样式系统设计目标</span></span><br><span class="line"><span class="string">目标1:</span> <span class="string">保留原生mini-player功能</span></span><br><span class="line"><span class="string">目标2:</span> <span class="string">添加shoka-player新样式</span></span><br><span class="line"><span class="string">目标3:</span> <span class="string">实现样式完全分离</span></span><br><span class="line"><span class="string">目标4:</span> <span class="string">不影响其他页面元素</span></span><br><span class="line"><span class="string">目标5:</span> <span class="string">支持动态切换</span></span><br></pre></td></tr></table></figure><h3 id="🏗️-架构设计方案">🏗️ 架构设计方案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新的文件结构设计</span></span><br><span class="line">themes/solitude/</span><br><span class="line">├── layout/</span><br><span class="line">│   └── includes/</span><br><span class="line">│       └── widgets/</span><br><span class="line">│           └── third-party/</span><br><span class="line">│               ├── music.pug              <span class="comment"># 原生mini-player</span></span><br><span class="line">│               └── shoka-player.pug       <span class="comment"># shoka-player模板</span></span><br><span class="line">├── <span class="built_in">source</span>/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   │   └── _components/</span><br><span class="line">│   │       ├── capsule.styl               <span class="comment"># 原生样式</span></span><br><span class="line">│   │       └── shoka-player.styl          <span class="comment"># shoka-player样式</span></span><br><span class="line">│   └── js/</span><br><span class="line">│       ├── music.js                       <span class="comment"># 原生逻辑</span></span><br><span class="line">│       └── custom/</span><br><span class="line">│           └── shoka-player.js            <span class="comment"># shoka-player逻辑</span></span><br></pre></td></tr></table></figure><h2 id="第三步：创建shoka-player核心文件">第三步：创建shoka-player核心文件</h2><h3 id="📝-1-创建shoka-player模板">📝 1. 创建shoka-player模板</h3><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/widgets/third-party/shoka-player.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//- Shoka Player 独立音乐播放器模板</span><br><span class="line">//- 致敬 Shoka 主题的播放器设计</span><br><span class="line"></span><br><span class="line">if theme.shoka_player &amp;&amp; theme.shoka_player.enable</span><br><span class="line">  //- 中央播放按钮</span><br><span class="line">  #shoka-player-center-btn</span><br><span class="line">    i.fas.fa-play</span><br><span class="line">  </span><br><span class="line">  //- 中央歌曲信息弹窗</span><br><span class="line">  #shoka-player-popup</span><br><span class="line">    .song-info</span><br><span class="line">      .song-title 未播放</span><br><span class="line">      .song-artist 未知歌手</span><br><span class="line">  </span><br><span class="line">  //- 左侧底部播放控制栏</span><br><span class="line">  #shoka-player-sidebar</span><br><span class="line">    .control-group</span><br><span class="line">      button.control-btn.music-btn(title=&quot;音乐控制&quot;)</span><br><span class="line">        i.fas.fa-music</span><br><span class="line">      button.control-btn.play-pause-btn(title=&quot;播放/暂停&quot;)</span><br><span class="line">        i.fas.fa-play</span><br></pre></td></tr></table></figure><h3 id="🎨-2-创建shoka-player样式文件">🎨 2. 创建shoka-player样式文件</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/css/_components/shoka-player.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Shoka Player Styles</span></span><br><span class="line"><span class="comment">// 独立于 capsule 的 shoka-player 样式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量定义</span></span><br><span class="line">shoka-player-bg = <span class="selector-tag">var</span>(<span class="attr">--efu-card-bg</span>)</span><br><span class="line">shoka-player-<span class="attribute">border</span> = <span class="built_in">var</span>(--style-border-always)</span><br><span class="line">shoka-player-shadow = <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>)</span><br><span class="line">shoka-player-radius = <span class="number">12px</span></span><br><span class="line">shoka-player-<span class="attribute">transition</span> = all <span class="number">0.3s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.4</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动画定义</span></span><br><span class="line"><span class="keyword">@keyframes</span> disc-<span class="attribute">rotate</span></span><br><span class="line">  from</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>)</span><br><span class="line">  to</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 左侧中央播放按钮</span></span><br><span class="line"><span class="selector-id">#shoka-player-center-btn</span></span><br><span class="line">  <span class="attribute">position</span>: fixed</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span></span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>)</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">999</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">22px</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">22px</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.25</span>)</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>)</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>)</span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line">  <span class="attribute">align-items</span>: center</span><br><span class="line">  <span class="attribute">justify-content</span>: center</span><br><span class="line">  <span class="attribute">cursor</span>: pointer</span><br><span class="line">  <span class="attribute">transition</span>: shoka-player-transition</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">15px</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>)</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.15</span>)</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="selector-tag">i</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">11px</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span></span><br><span class="line">    <span class="attribute">transition</span>: shoka-player-transition</span><br><span class="line">  </span><br><span class="line">  &amp;<span class="selector-class">.playing</span> <span class="selector-tag">i</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-main)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中央歌曲信息弹窗</span></span><br><span class="line"><span class="selector-id">#shoka-player-popup</span></span><br><span class="line">  <span class="attribute">position</span>: fixed</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span></span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>) <span class="built_in">scale</span>(<span class="number">0.8</span>)</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1000</span></span><br><span class="line">  <span class="attribute">background</span>: shoka-player-bg</span><br><span class="line">  <span class="attribute">border</span>: shoka-player-border</span><br><span class="line">  <span class="attribute">border-radius</span>: shoka-player-radius</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">30px</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: shoka-player-shadow</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">15px</span>)</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">  <span class="attribute">visibility</span>: hidden</span><br><span class="line">  <span class="attribute">transition</span>: shoka-player-transition</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">300px</span></span><br><span class="line">  <span class="attribute">text-align</span>: center</span><br><span class="line">  </span><br><span class="line">  &amp;<span class="selector-class">.show</span></span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line">    <span class="attribute">visibility</span>: visible</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>) <span class="built_in">scale</span>(<span class="number">1</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.song-info</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span></span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-fontcolor)</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.4</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.song-title</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-main)</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">700</span></span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.song-artist</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--efu-fontcolor)</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">0.8</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">14px</span></span><br><span class="line">      <span class="attribute">margin-top</span>: <span class="number">4px</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 左侧底部播放控制栏</span></span><br><span class="line"><span class="selector-id">#shoka-player-sidebar</span></span><br><span class="line">  <span class="attribute">position</span>: fixed</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">50px</span></span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">998</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">32px</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>)</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">16px</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>)</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">15px</span>)</span><br><span class="line">  <span class="attribute">transition</span>: shoka-player-transition</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span></span><br><span class="line">  </span><br><span class="line">  &amp;<span class="selector-class">.show</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">15px</span></span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.control-group</span></span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">    <span class="attribute">flex-direction</span>: column</span><br><span class="line">    <span class="attribute">align-items</span>: center</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">6px</span></span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.control-btn</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">22px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">22px</span></span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span></span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>)</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>)</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>)</span><br><span class="line">      <span class="attribute">display</span>: flex</span><br><span class="line">      <span class="attribute">align-items</span>: center</span><br><span class="line">      <span class="attribute">justify-content</span>: center</span><br><span class="line">      <span class="attribute">cursor</span>: pointer</span><br><span class="line">      <span class="attribute">transition</span>: shoka-player-transition</span><br><span class="line">      <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">10px</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#007bff</span></span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">123</span>, <span class="number">255</span>, <span class="number">0.3</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="selector-tag">i</span></span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">11px</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#333</span></span><br><span class="line">        <span class="attribute">transition</span>: shoka-player-transition</span><br><span class="line">      </span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span> <span class="selector-tag">i</span></span><br><span class="line">        <span class="attribute">color</span>: white</span><br><span class="line"></span><br><span class="line"><span class="comment">// 音乐控制面板</span></span><br><span class="line"><span class="selector-id">#shoka-music-panel</span></span><br><span class="line">  <span class="attribute">position</span>: fixed</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">60px</span></span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">997</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">420px</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span>)</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>)</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">32px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>)</span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">20px</span>)</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">  <span class="attribute">visibility</span>: hidden</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>) <span class="built_in">scale</span>(<span class="number">0.95</span>)</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.4</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">overflow</span>: hidden</span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line">  <span class="attribute">flex-direction</span>: column</span><br><span class="line">  </span><br><span class="line">  &amp;<span class="selector-class">.show</span></span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line">    <span class="attribute">visibility</span>: visible</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>) <span class="built_in">scale</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应式设计</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>)</span><br><span class="line">  #shoka-player-center-btn</span><br><span class="line">    left: <span class="number">10px</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">18px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18px</span></span><br><span class="line">    </span><br><span class="line">    i</span><br><span class="line">      font-size: <span class="number">9px</span></span><br><span class="line">  </span><br><span class="line">  #shoka-player-sidebar</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">28px</span></span><br><span class="line">    left: -<span class="number">42px</span></span><br><span class="line">    </span><br><span class="line">    &amp;.show</span><br><span class="line">      left: <span class="number">5px</span></span><br><span class="line">    </span><br><span class="line">    .control-btn</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">18px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">18px</span></span><br><span class="line">      </span><br><span class="line">      i</span><br><span class="line">        font-size: <span class="number">9px</span></span><br><span class="line">  </span><br><span class="line">  #shoka-music-panel</span><br><span class="line">    left: <span class="number">35px</span> !important</span><br><span class="line">    bottom: <span class="number">15px</span> !important</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">320px</span> !important</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">380px</span> !important</span><br><span class="line"></span><br><span class="line">// 暗色模式适配</span><br><span class="line">[data-theme=&quot;dark&quot;]</span><br><span class="line">  #shoka-player-popup,</span><br><span class="line">  #shoka-player-sidebar</span><br><span class="line">    background: rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>)</span><br><span class="line">    border: <span class="number">1px</span> solid rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">    backdrop-filter: blur(<span class="number">15px</span>)</span><br><span class="line">  </span><br><span class="line">  #shoka-music-panel</span><br><span class="line">    background: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8</span>)</span><br><span class="line">    border: <span class="number">1px</span> solid rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">    backdrop-filter: blur(<span class="number">20px</span>)</span><br></pre></td></tr></table></figure><h3 id="⚙️-3-创建shoka-player逻辑文件">⚙️ 3. 创建shoka-player逻辑文件</h3><p><strong>文件路径</strong>：<code>themes/solitude/source/js/custom/shoka-player.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Shoka Player - 独立音乐播放器</span></span><br><span class="line"><span class="comment"> * 致敬 Shoka 主题的播放器设计</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShokaPlayer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentSong</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popupTimer</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastScrollTop</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isScrolled</span> = <span class="literal">false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span> = <span class="literal">null</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 播放控制相关属性</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">playHistory</span> = [] <span class="comment">// 播放历史记录，用于上一首按钮</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maxHistorySize</span> = <span class="number">50</span> <span class="comment">// 最大历史记录数量</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentLoopMode</span> = <span class="number">0</span> <span class="comment">// 当前循环模式：0=随机播放，1=列表循环</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">init</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">createElements</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">bindEvents</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">waitForAplayer</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">createElements</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 创建左侧中央播放按钮</span></span><br><span class="line">    <span class="keyword">const</span> centerBtn = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    centerBtn.<span class="property">id</span> = <span class="string">&#x27;shoka-player-center-btn&#x27;</span></span><br><span class="line">    centerBtn.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;i class=&quot;fas fa-play&quot;&gt;&lt;/i&gt;&#x27;</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(centerBtn)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建中央歌曲信息弹窗</span></span><br><span class="line">    <span class="keyword">const</span> popup = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    popup.<span class="property">id</span> = <span class="string">&#x27;shoka-player-popup&#x27;</span></span><br><span class="line">    popup.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;song-info&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;song-title&quot;&gt;未播放&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;song-artist&quot;&gt;未知歌手&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(popup)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建左侧底部播放控制栏</span></span><br><span class="line">    <span class="keyword">const</span> sidebar = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    sidebar.<span class="property">id</span> = <span class="string">&#x27;shoka-player-sidebar&#x27;</span></span><br><span class="line">    sidebar.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;control-group&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;button class=&quot;control-btn music-btn&quot; title=&quot;音乐控制&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;i class=&quot;fas fa-music&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">        &lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;button class=&quot;control-btn play-pause-btn&quot; title=&quot;播放/暂停&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;i class=&quot;fas fa-play&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">        &lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(sidebar)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存引用</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">centerBtn</span> = centerBtn</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span> = popup</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sidebar</span> = sidebar</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">waitForAplayer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 等待 APlayer 初始化完成</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">checkAplayer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> metingElement = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;meting-js&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (metingElement &amp;&amp; metingElement.<span class="property">aplayer</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">aplayer</span> = metingElement.<span class="property">aplayer</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setupAplayerEvents</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">updateDisplay</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Shoka Player: APlayer 初始化完成&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(checkAplayer, <span class="number">100</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">checkAplayer</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setupAplayerEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">aplayer</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听播放状态变化</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="title function_">on</span>(<span class="string">&#x27;play&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">true</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateDisplay</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateSongInfo</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showPopup</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="title function_">on</span>(<span class="string">&#x27;pause&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">false</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateDisplay</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="title function_">on</span>(<span class="string">&#x27;ended&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">false</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateDisplay</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">handlePlayEnd</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听歌曲切换</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="title function_">on</span>(<span class="string">&#x27;listswitch&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">addToPlayHistory</span>(<span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">index</span>)</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">updateSongInfo</span>()</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isPlaying</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">showPopup</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="number">100</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取初始播放状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isPlaying</span> = !<span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">audio</span>.<span class="property">paused</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateDisplay</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 禁用APlayer的自动循环，完全由我们控制</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">loop</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 初始化循环模式UI</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateLoopModeUI</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">bindEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 绑定滚动事件处理函数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleScroll</span> = <span class="variable language_">this</span>.<span class="property">handleScroll</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 中央播放按钮点击事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">togglePlay</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 侧边栏播放按钮点击事件</span></span><br><span class="line">    <span class="keyword">const</span> playPauseBtn = <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.play-pause-btn&#x27;</span>)</span><br><span class="line">    playPauseBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">togglePlay</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 侧边栏音乐按钮点击事件</span></span><br><span class="line">    <span class="keyword">const</span> musicBtn = <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.music-btn&#x27;</span>)</span><br><span class="line">    musicBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      e.<span class="title function_">stopPropagation</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">toggleMusicControl</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 滚动事件监听</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleScroll</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击弹窗外部关闭弹窗</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (e.<span class="property">target</span> === <span class="variable language_">this</span>.<span class="property">popup</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">hidePopup</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> scrollTop = <span class="variable language_">window</span>.<span class="property">pageYOffset</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span></span><br><span class="line">    <span class="keyword">const</span> isAtTop = scrollTop &lt;= <span class="number">50</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查中央播放按钮是否可见</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">checkMiniPlayerVisibility</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 确保音乐按钮状态与mini-player状态同步</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">syncMusicButtonState</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (scrollTop &gt; <span class="variable language_">this</span>.<span class="property">lastScrollTop</span> &amp;&amp; scrollTop &gt; <span class="number">100</span>) &#123;</span><br><span class="line">      <span class="comment">// 向下滚动且不在顶部</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isScrolled</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isScrolled</span> = <span class="literal">true</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isAtTop) &#123;</span><br><span class="line">      <span class="comment">// 回到顶部</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isScrolled</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isScrolled</span> = <span class="literal">false</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;flex&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastScrollTop</span> = scrollTop</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">togglePlay</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">aplayer</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isPlaying</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="title function_">pause</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="title function_">play</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toggleMusicControl</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">toggleMusicPanel</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toggleMusicPanel</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> musicPanel = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;shoka-music-panel&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!musicPanel) &#123;</span><br><span class="line">      <span class="comment">// 创建音乐控制面板</span></span><br><span class="line">      musicPanel = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">      musicPanel.<span class="property">id</span> = <span class="string">&#x27;shoka-music-panel&#x27;</span></span><br><span class="line">      musicPanel.<span class="property">innerHTML</span> = <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;music-panel-container&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;!-- 控制模块 --&gt;</span></span><br><span class="line"><span class="string">          &lt;div class=&quot;shoka-player-control&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;top-section&quot;&gt;</span></span><br><span class="line"><span class="string">              &lt;div class=&quot;vinyl-disc-area&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;vinyl-disc&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;div class=&quot;disc-inner&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;album-art&quot;&gt;</span></span><br><span class="line"><span class="string">                      &lt;img src=&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjBGM0Y2Ii8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iNjAiIGZpbGw9IiM5Q0EzQUYiLz4KPGNpcmNsZSBjeD0iMTAwIiBjeT0iMTAwIiByPSI0MCIgZmlsbD0iI0YwRjNGNiIvPgo8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjE1IiBmaWxsPSIjOUNBM0FGIi8+CjxwYXRoIGQ9Ik04MCAxMDBMMTIwIDEwMEwxMDAgODBWMTIwWiIgZmlsbD0iI0YwRjNGNiIvPgo8L3N2Zz4K&quot; alt=&quot;专辑封面&quot; class=&quot;album-img&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                  &lt;/div&gt;</span></span><br><span class="line"><span class="string">                  &lt;div class=&quot;needle&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">              &lt;/div&gt;</span></span><br><span class="line"><span class="string">              </span></span><br><span class="line"><span class="string">              &lt;div class=&quot;song-info-area&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;song-title&quot;&gt;未播放&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;song-artist&quot;&gt;未知歌手&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;lyrics-container&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;div class=&quot;lyric-line prev-lyric&quot;&gt;上一句歌词&lt;/div&gt;</span></span><br><span class="line"><span class="string">                  &lt;div class=&quot;lyric-line current-lyric&quot;&gt;当前播放歌词&lt;/div&gt;</span></span><br><span class="line"><span class="string">                  &lt;div class=&quot;lyric-line next-lyric&quot;&gt;下一句歌词&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">              &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            &lt;div class=&quot;control-area&quot;&gt;</span></span><br><span class="line"><span class="string">              &lt;div class=&quot;playback-controls&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;button class=&quot;control-btn shuffle-btn&quot; title=&quot;随机播放&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;i class=&quot;fas fa-random&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">                &lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;button class=&quot;control-btn prev-btn&quot; title=&quot;上一首&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;i class=&quot;fas fa-step-backward&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">                &lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;button class=&quot;control-btn play-pause-btn&quot; title=&quot;播放/暂停&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;i class=&quot;fas fa-play&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">                &lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;button class=&quot;control-btn next-btn&quot; title=&quot;下一首&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;i class=&quot;fas fa-step-forward&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">                &lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;volume-group&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;button class=&quot;control-btn volume-btn&quot; title=&quot;音量&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;i class=&quot;fas fa-volume-up&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">                  &lt;/button&gt;</span></span><br><span class="line"><span class="string">                  &lt;div class=&quot;volume-slider-container&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;input type=&quot;range&quot; class=&quot;volume-slider&quot; min=&quot;0&quot; max=&quot;100&quot; value=&quot;70&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">              &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt;</span></span><br><span class="line"><span class="string">          </span></span><br><span class="line"><span class="string">          &lt;!-- 歌曲列表模块 --&gt;</span></span><br><span class="line"><span class="string">          &lt;div class=&quot;shoka-playList-control&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;playlist-container&quot;&gt;</span></span><br><span class="line"><span class="string">              &lt;div class=&quot;playlist-scroll&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;playlist-items&quot;&gt;</span></span><br><span class="line"><span class="string">                  &lt;!-- 歌曲列表将通过 JavaScript 动态生成 --&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">              &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt;</span></span><br><span class="line"><span class="string">          </span></span><br><span class="line"><span class="string">          &lt;!-- 定位按钮 --&gt;</span></span><br><span class="line"><span class="string">          &lt;button class=&quot;locate-btn&quot; title=&quot;定位到当前播放歌曲&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;i class=&quot;fas fa-crosshairs&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">          &lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        &lt;!-- 关闭按钮 --&gt;</span></span><br><span class="line"><span class="string">        &lt;button class=&quot;close-btn&quot; title=&quot;关闭&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;i class=&quot;fas fa-times&quot;&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">        &lt;/button&gt;</span></span><br><span class="line"><span class="string">      `</span></span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(musicPanel)</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 绑定面板事件</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">bindMusicPanelEvents</span>(musicPanel)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 切换面板显示状态</span></span><br><span class="line">    <span class="keyword">if</span> (musicPanel.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;show&#x27;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">hideMusicPanel</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showMusicPanel</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">showMusicPanel</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> musicPanel = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;shoka-music-panel&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (musicPanel) &#123;</span><br><span class="line">      musicPanel.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateMusicPanelContent</span>()</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 激活音乐按钮</span></span><br><span class="line">      <span class="keyword">const</span> musicBtn = <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.music-btn&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (musicBtn) &#123;</span><br><span class="line">        musicBtn.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">hideMusicPanel</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> musicPanel = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;shoka-music-panel&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (musicPanel) &#123;</span><br><span class="line">      musicPanel.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 取消激活音乐按钮</span></span><br><span class="line">      <span class="keyword">const</span> musicBtn = <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.music-btn&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (musicBtn) &#123;</span><br><span class="line">        musicBtn.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateDisplay</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 更新播放按钮状态</span></span><br><span class="line">    <span class="keyword">const</span> centerIcon = <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> sidebarIcon = <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.play-pause-btn i&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isPlaying</span>) &#123;</span><br><span class="line">      centerIcon.<span class="property">className</span> = <span class="string">&#x27;fas fa-pause&#x27;</span></span><br><span class="line">      sidebarIcon.<span class="property">className</span> = <span class="string">&#x27;fas fa-pause&#x27;</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.play-pause-btn&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      centerIcon.<span class="property">className</span> = <span class="string">&#x27;fas fa-play&#x27;</span></span><br><span class="line">      sidebarIcon.<span class="property">className</span> = <span class="string">&#x27;fas fa-play&#x27;</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.play-pause-btn&#x27;</span>).<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新音乐面板中的播放按钮状态</span></span><br><span class="line">    <span class="keyword">const</span> musicPanel = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;shoka-music-panel&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (musicPanel) &#123;</span><br><span class="line">      <span class="keyword">const</span> musicPanelPlayBtn = musicPanel.<span class="title function_">querySelector</span>(<span class="string">&#x27;.play-pause-btn&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> musicPanelIcon = musicPanelPlayBtn?.<span class="title function_">querySelector</span>(<span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (musicPanelPlayBtn &amp;&amp; musicPanelIcon) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isPlaying</span>) &#123;</span><br><span class="line">          musicPanelIcon.<span class="property">className</span> = <span class="string">&#x27;fas fa-pause&#x27;</span></span><br><span class="line">          musicPanelPlayBtn.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          musicPanelIcon.<span class="property">className</span> = <span class="string">&#x27;fas fa-play&#x27;</span></span><br><span class="line">          musicPanelPlayBtn.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新音乐面板内容</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateMusicPanelContent</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateSongInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">aplayer</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> currentSong = <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">audios</span>[<span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">index</span>]</span><br><span class="line">    <span class="keyword">if</span> (currentSong) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">currentSong</span> = &#123;</span><br><span class="line">        <span class="attr">title</span>: currentSong.<span class="property">name</span>,</span><br><span class="line">        <span class="attr">artist</span>: currentSong.<span class="property">artist</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新音乐面板内容</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateMusicPanelContent</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">showPopup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 清除之前的定时器</span></span><br><span class="line">    <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">popupTimer</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新弹窗内容</span></span><br><span class="line">    <span class="keyword">const</span> songTitle = <span class="variable language_">this</span>.<span class="property">currentSong</span> ? <span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">title</span> : <span class="string">&#x27;未播放&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> songArtist = <span class="variable language_">this</span>.<span class="property">currentSong</span> ? <span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">artist</span> : <span class="string">&#x27;未知歌手&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.song-title&#x27;</span>).<span class="property">textContent</span> = songTitle</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.song-artist&#x27;</span>).<span class="property">textContent</span> = songArtist</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 显示弹窗</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 5秒后自动隐藏</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popupTimer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">hidePopup</span>()</span><br><span class="line">    &#125;, <span class="number">5000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">hidePopup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">    <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">popupTimer</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 其他方法...</span></span><br><span class="line">  <span class="title function_">addToPlayHistory</span>(<span class="params">songIndex</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">playHistory</span>.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">playHistory</span>[<span class="variable language_">this</span>.<span class="property">playHistory</span>.<span class="property">length</span> - <span class="number">1</span>] === songIndex) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">playHistory</span>.<span class="title function_">push</span>(songIndex)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">playHistory</span>.<span class="property">length</span> &gt; <span class="variable language_">this</span>.<span class="property">maxHistorySize</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">playHistory</span>.<span class="title function_">shift</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handlePlayEnd</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">playNextSong</span>()</span><br><span class="line">    &#125;, <span class="number">100</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">playNextSong</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">aplayer</span>) <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> nextIndex = <span class="variable language_">this</span>.<span class="title function_">getNextSongIndex</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="title function_">switch</span>(nextIndex)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getNextSongIndex</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">aplayer</span> || !<span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">audios</span>.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> currentIndex = <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">index</span></span><br><span class="line">    <span class="keyword">const</span> totalSongs = <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">list</span>.<span class="property">audios</span>.<span class="property">length</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">currentLoopMode</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 随机播放</span></span><br><span class="line">        <span class="keyword">let</span> randomIndex</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">          randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * totalSongs)</span><br><span class="line">        &#125; <span class="keyword">while</span> (randomIndex === currentIndex &amp;&amp; totalSongs &gt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> randomIndex</span><br><span class="line">        </span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 列表循环</span></span><br><span class="line">        <span class="keyword">return</span> (currentIndex + <span class="number">1</span>) % totalSongs</span><br><span class="line">        </span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="keyword">return</span> (currentIndex + <span class="number">1</span>) % totalSongs</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateLoopModeUI</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> musicPanel = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;shoka-music-panel&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!musicPanel) <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> shuffleBtn = musicPanel.<span class="title function_">querySelector</span>(<span class="string">&#x27;.shuffle-btn&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!shuffleBtn) <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> icon = shuffleBtn.<span class="title function_">querySelector</span>(<span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">currentLoopMode</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 随机播放</span></span><br><span class="line">        icon.<span class="property">className</span> = <span class="string">&#x27;fas fa-random&#x27;</span></span><br><span class="line">        shuffleBtn.<span class="property">title</span> = <span class="string">&#x27;随机播放&#x27;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 列表循环</span></span><br><span class="line">        icon.<span class="property">className</span> = <span class="string">&#x27;fas fa-list-ul&#x27;</span></span><br><span class="line">        shuffleBtn.<span class="property">title</span> = <span class="string">&#x27;列表循环&#x27;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 销毁方法</span></span><br><span class="line">  <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">stopLyricsSyncTimer</span>()</span><br><span class="line">    <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">popupTimer</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">handleScroll</span>) &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleScroll</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">handleGlobalClick</span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleGlobalClick</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">centerBtn</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="property">parentNode</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">centerBtn</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">popup</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="property">parentNode</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">popup</span>.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">popup</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sidebar</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="property">parentNode</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sidebar</span>.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">sidebar</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> musicPanel = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;shoka-music-panel&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (musicPanel &amp;&amp; musicPanel.<span class="property">parentNode</span>) &#123;</span><br><span class="line">      musicPanel.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(musicPanel)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentSong</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popupTimer</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastScrollTop</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isScrolled</span> = <span class="literal">false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">aplayer</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">centerBtn</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">popup</span> = <span class="literal">null</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sidebar</span> = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">shokaPlayer</span> = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initShokaPlayer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">shokaPlayer</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">shokaPlayer</span> = <span class="keyword">new</span> <span class="title class_">ShokaPlayer</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面加载完成后初始化</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 延迟初始化，确保 meting-js 已加载</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">initShokaPlayer</span>()</span><br><span class="line">  &#125;, <span class="number">1500</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听主题切换事件</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;themeChange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 主题切换时重新初始化</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">shokaPlayer</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">shokaPlayer</span>.<span class="title function_">destroy</span>()</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">shokaPlayer</span> = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">initShokaPlayer</span>()</span><br><span class="line">  &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出类供其他脚本使用</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">module</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">exports</span>) &#123;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">ShokaPlayer</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第四步：配置主题启用shoka-player">第四步：配置主题启用shoka-player</h2><h3 id="⚙️-1-修改主题配置文件">⚙️ 1. 修改主题配置文件</h3><p><strong>文件路径</strong>：<code>_config.solitude.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在配置文件中添加shoka-player配置</span></span><br><span class="line"><span class="attr">shoka_player:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">shoka-player</span>  <span class="comment"># 可选值: capsule, shoka-player</span></span><br><span class="line">  <span class="attr">auto_switch:</span> <span class="literal">true</span>    <span class="comment"># 是否自动切换样式</span></span><br></pre></td></tr></table></figure><h3 id="🔧-2-修改音乐播放器模板">🔧 2. 修改音乐播放器模板</h3><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/widgets/third-party/music.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//- 音乐播放器模板</span><br><span class="line">if theme.music &amp;&amp; theme.music.enable</span><br><span class="line">  //- 根据配置选择播放器样式</span><br><span class="line">  if theme.shoka_player &amp;&amp; theme.shoka_player.enable &amp;&amp; theme.shoka_player.style == &#x27;shoka-player&#x27;</span><br><span class="line">    include shoka-player.pug</span><br><span class="line">  else</span><br><span class="line">    //- 原有的capsule样式</span><br><span class="line">    include capsule.pug</span><br></pre></td></tr></table></figure><h3 id="📦-3-引入样式和脚本文件">📦 3. 引入样式和脚本文件</h3><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/head.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//- 在head部分添加shoka-player样式</span><br><span class="line">if theme.shoka_player &amp;&amp; theme.shoka_player.enable</span><br><span class="line">  link(rel=&#x27;stylesheet&#x27;, href=url_for(&#x27;/css/_components/shoka-player.css&#x27;))</span><br></pre></td></tr></table></figure><p><strong>文件路径</strong>：<code>themes/solitude/layout/includes/inject/body.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//- 在body部分添加shoka-player脚本</span><br><span class="line">if theme.shoka_player &amp;&amp; theme.shoka_player.enable</span><br><span class="line">  script(src=url_for(&#x27;/js/custom/shoka-player.js&#x27;))</span><br></pre></td></tr></table></figure><h2 id="第五步：实现样式分离的关键技术">第五步：实现样式分离的关键技术</h2><h3 id="🎯-1-CSS命名空间隔离">🎯 1. CSS命名空间隔离</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：使用独立的CSS命名空间</span></span><br><span class="line"><span class="comment">// 避免与原生mini-player样式冲突</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原生mini-player使用 #music-page 命名空间</span></span><br><span class="line"><span class="selector-id">#music-page</span></span><br><span class="line">  <span class="comment">// 原生样式...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// shoka-player使用独立的命名空间</span></span><br><span class="line"><span class="selector-id">#shoka-player-center-btn</span>,</span><br><span class="line"><span class="selector-id">#shoka-player-popup</span>,</span><br><span class="line"><span class="selector-id">#shoka-player-sidebar</span>,</span><br><span class="line"><span class="selector-id">#shoka-music-panel</span></span><br><span class="line">  <span class="comment">// shoka-player样式...</span></span><br></pre></td></tr></table></figure><h3 id="🔒-2-JavaScript作用域隔离">🔒 2. JavaScript作用域隔离</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：使用独立的JavaScript类</span></span><br><span class="line"><span class="comment">// 避免与原生mini-player逻辑冲突</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原生mini-player使用全局函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initMusicPlayer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 原生逻辑...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// shoka-player使用类封装</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShokaPlayer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 独立的实例变量</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">false</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentSong</span> = <span class="literal">null</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 独立的方法</span></span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="title function_">destroy</span>(<span class="params"></span>) &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量使用不同名称</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">shokaPlayer</span> = <span class="literal">null</span>  <span class="comment">// 而不是 window.musicPlayer</span></span><br></pre></td></tr></table></figure><h3 id="🎨-3-DOM元素ID隔离">🎨 3. DOM元素ID隔离</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：使用不同的DOM元素ID</span></span><br><span class="line"><span class="comment">// 避免与原生mini-player元素冲突</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原生mini-player元素ID</span></span><br><span class="line"><span class="comment">// #music-page</span></span><br><span class="line"><span class="comment">// #music-page .aplayer</span></span><br><span class="line"><span class="comment">// #music-page .aplayer-list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// shoka-player元素ID</span></span><br><span class="line"><span class="comment">// #shoka-player-center-btn</span></span><br><span class="line"><span class="comment">// #shoka-player-popup  </span></span><br><span class="line"><span class="comment">// #shoka-player-sidebar</span></span><br><span class="line"><span class="comment">// #shoka-music-panel</span></span><br></pre></td></tr></table></figure><h3 id="🔄-4-事件监听器隔离">🔄 4. 事件监听器隔离</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键设计：使用独立的事件监听器</span></span><br><span class="line"><span class="comment">// 避免与原生mini-player事件冲突</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShokaPlayer</span> &#123;</span><br><span class="line">  <span class="title function_">bindEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 使用实例方法绑定事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleScroll</span> = <span class="variable language_">this</span>.<span class="property">handleScroll</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用独立的元素选择器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">centerBtn</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">togglePlay</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清理时移除所有事件监听器</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleScroll</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 完全清理所有事件监听器</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">handleScroll</span>) &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleScroll</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第六步：响应式设计适配">第六步：响应式设计适配</h2><h3 id="📱-1-移动端适配">📱 1. 移动端适配</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 手机设备 (480px 及以下)</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">480px</span>)</span><br><span class="line">  #shoka-player-center-btn</span><br><span class="line">    left: <span class="number">10px</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">18px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18px</span></span><br><span class="line">    </span><br><span class="line">    i</span><br><span class="line">      font-size: <span class="number">9px</span></span><br><span class="line">  </span><br><span class="line">  #shoka-player-sidebar</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">28px</span></span><br><span class="line">    left: -<span class="number">42px</span></span><br><span class="line">    </span><br><span class="line">    &amp;.show</span><br><span class="line">      left: <span class="number">5px</span></span><br><span class="line">    </span><br><span class="line">    .control-btn</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">18px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">18px</span></span><br><span class="line">      </span><br><span class="line">      i</span><br><span class="line">        font-size: <span class="number">9px</span></span><br><span class="line">  </span><br><span class="line">  #shoka-music-panel</span><br><span class="line">    left: <span class="number">35px</span> !important</span><br><span class="line">    bottom: <span class="number">15px</span> !important</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">320px</span> !important</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">380px</span> !important</span><br></pre></td></tr></table></figure><h3 id="💻-2-平板设备适配">💻 2. 平板设备适配</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 平板设备 (768px - 1024px)</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">769px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1024px</span>)</span><br><span class="line">  #shoka-player-center-btn</span><br><span class="line">    left: <span class="number">15px</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">20px</span></span><br><span class="line">    </span><br><span class="line">    i</span><br><span class="line">      font-size: <span class="number">10px</span></span><br><span class="line">  </span><br><span class="line">  #shoka-player-sidebar</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">30px</span></span><br><span class="line">    left: -<span class="number">45px</span></span><br><span class="line">    </span><br><span class="line">    &amp;.show</span><br><span class="line">      left: <span class="number">10px</span></span><br><span class="line">    </span><br><span class="line">    .control-btn</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">20px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">20px</span></span><br><span class="line">      </span><br><span class="line">      i</span><br><span class="line">        font-size: <span class="number">10px</span></span><br><span class="line">  </span><br><span class="line">  #shoka-music-panel</span><br><span class="line">    left: <span class="number">60px</span></span><br><span class="line">    bottom: <span class="number">18px</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">380px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span></span><br></pre></td></tr></table></figure><h2 id="第七步：暗色模式适配">第七步：暗色模式适配</h2><h3 id="🌙-1-暗色模式样式">🌙 1. 暗色模式样式</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 暗色模式适配</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-id">#shoka-player-popup</span>,</span><br><span class="line">  <span class="selector-id">#shoka-player-sidebar</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>)</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">    <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">15px</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.control-btn</span></span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>)</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#ffc107</span></span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">193</span>, <span class="number">7</span>, <span class="number">0.3</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="selector-tag">i</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#333</span></span><br><span class="line">        </span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span> <span class="selector-tag">i</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#333</span></span><br><span class="line">  </span><br><span class="line">  <span class="selector-id">#shoka-music-panel</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8</span>)</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">    <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">20px</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.song-title</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.song-artist</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.7</span>)</span><br></pre></td></tr></table></figure><h2 id="第八步：测试验证">第八步：测试验证</h2><h3 id="🧪-1-功能测试">🧪 1. 功能测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试步骤</span></span><br><span class="line">1. 启用shoka-player配置</span><br><span class="line">2. 重新生成网站: npm run build</span><br><span class="line">3. 测试播放器基本功能</span><br><span class="line">4. 测试响应式设计</span><br><span class="line">5. 测试暗色模式切换</span><br><span class="line">6. 测试与原生mini-player的兼容性</span><br></pre></td></tr></table></figure><h3 id="🔍-2-兼容性测试">🔍 2. 兼容性测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试项目</span></span><br><span class="line">✅ 原生mini-player功能正常</span><br><span class="line">✅ shoka-player功能正常</span><br><span class="line">✅ 两种播放器可以独立工作</span><br><span class="line">✅ 样式不会相互影响</span><br><span class="line">✅ 响应式设计正常</span><br><span class="line">✅ 暗色模式正常</span><br><span class="line">✅ 主题切换正常</span><br></pre></td></tr></table></figure><h3 id="🐛-3-问题排查">🐛 3. 问题排查</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常见问题排查</span></span><br><span class="line"><span class="number">1.</span> 检查控制台是否有错误</span><br><span class="line"><span class="number">2.</span> 检查<span class="variable constant_">DOM</span>元素是否正确创建</span><br><span class="line"><span class="number">3.</span> 检查<span class="variable constant_">CSS</span>样式是否正确加载</span><br><span class="line"><span class="number">4.</span> 检查<span class="title class_">JavaScript</span>是否正确执行</span><br><span class="line"><span class="number">5.</span> 检查事件监听器是否正确绑定</span><br></pre></td></tr></table></figure><h2 id="第九步：高级功能扩展">第九步：高级功能扩展</h2><h3 id="🎵-1-歌词同步功能">🎵 1. 歌词同步功能</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在ShokaPlayer类中添加歌词同步功能</span></span><br><span class="line"><span class="title function_">updateLyrics</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">aplayer</span>) <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 获取当前播放时间</span></span><br><span class="line">  <span class="keyword">const</span> currentTime = <span class="variable language_">this</span>.<span class="property">aplayer</span>.<span class="property">audio</span>.<span class="property">currentTime</span> || <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 查找APlayer的歌词容器</span></span><br><span class="line">  <span class="keyword">const</span> aplayerLrcContents = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.aplayer-lrc-contents&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (!aplayerLrcContents) <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 获取所有歌词行</span></span><br><span class="line">  <span class="keyword">const</span> lrcLines = aplayerLrcContents.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (lrcLines.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 找到当前应该显示的歌词行</span></span><br><span class="line">  <span class="keyword">let</span> currentIndex = -<span class="number">1</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 优先使用APlayer内置的歌词同步逻辑</span></span><br><span class="line">  <span class="keyword">const</span> currentHighlightedLine = aplayerLrcContents.<span class="title function_">querySelector</span>(<span class="string">&#x27;p.aplayer-lrc-current&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (currentHighlightedLine) &#123;</span><br><span class="line">    currentIndex = <span class="title class_">Array</span>.<span class="title function_">from</span>(lrcLines).<span class="title function_">indexOf</span>(currentHighlightedLine)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 更新shoka-player面板中的歌词显示</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">updateMusicPanelLyrics</span>(lrcLines, currentIndex)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🎨-2-自定义主题支持">🎨 2. 自定义主题支持</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持多种播放器主题</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShokaPlayer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">theme = <span class="string">&#x27;default&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">theme</span> = theme</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">init</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">createElements</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 根据主题创建不同的元素</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">theme</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;mona-lisa&#x27;</span>:</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">createMonaLisaElements</span>()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;black-cat&#x27;</span>:</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">createBlackCatElements</span>()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">createDefaultElements</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🔧-3-配置化设计">🔧 3. 配置化设计</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持丰富的配置选项</span></span><br><span class="line"><span class="attr">shoka_player:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">shoka-player</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">mona-lisa</span>  <span class="comment"># 可选: default, mona-lisa, black-cat</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">left</span>    <span class="comment"># 可选: left, right</span></span><br><span class="line">  <span class="attr">auto_hide:</span> <span class="literal">true</span>   <span class="comment"># 是否自动隐藏</span></span><br><span class="line">  <span class="attr">show_lyrics:</span> <span class="literal">true</span> <span class="comment"># 是否显示歌词</span></span><br><span class="line">  <span class="attr">animation_speed:</span> <span class="number">6</span> <span class="comment"># 唱片旋转速度(秒)</span></span><br><span class="line">  <span class="attr">responsive:</span> <span class="literal">true</span>  <span class="comment"># 是否启用响应式</span></span><br></pre></td></tr></table></figure><h2 id="总结与经验">总结与经验</h2><h3 id="🎯-关键设计要点">🎯 关键设计要点</h3><ol><li><strong>命名空间隔离</strong>：使用独立的CSS类名和JavaScript变量名</li><li><strong>DOM元素隔离</strong>：使用不同的元素ID避免冲突</li><li><strong>事件监听器管理</strong>：正确绑定和清理事件监听器</li><li><strong>响应式设计</strong>：适配不同屏幕尺寸</li><li><strong>主题适配</strong>：支持明暗主题切换</li></ol><h3 id="🔧-技术实现要点">🔧 技术实现要点</h3><ol><li><strong>模块化设计</strong>：将功能拆分为独立的模块</li><li><strong>配置化架构</strong>：通过配置文件控制功能开关</li><li><strong>渐进增强</strong>：在原有功能基础上添加新功能</li><li><strong>向后兼容</strong>：确保不影响现有功能</li><li><strong>性能优化</strong>：合理使用事件节流和防抖</li></ol><h3 id="🚀-扩展应用">🚀 扩展应用</h3><p>这个双样式系统的设计思路可以应用到其他场景：</p><ul><li><strong>多主题切换系统</strong></li><li><strong>插件化架构设计</strong></li><li><strong>组件化开发模式</strong></li><li><strong>配置驱动的功能模块</strong></li></ul><h3 id="💡-最佳实践">💡 最佳实践</h3><ol><li><strong>样式隔离</strong>：使用CSS命名空间和特异性控制</li><li><strong>脚本隔离</strong>：使用类封装和模块化设计</li><li><strong>配置管理</strong>：使用统一的配置文件管理</li><li><strong>测试验证</strong>：全面的功能测试和兼容性测试</li><li><strong>文档维护</strong>：详细的代码注释和使用文档</li></ol><hr><p>通过本次完整的双样式系统实现，我们不仅成功集成了shoka-player，还学会了如何设计可扩展的组件架构。这种设计思路可以帮助我们构建更加灵活和可维护的主题系统！</p><p><strong>下期预告</strong>：我们将探索更多Solitude主题的高级魔改技巧，敬请期待！</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
            <tag> mini-player </tag>
            
            <tag> shoka-player </tag>
            
            <tag> 音乐播放器 </tag>
            
            <tag> 双样式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(18)-相册页图片防复制防下载功能实现</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(18)-%E7%9B%B8%E5%86%8C%E9%A1%B5%E5%9B%BE%E7%89%87%E9%98%B2%E5%A4%8D%E5%88%B6%E9%98%B2%E4%B8%8B%E8%BD%BD%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(18)-%E7%9B%B8%E5%86%8C%E9%A1%B5%E5%9B%BE%E7%89%87%E9%98%B2%E5%A4%8D%E5%88%B6%E9%98%B2%E4%B8%8B%E8%BD%BD%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1>Solitude主题魔改教程(18)-相册页图片防复制防下载功能实现</h1><h2 id="前言">前言</h2><p>在上一篇教程中，我们实现了Banner图片和视频的防复制防下载功能。本篇教程将继续扩展防护范围，为相册页面的所有图片提供全面的防护保护，包括相册封面、照片墙、模态框中的大图和缩略图等。</p><h2 id="功能预览">功能预览</h2><h3 id="防护范围">防护范围</h3><ul><li>✅ 相册封面图片防护</li><li>✅ 照片墙图片防护</li><li>✅ 模态框主图防护</li><li>✅ 缩略图智能防护（保持点击功能）</li><li>✅ 动态加载图片防护</li></ul><h3 id="防护特性">防护特性</h3><ul><li>🛡️ 禁用右键菜单</li><li>🛡️ 禁用图片拖拽</li><li>🛡️ 禁用文本选择</li><li>🛡️ 防止长按保存（移动端）</li><li>🛡️ 键盘快捷键防护</li><li>🛡️ 开发者工具检测</li><li>🛡️ 透明遮罩层防护</li></ul><h2 id="实现思路">实现思路</h2><h3 id="防护策略设计">防护策略设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[相册页面图片] --&gt; B&#123;图片类型判断&#125;</span><br><span class="line">    B --&gt; C[封面图片]</span><br><span class="line">    B --&gt; D[照片墙图片]</span><br><span class="line">    B --&gt; E[模态框主图]</span><br><span class="line">    B --&gt; F[缩略图]</span><br><span class="line">    </span><br><span class="line">    C --&gt; G[完整防护]</span><br><span class="line">    D --&gt; G</span><br><span class="line">    E --&gt; G</span><br><span class="line">    F --&gt; H[轻度防护]</span><br><span class="line">    </span><br><span class="line">    G --&gt; I[右键+拖拽+选择+遮罩层]</span><br><span class="line">    H --&gt; J[右键+拖拽保持点击]</span><br><span class="line">    </span><br><span class="line">    style F fill:#e1f5fe</span><br><span class="line">    style H fill:#e8f5e8</span><br><span class="line">    style G fill:#fff3e0</span><br></pre></td></tr></table></figure><h3 id="防护等级设计">防护等级设计</h3><table><thead><tr><th>元素类型</th><th>防护等级</th><th>包含功能</th><th>保留功能</th></tr></thead><tbody><tr><td>相册封面</td><td>完整防护</td><td>右键+拖拽+选择+遮罩层</td><td>无</td></tr><tr><td>照片墙图片</td><td>完整防护</td><td>右键+拖拽+选择+遮罩层</td><td>无</td></tr><tr><td>模态框主图</td><td>完整防护</td><td>右键+拖拽+选择</td><td>无遮罩层</td></tr><tr><td>缩略图</td><td>轻度防护</td><td>右键+拖拽</td><td>点击切换</td></tr></tbody></table><h2 id="文件结构">文件结构</h2><p>本次魔改需要创建以下文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">themes/solitude/source/</span><br><span class="line">├── css/custom/</span><br><span class="line">│   └── album-protection.css       # 相册防护样式</span><br><span class="line">└── js/custom/</span><br><span class="line">    └── album-protection.js        # 相册防护脚本</span><br></pre></td></tr></table></figure><h2 id="实现步骤">实现步骤</h2><h3 id="步骤1：创建相册防护CSS">步骤1：创建相册防护CSS</h3><p>创建文件 <code>themes/solitude/source/css/custom/album-protection.css</code>：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 相册页面图片防护样式 */</span></span><br><span class="line"><span class="comment">/* Album Page Image Protection Styles */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 相册页面图片通用防护 */</span></span><br><span class="line"><span class="selector-id">#album_section</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.album_container</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.album_card</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-id">#photo_wall_section</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.photo_container</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.photo_wall</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-id">#album_modal</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.modal_main_image</span>,</span><br><span class="line"><span class="selector-class">.modal_thumbnails</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">    <span class="comment">/* 禁用文本选择 */</span></span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用拖拽 */</span></span><br><span class="line">    -webkit-user-drag: none;</span><br><span class="line">    -khtml-user-drag: none;</span><br><span class="line">    -moz-user-drag: none;</span><br><span class="line">    -o-user-drag: none;</span><br><span class="line">    user-drag: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用突出显示 */</span></span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    -webkit-tap-highlight-<span class="attribute">color</span>: transparent;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 防止长按保存 */</span></span><br><span class="line">    <span class="attribute">pointer-events</span>: auto;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 相册容器防护 */</span></span><br><span class="line"><span class="selector-id">#album_section</span>,</span><br><span class="line"><span class="selector-class">.album_container</span>,</span><br><span class="line"><span class="selector-id">#photo_wall_section</span>,</span><br><span class="line"><span class="selector-class">.photo_container</span>,</span><br><span class="line"><span class="selector-id">#album_modal</span> &#123;</span><br><span class="line">    <span class="comment">/* 禁用选择 */</span></span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 防止突出显示 */</span></span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    -webkit-tap-highlight-<span class="attribute">color</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 模态框主图片特殊防护 */</span></span><br><span class="line"><span class="selector-class">.modal_main_image</span> &#123;</span><br><span class="line">    <span class="comment">/* 强制防护 */</span></span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    </span><br><span class="line">    -webkit-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    -khtml-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    -moz-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    -o-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    </span><br><span class="line">    -webkit-touch-callout: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto <span class="meta">!important</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 防止右键菜单 */</span></span><br><span class="line">    -webkit-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    -moz-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 缩略图特殊防护（保持点击功能） */</span></span><br><span class="line"><span class="selector-class">.modal_thumbnails</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">    <span class="comment">/* 强制防护但保持点击 */</span></span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">    </span><br><span class="line">    -webkit-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    -khtml-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    -moz-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    -o-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    </span><br><span class="line">    -webkit-touch-callout: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 透明遮罩层防护 */</span></span><br><span class="line"><span class="selector-class">.album-protection-overlay</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">999</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto;</span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 移动端额外防护 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#album_section</span> <span class="selector-tag">img</span>,</span><br><span class="line">    <span class="selector-class">.album_container</span> <span class="selector-tag">img</span>,</span><br><span class="line">    <span class="selector-id">#album_modal</span> <span class="selector-tag">img</span>,</span><br><span class="line">    <span class="selector-class">.modal_main_image</span>,</span><br><span class="line">    <span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">        <span class="comment">/* 禁用长按菜单 */</span></span><br><span class="line">        -webkit-touch-callout: none <span class="meta">!important</span>;</span><br><span class="line">        -webkit-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        -khtml-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        -moz-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        -ms-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 禁用双击缩放 */</span></span><br><span class="line">        <span class="attribute">touch-action</span>: manipulation;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 防止长按选择 */</span></span><br><span class="line">        -webkit-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">        user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 额外的右键菜单禁用 */</span></span><br><span class="line"><span class="selector-class">.album-no-context-menu</span> &#123;</span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -khtml-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    -webkit-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    -moz-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    -webkit-user-drag: none;</span><br><span class="line">    user-drag: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="步骤2：创建相册防护JavaScript">步骤2：创建相册防护JavaScript</h3><p>创建文件 <code>themes/solitude/source/js/custom/album-protection.js</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 相册页面图片防护</span></span><br><span class="line"><span class="comment">// Album Page Image Protection</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 防护配置</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">PROTECTION_CONFIG</span> = &#123;</span><br><span class="line">        <span class="comment">// 要保护的选择器</span></span><br><span class="line">        <span class="attr">selectors</span>: &#123;</span><br><span class="line">            <span class="attr">albumImages</span>: <span class="string">&#x27;#album_section img, .album_container img, .album_card img, #photo_wall_section img, .photo_container img, .photo_wall img&#x27;</span>,</span><br><span class="line">            <span class="attr">modalImages</span>: <span class="string">&#x27;#album_modal img, .modal_main_image, .modal_thumbnails img, .thumbnail&#x27;</span>,</span><br><span class="line">            <span class="attr">albumContainers</span>: <span class="string">&#x27;#album_section, .album_container, #photo_wall_section, .photo_container, #album_modal&#x27;</span>,</span><br><span class="line">            <span class="attr">allImages</span>: <span class="string">&#x27;img[class*=&quot;album&quot;], img[src*=&quot;album&quot;], img[data-src*=&quot;album&quot;], img[class*=&quot;photo&quot;]&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 防护等级</span></span><br><span class="line">        <span class="attr">protectionLevel</span>: <span class="string">&#x27;high&#x27;</span>, <span class="comment">// low, medium, high</span></span><br><span class="line">        <span class="comment">// 是否显示警告</span></span><br><span class="line">        <span class="attr">showWarnings</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 调试模式</span></span><br><span class="line">        <span class="attr">debug</span>: <span class="literal">false</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 日志工具</span></span><br><span class="line">    <span class="keyword">const</span> logger = &#123;</span><br><span class="line">        <span class="attr">log</span>: <span class="function">(<span class="params">message</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">debug</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[Album Protection] <span class="subst">$&#123;message&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">warn</span>: <span class="function">(<span class="params">message</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">showWarnings</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`[Album Protection] <span class="subst">$&#123;message&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 防护工具类</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">AlbumProtection</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">protectedElements</span> = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">overlays</span> = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">lastWarningTime</span> = <span class="number">0</span>; <span class="comment">// 防止重复显示警告</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">warningCooldown</span> = <span class="number">2000</span>; <span class="comment">// 2秒冷却时间</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 初始化防护</span></span><br><span class="line">        <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">            logger.<span class="title function_">log</span>(<span class="string">&#x27;Initializing album protection...&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setupProtection</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setupMutationObserver</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setupKeyboardProtection</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setupAdvancedProtection</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用右键菜单</span></span><br><span class="line">        <span class="title function_">disableContextMenu</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element || <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">has</span>(element)) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> <span class="title function_">handler</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">                e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                e.<span class="title function_">stopImmediatePropagation</span>();</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">showWarnings</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">showProtectionWarning</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, handler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;auxclick&#x27;</span>, handler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用拖拽</span></span><br><span class="line">        <span class="title function_">disableDrag</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element || <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">has</span>(element)) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> <span class="title function_">dragHandler</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">                e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragstart&#x27;</span>, dragHandler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;drag&#x27;</span>, dragHandler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragend&#x27;</span>, dragHandler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 设置draggable属性</span></span><br><span class="line">            <span class="keyword">if</span> (element.<span class="property">tagName</span> === <span class="string">&#x27;IMG&#x27;</span>) &#123;</span><br><span class="line">                element.<span class="property">draggable</span> = <span class="literal">false</span>;</span><br><span class="line">                element.<span class="title function_">setAttribute</span>(<span class="string">&#x27;draggable&#x27;</span>, <span class="string">&#x27;false&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用选择</span></span><br><span class="line">        <span class="title function_">disableSelection</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element || <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">has</span>(element)) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> <span class="title function_">selectionHandler</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">                e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;selectstart&#x27;</span>, selectionHandler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.<span class="property">detail</span> &gt; <span class="number">1</span>) &#123; <span class="comment">// 多次点击</span></span><br><span class="line">                    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    <span class="comment">// 不阻止冒泡，允许正常的点击事件继续传播</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 防止双击选择</span></span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dblclick&#x27;</span>, selectionHandler, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加CSS防护类</span></span><br><span class="line">        <span class="title function_">addProtectionClasses</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            element.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;album-no-context-menu&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 设置CSS属性</span></span><br><span class="line">            <span class="keyword">const</span> protectionStyles = &#123;</span><br><span class="line">                <span class="string">&#x27;user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-webkit-user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-moz-user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-ms-user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-webkit-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-khtml-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-moz-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-o-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-webkit-touch-callout&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;-webkit-tap-highlight-color&#x27;</span>: <span class="string">&#x27;transparent&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;pointer-events&#x27;</span>: <span class="string">&#x27;auto&#x27;</span></span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">assign</span>(element.<span class="property">style</span>, protectionStyles);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 创建透明遮罩层</span></span><br><span class="line">        <span class="title function_">createProtectionOverlay</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element || element.<span class="title function_">querySelector</span>(<span class="string">&#x27;.album-protection-overlay&#x27;</span>)) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> overlay = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">            overlay.<span class="property">className</span> = <span class="string">&#x27;album-protection-overlay&#x27;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 确保父元素有定位</span></span><br><span class="line">            <span class="keyword">const</span> parentStyle = <span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(element.<span class="property">parentElement</span>);</span><br><span class="line">            <span class="keyword">if</span> (parentStyle.<span class="property">position</span> === <span class="string">&#x27;static&#x27;</span>) &#123;</span><br><span class="line">                element.<span class="property">parentElement</span>.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;relative&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            element.<span class="property">parentElement</span>.<span class="title function_">appendChild</span>(overlay);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">overlays</span>.<span class="title function_">add</span>(overlay);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 对遮罩层也应用防护</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">disableContextMenu</span>(overlay);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">disableSelection</span>(overlay);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">disableDrag</span>(overlay);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> overlay;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 缩略图轻度防护（保持点击功能）</span></span><br><span class="line">        <span class="title function_">applyThumbnailProtection</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element || <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">has</span>(element)) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 只禁用右键菜单，不使用capture模式以避免干扰点击事件</span></span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">showWarnings</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">showProtectionWarning</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, &#123; <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 轻度拖拽防护，不使用capture模式</span></span><br><span class="line">            element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragstart&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                e.<span class="title function_">preventDefault</span>();</span><br><span class="line">            &#125;, &#123; <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 设置基础CSS防护，但不影响事件</span></span><br><span class="line">            element.<span class="property">style</span>.<span class="property">userSelect</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">            element.<span class="property">style</span>.<span class="property">webkitUserSelect</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">            element.<span class="property">style</span>.<span class="property">webkitUserDrag</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">            element.<span class="property">style</span>.<span class="property">userDrag</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">            element.<span class="property">draggable</span> = <span class="literal">false</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 确保可以点击</span></span><br><span class="line">            element.<span class="property">style</span>.<span class="property">pointerEvents</span> = <span class="string">&quot;auto&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">add</span>(element);</span><br><span class="line">            logger.<span class="title function_">log</span>(<span class="string">`Thumbnail lightly protected: <span class="subst">$&#123;element.tagName&#125;</span>.<span class="subst">$&#123;element.className&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用完整防护</span></span><br><span class="line">        <span class="title function_">applyFullProtection</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!element || <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">has</span>(element)) <span class="keyword">return</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 对缩略图进行特殊处理，保持点击功能</span></span><br><span class="line">            <span class="keyword">if</span> (element.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;thumbnail&#x27;</span>) || element.<span class="title function_">closest</span>(<span class="string">&#x27;.modal_thumbnails&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">applyThumbnailProtection</span>(element);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">disableContextMenu</span>(element);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">disableDrag</span>(element);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">disableSelection</span>(element);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">addProtectionClasses</span>(element);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 对图片元素创建遮罩层，但排除缩略图和模态框内的图片</span></span><br><span class="line">            <span class="keyword">if</span> (element.<span class="property">tagName</span> === <span class="string">&#x27;IMG&#x27;</span> &amp;&amp; </span><br><span class="line">                <span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">protectionLevel</span> === <span class="string">&#x27;high&#x27;</span> &amp;&amp;</span><br><span class="line">                !element.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;thumbnail&#x27;</span>) &amp;&amp;</span><br><span class="line">                !element.<span class="title function_">closest</span>(<span class="string">&#x27;.modal_thumbnails&#x27;</span>) &amp;&amp;</span><br><span class="line">                !element.<span class="title function_">closest</span>(<span class="string">&#x27;#album_modal&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">createProtectionOverlay</span>(element);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">add</span>(element);</span><br><span class="line">            logger.<span class="title function_">log</span>(<span class="string">`Protected element: <span class="subst">$&#123;element.tagName&#125;</span>.<span class="subst">$&#123;element.className&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 清理缩略图上的遮罩层</span></span><br><span class="line">        <span class="title function_">cleanupThumbnailOverlays</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.modal_thumbnails .album-protection-overlay, .thumbnail + .album-protection-overlay&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">overlay</span> =&gt;</span> &#123;</span><br><span class="line">                logger.<span class="title function_">log</span>(<span class="string">&#x27;Removing overlay from thumbnail area&#x27;</span>);</span><br><span class="line">                overlay.<span class="title function_">remove</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 设置基础防护</span></span><br><span class="line">        <span class="title function_">setupProtection</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// 先清理可能存在的缩略图遮罩层</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">cleanupThumbnailOverlays</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 保护所有相册图片</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">selectors</span>.<span class="property">albumImages</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(img);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 保护模态框图片</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">selectors</span>.<span class="property">modalImages</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(img);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 保护容器</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">selectors</span>.<span class="property">albumContainers</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">container</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">disableSelection</span>(container);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">addProtectionClasses</span>(container);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 保护所有包含album关键词的图片</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">selectors</span>.<span class="property">allImages</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(img);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 设置变化监听器</span></span><br><span class="line">        <span class="title function_">setupMutationObserver</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="function">(<span class="params">mutations</span>) =&gt;</span> &#123;</span><br><span class="line">                mutations.<span class="title function_">forEach</span>(<span class="function">(<span class="params">mutation</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// 监听新增的节点</span></span><br><span class="line">                    mutation.<span class="property">addedNodes</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (node.<span class="property">nodeType</span> === <span class="title class_">Node</span>.<span class="property">ELEMENT_NODE</span>) &#123;</span><br><span class="line">                            <span class="comment">// 延迟应用防护，确保其他脚本先完成初始化</span></span><br><span class="line">                            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                <span class="comment">// 检查是否是图片</span></span><br><span class="line">                                <span class="keyword">if</span> (node.<span class="property">tagName</span> === <span class="string">&#x27;IMG&#x27;</span>) &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">shouldProtectImage</span>(node)) &#123;</span><br><span class="line">                                        <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(node);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                </span><br><span class="line">                                <span class="comment">// 检查子元素中的图片</span></span><br><span class="line">                                <span class="keyword">const</span> images = node.<span class="property">querySelectorAll</span> &amp;&amp; node.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">                                <span class="keyword">if</span> (images) &#123;</span><br><span class="line">                                    images.<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">                                        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">shouldProtectImage</span>(img)) &#123;</span><br><span class="line">                                            <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(img);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;, <span class="number">100</span>); <span class="comment">// 延迟100ms应用防护</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            observer.<span class="title function_">observe</span>(<span class="variable language_">document</span>.<span class="property">body</span>, &#123;</span><br><span class="line">                <span class="attr">childList</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">subtree</span>: <span class="literal">true</span></span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            logger.<span class="title function_">log</span>(<span class="string">&#x27;Mutation observer setup complete&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 判断是否应该保护图片</span></span><br><span class="line">        <span class="title function_">shouldProtectImage</span>(<span class="params">img</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> src = img.<span class="property">src</span> || img.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-src&#x27;</span>) || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">const</span> className = img.<span class="property">className</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">const</span> parentClasses = img.<span class="property">parentElement</span> ? img.<span class="property">parentElement</span>.<span class="property">className</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 排除模态框中的缩略图，让它们保持点击功能</span></span><br><span class="line">            <span class="keyword">if</span> (img.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;thumbnail&#x27;</span>) || img.<span class="title function_">closest</span>(<span class="string">&#x27;.modal_thumbnails&#x27;</span>)) &#123;</span><br><span class="line">                logger.<span class="title function_">log</span>(<span class="string">&#x27;Skipping thumbnail protection to preserve click functionality&#x27;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">                src.<span class="title function_">includes</span>(<span class="string">&#x27;album&#x27;</span>) ||</span><br><span class="line">                src.<span class="title function_">includes</span>(<span class="string">&#x27;photo&#x27;</span>) ||</span><br><span class="line">                className.<span class="title function_">includes</span>(<span class="string">&#x27;album&#x27;</span>) ||</span><br><span class="line">                className.<span class="title function_">includes</span>(<span class="string">&#x27;photo&#x27;</span>) ||</span><br><span class="line">                parentClasses.<span class="title function_">includes</span>(<span class="string">&#x27;album&#x27;</span>) ||</span><br><span class="line">                parentClasses.<span class="title function_">includes</span>(<span class="string">&#x27;photo&#x27;</span>) ||</span><br><span class="line">                img.<span class="title function_">closest</span>(<span class="string">&#x27;#album_section&#x27;</span>) ||</span><br><span class="line">                img.<span class="title function_">closest</span>(<span class="string">&#x27;#album_modal&#x27;</span>) ||</span><br><span class="line">                img.<span class="title function_">closest</span>(<span class="string">&#x27;.album_container&#x27;</span>) ||</span><br><span class="line">                img.<span class="title function_">closest</span>(<span class="string">&#x27;.photo_wall&#x27;</span>) ||</span><br><span class="line">                img.<span class="title function_">closest</span>(<span class="string">&#x27;#photo_wall_section&#x27;</span>) ||</span><br><span class="line">                img.<span class="title function_">closest</span>(<span class="string">&#x27;.photo_container&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 键盘快捷键防护</span></span><br><span class="line">        <span class="title function_">setupKeyboardProtection</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 在相册页面禁用特定快捷键</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isInAlbumContext</span>()) &#123;</span><br><span class="line">                    <span class="comment">// 禁用 Ctrl+S (保存)</span></span><br><span class="line">                    <span class="keyword">if</span> (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">key</span> === <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">                        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="title function_">showProtectionWarning</span>();</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// 禁用 Ctrl+A (全选)</span></span><br><span class="line">                    <span class="keyword">if</span> (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">key</span> === <span class="string">&#x27;a&#x27;</span>) &#123;</span><br><span class="line">                        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// 禁用 F12 和开发者工具快捷键</span></span><br><span class="line">                    <span class="keyword">if</span> (e.<span class="property">key</span> === <span class="string">&#x27;F12&#x27;</span> || </span><br><span class="line">                        (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; e.<span class="property">key</span> === <span class="string">&#x27;I&#x27;</span>) ||</span><br><span class="line">                        (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; e.<span class="property">key</span> === <span class="string">&#x27;C&#x27;</span>) ||</span><br><span class="line">                        (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">key</span> === <span class="string">&#x27;U&#x27;</span>)) &#123;</span><br><span class="line">                        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="title function_">showProtectionWarning</span>();</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, &#123; <span class="attr">capture</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 高级防护设置</span></span><br><span class="line">        <span class="title function_">setupAdvancedProtection</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// 防止通过控制台访问图片</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">protectionLevel</span> === <span class="string">&#x27;high&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">setupConsoleProtection</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 防止通过开发者工具复制图片URL</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setupDevToolsProtection</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 开发者工具防护</span></span><br><span class="line">        <span class="title function_">setupDevToolsProtection</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// 检测开发者工具</span></span><br><span class="line">            <span class="keyword">let</span> devtools = &#123;<span class="attr">open</span>: <span class="literal">false</span>, <span class="attr">orientation</span>: <span class="literal">null</span>&#125;;</span><br><span class="line">            <span class="keyword">const</span> threshold = <span class="number">160</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isInAlbumContext</span>()) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerHeight</span> - <span class="variable language_">window</span>.<span class="property">innerHeight</span> &gt; threshold || </span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">outerWidth</span> - <span class="variable language_">window</span>.<span class="property">innerWidth</span> &gt; threshold) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!devtools.<span class="property">open</span>) &#123;</span><br><span class="line">                            devtools.<span class="property">open</span> = <span class="literal">true</span>;</span><br><span class="line">                            <span class="variable language_">this</span>.<span class="title function_">showProtectionWarning</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        devtools.<span class="property">open</span> = <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否在相册上下文中</span></span><br><span class="line">        <span class="title function_">isInAlbumContext</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#album_section&#x27;</span>) !== <span class="literal">null</span> ||</span><br><span class="line">                   <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#album_modal:not(.hidden)&#x27;</span>) !== <span class="literal">null</span> ||</span><br><span class="line">                   <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>.<span class="title function_">includes</span>(<span class="string">&#x27;/album&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 显示防护警告</span></span><br><span class="line">        <span class="title function_">showProtectionWarning</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查页面是否还在加载中</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查是否有loading动画在显示</span></span><br><span class="line">            <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (loadingContainer &amp;&amp; !loadingContainer.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;hide&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 额外检查其他可能的loading元素</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.loading, #loading, [class*=&quot;loading&quot;]:not(.album-protection-warning)&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查冷却时间，防止重复显示</span></span><br><span class="line">            <span class="keyword">if</span> (now - <span class="variable language_">this</span>.<span class="property">lastWarningTime</span> &lt; <span class="variable language_">this</span>.<span class="property">warningCooldown</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查是否已有警告在显示</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.album-protection-warning&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">lastWarningTime</span> = now;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 创建警告提示</span></span><br><span class="line">            <span class="keyword">const</span> warning = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">            warning.<span class="property">className</span> = <span class="string">&#x27;album-protection-warning&#x27;</span>;</span><br><span class="line">            warning.<span class="property">style</span>.<span class="property">cssText</span> = <span class="string">`</span></span><br><span class="line"><span class="string">                position: fixed;</span></span><br><span class="line"><span class="string">                top: 20px;</span></span><br><span class="line"><span class="string">                right: 20px;</span></span><br><span class="line"><span class="string">                background: #ff4757;</span></span><br><span class="line"><span class="string">                color: white;</span></span><br><span class="line"><span class="string">                padding: 10px 15px;</span></span><br><span class="line"><span class="string">                border-radius: 5px;</span></span><br><span class="line"><span class="string">                z-index: 10000;</span></span><br><span class="line"><span class="string">                font-size: 14px;</span></span><br><span class="line"><span class="string">                font-family: Arial, sans-serif;</span></span><br><span class="line"><span class="string">                box-shadow: 0 2px 10px rgba(0,0,0,0.3);</span></span><br><span class="line"><span class="string">                animation: slideIn 0.3s ease-out;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line">            warning.<span class="property">textContent</span> = <span class="string">&#x27;图片受保护，禁止复制或下载&#x27;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 添加动画样式</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#album-protection-style&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">const</span> style = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>);</span><br><span class="line">                style.<span class="property">id</span> = <span class="string">&#x27;album-protection-style&#x27;</span>;</span><br><span class="line">                style.<span class="property">textContent</span> = <span class="string">`</span></span><br><span class="line"><span class="string">                    @keyframes slideIn &#123;</span></span><br><span class="line"><span class="string">                        from &#123; transform: translateX(100%); opacity: 0; &#125;</span></span><br><span class="line"><span class="string">                        to &#123; transform: translateX(0); opacity: 1; &#125;</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                `</span>;</span><br><span class="line">                <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(style);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(warning);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3秒后移除警告</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (warning.<span class="property">parentNode</span>) &#123;</span><br><span class="line">                    warning.<span class="title function_">remove</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">3000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 刷新防护（用于动态内容）</span></span><br><span class="line">        <span class="title function_">refresh</span>(<span class="params"></span>) &#123;</span><br><span class="line">            logger.<span class="title function_">log</span>(<span class="string">&#x27;Refreshing album protection...&#x27;</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setupProtection</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 清理防护</span></span><br><span class="line">        <span class="title function_">cleanup</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">clear</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">overlays</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">overlay</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (overlay.<span class="property">parentNode</span>) &#123;</span><br><span class="line">                    overlay.<span class="title function_">remove</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">overlays</span>.<span class="title function_">clear</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建全局实例</span></span><br><span class="line">    <span class="keyword">let</span> albumProtection = <span class="literal">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 初始化函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initAlbumProtection</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 等待loading动画完成</span></span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">waitForLoadingComplete</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (loadingContainer &amp;&amp; !loadingContainer.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;hide&#x27;</span>)) &#123;</span><br><span class="line">                <span class="comment">// 如果loading还在显示，延迟100ms再检查</span></span><br><span class="line">                <span class="built_in">setTimeout</span>(waitForLoadingComplete, <span class="number">100</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// loading已完成，开始初始化防护</span></span><br><span class="line">            <span class="keyword">if</span> (albumProtection) &#123;</span><br><span class="line">                albumProtection.<span class="title function_">cleanup</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            albumProtection = <span class="keyword">new</span> <span class="title class_">AlbumProtection</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 将实例添加到全局作用域以便调试</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">debug</span>) &#123;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="property">albumProtection</span> = albumProtection;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="title function_">waitForLoadingComplete</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 页面加载完成后初始化</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(initAlbumProtection, <span class="number">200</span>); <span class="comment">// 稍微延迟确保DOM完全准备好</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(initAlbumProtection, <span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// PJAX支持</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:success&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(initAlbumProtection, <span class="number">100</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Turbo支持</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;turbo:load&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(initAlbumProtection, <span class="number">100</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 页面可见性变化时刷新防护</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;visibilitychange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">document</span>.<span class="property">hidden</span> &amp;&amp; albumProtection) &#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> albumProtection.<span class="title function_">refresh</span>(), <span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    logger.<span class="title function_">log</span>(<span class="string">&#x27;Album protection script loaded&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="步骤3：集成到主题中">步骤3：集成到主题中</h3><h4 id="3-1-添加CSS到头部">3.1 添加CSS到头部</h4><p>编辑 <code>themes/solitude/layout/includes/head.pug</code>，在banner防护CSS后添加：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// banner protection css</span><br><span class="line">link(rel=&quot;stylesheet&quot;, href=url_for(&#x27;/css/custom/banner-protection.css&#x27;))</span><br><span class="line"></span><br><span class="line">// album protection css</span><br><span class="line">if page.type === &#x27;album&#x27;</span><br><span class="line">  link(rel=&quot;stylesheet&quot;, href=url_for(&#x27;/css/custom/album-protection.css&#x27;))</span><br></pre></td></tr></table></figure><h4 id="3-2-添加JavaScript到配置">3.2 添加JavaScript到配置</h4><p>编辑 <code>_config.solitude.yml</code>，在inject的body部分添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">body:</span></span><br><span class="line">    <span class="comment"># 相册集</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/album.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/album-modal.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/photo-wall.js&quot;</span> <span class="string">defer&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="comment"># 相册防护</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/album-protection.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-3-增强现有相册脚本">3.3 增强现有相册脚本</h4><p>为了确保防护功能与现有功能的兼容性，需要对现有的相册脚本进行小幅调整：</p><p><strong>增强 <code>album-modal.js</code> 中的点击事件：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 点击缩略图切换主图片 - 使用capture模式确保优先执行</span></span><br><span class="line">thumbnail.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Thumbnail clicked:&#x27;</span>, img.<span class="property">url</span>); <span class="comment">// 调试日志</span></span><br><span class="line">  mainImage.<span class="property">src</span> = img.<span class="property">url</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.thumbnail&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">thumb</span>) =&gt;</span> thumb.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>));</span><br><span class="line">  thumbnail.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 阻止事件冒泡，避免触发模态框关闭</span></span><br><span class="line">  event.<span class="title function_">stopPropagation</span>();</span><br><span class="line">&#125;, &#123; <span class="attr">capture</span>: <span class="literal">true</span>, <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br></pre></td></tr></table></figure><h3 id="步骤4：复制文件到public目录">步骤4：复制文件到public目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制CSS文件</span></span><br><span class="line"><span class="built_in">cp</span> themes/solitude/source/css/custom/album-protection.css public/css/custom/album-protection.css</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制JavaScript文件</span></span><br><span class="line"><span class="built_in">cp</span> themes/solitude/source/js/custom/album-protection.js public/js/custom/album-protection.js</span><br></pre></td></tr></table></figure><h3 id="步骤5：重新生成站点">步骤5：重新生成站点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo generate</span><br></pre></td></tr></table></figure><h2 id="功能特点">功能特点</h2><h3 id="智能防护策略">智能防护策略</h3><h4 id="分级防护设计">分级防护设计</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 防护等级配置</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PROTECTION_CONFIG</span> = &#123;</span><br><span class="line">    <span class="attr">protectionLevel</span>: <span class="string">&#x27;high&#x27;</span>, <span class="comment">// low, medium, high</span></span><br><span class="line">    <span class="attr">selectors</span>: &#123;</span><br><span class="line">        <span class="attr">albumImages</span>: <span class="string">&#x27;#album_section img, .album_container img, .album_card img, #photo_wall_section img, .photo_container img, .photo_wall img&#x27;</span>,</span><br><span class="line">        <span class="attr">modalImages</span>: <span class="string">&#x27;#album_modal img, .modal_main_image, .modal_thumbnails img, .thumbnail&#x27;</span>,</span><br><span class="line">        <span class="attr">albumContainers</span>: <span class="string">&#x27;#album_section, .album_container, #photo_wall_section, .photo_container, #album_modal&#x27;</span>,</span><br><span class="line">        <span class="attr">allImages</span>: <span class="string">&#x27;img[class*=&quot;album&quot;], img[src*=&quot;album&quot;], img[data-src*=&quot;album&quot;], img[class*=&quot;photo&quot;]&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="缩略图特殊处理">缩略图特殊处理</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 缩略图轻度防护（保持点击功能）</span></span><br><span class="line"><span class="title function_">applyThumbnailProtection</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="comment">// 只禁用右键菜单，不使用capture模式以避免干扰点击事件</span></span><br><span class="line">    element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable constant_">PROTECTION_CONFIG</span>.<span class="property">showWarnings</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">showProtectionWarning</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, &#123; <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 轻度拖拽防护，不使用capture模式</span></span><br><span class="line">    element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragstart&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    &#125;, &#123; <span class="attr">passive</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 确保可以点击</span></span><br><span class="line">    element.<span class="property">style</span>.<span class="property">pointerEvents</span> = <span class="string">&quot;auto&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动态内容监听">动态内容监听</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置变化监听器，监听动态加载的图片</span></span><br><span class="line"><span class="title function_">setupMutationObserver</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="function">(<span class="params">mutations</span>) =&gt;</span> &#123;</span><br><span class="line">        mutations.<span class="title function_">forEach</span>(<span class="function">(<span class="params">mutation</span>) =&gt;</span> &#123;</span><br><span class="line">            mutation.<span class="property">addedNodes</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (node.<span class="property">nodeType</span> === <span class="title class_">Node</span>.<span class="property">ELEMENT_NODE</span>) &#123;</span><br><span class="line">                    <span class="comment">// 延迟应用防护，确保其他脚本先完成初始化</span></span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (node.<span class="property">tagName</span> === <span class="string">&#x27;IMG&#x27;</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">shouldProtectImage</span>(node)) &#123;</span><br><span class="line">                                <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(node);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">// 检查子元素中的图片</span></span><br><span class="line">                        <span class="keyword">const</span> images = node.<span class="property">querySelectorAll</span> &amp;&amp; node.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (images) &#123;</span><br><span class="line">                            images.<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">                                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">shouldProtectImage</span>(img)) &#123;</span><br><span class="line">                                    <span class="variable language_">this</span>.<span class="title function_">applyFullProtection</span>(img);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="number">100</span>); <span class="comment">// 延迟100ms应用防护</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    observer.<span class="title function_">observe</span>(<span class="variable language_">document</span>.<span class="property">body</span>, &#123;</span><br><span class="line">        <span class="attr">childList</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">subtree</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="性能优化">性能优化</h3><h4 id="防重复防护">防重复防护</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">applyFullProtection</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!element || <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">has</span>(element)) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 防护逻辑...</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">protectedElements</span>.<span class="title function_">add</span>(element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Loading期间禁用警告">Loading期间禁用警告</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">showProtectionWarning</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 检查页面是否还在加载中</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检查是否有loading动画在显示</span></span><br><span class="line">    <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (loadingContainer &amp;&amp; !loadingContainer.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;hide&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 显示警告逻辑...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="兼容性处理">兼容性处理</h2><h3 id="PJAX支持">PJAX支持</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PJAX支持</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:success&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(initAlbumProtection, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="移动端优化">移动端优化</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 移动端额外防护 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#album_section</span> <span class="selector-tag">img</span>,</span><br><span class="line">    <span class="selector-class">.album_container</span> <span class="selector-tag">img</span>,</span><br><span class="line">    <span class="selector-id">#album_modal</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">        <span class="comment">/* 禁用长按菜单 */</span></span><br><span class="line">        -webkit-touch-callout: none <span class="meta">!important</span>;</span><br><span class="line">        -webkit-<span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">user-select</span>: none <span class="meta">!important</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 禁用双击缩放 */</span></span><br><span class="line">        <span class="attribute">touch-action</span>: manipulation;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 防止长按选择 */</span></span><br><span class="line">        -webkit-user-drag: none <span class="meta">!important</span>;</span><br><span class="line">        user-drag: none <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="浏览器兼容性">浏览器兼容性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置CSS属性兼容多浏览器</span></span><br><span class="line"><span class="keyword">const</span> protectionStyles = &#123;</span><br><span class="line">    <span class="string">&#x27;user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-webkit-user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-moz-user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-ms-user-select&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-webkit-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-khtml-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-moz-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-o-user-drag&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-webkit-touch-callout&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-webkit-tap-highlight-color&#x27;</span>: <span class="string">&#x27;transparent&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="调试与测试">调试与测试</h2><h3 id="开启调试模式">开启调试模式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PROTECTION_CONFIG</span> = &#123;</span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">true</span>, <span class="comment">// 开启调试模式</span></span><br><span class="line">    <span class="attr">showWarnings</span>: <span class="literal">true</span> <span class="comment">// 显示警告</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="测试清单">测试清单</h3><h4 id="基础功能测试">基础功能测试</h4><ul><li>[ ] 相册封面图片无法右键保存</li><li>[ ] 相册封面图片无法拖拽</li><li>[ ] 照片墙图片无法下载</li><li>[ ] 模态框主图无法复制</li><li>[ ] 缩略图可以正常点击切换</li><li>[ ] 缩略图无法右键保存</li></ul><h4 id="高级功能测试">高级功能测试</h4><ul><li>[ ] Ctrl+S无法保存图片</li><li>[ ] F12时显示警告</li><li>[ ] 开发者工具检测正常</li><li>[ ] 移动端长按无菜单</li><li>[ ] PJAX切换后防护正常</li></ul><h4 id="兼容性测试">兼容性测试</h4><ul><li>[ ] Chrome浏览器正常</li><li>[ ] Firefox浏览器正常</li><li>[ ] Safari浏览器正常</li><li>[ ] 移动端Safari正常</li><li>[ ] 移动端Chrome正常</li></ul><h2 id="注意事项">注意事项</h2><h3 id="重要提醒">重要提醒</h3><ol><li><p><strong>防护限制</strong>：</p><ul><li>防护主要针对普通用户，技术用户仍可能绕过</li><li>建议配合服务器端防盗链使用</li><li>定期更新防护策略</li></ul></li><li><p><strong>性能影响</strong>：</p><ul><li>大量图片时可能影响页面性能</li><li>建议在图片较多时适当调整防护等级</li><li>可根据需要关闭某些高级防护功能</li></ul></li><li><p><strong>功能平衡</strong>：</p><ul><li>缩略图采用轻度防护保持点击功能</li><li>如需更严格防护可修改配置</li><li>建议根据实际需求调整防护策略</li></ul></li></ol><h3 id="自定义配置">自定义配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可根据需要调整的配置</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PROTECTION_CONFIG</span> = &#123;</span><br><span class="line">    <span class="attr">protectionLevel</span>: <span class="string">&#x27;medium&#x27;</span>, <span class="comment">// 降低防护等级提升兼容性</span></span><br><span class="line">    <span class="attr">showWarnings</span>: <span class="literal">false</span>, <span class="comment">// 关闭警告提示</span></span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">false</span> <span class="comment">// 关闭调试模式</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="总结">总结</h2><p>本教程实现了Solitude主题相册页面的全面图片防护功能，包含了：</p><ol><li><strong>全面防护</strong>：覆盖相册封面、照片墙、模态框等所有图片</li><li><strong>智能策略</strong>：针对不同类型图片采用不同防护等级</li><li><strong>功能平衡</strong>：在防护和用户体验之间找到最佳平衡点</li><li><strong>性能优化</strong>：防重复处理、延迟加载等优化措施</li><li><strong>兼容性好</strong>：支持PJAX、移动端等多种环境</li></ol><p>通过本教程，你的相册页面将获得强大的图片防护能力，有效防止图片被恶意下载和复制，同时保持良好的用户体验。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 相册集 </tag>
            
            <tag> 照片墙 </tag>
            
            <tag> 模态框 </tag>
            
            <tag> 防护功能 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(19) - 修复Loading与TOC目录冲突问题</title>
      <link href="/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(19)-%E4%BF%AE%E5%A4%8DLoading%E4%B8%8ETOC%E7%9B%AE%E5%BD%95%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98/"/>
      <url>/2025/01/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(19)-%E4%BF%AE%E5%A4%8DLoading%E4%B8%8ETOC%E7%9B%AE%E5%BD%95%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="第一步：发现问题">第一步：发现问题</h2><h3 id="🔍-问题现象描述">🔍 问题现象描述</h3><p>在添加了Loading动画功能后，从第13篇文章开始出现了以下问题：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题症状</span></span><br><span class="line">❌ TOC文章目录无法点击跳转</span><br><span class="line">❌ 滚动时TOC不会高亮当前章节  </span><br><span class="line">❌ aside侧边栏的sticky定位失效</span><br><span class="line">✅ Loading动画本身显示正常</span><br><span class="line">✅ 第12篇文章及之前的功能正常</span><br></pre></td></tr></table></figure><h3 id="📊-影响范围确认">📊 影响范围确认</h3><p>通过逐篇检查发现：</p><ul><li><strong>正常文章</strong>：第1-12篇文章TOC和aside功能正常</li><li><strong>异常文章</strong>：第13-18篇文章TOC和aside功能失效</li><li><strong>关键节点</strong>：第13篇文章首次添加了<code>recommend: true</code>字段</li></ul><h3 id="🕵️-初步分析思路">🕵️ 初步分析思路</h3><h4 id="1-检查配置差异">1. 检查配置差异</h4><p>对比第12篇和第13篇文章的配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第12篇文章 front-matter (正常)</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Solitude主题魔改教程(12)-想做的事页面</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2024-11-18 00:00:00</span></span><br><span class="line"><span class="attr">categories:</span> [<span class="string">魔改教程</span>]</span><br><span class="line"><span class="attr">tags:</span> [<span class="string">Solitude</span>, <span class="string">魔改教程</span>, <span class="string">想做的事</span>]</span><br><span class="line"><span class="comment"># 没有 recommend 字段</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="comment"># 第13篇文章 front-matter (异常)</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Solitude主题魔改教程(13)-本站日志页面</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2024-11-25 00:00:00</span></span><br><span class="line"><span class="attr">categories:</span> [<span class="string">魔改教程</span>]</span><br><span class="line"><span class="attr">tags:</span> [<span class="string">Solitude</span>, <span class="string">魔改教程</span>, <span class="string">本站日志</span>]</span><br><span class="line"><span class="attr">recommend:</span> <span class="literal">true</span>  <span class="comment"># ← 新增字段</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><h4 id="2-验证关键发现">2. 验证关键发现</h4><p>通过测试发现：<strong>禁用loading功能后，TOC和aside立即恢复正常</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 验证步骤</span></span><br><span class="line">1. 修改 _config.solitude.yml: loading.fullpage: <span class="literal">false</span></span><br><span class="line">2. 重新生成网站: npm run build  </span><br><span class="line">3. 测试结果: ✅ TOC和aside功能完全恢复</span><br></pre></td></tr></table></figure><p><strong>结论</strong>：问题根源确定为Loading功能与TOC/aside的冲突</p><h2 id="第三步：找到问题点">第三步：找到问题点</h2><h3 id="🎯-深入代码分析">🎯 深入代码分析</h3><h4 id="1-检查Loading配置逻辑">1. 检查Loading配置逻辑</h4><p>在<code>_config.solitude.yml</code>中发现：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Loading相关配置</span></span><br><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">mona-lisa</span>  <span class="comment"># 当前使用的Loading主题</span></span><br></pre></td></tr></table></figure><h4 id="2-检查Pug模板逻辑">2. 检查Pug模板逻辑</h4><p>在<code>themes/solitude/layout/includes/loading.pug</code>中发现关键逻辑：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//- Loading模板判断逻辑</span><br><span class="line">if theme.loading &amp;&amp; theme.loading.fullpage</span><br><span class="line">  if page.recommend || is_post()</span><br><span class="line">    //- 只有推荐文章或文章页面才显示Loading</span><br><span class="line">    include loading-mona-lisa.pug</span><br></pre></td></tr></table></figure><h4 id="3-定位核心问题">3. 定位核心问题</h4><p>通过浏览器开发者工具分析发现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 问题现象分析</span></span><br><span class="line"><span class="number">1.</span> <span class="title class_">Loading</span>动画正常播放和退场</span><br><span class="line"><span class="number">2.</span> <span class="title class_">Loading</span>完成后，<span class="variable constant_">TOC</span>的scroll事件监听器丢失</span><br><span class="line"><span class="number">3.</span> <span class="variable constant_">TOC</span>元素存在，但click和scroll事件无响应</span><br><span class="line"><span class="number">4.</span> aside的sticky定位失效，position值被重置</span><br></pre></td></tr></table></figure><h4 id="4-关键代码追踪">4. 关键代码追踪</h4><p>在<code>themes/solitude/source/js/main.js</code>中找到TOC初始化逻辑：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js 中的TOC初始化代码（第XX行）</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable constant_">PAGE_CONFIG</span>.<span class="property">toc</span>) toc.<span class="title function_">init</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// toc.init() 执行时机与Loading冲突</span></span><br><span class="line"><span class="comment">// Loading动画会延迟1.3秒，此时TOC已初始化</span></span><br><span class="line"><span class="comment">// 但Loading完成后，相关事件监听器被意外清理</span></span><br></pre></td></tr></table></figure><h2 id="第四步：修改问题">第四步：修改问题</h2><h3 id="📝-方案设计">📝 方案设计</h3><p>基于问题分析，制定三步修复方案：</p><ol><li><strong>CSS层面</strong>：添加全局Loading状态控制</li><li><strong>JavaScript层面</strong>：在Loading完成后重新初始化TOC和aside</li><li><strong>多主题适配</strong>：确保Mona Lisa和Black Cat主题都得到修复</li></ol><h3 id="🔧-具体修改内容">🔧 具体修改内容</h3><h4 id="修改1：CSS全局状态控制">修改1：CSS全局状态控制</h4><p><strong>文件</strong>：<code>themes/solitude/source/css/_layout/fullpage.styl</code></p><p><strong>修改前</strong>：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.fullpage&#x27;</span>)</span><br><span class="line">  <span class="comment">// Mona Lisa 主题样式</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.theme&#x27;</span>) == <span class="string">&#x27;mona-lisa&#x27;</span></span><br><span class="line">    <span class="selector-id">#loading-container</span></span><br><span class="line">      <span class="attribute">position</span> fixed</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#fff</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">flex-direction</span> column</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line">      <span class="attribute">justify-content</span> center</span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">9998</span></span><br><span class="line">      <span class="attribute">transition</span> transform <span class="number">1.3s</span> ease</span><br><span class="line">      <span class="attribute">will-change</span> transform</span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Quicksand&#x27;</span>, <span class="string">&#x27;Nunito&#x27;</span>, <span class="string">&#x27;Poppins&#x27;</span>, <span class="string">&#x27;Arial Rounded MT Bold&#x27;</span>, <span class="string">&#x27;PingFang SC&#x27;</span>, <span class="string">&#x27;Microsoft YaHei&#x27;</span>, sans-serif</span><br></pre></td></tr></table></figure><p><strong>修改后</strong>：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.fullpage&#x27;</span>)</span><br><span class="line">  <span class="comment">// 全局隐藏滚动条当loading显示时</span></span><br><span class="line">  <span class="selector-tag">body</span><span class="selector-class">.loading-active</span></span><br><span class="line">    <span class="attribute">overflow</span> hidden <span class="meta">!important</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100vh</span> <span class="meta">!important</span></span><br><span class="line">  </span><br><span class="line">  <span class="selector-tag">html</span><span class="selector-class">.loading-active</span></span><br><span class="line">    <span class="attribute">overflow</span> hidden <span class="meta">!important</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100vh</span> <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Mona Lisa 主题样式</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.theme&#x27;</span>) == <span class="string">&#x27;mona-lisa&#x27;</span></span><br><span class="line">    <span class="selector-id">#loading-container</span></span><br><span class="line">      <span class="attribute">position</span> fixed</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#fff</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">flex-direction</span> column</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line">      <span class="attribute">justify-content</span> center</span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">9998</span></span><br><span class="line">      <span class="attribute">transition</span> transform <span class="number">1.3s</span> ease</span><br><span class="line">      <span class="attribute">will-change</span> transform</span><br><span class="line">      <span class="attribute">overflow</span> hidden  # ← 新增</span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Quicksand&#x27;</span>, <span class="string">&#x27;Nunito&#x27;</span>, <span class="string">&#x27;Poppins&#x27;</span>, <span class="string">&#x27;Arial Rounded MT Bold&#x27;</span>, <span class="string">&#x27;PingFang SC&#x27;</span>, <span class="string">&#x27;Microsoft YaHei&#x27;</span>, sans-serif</span><br></pre></td></tr></table></figure><h4 id="修改2：Mona-Lisa主题JavaScript增强">修改2：Mona Lisa主题JavaScript增强</h4><p><strong>文件</strong>：<code>themes/solitude/source/js/custom/loading-theme-mona-lisa.js</code></p><p><strong>修改A：startAnimation函数</strong></p><p>修改前：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开始动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting Mona Lisa loading animation...&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 隐藏页面滚动条</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 标记loading正在运行，避免其他脚本冲突</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始描边动画</span></span><br><span class="line">    <span class="title function_">animatePaths</span>(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始模拟加载</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">simulateLoading</span>();</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开始动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting Mona Lisa loading animation...&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 隐藏页面滚动条 - 多种方式确保隐藏</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 标记loading正在运行，避免其他脚本冲突</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始描边动画</span></span><br><span class="line">    <span class="title function_">animatePaths</span>(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始模拟加载</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">simulateLoading</span>();</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>修改B：completeLoading函数</strong></p><p>修改前：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始的完成函数（简化版）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">completeLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 移除loading元素</span></span><br><span class="line">        <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (loadingContainer) loadingContainer.<span class="title function_">remove</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 恢复滚动</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 清除loading标记</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;, <span class="number">1300</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 完成loading动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">completeLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] Mona Lisa loading完成，开始清理&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 移除loading元素</span></span><br><span class="line">        <span class="keyword">const</span> loadingAnimation = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-animation&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (loadingAnimation) loadingAnimation.<span class="title function_">remove</span>();</span><br><span class="line">        <span class="keyword">const</span> loadingBg = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-bg&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (loadingBg) loadingBg.<span class="title function_">remove</span>();</span><br><span class="line">        <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (loadingContainer) loadingContainer.<span class="title function_">remove</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 兼容其它可能的遮罩</span></span><br><span class="line">        <span class="keyword">const</span> masks = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.mask, .overlay, .loading-mask, .loading-overlay&#x27;</span>);</span><br><span class="line">        masks.<span class="title function_">forEach</span>(<span class="function"><span class="params">el</span> =&gt;</span> el.<span class="title function_">remove</span>());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 恢复页面滚动 - 移除所有滚动限制</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 清除loading标记</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 触发pace-done事件</span></span><br><span class="line">        <span class="keyword">const</span> body = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (body) &#123;</span><br><span class="line">            body.<span class="property">className</span> = <span class="string">&#x27;pace-done&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 🔧 关键修复：重新初始化TOC和aside功能</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] Mona Lisa loading完成，开始重新初始化&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查必要的DOM元素</span></span><br><span class="line">            <span class="keyword">const</span> tocContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.toc&#x27;</span>);</span><br><span class="line">            <span class="keyword">const</span> articleContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.article-container&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] TOC容器存在:&#x27;</span>, !!tocContainer);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 文章容器存在:&#x27;</span>, !!articleContainer);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] PAGE_CONFIG.toc:&#x27;</span>, <span class="variable constant_">PAGE_CONFIG</span>?.<span class="property">toc</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 清理旧的scroll监听器，避免重复绑定</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">tocScrollFn</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 清理旧的scroll监听器&#x27;</span>);</span><br><span class="line">                <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">window</span>.<span class="property">tocScrollFn</span>);</span><br><span class="line">                <span class="variable language_">window</span>.<span class="property">tocScrollFn</span> = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 重新初始化TOC</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable constant_">PAGE_CONFIG</span>?.<span class="property">toc</span> &amp;&amp; <span class="keyword">typeof</span> toc !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 直接重新初始化TOC&#x27;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    toc.<span class="title function_">init</span>();</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] TOC初始化成功&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;[Loading] TOC初始化失败:&#x27;</span>, error);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">refreshFn</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 使用refreshFn重新初始化&#x27;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="variable language_">window</span>.<span class="title function_">refreshFn</span>();</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] refreshFn执行成功&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;[Loading] refreshFn执行失败:&#x27;</span>, error);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 强制触发浏览器重新计算和事件</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 触发scroll和resize事件&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 触发TOC滚动函数</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">tocScrollFn</span>) &#123;</span><br><span class="line">                    <span class="variable language_">window</span>.<span class="title function_">tocScrollFn</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 触发浏览器重新计算布局</span></span><br><span class="line">                <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;resize&#x27;</span>));</span><br><span class="line">                <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;scroll&#x27;</span>));</span><br><span class="line">            &#125;, <span class="number">200</span>);</span><br><span class="line">            </span><br><span class="line">        &#125;, <span class="number">800</span>); <span class="comment">// 增加延迟确保DOM稳定</span></span><br><span class="line">        </span><br><span class="line">    &#125;, <span class="number">1300</span>); <span class="comment">// loading动画完成延迟</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="修改3：Black-Cat主题同步修复">修改3：Black Cat主题同步修复</h4><p><strong>文件</strong>：<code>themes/solitude/source/js/custom/loading-theme-black-cat.js</code></p><p><strong>修改A：startAnimation函数</strong></p><p>修改前：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开始动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting Black Cat loading animation...&#x27;</span>);</span><br><span class="line">    isAnimating = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 隐藏页面滚动条</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 标记loading正在运行，避免其他脚本冲突</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始小猫动画</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">initAni</span>();</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开始动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting Black Cat loading animation...&#x27;</span>);</span><br><span class="line">    isAnimating = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 隐藏页面滚动条 - 多种方式确保隐藏</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 标记loading正在运行，避免其他脚本冲突</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始小猫动画</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">initAni</span>();</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>修改B：completeLoading函数</strong></p><p>修改前：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始完成函数（简化版）</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 移除 loading 相关遮罩</span></span><br><span class="line">    <span class="keyword">if</span> (loadingContainer) loadingContainer.<span class="title function_">remove</span>();</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// 清除loading标记</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;, <span class="number">1300</span>);</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 移除 loading 相关遮罩</span></span><br><span class="line">    <span class="keyword">if</span> (loadingContainer) loadingContainer.<span class="title function_">remove</span>();</span><br><span class="line">    <span class="comment">// 兼容其它可能的遮罩</span></span><br><span class="line">    <span class="keyword">const</span> masks = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.mask, .overlay, .loading-mask, .loading-overlay&#x27;</span>);</span><br><span class="line">    masks.<span class="title function_">forEach</span>(<span class="function"><span class="params">el</span> =&gt;</span> el.<span class="title function_">remove</span>());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 恢复页面滚动 - 移除所有滚动限制</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;loading-active&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清除loading标记</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">loadingInProgress</span> = <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 触发pace-done事件</span></span><br><span class="line">    <span class="keyword">const</span> bodyElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (bodyElement) &#123;</span><br><span class="line">        bodyElement.<span class="property">className</span> = <span class="string">&#x27;pace-done&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 🔧 关键修复：重新初始化TOC和aside功能（与Mona Lisa相同的逻辑）</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] Black Cat loading完成，开始重新初始化&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查必要的DOM元素</span></span><br><span class="line">        <span class="keyword">const</span> tocContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.toc&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> articleContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.article-container&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] TOC容器存在:&#x27;</span>, !!tocContainer);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 文章容器存在:&#x27;</span>, !!articleContainer);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] PAGE_CONFIG.toc:&#x27;</span>, <span class="variable constant_">PAGE_CONFIG</span>?.<span class="property">toc</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 清理旧的scroll监听器，避免重复绑定</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">tocScrollFn</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 清理旧的scroll监听器&#x27;</span>);</span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">window</span>.<span class="property">tocScrollFn</span>);</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">tocScrollFn</span> = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 重新初始化TOC</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable constant_">PAGE_CONFIG</span>?.<span class="property">toc</span> &amp;&amp; <span class="keyword">typeof</span> toc !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 直接重新初始化TOC&#x27;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                toc.<span class="title function_">init</span>();</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] TOC初始化成功&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;[Loading] TOC初始化失败:&#x27;</span>, error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">refreshFn</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 使用refreshFn重新初始化&#x27;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="title function_">refreshFn</span>();</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] refreshFn执行成功&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;[Loading] refreshFn执行失败:&#x27;</span>, error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 强制触发浏览器重新计算和事件</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[Loading] 触发scroll和resize事件&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 触发TOC滚动函数</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">tocScrollFn</span>) &#123;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="title function_">tocScrollFn</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 触发浏览器重新计算布局</span></span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;resize&#x27;</span>));</span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;scroll&#x27;</span>));</span><br><span class="line">        &#125;, <span class="number">200</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;, <span class="number">800</span>); <span class="comment">// 增加延迟确保DOM稳定</span></span><br><span class="line">    </span><br><span class="line">&#125;, <span class="number">1300</span>); <span class="comment">// loading动画完成延迟</span></span><br></pre></td></tr></table></figure><h3 id="🔧-修改汇总">🔧 修改汇总</h3><p>经过以上修改，我们总共修改了以下文件：</p><ol><li><strong>CSS文件</strong>：<code>themes/solitude/source/css/_layout/fullpage.styl</code></li><li><strong>Mona Lisa主题JS</strong>：<code>themes/solitude/source/js/custom/loading-theme-mona-lisa.js</code></li><li><strong>Black Cat主题JS</strong>：<code>themes/solitude/source/js/custom/loading-theme-black-cat.js</code></li></ol><h2 id="第五步：测试验证">第五步：测试验证</h2><h3 id="⚡-重新生成网站">⚡ 重新生成网站</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在项目根目录执行</span></span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure><h3 id="🧪-测试步骤详解">🧪 测试步骤详解</h3><h4 id="测试1：基本功能验证">测试1：基本功能验证</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试环境准备</span></span><br><span class="line">1. 清空浏览器缓存</span><br><span class="line">2. 刷新有Loading的文章页面</span><br><span class="line">3. 观察Loading动画播放</span><br><span class="line">4. 等待Loading完成后测试TOC功能</span><br></pre></td></tr></table></figure><p><strong>预期结果</strong>：</p><ul><li>✅ Loading动画正常播放1.3秒</li><li>✅ Loading完成后页面正常显示</li><li>✅ TOC目录可以点击跳转</li><li>✅ 滚动时TOC正确高亮当前章节</li><li>✅ aside侧边栏保持sticky定位</li></ul><h4 id="测试2：控制台调试验证">测试2：控制台调试验证</h4><p>打开浏览器开发者工具Console面板，查看调试信息：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 应该看到以下调试日志序列</span></span><br><span class="line">[<span class="title class_">Loading</span>] <span class="title class_">Starting</span> <span class="title class_">Mona</span> <span class="title class_">Lisa</span> loading animation...</span><br><span class="line">[<span class="title class_">Loading</span>] <span class="title class_">Mona</span> <span class="title class_">Lisa</span> loading完成，开始清理</span><br><span class="line">[<span class="title class_">Loading</span>] <span class="title class_">Mona</span> <span class="title class_">Lisa</span> loading完成，开始重新初始化</span><br><span class="line">[<span class="title class_">Loading</span>] <span class="variable constant_">TOC</span>容器存在: <span class="literal">true</span></span><br><span class="line">[<span class="title class_">Loading</span>] 文章容器存在: <span class="literal">true</span>  </span><br><span class="line">[<span class="title class_">Loading</span>] <span class="variable constant_">PAGE_CONFIG</span>.<span class="property">toc</span>: <span class="literal">true</span></span><br><span class="line">[<span class="title class_">Loading</span>] 清理旧的scroll监听器</span><br><span class="line">[<span class="title class_">Loading</span>] 直接重新初始化<span class="variable constant_">TOC</span></span><br><span class="line">[<span class="title class_">Loading</span>] <span class="variable constant_">TOC</span>初始化成功</span><br><span class="line">[<span class="title class_">Loading</span>] 触发scroll和resize事件</span><br></pre></td></tr></table></figure><h4 id="测试3：多主题兼容性测试">测试3：多主题兼容性测试</h4><p>测试两种Loading主题：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 _config.solitude.yml 中切换主题</span></span><br><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">mona-lisa</span>   <span class="comment"># 测试Mona Lisa主题</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后切换为</span></span><br><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span>  </span><br><span class="line">  <span class="attr">theme:</span> <span class="string">black-cat</span>   <span class="comment"># 测试Black Cat主题</span></span><br></pre></td></tr></table></figure><p><strong>两个主题都应该</strong>：</p><ul><li>✅ Loading动画正常</li><li>✅ TOC功能正常恢复</li><li>✅ aside功能正常恢复</li></ul><h4 id="测试4：滚动条隐藏验证">测试4：滚动条隐藏验证</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 验证Loading期间滚动条状态</span></span><br><span class="line">1. 刷新页面，立即观察右侧</span><br><span class="line">2. Loading期间应该完全没有滚动条</span><br><span class="line">3. Loading完成后页面滚动条正常显示</span><br></pre></td></tr></table></figure><h4 id="测试5：不同文章类型测试">测试5：不同文章类型测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试范围</span></span><br><span class="line">✅ 带有 recommend: <span class="literal">true</span> 的文章</span><br><span class="line">✅ 普通文章页面</span><br><span class="line">✅ 没有TOC的文章页面</span><br><span class="line">✅ 短文章（无需滚动）</span><br><span class="line">✅ 长文章（需要滚动）</span><br></pre></td></tr></table></figure><h3 id="📊-测试结果记录">📊 测试结果记录</h3><h4 id="修复前测试结果：">修复前测试结果：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">❌ TOC点击无响应</span><br><span class="line">❌ 滚动时TOC不高亮</span><br><span class="line">❌ aside不能固定定位</span><br><span class="line">❌ Loading页面有滚动条</span><br><span class="line">✅ Loading动画播放正常</span><br></pre></td></tr></table></figure><h4 id="修复后测试结果：">修复后测试结果：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">✅ TOC点击正常跳转</span><br><span class="line">✅ 滚动时TOC正确高亮  </span><br><span class="line">✅ aside正常固定定位</span><br><span class="line">✅ Loading页面无滚动条</span><br><span class="line">✅ Loading动画播放正常</span><br><span class="line">✅ 多主题都正常工作</span><br><span class="line">✅ 控制台无错误信息</span><br></pre></td></tr></table></figure><h3 id="🐛-问题排查指南">🐛 问题排查指南</h3><p>如果修复后仍有问题，按以下步骤排查：</p><h4 id="1-检查控制台错误">1. 检查控制台错误</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打开F12，查看Console是否有错误</span></span><br><span class="line"><span class="comment">// 常见错误信息：</span></span><br><span class="line"><span class="comment">// - Cannot read property &#x27;init&#x27; of undefined</span></span><br><span class="line"><span class="comment">// - toc is not defined  </span></span><br><span class="line"><span class="comment">// - PAGE_CONFIG is not defined</span></span><br></pre></td></tr></table></figure><h4 id="2-检查DOM元素">2. 检查DOM元素</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在控制台执行以下检查</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;TOC元素:&#x27;</span>, <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.toc&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;文章容器:&#x27;</span>, <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.article-container&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;PAGE_CONFIG:&#x27;</span>, <span class="variable constant_">PAGE_CONFIG</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;toc对象:&#x27;</span>, <span class="keyword">typeof</span> toc);</span><br></pre></td></tr></table></figure><h4 id="3-检查事件监听器">3. 检查事件监听器</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检查滚动事件监听器</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;tocScrollFn:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">tocScrollFn</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;监听器类型:&#x27;</span>, <span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">tocScrollFn</span>);</span><br></pre></td></tr></table></figure><h4 id="4-手动重新初始化测试">4. 手动重新初始化测试</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在控制台手动执行</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> toc !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">    toc.<span class="title function_">init</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;手动重新初始化TOC完成&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="💡-性能优化建议">💡 性能优化建议</h3><p>修复完成后，还可以考虑以下优化：</p><h4 id="1-减少重复DOM查询">1. 减少重复DOM查询</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 缓存DOM元素引用</span></span><br><span class="line"><span class="keyword">const</span> tocContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.toc&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> articleContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.article-container&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="2-条件执行重新初始化">2. 条件执行重新初始化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只在必要时重新初始化</span></span><br><span class="line"><span class="keyword">if</span> (tocContainer &amp;&amp; <span class="variable constant_">PAGE_CONFIG</span>?.<span class="property">toc</span>) &#123;</span><br><span class="line">    <span class="comment">// 执行重新初始化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-事件节流优化">3. 事件节流优化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对scroll事件进行节流处理</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">func, delay</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> timeoutId;</span><br><span class="line">    <span class="keyword">let</span> lastExecTime = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> currentTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        <span class="keyword">if</span> (currentTime - lastExecTime &gt; delay) &#123;</span><br><span class="line">            func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">            lastExecTime = currentTime;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timeoutId);</span><br><span class="line">            timeoutId = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">                lastExecTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">            &#125;, delay - (currentTime - lastExecTime));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结与经验">总结与经验</h2><h3 id="🎯-关键修复要点">🎯 关键修复要点</h3><ol><li><strong>正确的初始化时机</strong>：Loading完成后延迟800ms重新初始化</li><li><strong>事件监听器管理</strong>：清理旧监听器，避免重复绑定</li><li><strong>DOM状态检查</strong>：确保必要元素存在后再初始化</li><li><strong>强制事件触发</strong>：手动触发resize和scroll事件</li><li><strong>多重滚动控制</strong>：CSS class + inline style双重保障</li></ol><h3 id="🔧-调试技巧总结">🔧 调试技巧总结</h3><ol><li><strong>使用详细日志</strong>：添加console.log跟踪执行流程</li><li><strong>分步验证</strong>：逐步检查DOM、配置、函数可用性</li><li><strong>浏览器工具</strong>：善用Network、Console、Elements面板</li><li><strong>手动测试</strong>：控制台手动执行关键代码验证</li></ol><h3 id="🚀-扩展应用">🚀 扩展应用</h3><p>这个修复方案的思路可以应用到其他类似场景：</p><ul><li><strong>其他Loading主题冲突</strong></li><li><strong>Modal弹窗与页面功能冲突</strong></li><li><strong>动画效果与交互功能冲突</strong></li><li><strong>第三方插件与主题功能冲突</strong></li></ul><p>核心思路：<strong>识别冲突 → 调整时机 → 重新绑定 → 验证效果</strong></p><hr><p>通过本次完整的问题解决过程，我们不仅修复了Loading与TOC的冲突，还学会了系统性的前端问题排查和解决方法。这种方法论可以帮助我们应对更多复杂的魔改场景！</p><p><strong>下期预告</strong>：我们将探索更多Solitude主题的高级魔改技巧，敬请期待！</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> Loading </tag>
            
            <tag> JavaScript </tag>
            
            <tag> TOC </tag>
            
            <tag> 问题修复 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(17)-Banner图片和视频防复制防下载功能实现</title>
      <link href="/2025/01/15/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(17)-Banner%E5%9B%BE%E7%89%87%E5%92%8C%E8%A7%86%E9%A2%91%E9%98%B2%E5%A4%8D%E5%88%B6%E9%98%B2%E4%B8%8B%E8%BD%BD%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/"/>
      <url>/2025/01/15/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(17)-Banner%E5%9B%BE%E7%89%87%E5%92%8C%E8%A7%86%E9%A2%91%E9%98%B2%E5%A4%8D%E5%88%B6%E9%98%B2%E4%B8%8B%E8%BD%BD%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在博客运营过程中，我们经常会遇到原创图片和视频被盗用的问题。虽然无法完全阻止技术高手的恶意行为，但可以通过技术手段提高普通用户获取媒体文件的门槛。本教程将详细介绍如何为Solitude主题的Banner区域添加全面的防护功能。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>🔓 Banner图片和视频可以轻易通过右键保存</li><li>🔓 媒体文件可以通过拖拽方式保存到本地</li><li>🔓 开发者工具可以轻松获取媒体文件链接</li><li>🔓 视频控制栏提供下载选项</li><li>🔓 移动端长按可以保存图片</li></ul><h3 id="期望效果">期望效果</h3><ul><li>🔒 禁用右键菜单，防止直接保存</li><li>🔒 禁用拖拽功能，防止拖拽保存</li><li>🔒 拦截开发者工具相关快捷键</li><li>🔒 完全隐藏视频控制栏</li><li>🔒 移动端防长按保存</li><li>🔒 添加透明遮罩层防护</li><li>🔒 保持正常交互功能不受影响</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>缺乏防护机制</strong><br>Solitude主题默认未对Banner媒体文件进行任何保护</p></li><li><p><strong>用户体验考虑</strong><br>原生浏览器功能便于用户操作，但也带来了内容保护隐患</p></li><li><p><strong>技术实现复杂度</strong><br>需要平衡防护效果与用户体验，确保正常功能不受影响</p></li><li><p><strong>兼容性要求</strong><br>需要支持不同浏览器和移动设备的防护</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>themes/solitude/layout/includes/head.pug</code></li><li><code>themes/solitude/source/css/custom/banner-protection.css</code></li><li><code>themes/solitude/source/js/custom/banner-video.js</code></li><li><code>source/js/custom/banner-video.js</code></li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建防护CSS样式">1. 创建防护CSS样式</h3><p><strong>文件路径：</strong><br><code>themes/solitude/source/css/custom/banner-protection.css</code></p><p><strong>文件内容：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Banner图片和视频防护样式 */</span></span><br><span class="line"><span class="comment">/* Banner Image and Video Protection Styles */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 禁用选择和拖拽 */</span></span><br><span class="line"><span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.single</span><span class="selector-class">.sharePage</span>,</span><br><span class="line"><span class="selector-class">.todayCard-cover</span>,</span><br><span class="line"><span class="selector-class">.todayCard-video</span>,</span><br><span class="line"><span class="selector-id">#banner-video</span>,</span><br><span class="line"><span class="selector-class">.image-container</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.author-content</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.banner-video-container</span> &#123;</span><br><span class="line">    <span class="comment">/* 禁用文本选择 */</span></span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用拖拽 */</span></span><br><span class="line">    -webkit-user-drag: none;</span><br><span class="line">    -khtml-user-drag: none;</span><br><span class="line">    -moz-user-drag: none;</span><br><span class="line">    -o-user-drag: none;</span><br><span class="line">    user-drag: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用突出显示 */</span></span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    -webkit-tap-highlight-<span class="attribute">color</span>: transparent;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 防止长按保存 */</span></span><br><span class="line">    <span class="attribute">pointer-events</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 视频特殊防护 */</span></span><br><span class="line"><span class="selector-id">#banner-video</span>,</span><br><span class="line"><span class="selector-class">.todayCard-video</span>,</span><br><span class="line"><span class="selector-tag">video</span><span class="selector-attr">[id*=<span class="string">&quot;banner&quot;</span>]</span>,</span><br><span class="line"><span class="selector-tag">video</span><span class="selector-attr">[class*=<span class="string">&quot;banner&quot;</span>]</span> &#123;</span><br><span class="line">    <span class="comment">/* 禁用视频控制栏 */</span></span><br><span class="line">    -webkit-controls: none;</span><br><span class="line">    -moz-controls: none;</span><br><span class="line">    controls: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用右键菜单 */</span></span><br><span class="line">    -webkit-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    -moz-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用画中画 */</span></span><br><span class="line">    -webkit-<span class="selector-tag">picture</span>-in-<span class="selector-tag">picture</span>: none;</span><br><span class="line">    <span class="selector-tag">picture</span>-in-<span class="selector-tag">picture</span>: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 防止视频被选中 */</span></span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 图片特殊防护 */</span></span><br><span class="line"><span class="selector-class">.image-container</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-class">.author-content</span> <span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-tag">img</span><span class="selector-attr">[src*=<span class="string">&quot;banner&quot;</span>]</span>,</span><br><span class="line"><span class="selector-tag">img</span><span class="selector-attr">[class*=<span class="string">&quot;banner&quot;</span>]</span> &#123;</span><br><span class="line">    <span class="comment">/* 禁用图片拖拽 */</span></span><br><span class="line">    -webkit-user-drag: none;</span><br><span class="line">    -khtml-user-drag: none;</span><br><span class="line">    -moz-user-drag: none;</span><br><span class="line">    -o-user-drag: none;</span><br><span class="line">    user-drag: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 防止图片被选中 */</span></span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 禁用长按保存 */</span></span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 创建透明遮罩层防护 */</span></span><br><span class="line"><span class="selector-class">.banner-protection-overlay</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto;</span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 确保banner内容区域的层级正确 */</span></span><br><span class="line"><span class="selector-class">.author-content</span> <span class="selector-class">.card-content</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">15</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 移动端额外防护 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.single</span><span class="selector-class">.sharePage</span>,</span><br><span class="line">    <span class="selector-class">.todayCard-cover</span>,</span><br><span class="line">    <span class="selector-id">#banner-video</span>,</span><br><span class="line">    <span class="selector-class">.image-container</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">        <span class="comment">/* 禁用长按菜单 */</span></span><br><span class="line">        -webkit-touch-callout: none;</span><br><span class="line">        -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">        -khtml-<span class="attribute">user-select</span>: none;</span><br><span class="line">        -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">        -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">        <span class="attribute">user-select</span>: none;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 禁用双击缩放 */</span></span><br><span class="line">        <span class="attribute">touch-action</span>: manipulation;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 隐藏视频控制栏的所有可能实现 */</span></span><br><span class="line"><span class="selector-tag">video</span>::-webkit-media-controls,</span><br><span class="line">video::-webkit-media-controls-panel,</span><br><span class="line">video::-webkit-media-controls-play-button,</span><br><span class="line">video::-webkit-media-controls-volume-slider,</span><br><span class="line">video::-webkit-media-controls-mute-button,</span><br><span class="line">video::-webkit-media-controls-timeline,</span><br><span class="line">video::-webkit-media-controls-current-time-display,</span><br><span class="line">video::-webkit-media-controls-time-remaining-display,</span><br><span class="line">video::-webkit-media-controls-fullscreen-button &#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 防止视频暂停显示播放按钮 */</span></span><br><span class="line"><span class="selector-tag">video</span>::-webkit-media-controls-overlay-play-button &#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 额外的右键菜单禁用 */</span></span><br><span class="line"><span class="selector-class">.no-context-menu</span> &#123;</span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">    -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -khtml-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">    -ms-<span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    -webkit-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    -moz-context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">    context-<span class="selector-tag">menu</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-修改head-pug引入CSS">2. 修改head.pug引入CSS</h3><p><strong>文件路径：</strong><br><code>themes/solitude/layout/includes/head.pug</code></p><p><strong>修改前：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// index.css</span><br><span class="line">link(rel=&quot;stylesheet&quot;, href=url_for(theme.cdn.main_css))</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// index.css</span><br><span class="line">link(rel=&quot;stylesheet&quot;, href=url_for(theme.cdn.main_css))</span><br><span class="line"></span><br><span class="line">// banner protection css</span><br><span class="line">link(rel=&quot;stylesheet&quot;, href=url_for(&#x27;/css/custom/banner-protection.css&#x27;))</span><br></pre></td></tr></table></figure><h3 id="3-增强banner-video-js防护功能">3. 增强banner-video.js防护功能</h3><p><strong>文件路径：</strong><br><code>themes/solitude/source/js/custom/banner-video.js</code></p><p><strong>完整代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Banner视频播放控制和防护</span></span><br><span class="line"><span class="comment">// Banner Video Control and Protection</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 防护功能</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initBannerProtection</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 禁用右键菜单</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">disableContextMenu</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (element) &#123;</span><br><span class="line">                element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用拖拽</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">disableDrag</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (element) &#123;</span><br><span class="line">                element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragstart&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;drag&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用选择</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">disableSelection</span>(<span class="params">element</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (element) &#123;</span><br><span class="line">                element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;selectstart&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (e.<span class="property">detail</span> &gt; <span class="number">1</span>) &#123; <span class="comment">// 防止多次点击选择</span></span><br><span class="line">                        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 禁用键盘快捷键</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">disableKeyboardShortcuts</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="comment">// 禁用F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+S, Ctrl+A, Ctrl+P</span></span><br><span class="line">                <span class="keyword">if</span> (e.<span class="property">keyCode</span> === <span class="number">123</span> || <span class="comment">// F12</span></span><br><span class="line">                    (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; (e.<span class="property">keyCode</span> === <span class="number">73</span> || e.<span class="property">keyCode</span> === <span class="number">74</span>)) || <span class="comment">// Ctrl+Shift+I/J</span></span><br><span class="line">                    (e.<span class="property">ctrlKey</span> &amp;&amp; (e.<span class="property">keyCode</span> === <span class="number">85</span> || e.<span class="property">keyCode</span> === <span class="number">83</span> || e.<span class="property">keyCode</span> === <span class="number">65</span> || e.<span class="property">keyCode</span> === <span class="number">80</span>))) &#123; <span class="comment">// Ctrl+U/S/A/P</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">const</span> target = e.<span class="property">target</span>;</span><br><span class="line">                    <span class="keyword">const</span> isInBanner = target.<span class="title function_">closest</span>(<span class="string">&#x27;.author-content&#x27;</span>) || </span><br><span class="line">                                     target.<span class="title function_">closest</span>(<span class="string">&#x27;.todayCard-cover&#x27;</span>) || </span><br><span class="line">                                     target.<span class="property">id</span> === <span class="string">&#x27;banner-video&#x27;</span> ||</span><br><span class="line">                                     target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;todayCard-video&#x27;</span>);</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> (isInBanner) &#123;</span><br><span class="line">                        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                        e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 应用防护到所有banner元素</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">applyProtectionToElements</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// 保护banner视频</span></span><br><span class="line">            <span class="keyword">const</span> bannerVideos = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;#banner-video, .todayCard-video, video[id*=&quot;banner&quot;], video[class*=&quot;banner&quot;]&#x27;</span>);</span><br><span class="line">            bannerVideos.<span class="title function_">forEach</span>(<span class="function"><span class="params">video</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">disableContextMenu</span>(video);</span><br><span class="line">                <span class="title function_">disableDrag</span>(video);</span><br><span class="line">                <span class="title function_">disableSelection</span>(video);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 禁用视频控制栏</span></span><br><span class="line">                video.<span class="property">controls</span> = <span class="literal">false</span>;</span><br><span class="line">                video.<span class="property">controlsList</span> = <span class="string">&#x27;nodownload nofullscreen noremoteplayback&#x27;</span>;</span><br><span class="line">                video.<span class="property">disablePictureInPicture</span> = <span class="literal">true</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 防止暂停时显示播放按钮</span></span><br><span class="line">                video.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pause&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (video.<span class="property">paused</span>) &#123;</span><br><span class="line">                            video.<span class="title function_">play</span>().<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="number">100</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 添加透明遮罩层</span></span><br><span class="line">                <span class="keyword">if</span> (!video.<span class="property">parentElement</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.banner-protection-overlay&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">const</span> overlay = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">                    overlay.<span class="property">className</span> = <span class="string">&#x27;banner-protection-overlay&#x27;</span>;</span><br><span class="line">                    video.<span class="property">parentElement</span>.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;relative&#x27;</span>;</span><br><span class="line">                    video.<span class="property">parentElement</span>.<span class="title function_">appendChild</span>(overlay);</span><br><span class="line">                    </span><br><span class="line">                    <span class="title function_">disableContextMenu</span>(overlay);</span><br><span class="line">                    <span class="title function_">disableSelection</span>(overlay);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 保护banner图片</span></span><br><span class="line">            <span class="keyword">const</span> bannerImages = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.image-container img, .author-content img, img[src*=&quot;banner&quot;], img[class*=&quot;banner&quot;]&#x27;</span>);</span><br><span class="line">            bannerImages.<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">disableContextMenu</span>(img);</span><br><span class="line">                <span class="title function_">disableDrag</span>(img);</span><br><span class="line">                <span class="title function_">disableSelection</span>(img);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 添加透明遮罩层</span></span><br><span class="line">                <span class="keyword">if</span> (!img.<span class="property">parentElement</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.banner-protection-overlay&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">const</span> overlay = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">                    overlay.<span class="property">className</span> = <span class="string">&#x27;banner-protection-overlay&#x27;</span>;</span><br><span class="line">                    img.<span class="property">parentElement</span>.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;relative&#x27;</span>;</span><br><span class="line">                    img.<span class="property">parentElement</span>.<span class="title function_">appendChild</span>(overlay);</span><br><span class="line">                    </span><br><span class="line">                    <span class="title function_">disableContextMenu</span>(overlay);</span><br><span class="line">                    <span class="title function_">disableSelection</span>(overlay);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 保护整个banner容器</span></span><br><span class="line">            <span class="keyword">const</span> bannerContainers = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.author-content, .todayCard-cover&#x27;</span>);</span><br><span class="line">            bannerContainers.<span class="title function_">forEach</span>(<span class="function"><span class="params">container</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">disableContextMenu</span>(container);</span><br><span class="line">                <span class="title function_">disableSelection</span>(container);</span><br><span class="line">                container.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;no-context-menu&#x27;</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 初始化防护</span></span><br><span class="line">        <span class="title function_">applyProtectionToElements</span>();</span><br><span class="line">        <span class="title function_">disableKeyboardShortcuts</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 监听DOM变化，动态应用防护</span></span><br><span class="line">        <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="keyword">function</span>(<span class="params">mutations</span>) &#123;</span><br><span class="line">            mutations.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">mutation</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mutation.<span class="property">type</span> === <span class="string">&#x27;childList&#x27;</span>) &#123;</span><br><span class="line">                    mutation.<span class="property">addedNodes</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">node</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (node.<span class="property">nodeType</span> === <span class="number">1</span>) &#123; <span class="comment">// 元素节点</span></span><br><span class="line">                            <span class="keyword">const</span> videos = node.<span class="property">querySelectorAll</span> ? node.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;video&#x27;</span>) : [];</span><br><span class="line">                            <span class="keyword">const</span> images = node.<span class="property">querySelectorAll</span> ? node.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;img&#x27;</span>) : [];</span><br><span class="line">                            </span><br><span class="line">                            [...videos, ...images].<span class="title function_">forEach</span>(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">                                <span class="title function_">disableContextMenu</span>(element);</span><br><span class="line">                                <span class="title function_">disableDrag</span>(element);</span><br><span class="line">                                <span class="title function_">disableSelection</span>(element);</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        observer.<span class="title function_">observe</span>(<span class="variable language_">document</span>.<span class="property">body</span>, &#123;</span><br><span class="line">            <span class="attr">childList</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">subtree</span>: <span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取banner视频元素</span></span><br><span class="line">    <span class="keyword">const</span> bannerVideo = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;banner-video&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 视频播放控制</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initBannerVideo</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bannerVideo) &#123;</span><br><span class="line">            <span class="comment">// 确保视频自动播放</span></span><br><span class="line">            bannerVideo.<span class="title function_">play</span>().<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Video autoplay failed:&#x27;</span>, error);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 监听视频加载完成</span></span><br><span class="line">            bannerVideo.<span class="title function_">addEventListener</span>(<span class="string">&#x27;loadeddata&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Banner video loaded successfully&#x27;</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 监听视频错误</span></span><br><span class="line">            bannerVideo.<span class="title function_">addEventListener</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Banner video error:&#x27;</span>, error);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 等待DOM加载完成</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">initBannerProtection</span>();</span><br><span class="line">            <span class="title function_">initBannerVideo</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">initBannerProtection</span>();</span><br><span class="line">        <span class="title function_">initBannerVideo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 确保在页面完全加载后再次应用防护</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(initBannerProtection, <span class="number">500</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="4-同步文件到source目录">4. 同步文件到source目录</h3><p><strong>文件路径：</strong><br><code>source/js/custom/banner-video.js</code></p><p>将上述JavaScript代码同样复制到source目录中的对应文件。</p><hr><h2 id="防护功能详解">防护功能详解</h2><h3 id="🔒-CSS防护机制">🔒 CSS防护机制</h3><ol><li><p><strong>用户选择禁用</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">-moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">-ms-<span class="attribute">user-select</span>: none;</span><br><span class="line"><span class="attribute">user-select</span>: none;</span><br></pre></td></tr></table></figure></li><li><p><strong>拖拽功能禁用</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-webkit-user-drag: none;</span><br><span class="line">-khtml-user-drag: none;</span><br><span class="line">-moz-user-drag: none;</span><br><span class="line">-o-user-drag: none;</span><br><span class="line">user-drag: none;</span><br></pre></td></tr></table></figure></li><li><p><strong>视频控制栏隐藏</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">video</span>::-webkit-media-controls &#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="🔒-JavaScript防护机制">🔒 JavaScript防护机制</h3><ol><li><p><strong>右键菜单拦截</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">element.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p><strong>键盘快捷键拦截</strong></p><ul><li>F12（开发者工具）</li><li>Ctrl+Shift+I（检查元素）</li><li>Ctrl+U（查看源码）</li><li>Ctrl+S（保存页面）</li></ul></li><li><p><strong>透明遮罩层</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> overlay = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">overlay.<span class="property">className</span> = <span class="string">&#x27;banner-protection-overlay&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>动态防护应用</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="keyword">function</span>(<span class="params">mutations</span>) &#123;</span><br><span class="line">    <span class="comment">// 监听DOM变化，自动为新元素应用防护</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><hr><h2 id="技术特性说明">技术特性说明</h2><h3 id="⚡-性能优化">⚡ 性能优化</h3><ol><li><strong>事件委托</strong> - 减少事件监听器数量</li><li><strong>防抖技术</strong> - 避免重复执行防护逻辑</li><li><strong>选择器优化</strong> - 使用高效的CSS选择器</li></ol><h3 id="🎯-智能识别">🎯 智能识别</h3><ol><li><strong>自动检测</strong> - 自动识别banner相关的媒体元素</li><li><strong>动态应用</strong> - 新添加的元素自动获得防护</li><li><strong>精准定位</strong> - 只对banner区域应用防护</li></ol><h3 id="🔧-兼容性支持">🔧 兼容性支持</h3><ol><li><strong>浏览器兼容</strong> - 支持Webkit、Gecko、IE等内核</li><li><strong>移动端优化</strong> - 针对触摸设备的特殊防护</li><li><strong>降级处理</strong> - 不支持的浏览器优雅降级</li></ol><hr><h2 id="效果对比">效果对比</h2><h3 id="修改前">修改前</h3><ul><li>❌ 可以右键保存banner图片/视频</li><li>❌ 可以拖拽保存媒体文件</li><li>❌ F12可以轻松获取媒体链接</li><li>❌ 视频控制栏提供下载选项</li><li>❌ 移动端长按可以保存图片</li></ul><h3 id="修改后">修改后</h3><ul><li>✅ 右键菜单被完全禁用</li><li>✅ 拖拽功能被阻止</li><li>✅ 开发者工具快捷键被拦截</li><li>✅ 视频控制栏完全隐藏</li><li>✅ 移动端长按无保存选项</li><li>✅ 透明遮罩层额外防护</li><li>✅ 正常交互功能不受影响</li></ul><hr><h2 id="使用方法">使用方法</h2><h3 id="自动启用">自动启用</h3><p>防护功能无需额外配置，会在页面加载时自动启用：</p><ol><li>CSS样式自动应用到所有页面</li><li>JavaScript防护代码自动运行</li><li>动态内容自动获得保护</li></ol><h3 id="自定义配置">自定义配置</h3><p>如需调整防护范围，可修改JavaScript中的选择器：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改这些选择器来调整防护范围</span></span><br><span class="line"><span class="keyword">const</span> bannerVideos = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;#banner-video, .todayCard-video, video[id*=&quot;banner&quot;], video[class*=&quot;banner&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bannerImages = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.image-container img, .author-content img, img[src*=&quot;banner&quot;], img[class*=&quot;banner&quot;]&#x27;</span>);</span><br></pre></td></tr></table></figure><hr><h2 id="防护等级说明">防护等级说明</h2><h3 id="🥉-基础防护">🥉 基础防护</h3><ul><li>禁用右键菜单</li><li>禁用拖拽保存</li><li>禁用文本选择</li></ul><h3 id="🥈-中级防护">🥈 中级防护</h3><ul><li>键盘快捷键拦截</li><li>透明遮罩层覆盖</li><li>移动端长按防护</li></ul><h3 id="🥇-高级防护">🥇 高级防护</h3><ul><li>视频控制栏完全隐藏</li><li>画中画功能禁用</li><li>动态内容自动防护</li><li>开发者工具拦截</li></ul><hr><h2 id="注意事项">注意事项</h2><h3 id="⚠️-用户体验">⚠️ 用户体验</h3><ol><li><strong>功能保留</strong> - Banner上的交互按钮（如rightbtn）仍可正常使用</li><li><strong>范围限制</strong> - 防护仅针对banner区域，不影响网站其他功能</li><li><strong>性能影响</strong> - 防护功能对页面性能影响极小</li></ol><h3 id="⚠️-技术限制">⚠️ 技术限制</h3><ol><li><strong>不是万能的</strong> - 无法阻止高级用户通过网络面板等方式获取资源</li><li><strong>主要目的</strong> - 提高普通用户获取资源的门槛</li><li><strong>需要配合</strong> - 建议配合服务器端防盗链等措施</li></ol><h3 id="⚠️-兼容性">⚠️ 兼容性</h3><ol><li><strong>现代浏览器</strong> - 在Chrome、Firefox、Safari等现代浏览器中效果最佳</li><li><strong>移动设备</strong> - 对iOS Safari、Android Chrome等移动浏览器优化</li><li><strong>降级处理</strong> - 旧版浏览器会优雅降级，不影响基本功能</li></ol><hr><h2 id="故障排查">故障排查</h2><h3 id="1-防护不生效？">1. 防护不生效？</h3><ul><li>检查CSS文件是否正确加载</li><li>确认JavaScript文件无语法错误</li><li>清理浏览器缓存重新测试</li></ul><h3 id="2-交互功能受影响？">2. 交互功能受影响？</h3><ul><li>检查z-index层级设置</li><li>确认pointer-events属性配置</li><li>调整遮罩层的事件处理</li></ul><h3 id="3-移动端问题？">3. 移动端问题？</h3><ul><li>检查触摸事件相关CSS</li><li>确认viewport设置正确</li><li>测试不同移动设备</li></ul><hr><h2 id="扩展应用">扩展应用</h2><h3 id="应用到其他区域">应用到其他区域</h3><p>可以将防护机制扩展到博客的其他媒体内容：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 扩展到文章内容区域</span></span><br><span class="line"><span class="keyword">const</span> contentImages = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.post-content img&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> contentVideos = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.post-content video&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="增强防护级别">增强防护级别</h3><p>可以添加更多防护措施：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 禁用打印功能</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;beforeprint&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测开发者工具</span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerHeight</span> - <span class="variable language_">window</span>.<span class="property">innerHeight</span> &gt; <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><hr><h2 id="总结">总结</h2><p>通过本次魔改，我们为Solitude主题的Banner区域添加了全面的防护功能：</p><h3 id="🎯-主要成果">🎯 主要成果</h3><ol><li><strong>多层防护</strong> - CSS + JavaScript双重保护</li><li><strong>智能化</strong> - 自动识别和保护banner元素</li><li><strong>兼容性</strong> - 支持PC端和移动端</li><li><strong>用户友好</strong> - 不影响正常交互功能</li><li><strong>可扩展</strong> - 易于调整和扩展防护范围</li></ol><h3 id="🔮-防护效果">🔮 防护效果</h3><ul><li>有效阻止普通用户的简单保存操作</li><li>提高了媒体文件获取的技术门槛</li><li>保护了博客的原创内容</li><li>维持了良好的用户体验</li></ul><p>虽然无法做到绝对的防护，但这套方案已经能够有效保护你的banner内容，让大部分访客无法轻易获取和使用你的原创图片和视频素材。</p><p>记住，内容保护是一个持续的过程，建议结合服务器端的防盗链、水印等措施，构建更完善的版权保护体系。</p><hr><p><em>更新时间: 2025-01-15</em><br><em>教程版本: v1.0.0</em></p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> Banner </tag>
            
            <tag> 防护功能 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(16)-双Loading界面主题分离实现</title>
      <link href="/2024/12/16/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(16)-%E5%8F%8CLoading%E7%95%8C%E9%9D%A2%E4%B8%BB%E9%A2%98%E5%88%86%E7%A6%BB%E5%AE%9E%E7%8E%B0/"/>
      <url>/2024/12/16/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(16)-%E5%8F%8CLoading%E7%95%8C%E9%9D%A2%E4%B8%BB%E9%A2%98%E5%88%86%E7%A6%BB%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>本次更新实现了Solitude主题loading界面的完全独立分离，支持 <strong>Mona Lisa</strong> 和 <strong>Black Cat</strong> 两种主题风格，通过配置文件可以轻松切换。两个主题完全独立，无重复样式，Black Cat主题完全基于原始创意svg加载loading小猫动画实现。</p><hr><h2 id="🎯-双主题概述">🎯 双主题概述</h2><h3 id="主题对比">主题对比</h3><table><thead><tr><th>特性</th><th>Mona Lisa 主题</th><th>Black Cat 主题</th></tr></thead><tbody><tr><td><strong>风格</strong></td><td>艺术感SVG描边</td><td>可爱小猫动画</td></tr><tr><td><strong>动画库</strong></td><td>原生CSS+JS</td><td>GSAP TweenMax</td></tr><tr><td><strong>主色调</strong></td><td>蓝色 (#409EFF)</td><td>灰色 (#E4E5E6)</td></tr><tr><td><strong>核心动画</strong></td><td>SVG描边循环</td><td>小猫跳跃动画</td></tr><tr><td><strong>进度显示</strong></td><td>分步进度条</td><td>小猫动作状态</td></tr><tr><td><strong>收起方式</strong></td><td>双层滑动收起</td><td>直接滑动收起</td></tr><tr><td><strong>适用场景</strong></td><td>专业/艺术类网站</td><td>个人/可爱风网站</td></tr></tbody></table><h3 id="配置方式">配置方式</h3><p>在 <code>_config.solitude.yml</code> 中配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">black-cat</span>  <span class="comment"># 可选值: mona-lisa / black-cat</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><hr><h2 id="📁-文件结构">📁 文件结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">themes/solitude/</span><br><span class="line">├── layout/includes/</span><br><span class="line">│   └── loading.pug                    # 主题判断和HTML结构</span><br><span class="line">├── source/css/_layout/</span><br><span class="line">│   └── fullpage.styl                  # 主题CSS样式分离</span><br><span class="line">└── source/js/custom/</span><br><span class="line">    ├── loading-theme-mona-lisa.js     # Mona Lisa主题JS</span><br><span class="line">    ├── loading-theme-black-cat.js     # Black Cat主题JS</span><br><span class="line">    └── README.html                    # 说明文档</span><br></pre></td></tr></table></figure><hr><h2 id="🎨-主题特性详解">🎨 主题特性详解</h2><h3 id="🖼️-Mona-Lisa-主题">🖼️ Mona Lisa 主题</h3><h4 id="核心特性">核心特性</h4><ul><li><strong>SVG描边动画</strong>: 复杂的SVG图形描边效果</li><li><strong>文字故障效果</strong>: 使用伪元素实现的故障动画</li><li><strong>进度条模拟</strong>: 模拟真实加载进度</li><li><strong>双重收起动画</strong>: 分层的收起效果</li><li><strong>颜色方案</strong>: 蓝色主题 (#409EFF)</li><li><strong>独立样式</strong>: 完全独立的CSS和JS实现</li></ul><h4 id="视觉效果">视觉效果</h4><ul><li>蓝色背景层带浮动装饰SVG</li><li>白色前景层承载主要内容</li><li>复杂SVG路径的循环描边动画</li><li>&quot;Loading&quot;文字的故障效果</li><li>5步分阶段的进度条加载</li></ul><h3 id="🐱-Black-Cat-主题">🐱 Black Cat 主题</h3><h4 id="核心特性-2">核心特性</h4><ul><li><strong>小猫动画</strong>: 完全基于原始创意svg加载loading小猫动画</li><li><strong>GSAP动画库</strong>: 使用TweenMax实现复杂动画</li><li><strong>直接跳转</strong>: 小猫跳跃后直接收起loading，跳转到真实主页</li><li><strong>响应式设计</strong>: 支持移动端适配</li><li><strong>颜色方案</strong>: 灰色主题 (#E4E5E6)</li><li><strong>原始特性保留</strong>: 完全保留原始动画的所有细节</li><li><strong>独立样式</strong>: 完全独立的CSS和JS实现</li><li><strong>全屏遮罩</strong>: 修复了loading时主页内容显示的问题</li></ul><h4 id="视觉效果-2">视觉效果</h4><ul><li>灰色全屏背景</li><li>可爱的SVG小猫角色</li><li>小猫眨眼、摆尾、跳跃动画序列</li><li>&quot;LOADING&quot;文字动态显示</li><li>跳跃完成后直接收起</li></ul><hr><h2 id="🛠️-完整实装代码">🛠️ 完整实装代码</h2><h3 id="1-主题判断和HTML结构-loading-pug">1. 主题判断和HTML结构 - loading.pug</h3><p><strong>文件路径：</strong> <code>themes/solitude/layout/includes/loading.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">// Mona Lisa 主题</span><br><span class="line">if theme.loading.theme == &#x27;mona-lisa&#x27;</span><br><span class="line">  div(id=&quot;loading-container&quot;)</span><br><span class="line">    // Loading 背景层</span><br><span class="line">    div#loading-bg</span><br><span class="line">        // 已移除内联SVG，外部SVG背景由CSS或img实现</span><br><span class="line">    // Loading 动画层</span><br><span class="line">    div#loading-animation</span><br><span class="line">        div#loading-box</span><br><span class="line">            svg.loading-svg(viewBox=&quot;0 0 400.98 400.98&quot;)</span><br><span class="line">                g</span><br><span class="line">                    // 外框</span><br><span class="line">                    path.draw-path(d=&quot;M354.526,2H46.454c-2.209,0-4,1.791-4,4v388.98c0,2.209,1.791,4,4,4h308.072c2.209,0,4-1.791,4-4V6C358.526,3.791,356.735,2,354.526,2z&quot;)</span><br><span class="line">                    // 内框合并</span><br><span class="line">                    path.draw-path.blue-path(d=&quot;M50.454,10 H350.526 V390.98 H50.454 V10 Z&quot;)</span><br><span class="line">                    // LOGO主体路径</span><br><span class="line">                    path.draw-path.blue-path(d=&quot;M189.11,128.898c2.209,0,4-1.791,4-4v-11.822l7.326,0.318c2.215,0.105,4.074-1.615,4.17-3.822 c0.096-2.207-1.615-4.074-3.822-4.17l-11.5-0.5c-1.104-0.053-2.152,0.353-2.94,1.106c-0.788,0.755-1.233,1.799-1.233,2.89v16 C185.11,127.107,186.901,128.898,189.11,128.898z&quot;)</span><br><span class="line">                    path.draw-path.blue-path(d=&quot;M186.175,304.806c-1.707-1.4-4.229-1.152-5.629,0.557c-1.401,1.708-1.151,4.229,0.557,5.629l25,20.5 c0.744,0.61,1.642,0.907,2.534,0.907c1.156,0,2.305-0.499,3.095-1.464c1.401-1.708,1.151-4.229-0.557-5.629L186.175,304.806z&quot;)</span><br><span class="line">                    path.draw-path.blue-path(d=&quot;M266.781,219.901c-24.928-0.923-34.529,18.514-36.09,28.849l-5.5,33.5c-0.357,2.181,1.119,4.237,3.299,4.596 c0.22,0.036,0.438,0.054,0.653,0.054c1.924,0,3.62-1.393,3.942-3.353l5.508-33.552c0.142-0.938,3.788-22.949,27.902-22.1 c2.187,0.078,4.061-1.646,4.14-3.854C270.715,221.833,268.989,219.98,266.781,219.901z&quot;)</span><br><span class="line">                    // ... 更多复杂的SVG路径</span><br><span class="line">                    path.draw-path(d=&quot;M79.841,357.983c0,2.209,1.791,4,4,4h233.298c2.209,0,4-1.791,4-4V42.998c0-2.209-1.791-4-4-4H83.841c-2.209,0-4,1.791-4,4V357.983z&quot;)</span><br><span class="line">                    // ... 省略部分复杂路径，实际使用时需要完整路径</span><br><span class="line">            </span><br><span class="line">            div.loading-text(data-glitch=&quot;Loading&quot;) Loading</span><br><span class="line">            div.progress-bar</span><br><span class="line">                div.progress-fill#progress-fill</span><br><span class="line"></span><br><span class="line">  // 引入Mona Lisa主题的JavaScript文件</span><br><span class="line">  script(src=&quot;/js/custom/loading-theme-mona-lisa.js&quot;)</span><br><span class="line"></span><br><span class="line">// Black Cat 主题 - 基于原始创意svg加载loading小猫动画</span><br><span class="line">if theme.loading.theme == &#x27;black-cat&#x27;</span><br><span class="line">  div(id=&quot;loading-container&quot;)</span><br><span class="line">    div.wrapper-no7</span><br><span class="line">      div.logo LOADING</span><br><span class="line">      div.animation-wrapper</span><br><span class="line">        div.cat-wrapper</span><br><span class="line">          svg.cat(xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 207.68 163.77&quot; preserveAspectRatio=&quot;none&quot;)</span><br><span class="line">            title cat</span><br><span class="line">            g.body</span><br><span class="line">              circle.body-backcircle(cx=&quot;76.86&quot; cy=&quot;83.31&quot; r=&quot;45.5&quot;)</span><br><span class="line">              circle.body-frontcircle(cx=&quot;150.86&quot; cy=&quot;83.31&quot; r=&quot;45.5&quot;)</span><br><span class="line">              rect.body-between(x=&quot;74.65&quot; y=&quot;37.89&quot; width=&quot;83.04&quot; height=&quot;90.61&quot;)</span><br><span class="line">            circle.head(cx=&quot;161.76&quot; cy=&quot;52.75&quot; r=&quot;45.92&quot;)</span><br><span class="line">            g.eyes</span><br><span class="line">              circle.eyes-l(cx=&quot;153.51&quot; cy=&quot;46.5&quot; r=&quot;8.25&quot;)</span><br><span class="line">              circle.eyes-r(cx=&quot;185.76&quot; cy=&quot;46.5&quot; r=&quot;8.25&quot;)</span><br><span class="line">            g.ears</span><br><span class="line">              polygon.ears-l(points=&quot;132.76 19 132.76 0 149.55 8.81 132.76 19&quot;)</span><br><span class="line">              polygon.ears-r(points=&quot;179.44 11.2 197 4.06 195.16 22.9 179.44 11.2&quot;)</span><br><span class="line">            rect.tail(x=&quot;-11&quot; y=&quot;32.87&quot; width=&quot;107&quot; height=&quot;20&quot; rx=&quot;9.58&quot; ry=&quot;9.58&quot; transform=&quot;translate(41.19 -18.41) rotate(45)&quot;)</span><br><span class="line">            g.backlegs</span><br><span class="line">              path.backlegs1(d=&quot;M74,124.85a6,6,0,0,0-4.7-7.07l-4.41-.89a6,6,0,0,0-7.07,4.7l-6.31,31.35a8.25,8.25,0,1,0,15.64,5,5.94,5.94,0,0,0,.44-1.33Z&quot; transform=&quot;translate(-1.58 -0.92)&quot;)</span><br><span class="line">              path.backlegs2(d=&quot;M88.22,125.86a6,6,0,0,0-4.38-7.27l-4.37-1.08a6,6,0,0,0-7.27,4.38l-7.69,31a8.25,8.25,0,1,0,15.41,5.72,5.94,5.94,0,0,0,.5-1.31Z&quot; transform=&quot;translate(-1.58 -0.92)&quot;)</span><br><span class="line">            g.frontlegs</span><br><span class="line">              path.frontlegs1(d=&quot;M162.89,120.91a6,6,0,0,0-7.65-3.68L151,118.72a6,6,0,0,0-3.68,7.65l10.57,30.18a8.25,8.25,0,1,0,16-3.65,5.94,5.94,0,0,0-.3-1.37Z&quot; transform=&quot;translate(-1.58 -0.92)&quot;)</span><br><span class="line">              path.frontlegs2(d=&quot;M175.77,120.08a6,6,0,0,0-7.48-4l-4.31,1.3a6,6,0,0,0-4,7.48l9.22,30.62a8.25,8.25,0,1,0,16.17-2.94,5.94,5.94,0,0,0-.24-1.38Z&quot; transform=&quot;translate(-1.58 -0.92)&quot;)</span><br><span class="line">        div.logoani LOADING</span><br><span class="line">      button.restart restart animation</span><br><span class="line"></span><br><span class="line">  // 引入GSAP动画库</span><br><span class="line">  script(src=&quot;https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.2/TweenMax.min.js&quot;)</span><br><span class="line">  // 引入Black Cat主题的JavaScript文件</span><br><span class="line">  script(src=&quot;/js/custom/loading-theme-black-cat.js&quot;)</span><br></pre></td></tr></table></figure><h3 id="2-主题CSS样式分离-fullpage-styl">2. 主题CSS样式分离 - fullpage.styl</h3><p><strong>文件路径：</strong> <code>themes/solitude/source/css/_layout/fullpage.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.fullpage&#x27;</span>)</span><br><span class="line">  <span class="comment">// Mona Lisa 主题样式 - 完全独立</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.theme&#x27;</span>) == <span class="string">&#x27;mona-lisa&#x27;</span></span><br><span class="line">    <span class="selector-id">#loading-container</span></span><br><span class="line">      <span class="attribute">position</span> fixed</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#fff</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">flex-direction</span> column</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line">      <span class="attribute">justify-content</span> center</span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">9999</span></span><br><span class="line">      <span class="attribute">transition</span> transform <span class="number">1.3s</span> ease</span><br><span class="line">      <span class="attribute">will-change</span> transform</span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Quicksand&#x27;</span>, <span class="string">&#x27;Nunito&#x27;</span>, <span class="string">&#x27;Poppins&#x27;</span>, <span class="string">&#x27;Arial Rounded MT Bold&#x27;</span>, <span class="string">&#x27;PingFang SC&#x27;</span>, <span class="string">&#x27;Microsoft YaHei&#x27;</span>, sans-serif</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loading 背景层 - 第二个收起的层</span></span><br><span class="line">    <span class="selector-id">#loading-bg</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#409EFF</span></span><br><span class="line">      <span class="attribute">transition</span> transform <span class="number">1.3s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.25</span>, <span class="number">0.46</span>, <span class="number">0.45</span>, <span class="number">0.94</span>)</span><br><span class="line">      <span class="attribute">transition-delay</span> <span class="number">0.3s</span></span><br><span class="line">      <span class="attribute">will-change</span> transform</span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">1</span></span><br><span class="line">      <span class="attribute">overflow</span> hidden</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 背景装饰SVG效果</span></span><br><span class="line">    <span class="selector-class">.loading-bg-svg</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">width</span> <span class="number">30%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">30%</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">0.6</span></span><br><span class="line">      <span class="attribute">animation</span> bgFloat <span class="number">20s</span> ease-in-out infinite</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建重复的背景效果 - 使用外部SVG文件</span></span><br><span class="line">    <span class="selector-id">#loading-bg</span><span class="selector-pseudo">::before</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="string">&#x27;/img/loading_bg.svg&#x27;</span>)</span><br><span class="line">      <span class="attribute">background-size</span> <span class="number">30%</span></span><br><span class="line">      <span class="attribute">background-repeat</span> repeat</span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">0.6</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 背景浮动动画</span></span><br><span class="line">    <span class="keyword">@keyframes</span> bgFloat</span><br><span class="line">      <span class="number">0%</span>, <span class="number">100%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">translate</span>(<span class="number">0</span>, <span class="number">0</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>)</span><br><span class="line">      <span class="number">25%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">translate</span>(<span class="number">10px</span>, -<span class="number">10px</span>) <span class="built_in">rotate</span>(<span class="number">1deg</span>)</span><br><span class="line">      <span class="number">50%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">translate</span>(-<span class="number">5px</span>, <span class="number">5px</span>) <span class="built_in">rotate</span>(-<span class="number">1deg</span>)</span><br><span class="line">      <span class="number">75%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">translate</span>(<span class="number">5px</span>, -<span class="number">5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span> <span class="selector-id">#loading-bg</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loading 动画层 - 第一个收起的层（前景）</span></span><br><span class="line">    <span class="selector-id">#loading-animation</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">flex-direction</span> column</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line">      <span class="attribute">justify-content</span> center</span><br><span class="line">      <span class="attribute">background</span> <span class="number">#fff</span></span><br><span class="line">      <span class="attribute">transition</span> transform <span class="number">1.3s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.25</span>, <span class="number">0.46</span>, <span class="number">0.45</span>, <span class="number">0.94</span>)</span><br><span class="line">      <span class="attribute">will-change</span> transform</span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span> <span class="selector-id">#loading-animation</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// SVG容器样式</span></span><br><span class="line">    <span class="selector-class">.loading-svg</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">400px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">      <span class="attribute">display</span> block</span><br><span class="line">      <span class="attribute">margin</span> <span class="number">60px</span> auto <span class="number">20px</span> auto</span><br><span class="line"></span><br><span class="line">    <span class="comment">// SVG描边路径样式</span></span><br><span class="line">    <span class="selector-class">.draw-path</span></span><br><span class="line">      <span class="attribute">stroke</span> <span class="number">#222</span></span><br><span class="line">      <span class="attribute">stroke-width</span> <span class="number">4</span></span><br><span class="line">      <span class="attribute">fill</span> none</span><br><span class="line">      <span class="attribute">stroke-linecap</span> round</span><br><span class="line">      <span class="attribute">stroke-linejoin</span> round</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.draw-path</span>, <span class="selector-class">.draw-path</span><span class="selector-attr">[stroke-width]</span></span><br><span class="line">      <span class="attribute">stroke-width</span> <span class="number">4</span> <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.blue-path</span></span><br><span class="line">      <span class="attribute">stroke</span> <span class="number">#409EFF</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">@keyframes</span> draw</span><br><span class="line">      to</span><br><span class="line">        <span class="attribute">stroke-dashoffset</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loading 文字容器</span></span><br><span class="line">    <span class="selector-id">#loading-box</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">flex-direction</span> column</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Loading 文字样式和故障效果</span></span><br><span class="line">    <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span></span><br><span class="line">      <span class="attribute">text-align</span> center</span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">28px</span></span><br><span class="line">      <span class="attribute">color</span> <span class="number">#363636</span></span><br><span class="line">      <span class="attribute">margin-top</span> <span class="number">1rem</span></span><br><span class="line">      <span class="attribute">letter-spacing</span> .<span class="number">3rem</span></span><br><span class="line">      <span class="attribute">font-weight</span> <span class="number">900</span></span><br><span class="line">      <span class="attribute">position</span> relative</span><br><span class="line">      <span class="attribute">line-height</span> <span class="number">1.2</span></span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">1</span></span><br><span class="line">      -webkit-<span class="attribute">animation</span> shift <span class="number">1s</span> ease-in-out infinite alternate</span><br><span class="line">      <span class="attribute">animation</span> shift <span class="number">1s</span> ease-in-out infinite alternate</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:before</span></span><br><span class="line">      -webkit-<span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) both infinite</span><br><span class="line">      <span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) both infinite</span><br><span class="line">      <span class="attribute">color</span> <span class="number">#c28b00</span></span><br><span class="line">      <span class="attribute">z-index</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:after</span></span><br><span class="line">      -webkit-<span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) reverse both infinite</span><br><span class="line">      <span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) reverse both infinite</span><br><span class="line">      <span class="attribute">color</span> <span class="number">#57bd6a</span></span><br><span class="line">      <span class="attribute">z-index</span> -<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:after</span>,</span><br><span class="line">    <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:before</span></span><br><span class="line">      <span class="attribute">display</span> block</span><br><span class="line">      <span class="attribute">content</span> <span class="built_in">attr</span>(data-glitch)</span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">opacity</span> .<span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 故障效果动画</span></span><br><span class="line">    <span class="keyword">@keyframes</span> glitch</span><br><span class="line">      <span class="number">0%</span></span><br><span class="line">        <span class="attribute">text-shadow</span> <span class="number">3px</span> <span class="number">0</span> <span class="number">#ff0033</span>, -<span class="number">3px</span> <span class="number">0</span> <span class="number">#fff</span></span><br><span class="line">      <span class="number">20%</span></span><br><span class="line">        <span class="attribute">text-shadow</span> -<span class="number">3px</span> -<span class="number">3px</span> <span class="number">#ff0033</span>, <span class="number">3px</span> <span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">      <span class="number">40%</span></span><br><span class="line">        <span class="attribute">text-shadow</span> <span class="number">3px</span> <span class="number">3px</span> <span class="number">#ff0033</span>, -<span class="number">3px</span> -<span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">      <span class="number">60%</span></span><br><span class="line">        <span class="attribute">text-shadow</span> -<span class="number">3px</span> <span class="number">3px</span> <span class="number">#ff0033</span>, <span class="number">3px</span> -<span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">      <span class="number">80%</span></span><br><span class="line">        <span class="attribute">text-shadow</span> <span class="number">3px</span> -<span class="number">3px</span> <span class="number">#ff0033</span>, -<span class="number">3px</span> <span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">      <span class="number">100%</span></span><br><span class="line">        <span class="attribute">text-shadow</span> -<span class="number">3px</span> <span class="number">0</span> <span class="number">#ff0033</span>, <span class="number">3px</span> <span class="number">0</span> <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文字偏移动画</span></span><br><span class="line">    <span class="keyword">@keyframes</span> shift</span><br><span class="line">      <span class="number">0%</span>,<span class="number">100%</span>,<span class="number">40%</span>,<span class="number">44%</span>,<span class="number">58%</span>,<span class="number">61%</span>,<span class="number">65%</span>,<span class="number">69%</span>,<span class="number">73%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">0</span>)</span><br><span class="line">      <span class="number">41%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">10deg</span>)</span><br><span class="line">      <span class="number">42%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(-<span class="number">10deg</span>)</span><br><span class="line">      <span class="number">59%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">40deg</span>) <span class="built_in">skewY</span>(<span class="number">10deg</span>)</span><br><span class="line">      <span class="number">60%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(-<span class="number">40deg</span>) <span class="built_in">skewY</span>(-<span class="number">10deg</span>)</span><br><span class="line">      <span class="number">63%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">10deg</span>) <span class="built_in">skewY</span>(-<span class="number">5deg</span>)</span><br><span class="line">      <span class="number">70%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(-<span class="number">50deg</span>) <span class="built_in">skewY</span>(-<span class="number">20deg</span>)</span><br><span class="line">      <span class="number">71%</span></span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">10deg</span>) <span class="built_in">skewY</span>(-<span class="number">10deg</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 进度条样式</span></span><br><span class="line">    <span class="selector-class">.progress-bar</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">4px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#f0f0f0</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">2px</span></span><br><span class="line">      <span class="attribute">margin-top</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">overflow</span> hidden</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.progress-fill</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="number">#409EFF</span>, <span class="number">#57bd6a</span>)</span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">2px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">0%</span></span><br><span class="line">      <span class="attribute">transition</span> width <span class="number">0.3s</span> ease</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Black Cat 主题样式 - 基于原始创意svg加载loading小猫动画</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.theme&#x27;</span>) == <span class="string">&#x27;black-cat&#x27;</span></span><br><span class="line">    <span class="comment">// Black Cat 全屏遮罩容器</span></span><br><span class="line">    <span class="selector-id">#loading-container</span></span><br><span class="line">      <span class="attribute">position</span> fixed</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100vh</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#E4E5E6</span></span><br><span class="line">      <span class="attribute">z-index</span> <span class="number">9999</span></span><br><span class="line">      <span class="attribute">transition</span> transform <span class="number">1.3s</span> ease</span><br><span class="line">      <span class="attribute">will-change</span> transform</span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">align-items</span> center</span><br><span class="line">      <span class="attribute">justify-content</span> center</span><br><span class="line">      <span class="attribute">overflow</span> hidden</span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Delius Swash Caps&#x27;</span>, cursive</span><br><span class="line">      <span class="attribute">text-align</span> center</span><br><span class="line">      <span class="attribute">color</span> <span class="number">#004466</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">justify-content</span> center</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.animation-wrapper</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.animation-wrapper</span><span class="selector-class">.notvisible</span></span><br><span class="line">      <span class="attribute">display</span> none</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.cat</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">80%</span></span><br><span class="line">      <span class="attribute">overflow</span> visible</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.cat-wrapper</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.eyes</span> <span class="selector-tag">circle</span></span><br><span class="line">      <span class="attribute">fill</span> <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.frontlegs</span>,</span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.backlegs</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.logoani</span></span><br><span class="line">      <span class="attribute">align-self</span> flex-end</span><br><span class="line">      <span class="attribute">margin-left</span> -<span class="number">25px</span></span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">45px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.logo</span></span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">55px</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> -<span class="number">40px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.logo</span><span class="selector-class">.visible</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line">      <span class="attribute">top</span> <span class="number">40px</span></span><br><span class="line">      <span class="attribute">transition</span> all <span class="number">1s</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.restart</span></span><br><span class="line">      <span class="attribute">display</span> none</span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">50%</span></span><br><span class="line">      <span class="attribute">background-color</span> white</span><br><span class="line">      <span class="attribute">border</span> <span class="number">#bbbbbb</span> <span class="number">1px</span> solid</span><br><span class="line">      <span class="attribute">box-shadow</span> none</span><br><span class="line">      <span class="attribute">padding</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">10px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.restart</span><span class="selector-pseudo">:hover</span></span><br><span class="line">      <span class="attribute">background-color</span> <span class="number">#ddd</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.wrapper-no7</span> <span class="selector-class">.restart</span><span class="selector-class">.visible</span></span><br><span class="line">      <span class="attribute">display</span> block</span><br></pre></td></tr></table></figure><h3 id="3-Mona-Lisa主题JavaScript-loading-theme-mona-lisa-js">3. Mona Lisa主题JavaScript - loading-theme-mona-lisa.js</h3><p><strong>文件路径：</strong> <code>themes/solitude/source/js/custom/loading-theme-mona-lisa.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Loading Theme Mona Lisa - Solitude Theme Loading Animation</span></span><br><span class="line"><span class="comment"> * Mona Lisa主题的loading动画实现</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 功能：</span></span><br><span class="line"><span class="comment"> * - SVG描边动画</span></span><br><span class="line"><span class="comment"> * - 进度条模拟</span></span><br><span class="line"><span class="comment"> * - 双重收起动画</span></span><br><span class="line"><span class="comment"> * - Pjax兼容</span></span><br><span class="line"><span class="comment"> * - 超时保护</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待DOM加载完成</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="variable constant_">DURATION</span> = <span class="number">1.5</span>; <span class="comment">// 动画时长（秒）</span></span><br><span class="line">        <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">let</span> progress = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> isAnimating = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 进度条更新</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">updateProgress</span>(<span class="params">percent</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> progressFill = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;progress-fill&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (progressFill) &#123;</span><br><span class="line">                progressFill.<span class="property">style</span>.<span class="property">width</span> = percent + <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// SVG描边动画</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">animatePaths</span>(<span class="params">appear</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> paths = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.draw-path&#x27;</span>));</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (paths.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;No draw-path elements found&#x27;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 1. 先全部 transition 设为 none，设置起始状态</span></span><br><span class="line">            paths.<span class="title function_">forEach</span>(<span class="function"><span class="params">path</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> len = path.<span class="title function_">getTotalLength</span>();</span><br><span class="line">                path.<span class="property">style</span>.<span class="property">strokeDasharray</span> = len;</span><br><span class="line">                path.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">                path.<span class="property">style</span>.<span class="property">strokeDashoffset</span> = appear ? len : <span class="number">0</span>;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2. 强制重绘</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3. 统一设置 transition 和目标状态</span></span><br><span class="line">            paths.<span class="title function_">forEach</span>(<span class="function"><span class="params">path</span> =&gt;</span> &#123;</span><br><span class="line">                path.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">`stroke-dashoffset <span class="subst">$&#123;DURATION&#125;</span>s linear`</span>;</span><br><span class="line">                path.<span class="property">style</span>.<span class="property">strokeDashoffset</span> = appear ? <span class="number">0</span> : path.<span class="property">style</span>.<span class="property">strokeDasharray</span>;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4. 动画结束后切换状态</span></span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!isAnimating) &#123;</span><br><span class="line">                    <span class="title function_">animatePaths</span>(!appear);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="variable constant_">DURATION</span> * <span class="number">1000</span> + <span class="number">50</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 模拟加载过程</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">simulateLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> loadingSteps = [</span><br><span class="line">                &#123; <span class="attr">progress</span>: <span class="number">20</span>, <span class="attr">delay</span>: <span class="number">500</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">progress</span>: <span class="number">40</span>, <span class="attr">delay</span>: <span class="number">800</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">progress</span>: <span class="number">60</span>, <span class="attr">delay</span>: <span class="number">600</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">progress</span>: <span class="number">80</span>, <span class="attr">delay</span>: <span class="number">700</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">progress</span>: <span class="number">100</span>, <span class="attr">delay</span>: <span class="number">1000</span> &#125;</span><br><span class="line">            ];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> currentStep = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">nextStep</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (currentStep &lt; loadingSteps.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="keyword">const</span> step = loadingSteps[currentStep];</span><br><span class="line">                    <span class="title function_">updateProgress</span>(step.<span class="property">progress</span>);</span><br><span class="line">                    currentStep++;</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> (currentStep &lt; loadingSteps.<span class="property">length</span>) &#123;</span><br><span class="line">                        <span class="built_in">setTimeout</span>(nextStep, step.<span class="property">delay</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 加载完成，开始收起动画</span></span><br><span class="line">                        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                            <span class="title function_">completeLoading</span>();</span><br><span class="line">                        &#125;, <span class="number">500</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="title function_">nextStep</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 完成加载 - 双层收起动画</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">completeLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line">            isAnimating = <span class="literal">true</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 停止描边动画</span></span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 第一次收起：loading-animation 层先收起</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> loadingAnimation = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-animation&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> (loadingAnimation) &#123;</span><br><span class="line">                    loadingAnimation.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateX(100%)&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 第二次收起：loading-bg 层延迟收起</span></span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> loadingBg = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-bg&#x27;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loadingBg) &#123;</span><br><span class="line">                        loadingBg.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateX(100%)&#x27;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// 最后收起整个容器</span></span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (loadingContainer) &#123;</span><br><span class="line">                            loadingContainer.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateX(100%)&#x27;</span>;</span><br><span class="line">                            </span><br><span class="line">                            <span class="comment">// 收起完成后移除 loading 容器</span></span><br><span class="line">                            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                <span class="comment">// 移除 loading 相关遮罩</span></span><br><span class="line">                                <span class="keyword">const</span> loadingBg = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-bg&#x27;</span>);</span><br><span class="line">                                <span class="keyword">if</span> (loadingBg) loadingBg.<span class="title function_">remove</span>();</span><br><span class="line">                                <span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">                                <span class="keyword">if</span> (loadingContainer) loadingContainer.<span class="title function_">remove</span>();</span><br><span class="line">                                <span class="comment">// 兼容其它可能的遮罩</span></span><br><span class="line">                                <span class="keyword">const</span> masks = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.mask, .overlay, .loading-mask, .loading-overlay&#x27;</span>);</span><br><span class="line">                                masks.<span class="title function_">forEach</span>(<span class="function"><span class="params">el</span> =&gt;</span> el.<span class="title function_">remove</span>());</span><br><span class="line">                                <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;auto&#x27;</span>;</span><br><span class="line">                                <span class="comment">// 触发pace-done事件</span></span><br><span class="line">                                <span class="keyword">const</span> body = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">                                <span class="keyword">if</span> (body) &#123;</span><br><span class="line">                                    body.<span class="property">className</span> = <span class="string">&#x27;pace-done&#x27;</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="comment">// 确保页面回到顶部</span></span><br><span class="line">                                <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                                <span class="comment">// 延迟触发一次 percent 函数，确保初始值正确</span></span><br><span class="line">                                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (<span class="keyword">typeof</span> percent === <span class="string">&#x27;function&#x27;</span>) <span class="title function_">percent</span>();</span><br><span class="line">                                &#125;, <span class="number">100</span>);</span><br><span class="line">                            &#125;, <span class="number">300</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="number">300</span>);</span><br><span class="line">                &#125;, <span class="number">300</span>);</span><br><span class="line">            &#125;, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开始动画</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">startAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting Mona Lisa loading animation...&#x27;</span>);</span><br><span class="line">            <span class="comment">// 开始描边动画</span></span><br><span class="line">            <span class="title function_">animatePaths</span>(<span class="literal">true</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 开始模拟加载</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">simulateLoading</span>();</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 页面加载完成后开始动画</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, startAnimation);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">startAnimation</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Pjax兼容</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:send&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Pjax send event triggered for Mona Lisa theme&#x27;</span>);</span><br><span class="line">            <span class="comment">// 重新创建loading容器</span></span><br><span class="line">            <span class="keyword">const</span> existingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (existingContainer) &#123;</span><br><span class="line">                existingContainer.<span class="title function_">remove</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 重新初始化loading</span></span><br><span class="line">            isAnimating = <span class="literal">false</span>;</span><br><span class="line">            progress = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 重新开始动画</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">animatePaths</span>(<span class="literal">true</span>);</span><br><span class="line">                <span class="title function_">simulateLoading</span>();</span><br><span class="line">            &#125;, <span class="number">100</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 超时保护</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isAnimating) &#123;</span><br><span class="line">                <span class="title function_">completeLoading</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">8000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="4-Black-Cat主题JavaScript-loading-theme-black-cat-js">4. Black Cat主题JavaScript - loading-theme-black-cat.js</h3><p><strong>文件路径：</strong> <code>themes/solitude/source/js/custom/loading-theme-black-cat.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Loading Theme Black Cat - Solitude Theme Loading Animation</span></span><br><span class="line"><span class="comment"> * Black Cat主题的loading动画实现</span></span><br><span class="line"><span class="comment"> * 完全基于原始创意svg加载loading小猫动画</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 功能：</span></span><br><span class="line"><span class="comment"> * - 小猫动画</span></span><br><span class="line"><span class="comment"> * - GSAP动画库</span></span><br><span class="line"><span class="comment"> * - 页面布局动画</span></span><br><span class="line"><span class="comment"> * - Pjax兼容</span></span><br><span class="line"><span class="comment"> * - 超时保护</span></span><br><span class="line"><span class="comment"> * - 收起动画</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="keyword">const</span> cat = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.cat&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> catBody = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.body&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> head = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.head&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> eyes = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.eyes circle&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> eyel = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.eyes-l&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> eyer = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.eyes-r&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ears = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.ears&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> earsl = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.ears-l&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> earsr = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.ears-r&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> tail = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.tail&#x27;</span>); </span><br><span class="line"><span class="keyword">const</span> backlegs = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.backlegs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> frontlegs = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.frontlegs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> frontlegs1 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.frontlegs1&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> backcircle = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.body-backcircle&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> frontcircle = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.body-frontcircle&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodybetween = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.body-between&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> logo = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.logoani&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> logofix = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.logo&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> resetbutton = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.restart&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ani = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.animation-wrapper&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> loadingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> isAnimating = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> animationComplete = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//start-animation</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initAni</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="keyword">const</span> tl = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>(&#123;<span class="attr">delay</span>:<span class="number">0.5</span>, <span class="attr">onComplete</span>:completeLoading&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//logo</span></span><br><span class="line">tl.<span class="title function_">fromTo</span>(logo, <span class="number">0.3</span>, &#123;<span class="attr">autoAlpha</span>:<span class="number">0</span>, <span class="attr">y</span>:-<span class="number">30</span>&#125;,&#123;<span class="attr">autoAlpha</span>:<span class="number">1</span>, <span class="attr">y</span>:<span class="number">0</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">  .<span class="title function_">fromTo</span>(cat, <span class="number">0.3</span>, &#123;<span class="attr">autoAlpha</span>:<span class="number">0</span>, <span class="attr">y</span>:-<span class="number">30</span>&#125;,&#123;<span class="attr">autoAlpha</span>:<span class="number">1</span>, <span class="attr">y</span>:<span class="number">0</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;, <span class="string">&quot;-=0.2&quot;</span>)</span><br><span class="line">  .<span class="title function_">fromTo</span>(cat, <span class="number">2</span>, &#123;<span class="attr">scale</span>:<span class="number">0.8</span>&#125;,&#123;<span class="attr">scale</span>:<span class="number">1</span>, <span class="attr">transformOrigin</span>:<span class="string">&quot;center center&quot;</span>, <span class="attr">ease</span>:<span class="title class_">Elastic</span>.<span class="property">easeOut</span>.<span class="title function_">config</span>(<span class="number">1</span>, <span class="number">0.3</span>)&#125;, <span class="string">&quot;-=0.1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//eyes</span></span><br><span class="line"><span class="keyword">const</span> tleyes = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>(&#123;<span class="attr">delay</span>:<span class="number">2</span>, <span class="attr">repeat</span>:-<span class="number">1</span>, <span class="attr">yoyo</span>:<span class="literal">true</span>, <span class="attr">repeatDelay</span>:<span class="number">3</span>&#125;);</span><br><span class="line">tleyes.<span class="title function_">to</span>(eyes, <span class="number">0.01</span>, &#123;<span class="attr">scaleY</span>:<span class="number">0.1</span>, <span class="attr">transformOrigin</span>:<span class="string">&quot;center center&quot;</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">      .<span class="title function_">to</span>(eyes, <span class="number">0.01</span>, &#123;<span class="attr">scaleY</span>:<span class="number">1</span>, <span class="attr">transformOrigin</span>:<span class="string">&quot;center center&quot;</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ears</span></span><br><span class="line"><span class="keyword">const</span> tlears = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>(&#123;<span class="attr">delay</span>:<span class="number">1</span>, <span class="attr">repeat</span>:-<span class="number">1</span>, <span class="attr">yoyo</span>:<span class="literal">true</span>, <span class="attr">repeatDelay</span>:<span class="number">1</span>&#125;);</span><br><span class="line">tlears.<span class="title function_">to</span>(earsl, <span class="number">1</span>, &#123;<span class="attr">rotation</span>:<span class="number">10</span>, <span class="attr">transformOrigin</span>:<span class="string">&quot;center bottom&quot;</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">      .<span class="title function_">to</span>(earsr, <span class="number">1</span>, &#123;<span class="attr">rotation</span>:-<span class="number">10</span>, <span class="attr">transformOrigin</span>:<span class="string">&quot;center bottom&quot;</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;, <span class="string">&quot;-=1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//tail</span></span><br><span class="line"><span class="keyword">const</span> tltail = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>(&#123;<span class="attr">delay</span>:<span class="number">0.5</span>, <span class="attr">repeat</span>:-<span class="number">1</span>, <span class="attr">yoyo</span>:<span class="literal">true</span>&#125;);</span><br><span class="line">tltail.<span class="title function_">to</span>(tail, <span class="number">1</span>, &#123;<span class="attr">rotation</span>: <span class="string">&quot;+=10&quot;</span>, <span class="attr">transformOrigin</span>:<span class="string">&quot;left center&quot;</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//moving</span></span><br><span class="line"><span class="keyword">const</span> tlmove = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>(&#123;<span class="attr">delay</span>:<span class="number">3</span>&#125;);</span><br><span class="line">tlmove.<span class="title function_">to</span>(cat, <span class="number">2</span>, &#123;<span class="attr">y</span>:-<span class="number">100</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">      .<span class="title function_">to</span>(cat, <span class="number">0.7</span>, &#123;<span class="attr">y</span>:<span class="number">0</span>, <span class="attr">ease</span>:<span class="title class_">Bounce</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">      .<span class="title function_">to</span>(cat, <span class="number">2</span>, &#123;<span class="attr">y</span>:-<span class="number">100</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">      .<span class="title function_">to</span>(cat, <span class="number">0.7</span>, &#123;<span class="attr">y</span>:<span class="number">0</span>, <span class="attr">ease</span>:<span class="title class_">Bounce</span>.<span class="property">easeOut</span>&#125;)</span><br><span class="line">      .<span class="title function_">to</span>(cat, <span class="number">2</span>, &#123;<span class="attr">y</span>:-<span class="number">300</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 完成loading动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">completeLoading</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (animationComplete) <span class="keyword">return</span>;</span><br><span class="line">animationComplete = <span class="literal">true</span>;</span><br><span class="line">isAnimating = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Black Cat animation completed, hiding loading...&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接收起loading容器</span></span><br><span class="line"><span class="keyword">if</span> (loadingContainer) &#123;</span><br><span class="line">loadingContainer.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&#x27;translateX(100%)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动画完成后移除容器</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (loadingContainer) &#123;</span><br><span class="line">loadingContainer.<span class="title function_">remove</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 恢复页面状态</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;auto&#x27;</span>;</span><br><span class="line"><span class="comment">// 触发pace-done事件</span></span><br><span class="line"><span class="keyword">const</span> body = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (body) &#123;</span><br><span class="line">body.<span class="property">className</span> = <span class="string">&#x27;pace-done&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 确保页面回到顶部</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// 延迟触发一次 percent 函数，确保初始值正确</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> percent === <span class="string">&#x27;function&#x27;</span>) <span class="title function_">percent</span>();</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;, <span class="number">1300</span>); <span class="comment">// 等待CSS动画完成</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// restart-button</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">restart</span>(<span class="params"></span>)&#123;</span><br><span class="line">isAnimating = <span class="literal">false</span>;</span><br><span class="line">animationComplete = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">const</span> tl = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>();</span><br><span class="line">tl.<span class="title function_">set</span>([cat, logo], &#123;<span class="attr">clearProps</span>:<span class="string">&quot;all&quot;</span>&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Black Cat animation restarted&#x27;</span>);</span><br><span class="line"><span class="title function_">initAni</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否需要重启</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkRestart</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(resetbutton)&#123;</span><br><span class="line">resetbutton.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, restart);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始动画</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startBlackCatAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting Black Cat loading animation...&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!isAnimating &amp;&amp; !animationComplete) &#123;</span><br><span class="line">isAnimating = <span class="literal">true</span>;</span><br><span class="line"><span class="title function_">initAni</span>();</span><br><span class="line"><span class="title function_">checkRestart</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面加载完成后开始动画</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, startBlackCatAnimation);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="title function_">startBlackCatAnimation</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pjax兼容性</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:send&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Pjax send event triggered for Black Cat theme&#x27;</span>);</span><br><span class="line"><span class="comment">// 重新创建loading容器</span></span><br><span class="line"><span class="keyword">const</span> existingContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-container&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (existingContainer) &#123;</span><br><span class="line">existingContainer.<span class="title function_">remove</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新初始化状态</span></span><br><span class="line">isAnimating = <span class="literal">false</span>;</span><br><span class="line">animationComplete = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新开始动画</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="title function_">startBlackCatAnimation</span>();</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 超时保护</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (!animationComplete) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Black Cat animation timeout, forcing completion...&#x27;</span>);</span><br><span class="line"><span class="title function_">completeLoading</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;, <span class="number">10000</span>); <span class="comment">// 10秒超时</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><h2 id="🔧-关键技术实现细节">🔧 关键技术实现细节</h2><h3 id="1-完全独立的配置判断">1. 完全独立的配置判断</h3><h4 id="CSS层面">CSS层面</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Mona Lisa 主题样式 - 完全独立</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.theme&#x27;</span>) == <span class="string">&#x27;mona-lisa&#x27;</span></span><br><span class="line">  <span class="comment">// Mona Lisa 特定样式，无重复</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Black Cat 主题样式 - 完全独立  </span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.theme&#x27;</span>) == <span class="string">&#x27;black-cat&#x27;</span></span><br><span class="line">  <span class="comment">// Black Cat 特定样式，完全基于原始实现</span></span><br></pre></td></tr></table></figure><h4 id="HTML层面">HTML层面</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Mona Lisa 主题 - 完全独立</span><br><span class="line">if theme.loading.theme == &#x27;mona-lisa&#x27;</span><br><span class="line">  // Mona Lisa HTML结构，使用loading-container</span><br><span class="line"></span><br><span class="line">// Black Cat 主题 - 完全独立</span><br><span class="line">if theme.loading.theme == &#x27;black-cat&#x27;</span><br><span class="line">  // Black Cat HTML结构，添加全屏遮罩容器</span><br></pre></td></tr></table></figure><h3 id="2-JavaScript完全独立">2. JavaScript完全独立</h3><ul><li><strong>Mona Lisa</strong>: 专注于SVG描边动画和进度条，使用IIFE封装</li><li><strong>Black Cat</strong>: 完全基于原始实现，直接使用原始动画逻辑，添加收起动画</li></ul><h3 id="3-CSS样式完全独立">3. CSS样式完全独立</h3><ul><li><strong>Mona Lisa</strong>: 双层结构，蓝白配色，故障文字效果</li><li><strong>Black Cat</strong>: 单层结构，灰色背景，小猫动画样式</li></ul><hr><h2 id="🎬-动画执行流程对比">🎬 动画执行流程对比</h2><h3 id="Mona-Lisa-动画流程">Mona Lisa 动画流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">开始 → SVG描边循环 → 进度条分步 → 双层收起</span><br><span class="line">  ↓        ↓           ↓         ↓</span><br><span class="line">DOM就绪  描边动画      5步进度   前景→背景→容器</span><br><span class="line">  ↓        ↓           ↓         ↓</span><br><span class="line">1000ms   循环1.5s     3600ms    分层收起</span><br></pre></td></tr></table></figure><h3 id="Black-Cat-动画流程">Black Cat 动画流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">开始 → 小猫出现 → 眨眼摆尾 → 跳跃动画 → 直接收起</span><br><span class="line">  ↓       ↓        ↓        ↓        ↓</span><br><span class="line">DOM就绪  缩放弹性  循环动作  三次跳跃  滑动收起</span><br><span class="line">  ↓       ↓        ↓        ↓        ↓</span><br><span class="line">500ms   2000ms   3000ms   7000ms   直接移除</span><br></pre></td></tr></table></figure><hr><h2 id="📦-修复内容详解">📦 修复内容详解</h2><h3 id="Black-Cat主题全屏遮罩修复">Black Cat主题全屏遮罩修复</h3><h4 id="问题">问题</h4><p>Black Cat主题在loading时主页内容会显示出来，没有全屏遮罩效果。</p><h4 id="解决方案">解决方案</h4><ol><li><strong>HTML结构修复</strong>：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Black Cat 主题 - 基于原始创意svg加载loading小猫动画</span><br><span class="line">if theme.loading.theme == &#x27;black-cat&#x27;</span><br><span class="line">  div(id=&quot;loading-container&quot;)  // 添加全屏遮罩容器</span><br><span class="line">    div.wrapper-no7</span><br><span class="line">      // ... 原始HTML结构</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>CSS样式修复</strong>：</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Black Cat 全屏遮罩容器</span></span><br><span class="line"><span class="selector-id">#loading-container</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">background</span> <span class="number">#E4E5E6</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">9999</span></span><br><span class="line">  <span class="attribute">transition</span> transform <span class="number">1.3s</span> ease</span><br><span class="line">  <span class="attribute">will-change</span> transform</span><br><span class="line">  <span class="attribute">display</span> flex</span><br><span class="line">  <span class="attribute">align-items</span> center</span><br><span class="line">  <span class="attribute">justify-content</span> center</span><br><span class="line">  <span class="attribute">overflow</span> hidden</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>JavaScript修复</strong>：</li></ol><ul><li>添加了 <code>completeLoading()</code> 函数</li><li>在动画完成后自动收起loading容器</li><li>添加了Pjax兼容和超时保护</li></ul><h3 id="Black-Cat主题直接跳转修复">Black Cat主题直接跳转修复</h3><h4 id="问题-2">问题</h4><p>小猫跳跃后显示假的layout页面，而不是直接跳转到真实主页。</p><h4 id="解决方案-2">解决方案</h4><ol><li><strong>移除假页面元素</strong>：</li></ol><ul><li>移除了所有layout相关的HTML元素</li><li>简化了HTML结构</li></ul><ol start="2"><li><strong>移除假页面样式</strong>：</li></ol><ul><li>移除了所有layout相关的CSS样式</li><li>减少了CSS体积</li></ul><ol start="3"><li><strong>修改动画逻辑</strong>：</li></ol><ul><li>将动画完成回调从 <code>logoVisible</code> 改为 <code>completeLoading</code></li><li>移除了对layout元素的引用</li><li>小猫跳跃后直接收起loading容器</li></ul><hr><h2 id="🔍-使用配置详解">🔍 使用配置详解</h2><h3 id="基础配置">基础配置</h3><p>在 <code>_config.solitude.yml</code> 中配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">mona-lisa</span>  <span class="comment"># 或 black-cat</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="主题切换">主题切换</h3><h4 id="切换到Mona-Lisa主题">切换到Mona Lisa主题</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">mona-lisa</span></span><br></pre></td></tr></table></figure><p><strong>特点</strong>: SVG艺术风、双层动画、进度条、蓝色主题</p><h4 id="切换到Black-Cat主题">切换到Black Cat主题</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">black-cat</span></span><br></pre></td></tr></table></figure><p><strong>特点</strong>: 小猫动画、GSAP动画、跳跃效果、灰色主题</p><h3 id="高级配置">高级配置</h3><h4 id="禁用Loading">禁用Loading</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h4 id="仅启用顶部进度条">仅启用顶部进度条</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><hr><h2 id="🎨-自定义和扩展">🎨 自定义和扩展</h2><h3 id="1-修改Mona-Lisa主题颜色">1. 修改Mona Lisa主题颜色</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改主色调</span></span><br><span class="line"><span class="selector-id">#loading-bg</span></span><br><span class="line">  <span class="attribute">background</span> #your-color  // 替换 <span class="number">#409EFF</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.blue-path</span></span><br><span class="line">  <span class="attribute">stroke</span> #your-color      // 替换 <span class="number">#409EFF</span></span><br></pre></td></tr></table></figure><h3 id="2-调整Black-Cat动画时间">2. 调整Black Cat动画时间</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改动画延迟和时长</span></span><br><span class="line"><span class="keyword">const</span> tl = <span class="keyword">new</span> <span class="title class_">TimelineMax</span>(&#123;<span class="attr">delay</span>:<span class="number">0.5</span>, <span class="attr">onComplete</span>:completeLoading&#125;);</span><br><span class="line">tl.<span class="title function_">fromTo</span>(logo, <span class="number">0.3</span>, &#123;<span class="attr">autoAlpha</span>:<span class="number">0</span>, <span class="attr">y</span>:-<span class="number">30</span>&#125;,&#123;<span class="attr">autoAlpha</span>:<span class="number">1</span>, <span class="attr">y</span>:<span class="number">0</span>, <span class="attr">ease</span>:<span class="title class_">Power2</span>.<span class="property">easeOut</span>&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-添加新的Loading主题">3. 添加新的Loading主题</h3><ol><li>在 <code>loading.pug</code> 中添加新的判断条件</li><li>在 <code>fullpage.styl</code> 中添加新主题样式</li><li>创建新的JavaScript文件处理动画逻辑</li></ol><h3 id="4-自定义SVG路径">4. 自定义SVG路径</h3><p>修改 <code>loading.pug</code> 中的SVG path元素，可以创建自己的描边图案。</p><hr><h2 id="🔧-常见问题解决">🔧 常见问题解决</h2><h3 id="1-主题切换不生效">1. 主题切换不生效</h3><ul><li>检查配置文件中 <code>loading.theme</code> 是否正确</li><li>清除浏览器缓存</li><li>重新生成站点</li></ul><h3 id="2-Black-Cat动画不显示">2. Black Cat动画不显示</h3><ul><li>确保GSAP库正确加载</li><li>检查控制台是否有JavaScript错误</li><li>验证SVG元素是否存在</li></ul><h3 id="3-Mona-Lisa描边动画不工作">3. Mona Lisa描边动画不工作</h3><ul><li>检查SVG路径是否完整</li><li>验证CSS样式是否正确应用</li><li>确认stroke-dasharray设置</li></ul><h3 id="4-动画卡住不收起">4. 动画卡住不收起</h3><ul><li>检查超时保护机制</li><li>验证completeLoading函数是否正确调用</li><li>查看控制台错误信息</li></ul><h3 id="5-Pjax兼容性问题">5. Pjax兼容性问题</h3><ul><li>确保事件监听器正确绑定</li><li>检查页面切换时的状态重置</li><li>验证loading容器的重新创建</li></ul><hr><h2 id="📋-总结">📋 总结</h2><p>通过本教程的实装，您的Solitude主题将拥有两套完全独立的Loading界面：</p><h3 id="🖼️-Mona-Lisa主题优势">🖼️ Mona Lisa主题优势</h3><ul><li><strong>艺术感强</strong>: SVG描边动画营造艺术氛围</li><li><strong>技术展示</strong>: 复杂的前端动画技术</li><li><strong>专业感</strong>: 适合技术类、设计类网站</li><li><strong>用户体验</strong>: 分步进度条提供明确反馈</li></ul><h3 id="🐱-Black-Cat主题优势">🐱 Black Cat主题优势</h3><ul><li><strong>可爱风格</strong>: 小猫动画增加亲和力</li><li><strong>动画流畅</strong>: GSAP库确保动画质量</li><li><strong>个性化</strong>: 独特的小猫IP形象</li><li><strong>简洁高效</strong>: 直接的动画流程</li></ul><h3 id="🔧-技术亮点">🔧 技术亮点</h3><ul><li><strong>完全分离</strong>: 两套主题互不干扰</li><li><strong>配置简单</strong>: 一行配置即可切换</li><li><strong>性能优化</strong>: 按需加载，硬件加速</li><li><strong>兼容性强</strong>: 支持Pjax、移动端适配</li><li><strong>易于扩展</strong>: 模块化设计，便于添加新主题</li></ul><p>这套双Loading界面系统不仅为用户提供了丰富的选择，也展示了前端动画技术的多样性和创造力！🎉✨</p><hr><h2 id="🚀-扩展建议">🚀 扩展建议</h2><ol><li><strong>添加更多主题</strong>: 基于现有架构添加新的Loading主题</li><li><strong>音效支持</strong>: 为动画添加音效增强体验</li><li><strong>自定义配置</strong>: 提供更多可配置的动画参数</li><li><strong>响应式优化</strong>: 针对不同设备尺寸优化动画</li><li><strong>性能监控</strong>: 添加加载性能统计</li><li><strong>用户偏好</strong>: 记住用户的主题选择</li><li><strong>动画预设</strong>: 提供多种动画速度预设</li><li><strong>主题编辑器</strong>: 可视化的主题自定义工具</li></ol><hr><blockquote><p><strong>本教程完</strong><br>希望这个详细的双Loading界面实装指南能帮助您打造出个性化的加载体验！🎨🐱✨</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> Loading </tag>
            
            <tag> 主题分离 </tag>
            
            <tag> mona-lisa </tag>
            
            <tag> black-cat </tag>
            
            <tag> SVG动画 </tag>
            
            <tag> GSAP动画 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(15)-加载页面功能移植</title>
      <link href="/2024/12/09/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(15)-%E5%8A%A0%E8%BD%BD%E9%A1%B5%E9%9D%A2%E5%8A%9F%E8%83%BD%E7%A7%BB%E6%A4%8D/"/>
      <url>/2024/12/09/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(15)-%E5%8A%A0%E8%BD%BD%E9%A1%B5%E9%9D%A2%E5%8A%9F%E8%83%BD%E7%A7%BB%E6%A4%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认的loading功能相对简单，缺乏美观的动画效果和完整的交互体验。本文将详细介绍如何从 blog-solitude-player 项目完整移植loading功能到 solitude-latest，包括全屏加载动画、顶部进度条、SVG描边动画和双层收起效果的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认loading功能过于简单</li><li>缺乏美观的动画效果和交互体验</li><li>没有进度条和SVG描边动画</li><li>缺少双层收起动画效果</li></ul><h3 id="期望效果">期望效果</h3><ul><li>美观的全屏加载动画</li><li>SVG描边动画效果</li><li>进度条模拟加载过程</li><li>双层收起动画（先收起动画层，再收起背景层）</li><li>顶部进度条（Pace loading）</li><li>Pjax兼容性支持</li></ul><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/loading.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_layout/fullpage.styl</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_layout/pace.styl</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/img/loading_bg.svg</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/_config.yml</code></li><li><code>solitude-latest/_config.solitude.yml</code></li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-更新loading-pug文件">1. 更新loading.pug文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/loading.pug</code></p><p><strong>修改内容：</strong><br>将简单的loading实现替换为完整的动画版本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line">div(id=&quot;loading-container&quot;)</span><br><span class="line">    // Loading 背景层</span><br><span class="line">    div#loading-bg</span><br><span class="line">        // 已移除内联SVG，外部SVG背景由CSS或img实现</span><br><span class="line">    // Loading 动画层</span><br><span class="line">    div#loading-animation</span><br><span class="line">        div#loading-box</span><br><span class="line">            svg.loading-svg(viewBox=&quot;0 0 400.98 400.98&quot;)</span><br><span class="line">                g</span><br><span class="line">                    // 外框</span><br><span class="line">                    path.draw-path(d=&quot;M354.526,2H46.454c-2.209,0-4,1.791-4,4v388.98c0,2.209,1.791,4,4,4h308.072c2.209,0,4-1.791,4-4V6C358.526,3.791,356.735,2,354.526,2z&quot;)</span><br><span class="line">                    // 内框合并</span><br><span class="line">                    path.draw-path.blue-path(d=&quot;M50.454,10 H350.526 V390.98 H50.454 V10 Z&quot;)</span><br><span class="line">                    // ... 更多SVG路径</span><br><span class="line">            div.loading-text(data-glitch=&quot;Loading&quot;) Loading</span><br><span class="line">            div.progress-bar</span><br><span class="line">                div.progress-fill#progress-fill</span><br><span class="line"></span><br><span class="line">script.</span><br><span class="line">    // 等待DOM加载完成</span><br><span class="line">    document.addEventListener(&#x27;DOMContentLoaded&#x27;, function() &#123;</span><br><span class="line">        const DURATION = 1.5; // 动画时长（秒）</span><br><span class="line">        let timer = null;</span><br><span class="line">        let progress = 0;</span><br><span class="line">        let isAnimating = false;</span><br><span class="line"></span><br><span class="line">        // 进度条更新</span><br><span class="line">        function updateProgress(percent) &#123;</span><br><span class="line">            const progressFill = document.getElementById(&#x27;progress-fill&#x27;);</span><br><span class="line">            if (progressFill) &#123;</span><br><span class="line">                progressFill.style.width = percent + &#x27;%&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 描边动画</span><br><span class="line">        function animatePaths(appear) &#123;</span><br><span class="line">            const paths = Array.from(document.querySelectorAll(&#x27;.draw-path&#x27;));</span><br><span class="line">            </span><br><span class="line">            if (paths.length === 0) &#123;</span><br><span class="line">                console.log(&#x27;No draw-path elements found&#x27;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // 1. 先全部 transition 设为 none，设置起始状态</span><br><span class="line">            paths.forEach(path =&gt; &#123;</span><br><span class="line">                const len = path.getTotalLength();</span><br><span class="line">                path.style.strokeDasharray = len;</span><br><span class="line">                path.style.transition = &#x27;none&#x27;;</span><br><span class="line">                path.style.strokeDashoffset = appear ? len : 0;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            // 2. 强制重绘</span><br><span class="line">            document.body.offsetHeight;</span><br><span class="line"></span><br><span class="line">            // 3. 统一设置 transition 和目标状态</span><br><span class="line">            paths.forEach(path =&gt; &#123;</span><br><span class="line">                path.style.transition = `stroke-dashoffset $&#123;DURATION&#125;s linear`;</span><br><span class="line">                path.style.strokeDashoffset = appear ? 0 : path.style.strokeDasharray;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            // 4. 动画结束后切换状态</span><br><span class="line">            clearTimeout(timer);</span><br><span class="line">            timer = setTimeout(() =&gt; &#123;</span><br><span class="line">                if (!isAnimating) &#123;</span><br><span class="line">                    animatePaths(!appear);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, DURATION * 1000 + 50);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 模拟加载过程</span><br><span class="line">        function simulateLoading() &#123;</span><br><span class="line">            const loadingSteps = [</span><br><span class="line">                &#123; progress: 20, delay: 500 &#125;,</span><br><span class="line">                &#123; progress: 40, delay: 800 &#125;,</span><br><span class="line">                &#123; progress: 60, delay: 600 &#125;,</span><br><span class="line">                &#123; progress: 80, delay: 700 &#125;,</span><br><span class="line">                &#123; progress: 100, delay: 1000 &#125;</span><br><span class="line">            ];</span><br><span class="line"></span><br><span class="line">            let currentStep = 0;</span><br><span class="line"></span><br><span class="line">            function nextStep() &#123;</span><br><span class="line">                if (currentStep &lt; loadingSteps.length) &#123;</span><br><span class="line">                    const step = loadingSteps[currentStep];</span><br><span class="line">                    updateProgress(step.progress);</span><br><span class="line">                    currentStep++;</span><br><span class="line">                    </span><br><span class="line">                    if (currentStep &lt; loadingSteps.length) &#123;</span><br><span class="line">                        setTimeout(nextStep, step.delay);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        // 加载完成，开始收起动画</span><br><span class="line">                        setTimeout(() =&gt; &#123;</span><br><span class="line">                            completeLoading();</span><br><span class="line">                        &#125;, 500);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            nextStep();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 完成加载 - 实现两次收起动画</span><br><span class="line">        function completeLoading() &#123;</span><br><span class="line">            isAnimating = true;</span><br><span class="line">            </span><br><span class="line">            // 停止描边动画</span><br><span class="line">            clearTimeout(timer);</span><br><span class="line">            </span><br><span class="line">            // 第一次收起：loading-animation 层先收起</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">                const loadingAnimation = document.getElementById(&#x27;loading-animation&#x27;);</span><br><span class="line">                if (loadingAnimation) &#123;</span><br><span class="line">                    loadingAnimation.style.transform = &#x27;translateX(100%)&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // 第二次收起：loading-bg 层延迟收起</span><br><span class="line">                setTimeout(() =&gt; &#123;</span><br><span class="line">                    const loadingBg = document.getElementById(&#x27;loading-bg&#x27;);</span><br><span class="line">                    if (loadingBg) &#123;</span><br><span class="line">                        loadingBg.style.transform = &#x27;translateX(100%)&#x27;;</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    // 最后收起整个容器</span><br><span class="line">                    setTimeout(() =&gt; &#123;</span><br><span class="line">                        const loadingContainer = document.getElementById(&#x27;loading-container&#x27;);</span><br><span class="line">                        if (loadingContainer) &#123;</span><br><span class="line">                            loadingContainer.style.transform = &#x27;translateX(100%)&#x27;;</span><br><span class="line">                            </span><br><span class="line">                            // 收起完成后移除 loading 容器</span><br><span class="line">                            setTimeout(() =&gt; &#123;</span><br><span class="line">                                // 移除 loading 相关遮罩</span><br><span class="line">                                const loadingBg = document.getElementById(&#x27;loading-bg&#x27;);</span><br><span class="line">                                if (loadingBg) loadingBg.remove();</span><br><span class="line">                                const loadingContainer = document.getElementById(&#x27;loading-container&#x27;);</span><br><span class="line">                                if (loadingContainer) loadingContainer.remove();</span><br><span class="line">                                // 兼容其它可能的遮罩</span><br><span class="line">                                const masks = document.querySelectorAll(&#x27;.mask, .overlay, .loading-mask, .loading-overlay&#x27;);</span><br><span class="line">                                masks.forEach(el =&gt; el.remove());</span><br><span class="line">                                document.body.style.overflow = &#x27;auto&#x27;;</span><br><span class="line">                                // 触发pace-done事件</span><br><span class="line">                                const body = document.getElementById(&#x27;body&#x27;);</span><br><span class="line">                                if (body) &#123;</span><br><span class="line">                                    body.className = &#x27;pace-done&#x27;;</span><br><span class="line">                                &#125;</span><br><span class="line">                                // 确保页面回到顶部</span><br><span class="line">                                window.scrollTo(0, 0);</span><br><span class="line">                                // 延迟触发一次 percent 函数，确保初始值正确</span><br><span class="line">                                setTimeout(() =&gt; &#123;</span><br><span class="line">                                    if (typeof percent === &#x27;function&#x27;) percent();</span><br><span class="line">                                &#125;, 100);</span><br><span class="line">                            &#125;, 300);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, 300);</span><br><span class="line">                &#125;, 300);</span><br><span class="line">            &#125;, 500);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 开始动画</span><br><span class="line">        function startAnimation() &#123;</span><br><span class="line">            console.log(&#x27;Starting loading animation...&#x27;);</span><br><span class="line">            // 开始描边动画</span><br><span class="line">            animatePaths(true);</span><br><span class="line">            </span><br><span class="line">            // 开始模拟加载</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">                simulateLoading();</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 页面加载完成后开始动画</span><br><span class="line">        if (document.readyState === &#x27;loading&#x27;) &#123;</span><br><span class="line">            document.addEventListener(&#x27;load&#x27;, startAnimation);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            startAnimation();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Pjax兼容</span><br><span class="line">        window.addEventListener(&#x27;pjax:send&#x27;, () =&gt; &#123;</span><br><span class="line">            console.log(&#x27;Pjax send event triggered&#x27;);</span><br><span class="line">            // 重新创建loading容器</span><br><span class="line">            const existingContainer = document.getElementById(&#x27;loading-container&#x27;);</span><br><span class="line">            if (existingContainer) &#123;</span><br><span class="line">                existingContainer.remove();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // 重新初始化loading</span><br><span class="line">            isAnimating = false;</span><br><span class="line">            progress = 0;</span><br><span class="line">            clearTimeout(timer);</span><br><span class="line">            </span><br><span class="line">            // 重新开始动画</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">                animatePaths(true);</span><br><span class="line">                simulateLoading();</span><br><span class="line">            &#125;, 100);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 超时保护</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">            if (!isAnimating) &#123;</span><br><span class="line">                completeLoading();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, 8000);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><hr><h3 id="2-更新fullpage-styl文件">2. 更新fullpage.styl文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_layout/fullpage.styl</code></p><p><strong>修改内容：</strong><br>将简单的loading样式替换为完整的动画样式：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.fullpage&#x27;</span>)</span><br><span class="line">  <span class="selector-id">#loading-container</span></span><br><span class="line">    <span class="attribute">position</span> fixed</span><br><span class="line">    <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#fff</span></span><br><span class="line">    <span class="attribute">display</span> flex</span><br><span class="line">    <span class="attribute">flex-direction</span> column</span><br><span class="line">    <span class="attribute">align-items</span> center</span><br><span class="line">    <span class="attribute">justify-content</span> center</span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">9999</span></span><br><span class="line">    <span class="attribute">transition</span> transform <span class="number">1.3s</span> ease</span><br><span class="line">    <span class="attribute">will-change</span> transform</span><br><span class="line">    <span class="attribute">font-family</span> <span class="string">&#x27;Quicksand&#x27;</span>, <span class="string">&#x27;Nunito&#x27;</span>, <span class="string">&#x27;Poppins&#x27;</span>, <span class="string">&#x27;Arial Rounded MT Bold&#x27;</span>, <span class="string">&#x27;PingFang SC&#x27;</span>, <span class="string">&#x27;Microsoft YaHei&#x27;</span>, sans-serif</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Loading 背景层</span></span><br><span class="line">  <span class="selector-id">#loading-bg</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#409EFF</span></span><br><span class="line">    <span class="attribute">transition</span> transform <span class="number">1.3s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.25</span>, <span class="number">0.46</span>, <span class="number">0.45</span>, <span class="number">0.94</span>)</span><br><span class="line">    <span class="attribute">transition-delay</span> <span class="number">0.3s</span></span><br><span class="line">    <span class="attribute">will-change</span> transform</span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">1</span></span><br><span class="line">    <span class="attribute">overflow</span> hidden</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.loading-bg-svg</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">width</span> <span class="number">30%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">30%</span></span><br><span class="line">    <span class="attribute">opacity</span> <span class="number">0.6</span></span><br><span class="line">    <span class="attribute">animation</span> bgFloat <span class="number">20s</span> ease-in-out infinite</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建重复的背景效果 - 使用外部SVG文件</span></span><br><span class="line">  <span class="selector-id">#loading-bg</span><span class="selector-pseudo">::before</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="string">&#x27;/img/loading_bg.svg&#x27;</span>)</span><br><span class="line">    <span class="attribute">background-size</span> <span class="number">30%</span></span><br><span class="line">    <span class="attribute">background-repeat</span> repeat</span><br><span class="line">    <span class="attribute">opacity</span> <span class="number">0.6</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">@keyframes</span> bgFloat</span><br><span class="line">    <span class="number">0%</span>, <span class="number">100%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translate</span>(<span class="number">0</span>, <span class="number">0</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>)</span><br><span class="line">    <span class="number">25%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translate</span>(<span class="number">10px</span>, -<span class="number">10px</span>) <span class="built_in">rotate</span>(<span class="number">1deg</span>)</span><br><span class="line">    <span class="number">50%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translate</span>(-<span class="number">5px</span>, <span class="number">5px</span>) <span class="built_in">rotate</span>(-<span class="number">1deg</span>)</span><br><span class="line">    <span class="number">75%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">translate</span>(<span class="number">5px</span>, -<span class="number">5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span> <span class="selector-id">#loading-bg</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Loading 动画层</span></span><br><span class="line">  <span class="selector-id">#loading-animation</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">display</span> flex</span><br><span class="line">    <span class="attribute">flex-direction</span> column</span><br><span class="line">    <span class="attribute">align-items</span> center</span><br><span class="line">    <span class="attribute">justify-content</span> center</span><br><span class="line">    <span class="attribute">background</span> <span class="number">#fff</span></span><br><span class="line">    <span class="attribute">transition</span> transform <span class="number">1.3s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.25</span>, <span class="number">0.46</span>, <span class="number">0.45</span>, <span class="number">0.94</span>)</span><br><span class="line">    <span class="attribute">will-change</span> transform</span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-container</span><span class="selector-class">.hide</span> <span class="selector-id">#loading-animation</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translateX</span>(<span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.loading-svg</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">display</span> block</span><br><span class="line">    <span class="attribute">margin</span> <span class="number">60px</span> auto <span class="number">20px</span> auto</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.draw-path</span></span><br><span class="line">    <span class="attribute">stroke</span> <span class="number">#222</span></span><br><span class="line">    <span class="attribute">stroke-width</span> <span class="number">4</span></span><br><span class="line">    <span class="attribute">fill</span> none</span><br><span class="line">    <span class="attribute">stroke-linecap</span> round</span><br><span class="line">    <span class="attribute">stroke-linejoin</span> round</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.draw-path</span>, <span class="selector-class">.draw-path</span><span class="selector-attr">[stroke-width]</span></span><br><span class="line">    <span class="attribute">stroke-width</span> <span class="number">4</span> <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.blue-path</span></span><br><span class="line">    <span class="attribute">stroke</span> <span class="number">#409EFF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">@keyframes</span> draw</span><br><span class="line">    to</span><br><span class="line">      <span class="attribute">stroke-dashoffset</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Loading 文字样式</span></span><br><span class="line">  <span class="selector-id">#loading-box</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">display</span> flex</span><br><span class="line">    <span class="attribute">flex-direction</span> column</span><br><span class="line">    <span class="attribute">align-items</span> center</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span></span><br><span class="line">    <span class="attribute">text-align</span> center</span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">28px</span></span><br><span class="line">    <span class="attribute">color</span> <span class="number">#363636</span></span><br><span class="line">    <span class="attribute">margin-top</span> <span class="number">1rem</span></span><br><span class="line">    <span class="attribute">letter-spacing</span> .<span class="number">3rem</span></span><br><span class="line">    <span class="attribute">font-weight</span> <span class="number">900</span></span><br><span class="line">    <span class="attribute">position</span> relative</span><br><span class="line">    <span class="attribute">line-height</span> <span class="number">1.2</span></span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">1</span></span><br><span class="line">    -webkit-<span class="attribute">animation</span> shift <span class="number">1s</span> ease-in-out infinite alternate</span><br><span class="line">    <span class="attribute">animation</span> shift <span class="number">1s</span> ease-in-out infinite alternate</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:before</span></span><br><span class="line">    -webkit-<span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) both infinite</span><br><span class="line">    <span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) both infinite</span><br><span class="line">    <span class="attribute">color</span> <span class="number">#c28b00</span></span><br><span class="line">    <span class="attribute">z-index</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:after</span></span><br><span class="line">    -webkit-<span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) reverse both infinite</span><br><span class="line">    <span class="attribute">animation</span> glitch .<span class="number">4s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">25</span>,.<span class="number">46</span>,.<span class="number">45</span>,.<span class="number">94</span>) reverse both infinite</span><br><span class="line">    <span class="attribute">color</span> <span class="number">#57bd6a</span></span><br><span class="line">    <span class="attribute">z-index</span> -<span class="number">2</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:after</span>,</span><br><span class="line">  <span class="selector-id">#loading-box</span> <span class="selector-class">.loading-text</span><span class="selector-pseudo">:before</span></span><br><span class="line">    <span class="attribute">display</span> block</span><br><span class="line">    <span class="attribute">content</span> <span class="built_in">attr</span>(data-glitch)</span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">opacity</span> .<span class="number">8</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">@keyframes</span> glitch</span><br><span class="line">    <span class="number">0%</span></span><br><span class="line">      <span class="attribute">text-shadow</span> <span class="number">3px</span> <span class="number">0</span> <span class="number">#ff0033</span>, -<span class="number">3px</span> <span class="number">0</span> <span class="number">#fff</span></span><br><span class="line">    <span class="number">20%</span></span><br><span class="line">      <span class="attribute">text-shadow</span> -<span class="number">3px</span> -<span class="number">3px</span> <span class="number">#ff0033</span>, <span class="number">3px</span> <span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">    <span class="number">40%</span></span><br><span class="line">      <span class="attribute">text-shadow</span> <span class="number">3px</span> <span class="number">3px</span> <span class="number">#ff0033</span>, -<span class="number">3px</span> -<span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">    <span class="number">60%</span></span><br><span class="line">      <span class="attribute">text-shadow</span> -<span class="number">3px</span> <span class="number">3px</span> <span class="number">#ff0033</span>, <span class="number">3px</span> -<span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">    <span class="number">80%</span></span><br><span class="line">      <span class="attribute">text-shadow</span> <span class="number">3px</span> -<span class="number">3px</span> <span class="number">#ff0033</span>, -<span class="number">3px</span> <span class="number">3px</span> <span class="number">#fff</span></span><br><span class="line">    <span class="number">100%</span></span><br><span class="line">      <span class="attribute">text-shadow</span> -<span class="number">3px</span> <span class="number">0</span> <span class="number">#ff0033</span>, <span class="number">3px</span> <span class="number">0</span> <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">@keyframes</span> shift</span><br><span class="line">    <span class="number">0%</span>,<span class="number">100%</span>,<span class="number">40%</span>,<span class="number">44%</span>,<span class="number">58%</span>,<span class="number">61%</span>,<span class="number">65%</span>,<span class="number">69%</span>,<span class="number">73%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="number">41%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">10deg</span>)</span><br><span class="line">    <span class="number">42%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(-<span class="number">10deg</span>)</span><br><span class="line">    <span class="number">59%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">40deg</span>) <span class="built_in">skewY</span>(<span class="number">10deg</span>)</span><br><span class="line">    <span class="number">60%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(-<span class="number">40deg</span>) <span class="built_in">skewY</span>(-<span class="number">10deg</span>)</span><br><span class="line">    <span class="number">63%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">10deg</span>) <span class="built_in">skewY</span>(-<span class="number">5deg</span>)</span><br><span class="line">    <span class="number">70%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(-<span class="number">50deg</span>) <span class="built_in">skewY</span>(-<span class="number">20deg</span>)</span><br><span class="line">    <span class="number">71%</span></span><br><span class="line">      <span class="attribute">transform</span> <span class="built_in">skewX</span>(<span class="number">10deg</span>) <span class="built_in">skewY</span>(-<span class="number">10deg</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 进度条</span></span><br><span class="line">  <span class="selector-class">.progress-bar</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">4px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#f0f0f0</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">2px</span></span><br><span class="line">    <span class="attribute">margin-top</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">overflow</span> hidden</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.progress-fill</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="number">#409EFF</span>, <span class="number">#57bd6a</span>)</span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">2px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">0%</span></span><br><span class="line">    <span class="attribute">transition</span> width <span class="number">0.3s</span> ease</span><br></pre></td></tr></table></figure><hr><h3 id="3-创建pace-styl文件">3. 创建pace.styl文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_layout/pace.styl</code></p><p><strong>文件内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;loading.pace&#x27;</span>)</span><br><span class="line">  <span class="selector-class">.pace</span></span><br><span class="line">    <span class="attribute">pointer-events</span>: none</span><br><span class="line">    <span class="attribute">user-select</span>: none</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2000</span></span><br><span class="line">    <span class="attribute">position</span>: fixed</span><br><span class="line">    <span class="attribute">margin</span>: auto</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">4px</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">4rem</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--efu-secondbg)</span><br><span class="line">    <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border)</span><br><span class="line">    <span class="attribute">overflow</span>: hidden</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-class">.pace-inactive</span></span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">transition</span>: .<span class="number">3s</span></span><br><span class="line">      <span class="attribute">top</span>: -<span class="number">8px</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.pace-progress</span></span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">transition</span>: .<span class="number">3s</span> ease-in</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.pace-progress</span></span><br><span class="line">      <span class="attribute">box-sizing</span>: border-box</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">200px</span></span><br><span class="line">      <span class="attribute">z-index</span>: <span class="number">2000</span></span><br><span class="line">      <span class="attribute">display</span>: block</span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">right</span>: <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--efu-logo-color)</span><br><span class="line">      <span class="attribute">animation</span>: gradient <span class="number">2s</span> ease infinite</span><br><span class="line">      <span class="attribute">background-size</span>: <span class="number">200%</span></span><br></pre></td></tr></table></figure><hr><h3 id="4-创建loading背景SVG文件">4. 创建loading背景SVG文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/img/loading_bg.svg</code></p><p><strong>文件内容：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Generator: Adobe Illustrator 22.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">version</span>=<span class="string">&quot;1.1&quot;</span> <span class="attr">id</span>=<span class="string">&quot;图层_1&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0px&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0px&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 437.5 271&quot;</span> <span class="attr">style</span>=<span class="string">&quot;enable-background:new 0 0 437.5 271;&quot;</span> <span class="attr">xml:space</span>=<span class="string">&quot;preserve&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.st0</span>&#123;<span class="attribute">display</span>:none;<span class="attribute">opacity</span>:<span class="number">0.6</span>;&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.st1</span>&#123;<span class="attribute">display</span>:inline;&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.st2</span>&#123;<span class="attribute">fill</span>:none;<span class="attribute">stroke</span>:<span class="number">#000000</span>;<span class="attribute">stroke-miterlimit</span>:<span class="number">10</span>;&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&quot;h_274&quot;</span> <span class="attr">class</span>=<span class="string">&quot;st0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">g</span> <span class="attr">class</span>=<span class="string">&quot;st1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">&quot;43.6,74.3 43.6,92.3 12.7,110.2 12.7,-1.5 28.2,-1.5 28.2,83.3 &quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ... 更多SVG路径 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">&quot;h_271&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">polygon</span> <span class="attr">class</span>=<span class="string">&quot;st2&quot;</span> <span class="attr">points</span>=<span class="string">&quot;43.6,74.3 43.6,92.3 12.7,110.2 12.7,-1.5 28.2,-1.5 28.2,83.3 &quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ... 更多SVG路径 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="5-更新主题配置">5. 更新主题配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/_config.yml</code></p><p><strong>修改内容：</strong><br>在loading配置中启用fullpage：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --------------------------- start ---------------------------</span></span><br><span class="line"><span class="comment"># Loading</span></span><br><span class="line"><span class="comment"># 加载</span></span><br><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="comment"># Full screen loading</span></span><br><span class="line">  <span class="comment"># 全屏加载</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Loading icon, default is siteicon</span></span><br><span class="line">  <span class="comment"># 加载图标，不写默认siteicon</span></span><br><span class="line">  <span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br><span class="line">  <span class="comment"># Pace loading</span></span><br><span class="line">  <span class="comment"># Pace 加载</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># --------------------------- end ---------------------------</span></span><br></pre></td></tr></table></figure><hr><h3 id="6-更新用户配置">6. 更新用户配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改内容：</strong><br>启用loading功能：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --------------------------- start ---------------------------</span></span><br><span class="line"><span class="comment"># Loading</span></span><br><span class="line"><span class="comment"># 加载</span></span><br><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="comment"># Full screen loading</span></span><br><span class="line">  <span class="comment"># 全屏加载</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Loading icon, default is siteicon</span></span><br><span class="line">  <span class="comment"># 加载图标，不写默认siteicon</span></span><br><span class="line">  <span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br><span class="line">  <span class="comment"># Pace loading</span></span><br><span class="line">  <span class="comment"># Pace 加载</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># --------------------------- end ---------------------------</span></span><br></pre></td></tr></table></figure><hr><h2 id="功能特性">功能特性</h2><h3 id="1-全屏加载动画">1. 全屏加载动画</h3><ul><li>美观的SVG描边动画</li><li>进度条模拟加载过程</li><li>双层收起动画效果</li><li>文字故障动画效果</li></ul><h3 id="2-SVG描边动画">2. SVG描边动画</h3><ul><li>使用stroke-dasharray实现描边效果</li><li>支持循环动画</li><li>平滑的过渡效果</li><li>可自定义动画时长</li></ul><h3 id="3-进度条功能">3. 进度条功能</h3><ul><li>分步骤模拟加载进度</li><li>渐变色彩效果</li><li>平滑的宽度过渡</li><li>可自定义进度步骤</li></ul><h3 id="4-双层收起动画">4. 双层收起动画</h3><ul><li>第一次收起：loading-animation层</li><li>第二次收起：loading-bg层</li><li>延迟动画效果</li><li>平滑的transform过渡</li></ul><h3 id="5-顶部进度条">5. 顶部进度条</h3><ul><li>Pace loading功能</li><li>渐变动画效果</li><li>自动隐藏功能</li><li>Pjax兼容性</li></ul><h3 id="6-Pjax兼容性">6. Pjax兼容性</h3><ul><li>页面切换时重新创建loading</li><li>保持动画连续性</li><li>超时保护机制</li><li>错误处理</li></ul><h3 id="7-响应式设计">7. 响应式设计</h3><ul><li>适配不同屏幕尺寸</li><li>移动端优化</li><li>性能优化</li><li>浏览器兼容性</li></ul><hr><h2 id="使用说明">使用说明</h2><h3 id="1-启用-禁用功能">1. 启用/禁用功能</h3><p>在 <code>_config.solitude.yml</code> 中修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">loading:</span></span><br><span class="line">  <span class="attr">fullpage:</span> <span class="literal">true</span>  <span class="comment"># 全屏加载</span></span><br><span class="line">  <span class="attr">pace:</span> <span class="literal">true</span>      <span class="comment"># 顶部进度条</span></span><br></pre></td></tr></table></figure><h3 id="2-自定义动画时长">2. 自定义动画时长</h3><p>修改 <code>loading.pug</code> 中的 <code>DURATION</code> 变量：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">DURATION</span> = <span class="number">1.5</span>; <span class="comment">// 动画时长（秒）</span></span><br></pre></td></tr></table></figure><h3 id="3-调整进度条步骤">3. 调整进度条步骤</h3><p>修改 <code>simulateLoading</code> 函数中的 <code>loadingSteps</code> 数组：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> loadingSteps = [</span><br><span class="line">    &#123; <span class="attr">progress</span>: <span class="number">20</span>, <span class="attr">delay</span>: <span class="number">500</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">progress</span>: <span class="number">40</span>, <span class="attr">delay</span>: <span class="number">800</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">progress</span>: <span class="number">60</span>, <span class="attr">delay</span>: <span class="number">600</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">progress</span>: <span class="number">80</span>, <span class="attr">delay</span>: <span class="number">700</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">progress</span>: <span class="number">100</span>, <span class="attr">delay</span>: <span class="number">1000</span> &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="4-自定义收起动画">4. 自定义收起动画</h3><p>修改 <code>completeLoading</code> 函数中的延迟时间：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 第一次收起</span></span><br><span class="line">&#125;, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 第二次收起</span></span><br><span class="line">&#125;, <span class="number">300</span>);</span><br></pre></td></tr></table></figure><h3 id="5-调整超时保护">5. 调整超时保护</h3><p>修改超时时间：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isAnimating) &#123;</span><br><span class="line">        <span class="title function_">completeLoading</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">8000</span>); <span class="comment">// 8秒超时</span></span><br></pre></td></tr></table></figure><hr><h2 id="常见问题解决">常见问题解决</h2><h3 id="1-动画不显示">1. 动画不显示</h3><ul><li>检查 <code>loading.fullpage</code> 是否为 true</li><li>检查CSS文件是否正确生成</li><li>清除浏览器缓存</li><li>检查控制台错误</li></ul><h3 id="2-SVG动画不生效">2. SVG动画不生效</h3><ul><li>检查SVG路径是否正确</li><li>检查stroke-dasharray设置</li><li>验证SVG文件完整性</li><li>检查CSS样式是否正确</li></ul><h3 id="3-进度条不更新">3. 进度条不更新</h3><ul><li>检查 <code>progress-fill</code> 元素是否存在</li><li>检查JavaScript错误</li><li>验证进度步骤配置</li><li>检查CSS样式</li></ul><h3 id="4-收起动画异常">4. 收起动画异常</h3><ul><li>检查transform属性设置</li><li>验证延迟时间配置</li><li>检查z-index层级</li><li>清除浏览器缓存</li></ul><h3 id="5-Pjax兼容性问题">5. Pjax兼容性问题</h3><ul><li>检查pjax事件监听</li><li>验证loading容器重新创建</li><li>检查动画状态重置</li><li>测试页面切换效果</li></ul><h3 id="6-性能问题">6. 性能问题</h3><ul><li>检查will-change属性</li><li>优化CSS动画</li><li>减少不必要的DOM操作</li><li>使用硬件加速</li></ul><hr><h2 id="高级定制">高级定制</h2><h3 id="1-自定义SVG动画">1. 自定义SVG动画</h3><p>修改 <code>animatePaths</code> 函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">animatePaths</span>(<span class="params">appear</span>) &#123;</span><br><span class="line">    <span class="comment">// 自定义动画逻辑</span></span><br><span class="line">    <span class="keyword">const</span> paths = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.draw-path&#x27;</span>));</span><br><span class="line">    paths.<span class="title function_">forEach</span>(<span class="function"><span class="params">path</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 自定义动画效果</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-添加更多动画效果">2. 添加更多动画效果</h3><p>在CSS中添加新的动画：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> customAnimation &#123;</span><br><span class="line">    <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>); &#125;</span><br><span class="line">    <span class="number">50%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>); &#125;</span><br><span class="line">    <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-自定义进度条样式">3. 自定义进度条样式</h3><p>修改 <code>.progress-fill</code> 样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.progress-fill</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, #your-color1, #your-color2);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-添加音效">4. 添加音效</h3><p>在动画中添加音效：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">playSound</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> audio = <span class="keyword">new</span> <span class="title class_">Audio</span>(<span class="string">&#x27;/sounds/loading.mp3&#x27;</span>);</span><br><span class="line">    audio.<span class="title function_">play</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们为Solitude主题添加了完整的loading功能。该功能不仅具有美观的动画效果，还支持多种交互方式和完整的兼容性，为用户提供了良好的加载体验。</p><p>Loading功能的特点：</p><ul><li><strong>美观的动画效果</strong>：SVG描边动画、文字故障效果、进度条动画</li><li><strong>双层收起动画</strong>：先收起动画层，再收起背景层，平滑过渡</li><li><strong>进度条功能</strong>：分步骤模拟加载进度，渐变色彩效果</li><li><strong>Pjax兼容性</strong>：页面切换时重新创建loading，保持动画连续性</li><li><strong>超时保护</strong>：8秒超时自动完成加载，防止卡死</li><li><strong>响应式设计</strong>：适配不同屏幕尺寸，移动端优化</li><li><strong>易于维护</strong>：通过配置文件轻松修改动画参数</li><li><strong>完整实现</strong>：包含所有必要的文件、样式和资源</li></ul><hr><h2 id="相关文件清单">相关文件清单</h2><h3 id="修改文件">修改文件</h3><ul><li><code>node_modules/hexo-theme-solitude/layout/includes/loading.pug</code> - 完整的loading实现</li><li><code>node_modules/hexo-theme-solitude/source/css/_layout/fullpage.styl</code> - 全屏加载样式</li><li><code>node_modules/hexo-theme-solitude/source/css/_layout/pace.styl</code> - 顶部进度条样式</li><li><code>node_modules/hexo-theme-solitude/source/img/loading_bg.svg</code> - 背景SVG文件</li><li><code>node_modules/hexo-theme-solitude/_config.yml</code> - 主题配置</li><li><code>_config.solitude.yml</code> - 用户配置</li></ul><h3 id="生成文件">生成文件</h3><ul><li><code>public/css/_layout/fullpage.css</code> - 编译后的全屏加载样式</li><li><code>public/css/_layout/pace.css</code> - 编译后的进度条样式</li><li><code>public/img/loading_bg.svg</code> - 生成的背景SVG文件</li></ul><hr><h2 id="扩展建议">扩展建议</h2><ol><li><strong>添加音效</strong>：为loading动画添加音效</li><li><strong>自定义主题</strong>：支持多种loading主题</li><li><strong>加载统计</strong>：显示加载时间和速度</li><li><strong>网络检测</strong>：根据网络状况调整动画</li><li><strong>设备适配</strong>：针对不同设备优化动画</li><li><strong>性能监控</strong>：监控loading性能指标</li><li><strong>A/B测试</strong>：测试不同loading效果</li><li><strong>用户反馈</strong>：收集用户对loading的反馈</li></ol><hr>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> Loading </tag>
            
            <tag> 动画效果 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(14)-留言板页面</title>
      <link href="/2024/12/02/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(14)-%E7%95%99%E8%A8%80%E6%9D%BF%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/12/02/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(14)-%E7%95%99%E8%A8%80%E6%9D%BF%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有&quot;留言板&quot;页面功能，但很多站长希望提供一个美观的留言展示页面。本文将详细介绍如何从 blog-solitude 项目完整移植留言板页面功能到 solitude-latest，包括信封动画效果、页面模板、配置文件和样式设计的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认没有&quot;留言板&quot;页面</li><li>无法以美观的方式展示留言内容</li><li>缺少信封动画效果和交互体验</li></ul><h3 id="期望效果">期望效果</h3><ul><li>独立的&quot;留言板&quot;页面（<code>/comments/</code>）</li><li>支持信封动画效果（hover展开）</li><li>支持自定义留言内容和图片</li><li>支持主题色适配和响应式设计</li></ul><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/source/comments/index.md</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/comments.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/comments/content.pug</code></li><li><code>solitude-latest/_config.solitude.yml</code>（envelope_comment配置）</li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/custom/comments.css</code></li><li><code>solitude-latest/public/img/comments/</code>（图片资源目录）</li><li><code>solitude-latest/public/mp4/message-banner.mp4</code>（视频Banner）</li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建留言板页面配置">1. 创建留言板页面配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/comments/index.md</code></p><p><strong>文件内容：</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 留言板</span><br><span class="line">date: 2024-11-19 23:59:27</span><br><span class="line">type: comments</span><br><span class="line">cover: /mp4/message-banner.mp4</span><br><span class="line">desc: 留下你想说的话</span><br><span class="line">leftend: 向 Ryan 传达你的想法</span><br><span class="line"><span class="section">container: true</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-创建页面模板">2. 创建页面模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/comments.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- const &#123; enable, custom_pic, message, bottom &#125; = theme.envelope_comment || &#123;&#125;</span><br><span class="line"></span><br><span class="line">//- include ../widgets/page/banner</span><br><span class="line">include ../widgets/page/comments/content</span><br></pre></td></tr></table></figure><hr><h3 id="3-创建信封内容模板">3. 创建信封内容模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/comments/content.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">if theme.envelope_comment &amp;&amp; theme.envelope_comment.enable</span><br><span class="line">  #envelope-container</span><br><span class="line">    #maincontent</span><br><span class="line">      #form-wrap</span><br><span class="line">        img#beforeimg.no-lightbox(src=custom_pic.beforeimg)</span><br><span class="line">        #envelope</span><br><span class="line">          form</span><br><span class="line">            .formmain(style=&quot;pointer-events: none;&quot;)</span><br><span class="line">              img.headerimg.no-lightbox(src=custom_pic.cover style=&quot;width: 100%;overflow: hidden;pointer-events: none;&quot;)</span><br><span class="line">              .comments-main</span><br><span class="line">                h3.title3(style=&quot;text-decoration: none;color: $theme-color;text-align: center;&quot;) 来自Ryan的留言:</span><br><span class="line">                if Array.isArray(message) &amp;&amp; message.length &gt; 0</span><br><span class="line">                  .comments(style=&quot;text-align: center;border-bottom: #ddd 1px solid;border-left: #ddd 1px solid;padding-bottom: 20px;background-color: #eee;margin: 15px 0px;padding-left: 20px;padding-right: 20px;border-top: #ddd 1px solid;border-right: #ddd 1px solid;padding-top: 20px;&quot;)</span><br><span class="line">                    each i in message</span><br><span class="line">                      div=`$&#123;i&#125;`</span><br><span class="line">                else</span><br><span class="line">                  .comments(style=&quot;text-align: center; color: #999; padding: 20px;&quot;) 暂无留言内容</span><br><span class="line">                .bottomcontent(style=&quot;text-align: center;margin-top: 40px;&quot;)</span><br><span class="line">                  img.bottomimg.no-lightbox(src=custom_pic.line style=&quot;width: 100%;margin: 5px auto 5px auto;display: block;pointer-events: none;&quot;)</span><br><span class="line">                p.bottomhr(style=&quot;font-size: 12px;text-align: center;color: #999;&quot;)=`$&#123;bottom&#125;`</span><br><span class="line">        img#afterimg.no-lightbox(src=custom_pic.afterimg)</span><br></pre></td></tr></table></figure><hr><h3 id="4-注册页面类型">4. 注册页面类型</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></p><p><strong>修改内容：</strong><br>在 <code>case page.type</code> 处添加 comments：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">when &#x27;comments&#x27;</span><br><span class="line">    include includes/page/comments</span><br></pre></td></tr></table></figure><p><strong>实际位置：</strong> 第32-33行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">when &#x27;bloglog&#x27;</span><br><span class="line">    include includes/page/bloglog</span><br><span class="line">when &#x27;comments&#x27;</span><br><span class="line">    include includes/page/comments</span><br><span class="line">when &#x27;recentcomment&#x27;</span><br></pre></td></tr></table></figure><hr><h3 id="5-添加配置文件">5. 添加配置文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改内容：</strong><br>在文件末尾添加 envelope_comment 配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --------------------------- start ---------------------------</span></span><br><span class="line"><span class="comment"># Message Page</span></span><br><span class="line"><span class="comment"># 留言板信封页面</span></span><br><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制开关</span></span><br><span class="line">  <span class="attr">custom_pic:</span>      </span><br><span class="line">    <span class="attr">cover:</span> <span class="string">/img/comments/violet.jpg</span> <span class="comment">#信笺头部图片</span></span><br><span class="line">    <span class="attr">line:</span> <span class="string">/img/comments/line.png</span> <span class="comment">#信笺底部图片</span></span><br><span class="line">    <span class="attr">beforeimg:</span> <span class="string">/img/comments/before.png</span> <span class="comment"># 信封前半部分</span></span><br><span class="line">    <span class="attr">afterimg:</span> <span class="string">/img/comments/after.png</span> <span class="comment"># 信封后半部分</span></span><br><span class="line">  <span class="attr">message:</span> <span class="comment">#信笺正文，多行文本，写法如下</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span> <span class="comment">#仅支持单行文本</span></span><br><span class="line"><span class="comment"># --------------------------- end ---------------------------</span></span><br></pre></td></tr></table></figure><p><strong>实际位置：</strong> 第1120-1138行</p><hr><h3 id="6-创建样式文件">6. 创建样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/custom/comments.css</code></p><p><strong>文件内容：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">600px</span>) &#123;</span><br><span class="line"><span class="selector-id">#beforeimg</span>,</span><br><span class="line"><span class="selector-id">#afterimg</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">600px</span>) &#123;</span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">0rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#form-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">447px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">1s</span> ease-in-out .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#form-wrap</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1050px</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#beforeimg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">126px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">530px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">317px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">100</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#afterimg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: -<span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">530px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">259px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">100</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#envelope</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: visible;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span> auto;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">1s</span> ease-in-out .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#maincontent</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">530px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">20px</span> auto <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.formmain</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: white;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">95%</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">800px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto auto;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">20px</span> <span class="number">0px</span> <span class="number">#000000</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">20px</span> <span class="number">0px</span> <span class="number">#000000</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span></span><br><span class="line"><span class="selector-class">.formmain</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#323232</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span></span><br><span class="line"><span class="selector-class">.comments</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#5a5a5a</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="7-引入样式文件">7. 引入样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code></p><p><strong>修改内容：</strong><br>在第18行添加：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;custom/comments.css&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>实际位置：</strong> 第18行</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;custom/todolist.css&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;custom/bloglog.css&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;custom/comments.css&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;album-modal.css&#x27;</span></span><br></pre></td></tr></table></figure><hr><h3 id="8-创建图片资源目录">8. 创建图片资源目录</h3><p><strong>文件路径：</strong><br><code>solitude-latest/public/img/comments/</code></p><p><strong>操作步骤：</strong></p><ol><li>创建目录：<code>mkdir -p public/img/comments</code></li><li>复制图片文件：<ul><li><code>violet.jpg</code> - 信笺头部图片 (117KB)</li><li><code>line.png</code> - 信笺底部图片 (13KB)</li><li><code>before.png</code> - 信封前半部分 (64KB)</li><li><code>after.png</code> - 信封后半部分 (159KB)</li></ul></li></ol><p><strong>实际状态：</strong> ✅ 已完成，所有图片文件已存在</p><hr><h3 id="9-静态资源">9. 静态资源</h3><p>确保 <code>/mp4/message-banner.mp4</code> 已存在于 solitude-latest 的静态资源目录。</p><p><strong>实际状态：</strong> ✅ 已完成，文件已存在</p><hr><h3 id="10-重新生成">10. 重新生成</h3><p>在 solitude-latest 目录下执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br></pre></td></tr></table></figure><p>访问 <code>/comments/</code> 页面即可。</p><p><strong>实际状态：</strong> ✅ 已完成，页面已生成</p><hr><h2 id="功能特性">功能特性</h2><h3 id="1-信封动画效果">1. 信封动画效果</h3><ul><li>鼠标悬停时信封自动展开</li><li>平滑的过渡动画效果（1s ease-in-out .3s）</li><li>信封前后部分分离显示</li><li>展开高度从447px到1050px</li></ul><h3 id="2-自定义留言内容">2. 自定义留言内容</h3><ul><li>支持多行留言文本（数组格式）</li><li>可自定义底部签名</li><li>支持主题色适配</li><li>支持条件渲染（有内容时显示，无内容时显示&quot;暂无留言内容&quot;）</li></ul><h3 id="3-响应式设计">3. 响应式设计</h3><ul><li>移动端（≤600px）隐藏信封装饰图片</li><li>桌面端（&gt;600px）完整展示信封效果</li><li>适配不同屏幕尺寸</li></ul><h3 id="4-深色模式支持">4. 深色模式支持</h3><ul><li>自动适配深色主题</li><li>信封和留言区域颜色调整</li><li>深色模式下信封背景为#323232</li><li>深色模式下留言区域背景为#5a5a5a</li></ul><h3 id="5-图片资源管理">5. 图片资源管理</h3><ul><li>支持自定义信笺头部图片</li><li>支持自定义信笺底部图片</li><li>支持自定义信封前后部分图片</li><li>所有图片路径可配置</li></ul><hr><h2 id="使用说明">使用说明</h2><h3 id="1-修改留言内容">1. 修改留言内容</h3><p>编辑 <code>_config.solitude.yml</code> 中的 <code>envelope_comment.message</code> 数组：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">message:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br></pre></td></tr></table></figure><h3 id="2-修改底部签名">2. 修改底部签名</h3><p>编辑 <code>_config.solitude.yml</code> 中的 <code>envelope_comment.bottom</code>：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span></span><br></pre></td></tr></table></figure><h3 id="3-更换图片资源">3. 更换图片资源</h3><p>替换 <code>public/img/comments/</code> 目录下的图片文件：</p><ul><li><code>violet.jpg</code> - 信笺头部图片</li><li><code>line.png</code> - 信笺底部图片</li><li><code>before.png</code> - 信封前半部分</li><li><code>after.png</code> - 信封后半部分</li></ul><h3 id="4-调整动画效果">4. 调整动画效果</h3><p>修改 <code>comments.css</code> 中的相关样式：</p><ul><li><code>#form-wrap:hover</code> - 控制展开高度（当前：1050px）</li><li><code>transition</code> - 控制动画时长和缓动函数（当前：1s ease-in-out .3s）</li></ul><h3 id="5-启用-禁用功能">5. 启用/禁用功能</h3><p>在 <code>_config.solitude.yml</code> 中修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment"># 改为 false 可禁用留言板功能</span></span><br></pre></td></tr></table></figure><hr><h2 id="常见问题解决">常见问题解决</h2><h3 id="1-页面无法访问">1. 页面无法访问</h3><ul><li>检查 <code>page.pug</code> 是否已注册 comments 页面类型</li><li>检查 <code>_config.solitude.yml</code> 中 envelope_comment.enable 是否为 true</li><li>重新生成：<code>hexo clean &amp;&amp; hexo generate</code></li></ul><h3 id="2-信封动画不生效">2. 信封动画不生效</h3><ul><li>检查 <code>comments.css</code> 是否正确引入</li><li>检查图片路径是否正确</li><li>清除浏览器缓存</li><li>检查CSS文件是否生成：<code>ls public/css/custom/comments.css</code></li></ul><h3 id="3-图片显示异常">3. 图片显示异常</h3><ul><li>检查 <code>public/img/comments/</code> 目录是否存在</li><li>检查图片文件是否完整复制</li><li>检查图片路径配置是否正确</li><li>验证图片文件：<code>ls -la public/img/comments/</code></li></ul><h3 id="4-样式不生效">4. 样式不生效</h3><ul><li>检查 <code>index.styl</code> 是否已引入 <code>custom/comments.css</code></li><li>重新构建项目：<code>hexo clean &amp;&amp; hexo generate</code></li><li>清除浏览器缓存</li><li>检查编译后的CSS：<code>ls public/css/custom/comments.css</code></li></ul><h3 id="5-移动端显示问题">5. 移动端显示问题</h3><ul><li>检查 <code>@media screen and (max-width: 600px)</code> 样式</li><li>确保移动端隐藏装饰图片</li><li>测试不同屏幕尺寸的显示效果</li></ul><h3 id="6-深色模式问题">6. 深色模式问题</h3><ul><li>检查深色模式下的颜色适配</li><li>确保 <code>[data-theme='dark']</code> 样式正确</li><li>测试主题切换功能</li></ul><hr><h2 id="高级定制">高级定制</h2><h3 id="1-自定义信封颜色">1. 自定义信封颜色</h3><p>修改 <code>comments.css</code> 中的信封样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.formmain</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: #your-color;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid #your-border-color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-调整动画时长">2. 调整动画时长</h3><p>修改 <code>transition</code> 属性：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#form-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">1.5s</span> ease-in-out .<span class="number">5s</span>; <span class="comment">/* 调整时长和延迟 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-添加更多交互效果">3. 添加更多交互效果</h3><p>可以在 <code>comments.css</code> 中添加更多 hover 效果：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#envelope</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.02</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-自定义留言样式">4. 自定义留言样式</h3><p>修改留言区域的样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.comments</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: #your-color;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid #your-border-color;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们为Solitude主题添加了完整的&quot;留言板&quot;功能。该功能不仅具有美观的信封动画效果，还支持自定义留言内容和响应式设计，为用户提供了良好的交互体验。</p><p>留言板功能的特点：</p><ul><li><strong>美观的信封动画</strong>：鼠标悬停时信封自动展开，平滑过渡</li><li><strong>自定义内容</strong>：支持多行留言和自定义签名，完全可配置</li><li><strong>响应式设计</strong>：适配移动端和桌面端，移动端隐藏装饰图片</li><li><strong>主题适配</strong>：支持浅色/深色主题切换，自动颜色调整</li><li><strong>易于维护</strong>：通过配置文件轻松修改内容和样式</li><li><strong>完整实现</strong>：包含所有必要的文件、样式和资源</li></ul><hr><h2 id="相关文件清单">相关文件清单</h2><h3 id="新增文件">新增文件</h3><ul><li><code>source/comments/index.md</code> - 留言板页面配置</li><li><code>node_modules/hexo-theme-solitude/layout/includes/page/comments.pug</code> - 页面模板</li><li><code>node_modules/hexo-theme-solitude/layout/includes/widgets/page/comments/content.pug</code> - 内容模板</li><li><code>node_modules/hexo-theme-solitude/source/css/custom/comments.css</code> - 样式文件</li><li><code>public/img/comments/</code> - 图片资源目录（4个文件）</li></ul><h3 id="修改文件">修改文件</h3><ul><li><code>node_modules/hexo-theme-solitude/layout/page.pug</code> - 注册页面类型（第32-33行）</li><li><code>node_modules/hexo-theme-solitude/source/css/index.styl</code> - 引入样式（第18行）</li><li><code>_config.solitude.yml</code> - 添加配置项（第1120-1138行）</li></ul><h3 id="生成文件">生成文件</h3><ul><li><code>public/comments/index.html</code> - 留言板页面（55KB）</li><li><code>public/css/custom/comments.css</code> - 编译后的样式文件（1.4KB）</li></ul><hr><h2 id="扩展建议">扩展建议</h2><ol><li><strong>添加留言表单</strong>：可以扩展为真正的留言功能</li><li><strong>添加留言管理</strong>：后台管理留言内容</li><li><strong>添加留言通知</strong>：新留言时发送通知</li><li><strong>添加留言审核</strong>：防止垃圾留言</li><li><strong>添加留言回复</strong>：支持留言回复功能</li><li><strong>添加留言统计</strong>：显示留言数量和时间</li><li><strong>添加留言搜索</strong>：支持留言内容搜索</li><li><strong>添加留言分类</strong>：按类型分类留言</li></ol><hr>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 留言板 </tag>
            
            <tag> 信封动画 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(13)-本站日志页面</title>
      <link href="/2024/11/25/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(13)-%E6%9C%AC%E7%AB%99%E6%97%A5%E5%BF%97%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/11/25/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(13)-%E6%9C%AC%E7%AB%99%E6%97%A5%E5%BF%97%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有“本站日志”页面功能，但很多站长希望记录和展示网站的成长历程。本文将详细介绍如何从 blog-solitude 项目完整移植本站日志页面功能到 solitude-latest，包括时间轴展示、页面模板、导航配置和样式适配的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认没有“本站日志”页面</li><li>无法以时间轴形式展示网站更新历史</li><li>缺少专属的日志页面模板和样式</li></ul><h3 id="期望效果">期望效果</h3><ul><li>独立的“本站日志”页面（<code>/bloglog/</code>）</li><li>支持时间轴（timeline）展示网站大事记</li><li>支持视频Banner</li><li>支持主题色适配和响应式设计</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>页面类型缺失</strong><br>solitude-latest主题缺少 bloglog 页面类型的支持</p></li><li><p><strong>模板文件缺失</strong><br>缺少 bloglog 页面模板</p></li><li><p><strong>导航配置缺失</strong><br>没有在主题导航中添加“本站日志”入口</p></li><li><p><strong>样式适配缺失</strong><br>时间轴样式未适配或未引入</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/source/bloglog/index.md</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/bloglog.pug</code></li><li><code>solitude-latest/_config.solitude.yml</code>（导航配置）</li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/custom/bloglog.css</code>（如需自定义样式）</li><li><code>solitude-latest/public/mp4/bloglog-banner.mp4</code>（视频Banner）</li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建本站日志页面配置">1. 创建本站日志页面配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/bloglog/index.md</code></p><p><strong>文件内容：</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 网站日志</span><br><span class="line">date: 2024-11-17 12:12:02</span><br><span class="line">type: bloglog</span><br><span class="line">cover: /mp4/bloglog-banner.mp4</span><br><span class="line">desc: 网站日志实时更新</span><br><span class="line"><span class="section">container: true</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;notice&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% note &#x27;info&#x27; &#x27;fas fa-bullhorn&#x27; %&#125;</span><br><span class="line">估摸着时间有些对不上的，总之记录下来就好啦</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;timeline&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% timeline 2024 %&#125;</span><br><span class="line">&#123;% timenode 11-11 %&#125;</span><br><span class="line">&#123;% radio pink 追番集功能暂时关闭 %&#125;</span><br><span class="line">&#123;% radio purple 修改藏宝阁功能, 不用通过card来实现画面显示 %&#125;</span><br><span class="line">&#123;% radio yellow 新增想做的事, 本站日志功能 %&#125;</span><br><span class="line">&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-08 %&#125;三个站点的ssh在同一台电脑的配置完成，实现不同站点的deploy&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-07 %&#125;站点的引导页制作完成，可以通过站点实现主站1，主站2，分站之间的跳转&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-05 %&#125;侧边栏添加最近播放的歌曲，那年今日追加&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-04 %&#125;侧边栏添加新年倒计时&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-03 %&#125;侧边栏添加日历&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-02 %&#125;侧边栏添加个性时钟&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 11-01 %&#125;页面banner支持MP4视频显示&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 10-29 %&#125;趣游居，追番集移植完成&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 10-28 %&#125;碎碎念，我的装备，在线工具，关于本人，留言板搭建完成&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 10-27 %&#125;音乐馆搭建完成&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 10-25 %&#125;归档，分类，标签页添加统计图表完成&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% timenode 10-24 %&#125;solitude博客搭建，主题应用完成&#123;% endtimenode %&#125;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><hr><h3 id="2-创建页面模板">2. 创建页面模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/bloglog.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">include ../widgets/page/banner</span><br><span class="line">#article-container</span><br><span class="line">    != page.content</span><br></pre></td></tr></table></figure><hr><h3 id="3-注册页面类型">3. 注册页面类型</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></p><p><strong>修改内容：</strong><br>在 <code>case page.type</code> 处添加 bloglog：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">when &#x27;bloglog&#x27;</span><br><span class="line">    include includes/page/bloglog</span><br></pre></td></tr></table></figure><hr><h3 id="4-导航配置">4. 导航配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改内容：</strong><br>确保导航栏有“本站日志”入口：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">关于:</span></span><br><span class="line">  <span class="string">本站日志:</span> <span class="string">/bloglog/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-book</span></span><br></pre></td></tr></table></figure><hr><h3 id="5-静态资源">5. 静态资源</h3><p>确保 <code>/mp4/bloglog-banner.mp4</code> 已存在于 solitude-latest 的静态资源目录（如 themes/solitude/source/mp4/ 或 public/mp4/）。</p><hr><h3 id="6-样式适配（可选）">6. 样式适配（可选）</h3><p>如果时间轴样式不理想，可自定义样式：</p><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/custom/bloglog.css</code></p><p><strong>示例内容：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.timeline</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">2rem</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--efu-card-bg, <span class="number">#fff</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.05</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.timeline</span> <span class="selector-class">.timenode</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1.5rem</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">1.5rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.timeline</span> <span class="selector-class">.timenode</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0.2rem</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0.7rem</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0.7rem</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--efu-main, <span class="number">#007bff</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.timeline</span> <span class="selector-class">.radio</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0.2rem</span> <span class="number">0.6rem</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.95em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.timeline</span> <span class="selector-class">.radio</span><span class="selector-class">.pink</span> &#123; <span class="attribute">background</span>: <span class="number">#ffb6c1</span>; <span class="attribute">color</span>: <span class="number">#fff</span>; &#125;</span><br><span class="line"><span class="selector-class">.timeline</span> <span class="selector-class">.radio</span><span class="selector-class">.purple</span> &#123; <span class="attribute">background</span>: <span class="number">#b39ddb</span>; <span class="attribute">color</span>: <span class="number">#fff</span>; &#125;</span><br><span class="line"><span class="selector-class">.timeline</span> <span class="selector-class">.radio</span><span class="selector-class">.yellow</span> &#123; <span class="attribute">background</span>: <span class="number">#ffe082</span>; <span class="attribute">color</span>: <span class="number">#333</span>; &#125;</span><br></pre></td></tr></table></figure><p>并在主题CSS入口文件引入（如 <code>index.styl</code>）：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;custom/bloglog.css&#x27;</span></span><br></pre></td></tr></table></figure><hr><h3 id="7-重新生成">7. 重新生成</h3><p>在 solitude-latest 目录下执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><p>访问 <code>/bloglog/</code> 页面即可。</p><hr><h2 id="功能特性">功能特性</h2><h3 id="1-时间轴展示">1. 时间轴展示</h3><ul><li>以时间轴形式展示网站大事记</li><li>支持多种颜色标签（radio）</li></ul><h3 id="2-视频Banner">2. 视频Banner</h3><ul><li>支持MP4视频作为页面顶部Banner</li></ul><h3 id="3-主题适配">3. 主题适配</h3><ul><li>支持浅色/深色主题自动切换</li></ul><h3 id="4-响应式设计">4. 响应式设计</h3><ul><li>适配移动端和桌面端</li></ul><hr><h2 id="使用说明">使用说明</h2><ul><li>编辑 <code>source/bloglog/index.md</code>，添加或修改日志内容</li><li>可自定义时间轴样式</li><li>可随时扩展更多节点和内容</li></ul><hr><h2 id="常见问题解决">常见问题解决</h2><h3 id="1-页面无法访问">1. 页面无法访问</h3><ul><li>检查 <code>page.pug</code> 是否已注册 bloglog 页面类型</li><li>检查导航配置是否正确</li></ul><h3 id="2-样式不生效">2. 样式不生效</h3><ul><li>检查自定义CSS是否已正确引入</li><li>清除浏览器缓存</li></ul><h3 id="3-时间轴内容不显示">3. 时间轴内容不显示</h3><ul><li>检查日志页面内容格式是否正确</li><li>检查主题是否支持 <code>&#123;% timeline %&#125;</code> 语法（如需插件请安装）</li></ul><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们为Solitude主题添加了完整的“本站日志”功能。该功能不仅美观实用，还能帮助站长记录和展示网站成长历程，提升博客的专业性和可读性。</p><hr>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 本站日志 </tag>
            
            <tag> 时间轴 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(12)-想做的事页面</title>
      <link href="/2024/11/18/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(12)-%E6%83%B3%E5%81%9A%E7%9A%84%E4%BA%8B%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/11/18/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(12)-%E6%83%B3%E5%81%9A%E7%9A%84%E4%BA%8B%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有想做的事页面功能，但有时我们希望展示个人的目标和计划。本文将详细介绍如何从blog-solitude项目完整移植想做的事页面功能到solitude-latest，包括数据管理、模板创建、样式设计和响应式布局的完整实现方案。</p><h2 id="功能概述">功能概述</h2><h3 id="目标功能">目标功能</h3><ul><li>展示个人想做的事清单</li><li>支持多个分类管理</li><li>左右两栏布局展示</li><li>完成状态标记功能</li><li>响应式设计适配</li><li>Banner视频播放功能</li><li>移动端优化显示</li></ul><h3 id="技术特点">技术特点</h3><ul><li>数据驱动的YAML配置</li><li>模板化的页面结构</li><li>主题适配的样式设计</li><li>移动端友好的布局</li><li>Banner响应式设计</li></ul><h2 id="移植步骤">移植步骤</h2><h3 id="第一步：创建页面文件">第一步：创建页面文件</h3><h4 id="1-1-创建页面配置文件">1.1 创建页面配置文件</h4><p>在 <code>solitude-latest/source/todolist/index.md</code> 创建页面配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">想做的事</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2024-11-17 04:51:15</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">todolist</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/todolist-banner.mp4</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">天地很大，想做的事很多；人生很长，可以来慢慢实现</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><h4 id="1-2-创建数据配置文件">1.2 创建数据配置文件</h4><p>在 <code>solitude-latest/source/_data/todolist.yml</code> 创建数据配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># seat控制清单在左栏还是右栏显示，completed控制是否已完成</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">想做的项目</span></span><br><span class="line">  <span class="attr">seat:</span> <span class="string">left</span></span><br><span class="line">  <span class="attr">todo_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">主页</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">小程序</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">想看的书</span></span><br><span class="line">  <span class="attr">seat:</span> <span class="string">left</span></span><br><span class="line">  <span class="attr">todo_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">《骆驼祥子》</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">《活着》</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">想买的东西</span></span><br><span class="line">  <span class="attr">seat:</span> <span class="string">left</span></span><br><span class="line">  <span class="attr">todo_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">东西</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">机械硬盘盒</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">想学的技术</span></span><br><span class="line">  <span class="attr">seat:</span> <span class="string">right</span></span><br><span class="line">  <span class="attr">todo_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">骑自行车</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">修自行车</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">想去的地方</span></span><br><span class="line">  <span class="attr">seat:</span> <span class="string">right</span></span><br><span class="line">  <span class="attr">todo_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">桂林</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">心里</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="第二步：创建模板文件">第二步：创建模板文件</h3><h4 id="2-1-创建页面模板">2.1 创建页面模板</h4><p>在 <code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/todolist.pug</code> 创建页面模板：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include ../widgets/page/banner</span><br><span class="line">include ../widgets/page/todolist/content</span><br></pre></td></tr></table></figure><h4 id="2-2-创建内容模板">2.2 创建内容模板</h4><p>在 <code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/todolist/content.pug</code> 创建内容模板：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#todolist-main</span><br><span class="line">        #todolist-left</span><br><span class="line">            each i in site.data.todolist</span><br><span class="line">                if i.seat == &#x27;left&#x27;</span><br><span class="line">                    .todolist-item</span><br><span class="line">                        h3.todolist-title=i.class_name</span><br><span class="line">                        ul.todolist-ul</span><br><span class="line">                            each item in i.todo_list</span><br><span class="line">                                 - var listItemClass = item.completed ? &#x27;todolist-li-done&#x27; : &#x27;todolist-li&#x27;</span><br><span class="line">                                 li(class=listItemClass)</span><br><span class="line">                                    if item.completed</span><br><span class="line">                                        i.fa-regular.fa-circle-check</span><br><span class="line">                                    else </span><br><span class="line">                                        i.fa-regular.fa-circle</span><br><span class="line">                                    span=item.content</span><br><span class="line">        #todolist-right</span><br><span class="line">            each i in site.data.todolist</span><br><span class="line">                if i.seat == &#x27;right&#x27;</span><br><span class="line">                    .todolist-item</span><br><span class="line">                        h3.todolist-title=i.class_name</span><br><span class="line">                        ul.todolist-ul</span><br><span class="line">                            each item in i.todo_list</span><br><span class="line">                                 - var listItemClass = item.completed ? &#x27;todolist-li-done&#x27; : &#x27;todolist-li&#x27;</span><br><span class="line">                                 li(class=listItemClass)</span><br><span class="line">                                    if item.completed</span><br><span class="line">                                        i.fa-regular.fa-circle-check</span><br><span class="line">                                    else </span><br><span class="line">                                        i.fa-regular.fa-circle</span><br><span class="line">                                    span=item.content</span><br></pre></td></tr></table></figure><h3 id="第三步：创建样式文件">第三步：创建样式文件</h3><h4 id="3-1-创建CSS样式文件">3.1 创建CSS样式文件</h4><p>在 <code>solitude-latest/node_modules/hexo-theme-solitude/source/css/custom/todolist.css</code> 创建样式文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-background);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">0</span> <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-id">#page</span> <span class="selector-class">.page-title</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Banner响应式高度设置 */</span></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.sharePage</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">19rem</span>; <span class="comment">/* 与相册集保持一致 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/* 移除边距，与相册集保持一致 */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>; <span class="comment">/* 恢复圆角，与相册集保持一致 */</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 移动端banner设置 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.sharePage</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">150px</span> <span class="meta">!important</span>; <span class="comment">/* 手机端高度 */</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">95%</span> <span class="meta">!important</span>; <span class="comment">/* 手机端宽度 */</span></span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="meta">!important</span>; <span class="comment">/* 居中显示 */</span></span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">12px</span>; <span class="comment">/* 保持圆角 */</span></span><br><span class="line">        <span class="attribute">overflow</span>: hidden;</span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">95%</span>; <span class="comment">/* 确保最大宽度不超过95% */</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 确保父容器不会影响宽度 */</span></span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="meta">!important</span>; <span class="comment">/* 添加左右内边距 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-class">.author-content-item</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">95%</span> <span class="meta">!important</span>; <span class="comment">/* 确保内容区域也是95%宽度 */</span></span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="meta">!important</span>; <span class="comment">/* 居中显示 */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Todolist */</span></span><br><span class="line">  <span class="selector-id">#todolist-box</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#todolist-main</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">30px</span> <span class="number">0</span> <span class="number">10px</span>; <span class="comment">/* 增加顶部间距，从16px改为30px */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#todolist-main</span> <span class="selector-tag">li</span>&#123;</span><br><span class="line">    <span class="attribute">list-style</span>:none;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">17px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#todolist-main</span> <span class="selector-tag">ul</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#todolist-left</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#todolist-right</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.todolist-item</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fae4df</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">1rem</span> <span class="number">1.2rem</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> dashed <span class="number">#f7a796</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-attr">[data-theme=dark]</span></span><br><span class="line">  <span class="selector-class">.todolist-item</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#242424</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> dashed <span class="number">#51908b</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">li</span><span class="selector-class">.todolist-li</span> <span class="selector-tag">i</span>&#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">h3</span><span class="selector-class">.todolist-title</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="built_in">var</span>(--todo-border);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">li</span><span class="selector-class">.todolist-li</span>&#123;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="built_in">var</span>(--todo-border);</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">li</span><span class="selector-class">.todolist-li-done</span>&#123;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="built_in">var</span>(--todo-border);</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">    <span class="attribute">text-decoration</span>: line-through;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.todolist-li</span> <span class="selector-tag">span</span>&#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.todolist-li-done</span> <span class="selector-tag">span</span>&#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">700px</span>)&#123;</span><br><span class="line">    <span class="selector-id">#todolist-left</span>,<span class="selector-id">#todolist-right</span>&#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 手机端内容区域宽度设置，与banner保持一致 */</span></span><br><span class="line">    <span class="selector-id">#todolist-main</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">95%</span> <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">20px</span> auto <span class="number">10px</span> <span class="meta">!important</span>; <span class="comment">/* 增加顶部间距为20px */</span></span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">95%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 确保父容器不会影响宽度 */</span></span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;todolist&quot;</span>]</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="第四步：修改主题文件">第四步：修改主题文件</h3><h4 id="4-1-添加页面类型支持">4.1 添加页面类型支持</h4><p>修改 <code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code> 文件，在case语句中添加todolist支持：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner(class=page.aside ? &#x27;&#x27; : &#x27;hide-aside&#x27;)</span><br><span class="line">        #page</span><br><span class="line">            case page.type</span><br><span class="line">                when &#x27;categories&#x27;</span><br><span class="line">                    include includes/page/categories</span><br><span class="line">                when &#x27;tags&#x27;</span><br><span class="line">                    include includes/page/tags</span><br><span class="line">                when &#x27;links&#x27;</span><br><span class="line">                    include includes/page/links</span><br><span class="line">                when &#x27;about&#x27;</span><br><span class="line">                    include includes/page/about</span><br><span class="line">                when &#x27;brevity&#x27;</span><br><span class="line">                    include includes/page/brevity</span><br><span class="line">                when &#x27;kit&#x27;</span><br><span class="line">                    include includes/page/kit</span><br><span class="line">                when &#x27;music&#x27;</span><br><span class="line">                    include includes/page/music</span><br><span class="line">                when &#x27;game&#x27;</span><br><span class="line">                    include includes/page/game</span><br><span class="line">                when &#x27;collects&#x27;</span><br><span class="line">                    include includes/page/collects</span><br><span class="line">                when &#x27;musicsheets&#x27;</span><br><span class="line">                    include includes/page/musicsheets</span><br><span class="line">                when &#x27;album&#x27;</span><br><span class="line">                    include includes/page/album</span><br><span class="line">                when &#x27;nekko&#x27;</span><br><span class="line">                    include includes/page/nekko</span><br><span class="line">                when &#x27;todolist&#x27;</span><br><span class="line">                    include includes/page/todolist</span><br><span class="line">                when &#x27;message&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/message&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;recentcomment&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/recentcomment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;banner&#x27;</span><br><span class="line">                    include includes/widgets/page/banner</span><br><span class="line">                    if page.container</span><br><span class="line">                        include includes/page/default</span><br><span class="line">                    else</span><br><span class="line">                        != page.content</span><br><span class="line">                default</span><br><span class="line">                    include includes/page/default</span><br><span class="line">            if page.comment</span><br><span class="line">                - var comment_js = true</span><br><span class="line">                include includes/widgets/third-party/comments/comment</span><br><span class="line">        if page.aside</span><br><span class="line">            include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><h4 id="4-2-引入CSS文件">4.2 引入CSS文件</h4><p>修改 <code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code> 文件，在适当位置添加：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@charset</span> <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;css_prefix&#x27;</span>)</span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;nib&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;third_party/snackbar.min.css&quot;</span></span><br><span class="line"><span class="comment">// project</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;var.styl&quot;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_global/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_layout/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/index.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_post/index.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/game.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/collects.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/musicsheets.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/album.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;custom/todolist.css&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_mode/*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// highlight</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_highlight/index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// search</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;search.enable&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;search.type&#x27;</span>) == <span class="string">&#x27;algolia&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;_search/algolia-search&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;search.type&#x27;</span>) == <span class="string">&#x27;local&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;_search/local-search&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tags plugin</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;_tags/*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// comment</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;comment.use&#x27;</span>)</span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;_comments/comment.styl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// components</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_components/index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// album modal</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;album-modal.css&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="第五步：配置导航">第五步：配置导航</h3><h4 id="5-1-检查导航配置">5.1 检查导航配置</h4><p>确保 <code>solitude-latest/_config.solitude.yml</code> 中已包含想做的事的导航配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="comment"># 主菜单格式 → name: url</span></span><br><span class="line">  <span class="string">站点:</span> <span class="string">/navigate/</span></span><br><span class="line">  <span class="string">文章:</span></span><br><span class="line">    <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-box-archive</span></span><br><span class="line">    <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-clone</span></span><br><span class="line">    <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="comment"># 有子菜单不用绑定url</span></span><br><span class="line">  <span class="string">分享:</span> </span><br><span class="line">    <span class="comment"># 子菜单格式 →item name: link || icon (|| icon 为非必要选项)</span></span><br><span class="line">    <span class="string">音乐馆:</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-music</span></span><br><span class="line">    <span class="string">电玩屋:</span> <span class="string">/game/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-gamepad</span></span><br><span class="line">    <span class="string">藏宝阁:</span> <span class="string">/collects/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-gift</span></span><br><span class="line">    <span class="string">乐谱坊:</span> <span class="string">/musicsheets/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-file-audio</span></span><br><span class="line">  <span class="string">我的:</span></span><br><span class="line">    <span class="string">相册集:</span> <span class="string">/album/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-image</span></span><br><span class="line">    <span class="string">碎碎念:</span> <span class="string">/tsukkomi/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-head-side-cough</span></span><br><span class="line">    <span class="string">猫の日:</span> <span class="string">/nekko/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-cake-candles</span></span><br><span class="line">  <span class="string">工具:</span></span><br><span class="line">    <span class="string">装备库:</span> <span class="string">/equipment/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-laptop</span></span><br><span class="line">    <span class="string">工具箱:</span> <span class="string">/tlink/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-toolbox</span></span><br><span class="line">  <span class="string">关于:</span></span><br><span class="line">    <span class="string">关于本人:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-address-card</span></span><br><span class="line">    <span class="string">想做的事:</span> <span class="string">/todolist/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-clipboard-list</span></span><br><span class="line">    <span class="string">本站日志:</span> <span class="string">/bloglog/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-book</span></span><br><span class="line">    <span class="string">留言板:</span> <span class="string">/comments/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-envelope</span></span><br><span class="line">    <span class="string">弹幕栏:</span> <span class="string">/message/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-envelope</span></span><br></pre></td></tr></table></figure><h3 id="第六步：测试和构建">第六步：测试和构建</h3><h4 id="6-1-构建项目">6.1 构建项目</h4><p>运行以下命令构建项目：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> solitude-latest</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure><h4 id="6-2-启动本地服务器">6.2 启动本地服务器</h4><p>运行以下命令启动本地服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run server</span><br></pre></td></tr></table></figure><h4 id="6-3-访问页面">6.3 访问页面</h4><p>在浏览器中访问 <code>http://localhost:4000/todolist/</code> 查看页面效果。</p><h2 id="功能特点详解">功能特点详解</h2><h3 id="1-数据驱动设计">1. 数据驱动设计</h3><ul><li><strong>YAML配置</strong>：通过 <code>todolist.yml</code> 文件管理所有待办事项</li><li><strong>动态更新</strong>：无需修改代码，直接编辑配置文件即可更新内容</li><li><strong>分类管理</strong>：支持多个分类，每个分类独立管理</li></ul><h3 id="2-布局设计">2. 布局设计</h3><ul><li><strong>左右两栏</strong>：桌面端采用左右两栏布局，合理利用空间</li><li><strong>响应式</strong>：移动端自动切换为单栏布局</li><li><strong>卡片设计</strong>：每个分类采用卡片式设计，视觉效果更好</li></ul><h3 id="3-状态管理">3. 状态管理</h3><ul><li><strong>完成状态</strong>：支持标记已完成/未完成状态</li><li><strong>视觉反馈</strong>：已完成项目显示删除线效果</li><li><strong>图标区分</strong>：使用不同图标区分完成状态</li></ul><h3 id="4-主题适配">4. 主题适配</h3><ul><li><strong>浅色主题</strong>：粉色背景，温馨舒适</li><li><strong>深色主题</strong>：深灰背景，护眼舒适</li><li><strong>自动切换</strong>：跟随主题设置自动切换样式</li></ul><h3 id="5-Banner响应式设计">5. Banner响应式设计</h3><ul><li><strong>桌面端</strong>：19rem高度，与相册集页面保持一致</li><li><strong>移动端</strong>：150px高度，95%宽度，居中显示</li><li><strong>视频播放</strong>：支持Banner视频背景播放</li><li><strong>圆角设计</strong>：12px圆角，视觉效果更佳</li></ul><h3 id="6-移动端优化">6. 移动端优化</h3><ul><li><strong>宽度统一</strong>：banner和内容区域都是95%宽度</li><li><strong>间距优化</strong>：桌面端30px间距，移动端20px间距</li><li><strong>居中显示</strong>：移动端自动居中，视觉效果更好</li><li><strong>响应式布局</strong>：自动适配不同屏幕尺寸</li></ul><h3 id="7-交互体验">7. 交互体验</h3><ul><li><strong>悬停效果</strong>：鼠标悬停时的视觉反馈</li><li><strong>平滑过渡</strong>：CSS过渡动画，体验更流畅</li><li><strong>移动友好</strong>：触摸设备上的良好体验</li></ul><h2 id="自定义配置">自定义配置</h2><h3 id="1-修改数据内容">1. 修改数据内容</h3><p>编辑 <code>source/_data/todolist.yml</code> 文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">你的分类名称</span></span><br><span class="line">  <span class="attr">seat:</span> <span class="string">left</span>  <span class="comment"># left或right</span></span><br><span class="line">  <span class="attr">todo_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">你的待办事项</span></span><br><span class="line">      <span class="attr">completed:</span> <span class="literal">false</span>  <span class="comment"># true或false</span></span><br></pre></td></tr></table></figure><h3 id="2-修改页面信息">2. 修改页面信息</h3><p>编辑 <code>source/todolist/index.md</code> 文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">你的页面标题</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2024-11-17 04:51:15</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">todolist</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/todolist-banner.mp4</span>  <span class="comment"># 你的视频文件</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">你的页面描述</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><h3 id="3-自定义样式">3. 自定义样式</h3><p>编辑 <code>node_modules/hexo-theme-solitude/source/css/custom/todolist.css</code> 文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 修改背景颜色 */</span></span><br><span class="line"><span class="selector-class">.todolist-item</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: #你的颜色;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 修改边框样式 */</span></span><br><span class="line"><span class="selector-class">.todolist-item</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> dashed #你的颜色;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 修改字体大小 */</span></span><br><span class="line"><span class="selector-id">#todolist-main</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: 你的大小px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 修改间距 */</span></span><br><span class="line"><span class="selector-id">#todolist-main</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: 你的间距px <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="常见问题">常见问题</h2><h3 id="Q1-页面无法访问">Q1: 页面无法访问</h3><p><strong>A</strong>: 检查以下几点：</p><ol><li>确保 <code>page.pug</code> 中已添加todolist支持</li><li>确保页面文件路径正确</li><li>重新构建项目</li></ol><h3 id="Q2-样式不生效">Q2: 样式不生效</h3><p><strong>A</strong>: 检查以下几点：</p><ol><li>确保CSS文件路径正确</li><li>确保 <code>index.styl</code> 中已引入todolist.css</li><li>清除浏览器缓存</li></ol><h3 id="Q3-数据不显示">Q3: 数据不显示</h3><p><strong>A</strong>: 检查以下几点：</p><ol><li>确保YAML文件格式正确</li><li>确保文件路径为 <code>source/_data/todolist.yml</code></li><li>检查模板文件语法</li></ol><h3 id="Q4-移动端显示异常">Q4: 移动端显示异常</h3><p><strong>A</strong>: 检查以下几点：</p><ol><li>确保CSS中包含响应式媒体查询</li><li>测试不同屏幕尺寸</li><li>检查移动端样式是否正确</li></ol><h3 id="Q5-Banner视频不显示">Q5: Banner视频不显示</h3><p><strong>A</strong>: 检查以下几点：</p><ol><li>确保视频文件路径正确</li><li>确保视频文件格式为MP4</li><li>检查浏览器是否支持HTML5 video</li></ol><h2 id="扩展功能">扩展功能</h2><h3 id="1-添加动画效果">1. 添加动画效果</h3><p>可以在CSS中添加动画效果：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.todolist-item</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.todolist-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">2px</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-添加交互功能">2. 添加交互功能</h3><p>可以通过JavaScript添加点击切换完成状态的功能：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.todolist-li&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    item.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;todolist-li-done&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="3-添加统计功能">3. 添加统计功能</h3><p>可以添加完成进度统计：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> totalItems = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.todolist-li, .todolist-li-done&#x27;</span>).<span class="property">length</span>;</span><br><span class="line"><span class="keyword">const</span> completedItems = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.todolist-li-done&#x27;</span>).<span class="property">length</span>;</span><br><span class="line"><span class="keyword">const</span> progress = (completedItems / totalItems * <span class="number">100</span>).<span class="title function_">toFixed</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h2 id="总结">总结</h2><p>通过以上步骤，我们成功为Solitude主题添加了完整的想做的事功能。这个功能不仅提供了美观的待办事项展示界面，还具有良好的扩展性和维护性。用户可以根据自己的需求轻松添加和管理待办事项，展示个人的目标和计划。</p><h3 id="主要优势">主要优势</h3><ol><li><strong>数据驱动</strong>：通过YAML文件管理，易于维护</li><li><strong>响应式设计</strong>：适配各种设备</li><li><strong>主题适配</strong>：支持浅色/深色主题</li><li><strong>Banner视频</strong>：支持视频背景播放</li><li><strong>移动端优化</strong>：完美的移动端体验</li><li><strong>扩展性强</strong>：易于添加新功能</li><li><strong>用户体验好</strong>：界面美观，交互流畅</li></ol><h3 id="重要更新">重要更新</h3><ul><li><strong>Banner响应式设计</strong>：与相册集页面保持一致，移动端优化</li><li><strong>移动端宽度统一</strong>：banner和内容区域都是95%宽度</li><li><strong>间距优化</strong>：桌面端30px间距，移动端20px间距</li><li><strong>视觉一致性</strong>：与猫の日页面完全一致的banner样式</li></ul><p>这个功能为Solitude主题增添了独特的个人管理模块，丰富了博客的内容展示形式，提升了用户体验。用户可以通过这个页面展示自己的目标和计划，让博客更加个性化和实用。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 想做的事 </tag>
            
            <tag> Todolist </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(11)-猫の日页面</title>
      <link href="/2024/11/11/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(11)-%E7%8C%AB%E3%81%AE%E6%97%A5%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/11/11/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(11)-%E7%8C%AB%E3%81%AE%E6%97%A5%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在之前的魔改教程中，我们已经成功移植了相册集、电玩屋、藏宝阁、乐谱坊等多个页面功能。今天，我们将继续移植一个非常有趣的功能——<strong>猫の日</strong>页面。</p><p>这个页面主要用于记录宠物的纪念日，支持农历计算、多种显示模式（天数/周数/月数），并且包含精美的banner视频和可爱的宠物图标。让我们一起来看看如何完整移植这个功能。</p><h2 id="功能分析">功能分析</h2><h3 id="主要特性">主要特性</h3><ul><li>🎥 <strong>Banner视频播放</strong> - 可爱的猫咪视频背景</li><li>🐱 <strong>宠物纪念日卡片</strong> - 显示宠物信息和时间计算</li><li>📅 <strong>农历支持</strong> - 支持农历日期计算</li><li>🔄 <strong>多模式显示</strong> - 点击切换天数/周数/月数显示</li><li>📱 <strong>响应式设计</strong> - 适配不同设备屏幕</li><li>🎨 <strong>精美样式</strong> - 卡片悬停效果和动画</li></ul><h3 id="文件结构">文件结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">blog-solitude/</span><br><span class="line">├── source/</span><br><span class="line">│   ├── nekko/</span><br><span class="line">│   │   └── index.md                    # 页面文件</span><br><span class="line">│   └── _data/</span><br><span class="line">│       └── nekko.yml                   # 宠物数据</span><br><span class="line">├── themes/solitude/</span><br><span class="line">│   ├── layout/includes/page/</span><br><span class="line">│   │   └── nekko.pug                   # 页面模板</span><br><span class="line">│   ├── layout/includes/widgets/page/nekko/</span><br><span class="line">│   │   └── content.pug                 # 内容模板</span><br><span class="line">│   ├── source/css/custom/</span><br><span class="line">│   │   └── nekko.css                   # 样式文件</span><br><span class="line">│   └── source/js/custom/</span><br><span class="line">│       └── nekko.js                    # 脚本文件</span><br><span class="line">└── public/</span><br><span class="line">    ├── img/cats/</span><br><span class="line">    │   ├── miya-icon.png               # 宠物图标</span><br><span class="line">    │   └── mona-icon.png</span><br><span class="line">    └── mp4/</span><br><span class="line">        └── cats-banner.mp4             # Banner视频</span><br></pre></td></tr></table></figure><h2 id="移植步骤">移植步骤</h2><h3 id="1-创建页面文件">1. 创建页面文件</h3><p>首先创建nekko页面的markdown文件：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 猫の日</span><br><span class="line">date: 2024-11-18 13:04:37</span><br><span class="line">type: nekko</span><br><span class="line">cover: /mp4/cats-banner.mp4</span><br><span class="line"><span class="section">desc: 网上撸猫指日可待</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/source/nekko/index.md</code></p><p><strong>注意：</strong> 移除了<code>container: true</code>设置，与相册集页面保持一致。</p><h3 id="2-创建数据文件">2. 创建数据文件</h3><p>创建宠物纪念日数据文件：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">我的小鼻噶们</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">&quot;宠物纪念日&quot;</span></span><br><span class="line">  <span class="attr">anniversaries:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MIYA</span></span><br><span class="line">      <span class="attr">date:</span> <span class="string">&#x27;2023-01-11&#x27;</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">&#x27;/img/cats/miya-icon.png&#x27;</span></span><br><span class="line">      <span class="attr">lunar:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">color:</span> <span class="string">&#x27;#ffb3c6&#x27;</span></span><br><span class="line">      <span class="attr">display_mode:</span> <span class="string">&quot;elapsed&quot;</span></span><br><span class="line">      <span class="attr">show_copyright:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">copyright_name:</span> <span class="string">&quot;喵喵纪念日&quot;</span></span><br><span class="line">      <span class="attr">copyright_link:</span> <span class="string">&quot;https://blog.bornforthis.cn/anniversary/&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MONA</span></span><br><span class="line">      <span class="attr">date:</span> <span class="string">&#x27;2023-02-12&#x27;</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">&#x27;/img/cats/mona-icon.png&#x27;</span></span><br><span class="line">      <span class="attr">lunar:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">color:</span> <span class="string">&#x27;#f1faee&#x27;</span></span><br><span class="line">      <span class="attr">display_mode:</span> <span class="string">&quot;elapsed&quot;</span></span><br><span class="line">      <span class="attr">show_copyright:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">copyright_name:</span> <span class="string">&quot;喵喵纪念日&quot;</span></span><br><span class="line">      <span class="attr">copyright_link:</span> <span class="string">&quot;https://blog.bornforthis.cn/anniversary/&quot;</span></span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/source/_data/nekko.yml</code></p><h3 id="3-创建页面模板">3. 创建页面模板</h3><p>创建nekko页面模板：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include ../widgets/page/banner</span><br><span class="line">include ../widgets/page/nekko/content</span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/nekko.pug</code></p><h3 id="4-创建内容模板">4. 创建内容模板</h3><p>创建nekko内容模板：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#nekko-box</span><br><span class="line">    #nekko-main</span><br><span class="line">      each group in site.data.nekko</span><br><span class="line">        .nekko-group</span><br><span class="line">          .group-header</span><br><span class="line">            .group-title #&#123;group.class_name&#125; (#&#123;group.anniversaries.length&#125;)</span><br><span class="line">            .group-desc #&#123;group.class_desc&#125;</span><br><span class="line">          .nekko-cards</span><br><span class="line">            each item in group.anniversaries</span><br><span class="line">              .nekko-card(style=`background-color: $&#123;item.color&#125;`)</span><br><span class="line">                .card-content</span><br><span class="line">                  .card-header(style=&quot;justify-content: center;&quot;)</span><br><span class="line">                    if item.icon</span><br><span class="line">                      img.card-icon(src=item.icon alt=&quot;icon&quot;)</span><br><span class="line">                    .card-title #&#123;item.name&#125;</span><br><span class="line">                  .card-body(style=&quot;background-color: white; padding: 20px; text-align: center;&quot;)</span><br><span class="line">                    .countdown-wrapper</span><br><span class="line">                      span.countdown(data-date=item.date data-lunar=item.lunar data-display-mode=item.display_mode) 计算中...</span><br><span class="line">                      .days-label 天后</span><br><span class="line">                  .card-footer</span><br><span class="line">                    .dashed-line(style=&quot;border-top: 1px dashed #ccc; margin: 10px 0;&quot;)</span><br><span class="line">                    .target-info </span><br><span class="line">                      if item.display_mode === &#x27;elapsed&#x27;</span><br><span class="line">                        span.target-label - 诞生日 -</span><br><span class="line">                      else</span><br><span class="line">                        span.target-label - 目标日 -</span><br><span class="line">                      br</span><br><span class="line">                      span.target-date(data-date=item.date data-lunar=item.lunar data-display-mode=item.display_mode) 计算中...</span><br><span class="line"></span><br><span class="line">                if item.show_copyright</span><br><span class="line">                  - let copyrightName = item.copyright_name ? item.copyright_name : &#x27;喵喵纪念日&#x27;</span><br><span class="line">                  - let copyrightLink = item.copyright_link ? item.copyright_link : &#x27;https://blog.bornforthis.cn/posts/41c7c45e.html&#x27;</span><br><span class="line">                  .card-copyright</span><br><span class="line">                    | 版权所有 © #&#123;item.name&#125;</span><br><span class="line">                    a(href=copyrightLink target=&quot;_blank&quot;) #&#123;copyrightName&#125;</span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/nekko/content.pug</code></p><h3 id="5-修改主题布局">5. 修改主题布局</h3><p>在page.pug中添加nekko类型支持：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">when &#x27;nekko&#x27;</span><br><span class="line">    include includes/page/nekko</span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></p><h3 id="6-创建样式文件">6. 创建样式文件</h3><p>创建nekko的CSS样式文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 背景与页面基本样式 */</span></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-background);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">0</span> <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-id">#page</span> <span class="selector-class">.page-title</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Banner响应式高度设置 */</span></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.sharePage</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">19rem</span>; <span class="comment">/* 与相册集保持一致 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/* 移除边距，与相册集保持一致 */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>; <span class="comment">/* 恢复圆角，与相册集保持一致 */</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 移动端banner设置 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.sharePage</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">150px</span> <span class="meta">!important</span>; <span class="comment">/* 手机端高度 */</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">95%</span> <span class="meta">!important</span>; <span class="comment">/* 手机端宽度 */</span></span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="meta">!important</span>; <span class="comment">/* 居中显示 */</span></span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">12px</span>; <span class="comment">/* 保持圆角 */</span></span><br><span class="line">        <span class="attribute">overflow</span>: hidden;</span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">95%</span>; <span class="comment">/* 确保最大宽度不超过95% */</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 确保父容器不会影响宽度 */</span></span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-id">#page</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="meta">!important</span>; <span class="comment">/* 添加左右内边距 */</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;nekko&quot;</span>]</span> <span class="selector-class">.author-content-item</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">95%</span> <span class="meta">!important</span>; <span class="comment">/* 确保内容区域也是95%宽度 */</span></span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="meta">!important</span>; <span class="comment">/* 居中显示 */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 卡片整体布局 */</span></span><br><span class="line"><span class="selector-class">.nekko-cards</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: grid;</span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="built_in">minmax</span>(<span class="number">250px</span>, <span class="number">1</span>fr)); <span class="comment">/* 响应式布局 */</span></span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 卡片样式 */</span></span><br><span class="line"><span class="selector-class">.nekko-card</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">4px</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="number">0.3s</span> ease-in-out, box-shadow <span class="number">0.3s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.nekko-card</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">10px</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">10px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 卡片标题和图标水平居中对齐的样式 */</span></span><br><span class="line"><span class="selector-class">.card-header</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center; <span class="comment">/* 水平居中 */</span></span><br><span class="line">    <span class="attribute">align-items</span>: center; <span class="comment">/* 垂直居中 */</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center; <span class="comment">/* 文本居中 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card-icon</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">54px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">54px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/* 图标与标题之间的间距 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 白色背景的中间部分 */</span></span><br><span class="line"><span class="selector-class">.card-body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: white;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 剩余天数与&quot;天后&quot;的样式 */</span></span><br><span class="line"><span class="selector-class">.countdown-wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">3rem</span>; <span class="comment">/* 设置数字大小 */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#6b4226</span>; <span class="comment">/* 设置数字的颜色 */</span></span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.days-label</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">right</span>: -<span class="number">45px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#36c5b2</span>;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">3px</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 目标日样式 */</span></span><br><span class="line"><span class="selector-class">.target-info</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.target-label</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/* 去掉额外的边距 */</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">letter-spacing</span>: <span class="number">2px</span>; <span class="comment">/* 保持文字间距 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.target-date</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block; <span class="comment">/* 改为inline-block，直接与目标日标签对齐 */</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/* 去掉所有的上下边距 */</span></span><br><span class="line">    <span class="attribute">font-weight</span>: normal; <span class="comment">/* 去掉加粗效果 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 虚线样式 */</span></span><br><span class="line"><span class="selector-class">.dashed-line</span> &#123;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> dashed <span class="number">#ccc</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 目标日期与已经过去的天数信息 */</span></span><br><span class="line"><span class="selector-class">.target-info</span>, <span class="selector-class">.total-days-info</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式布局优化，适配不同设备 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.nekko-cards</span> &#123;</span><br><span class="line">        <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.nekko-card</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.card-title</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.2rem</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 动画效果 */</span></span><br><span class="line"><span class="selector-class">.nekko-card</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.nekko-card</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">6px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 版权信息的样式 */</span></span><br><span class="line"><span class="selector-class">.card-copyright</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.85rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card-copyright</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#007bff</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.card-copyright</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 分组标题和描述样式 */</span></span><br><span class="line"><span class="selector-class">.nekko-group</span> &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.group-header</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: left; <span class="comment">/* 将文本左对齐 */</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.group-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: left; <span class="comment">/* 分组标题左对齐 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.group-desc</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: left; <span class="comment">/* 分组描述左对齐 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/node_modules/hexo-theme-solitude/source/css/custom/nekko.css</code></p><p><strong>重要更新：</strong></p><ul><li>添加了Banner响应式设置，与相册集页面保持一致</li><li>移动端banner高度为150px，宽度为95%</li><li>桌面端banner高度为19rem，与相册集一致</li></ul><h3 id="7-创建脚本文件">7. 创建脚本文件</h3><p>创建nekko的JavaScript文件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nekko.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initializenekko</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">LunarDate</span>(<span class="params">Year, Month, Day</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> solar = <span class="title class_">Lunar</span>.<span class="title function_">fromYmdHms</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>).<span class="title function_">getSolar</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(solar.<span class="title function_">getYear</span>(), solar.<span class="title function_">getMonth</span>() - <span class="number">1</span>, solar.<span class="title function_">getDay</span>());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">LunarDate</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span> - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 计算两个日期之间的天数差</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">daysBetween</span>(<span class="params">date1, date2</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> oneDay = <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>((date2 - date1) / oneDay);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 计算两个日期之间的周数和天数差</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">weeksAndDaysBetween</span>(<span class="params">date1, date2</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> totalDays = <span class="title function_">daysBetween</span>(date1, date2);</span><br><span class="line">        <span class="keyword">const</span> weeks = <span class="title class_">Math</span>.<span class="title function_">floor</span>(totalDays / <span class="number">7</span>);</span><br><span class="line">        <span class="keyword">const</span> days = totalDays % <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123; weeks, days &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 计算两个日期之间的月数和天数差</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">monthsAndDaysBetween</span>(<span class="params">date1, date2</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> years = date2.<span class="title function_">getFullYear</span>() - date1.<span class="title function_">getFullYear</span>();</span><br><span class="line">        <span class="keyword">let</span> months = date2.<span class="title function_">getMonth</span>() - date1.<span class="title function_">getMonth</span>() + years * <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">let</span> days = date2.<span class="title function_">getDate</span>() - date1.<span class="title function_">getDate</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (days &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            months -= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">let</span> previousMonth = <span class="keyword">new</span> <span class="title class_">Date</span>(date2.<span class="title function_">getFullYear</span>(), date2.<span class="title function_">getMonth</span>(), <span class="number">0</span>);</span><br><span class="line">            days += previousMonth.<span class="title function_">getDate</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123; months, days &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 剩余天数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">daysLeft</span>(<span class="params">dateStr, isLunar</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> [<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>] = dateStr.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="title class_">Number</span>);</span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        now = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), now.<span class="title function_">getMonth</span>(), now.<span class="title function_">getDate</span>());</span><br><span class="line">        <span class="keyword">let</span> nekkoDate;</span><br><span class="line">        <span class="keyword">if</span> (isLunar) &#123;</span><br><span class="line">            nekkoDate = <span class="title class_">LunarDate</span>(now.<span class="title function_">getFullYear</span>(), <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">            <span class="keyword">if</span> (nekkoDate &lt; now) &#123;</span><br><span class="line">                nekkoDate = <span class="title class_">LunarDate</span>(now.<span class="title function_">getFullYear</span>() + <span class="number">1</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            nekkoDate = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">            <span class="keyword">if</span> (nekkoDate &lt; now) &#123;</span><br><span class="line">                nekkoDate = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>() + <span class="number">1</span>, <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">daysBetween</span>(now, nekkoDate);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 经过天数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">totalDays</span>(<span class="params">dateStr, isLunar</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> [<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>] = dateStr.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="title class_">Number</span>);</span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        now = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), now.<span class="title function_">getMonth</span>(), now.<span class="title function_">getDate</span>());</span><br><span class="line">        <span class="keyword">let</span> startDate;</span><br><span class="line">        <span class="keyword">if</span> (isLunar) &#123;</span><br><span class="line">            startDate = <span class="title class_">LunarDate</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            startDate = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">daysBetween</span>(startDate, now);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 返回目标或起始日期以及星期几</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">targetDate</span>(<span class="params">dateStr, isLunar</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> [<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>] = dateStr.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="title class_">Number</span>);</span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        now = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), now.<span class="title function_">getMonth</span>(), now.<span class="title function_">getDate</span>());</span><br><span class="line">        <span class="keyword">let</span> nekkoDate;</span><br><span class="line">        <span class="keyword">if</span> (isLunar) &#123;</span><br><span class="line">            nekkoDate = <span class="title class_">LunarDate</span>(now.<span class="title function_">getFullYear</span>(), <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">            <span class="keyword">if</span> (nekkoDate &lt; now) &#123;</span><br><span class="line">                nekkoDate = <span class="title class_">LunarDate</span>(now.<span class="title function_">getFullYear</span>() + <span class="number">1</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            nekkoDate = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">            <span class="keyword">if</span> (nekkoDate &lt; now) &#123;</span><br><span class="line">                nekkoDate = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>() + <span class="number">1</span>, <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> weekDay = nekkoDate.<span class="title function_">toLocaleDateString</span>(<span class="string">&#x27;zh-CN&#x27;</span>, &#123; <span class="attr">weekday</span>: <span class="string">&#x27;long&#x27;</span> &#125;);</span><br><span class="line">        <span class="keyword">const</span> year = nekkoDate.<span class="title function_">getFullYear</span>();</span><br><span class="line">        <span class="keyword">const</span> month = (nekkoDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> day = nekkoDate.<span class="title function_">getDate</span>().<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;year&#125;</span>-<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;day&#125;</span> (<span class="subst">$&#123;weekDay&#125;</span>)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 返回目标或起始日期（根据 displayMode）</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">targetOrStartDate</span>(<span class="params">dateStr, isLunar, displayMode</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (displayMode === <span class="string">&quot;elapsed&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> dateStr;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">targetDate</span>(dateStr, isLunar);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> countdownElements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.countdown&quot;</span>);</span><br><span class="line"></span><br><span class="line">    countdownElements.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">elem</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> dateStr = elem.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-date&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> isLunar = elem.<span class="title function_">hasAttribute</span>(<span class="string">&quot;data-lunar&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> displayMode = elem.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-display-mode&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (displayMode === <span class="string">&quot;elapsed&quot;</span>) &#123;</span><br><span class="line">            elem.<span class="property">dataset</span>.<span class="property">displayState</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="title function_">updateElapsedDisplay</span>(elem, dateStr, isLunar, <span class="number">0</span>);</span><br><span class="line">            elem.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">let</span> currentState = <span class="built_in">parseInt</span>(elem.<span class="property">dataset</span>.<span class="property">displayState</span>);</span><br><span class="line">                currentState = (currentState + <span class="number">1</span>) % <span class="number">3</span>;</span><br><span class="line">                elem.<span class="property">dataset</span>.<span class="property">displayState</span> = currentState.<span class="title function_">toString</span>();</span><br><span class="line">                <span class="title function_">updateElapsedDisplay</span>(elem, dateStr, isLunar, currentState);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> daysText = <span class="title function_">daysLeft</span>(dateStr, isLunar);</span><br><span class="line">            elem.<span class="property">textContent</span> = daysText;</span><br><span class="line">            elem.<span class="property">nextElementSibling</span>.<span class="property">textContent</span> = <span class="string">&quot;天后&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新elapsed模式下的显示内容</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateElapsedDisplay</span>(<span class="params">elem, dateStr, isLunar, displayState</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (displayState === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> days = <span class="title function_">totalDays</span>(dateStr, isLunar);</span><br><span class="line">            elem.<span class="property">textContent</span> = days;</span><br><span class="line">            elem.<span class="property">nextElementSibling</span>.<span class="property">textContent</span> = <span class="string">&quot;天了&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (displayState === <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> [<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>] = dateStr.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="title class_">Number</span>);</span><br><span class="line">            <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">            now = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), now.<span class="title function_">getMonth</span>(), now.<span class="title function_">getDate</span>());</span><br><span class="line">            <span class="keyword">let</span> startDate;</span><br><span class="line">            <span class="keyword">if</span> (isLunar) &#123;</span><br><span class="line">                startDate = <span class="title class_">LunarDate</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                startDate = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> &#123; weeks, days &#125; = <span class="title function_">weeksAndDaysBetween</span>(startDate, now);</span><br><span class="line">            <span class="keyword">if</span> (days === <span class="number">0</span>) &#123;</span><br><span class="line">                elem.<span class="property">textContent</span> = weeks;</span><br><span class="line">                elem.<span class="property">nextElementSibling</span>.<span class="property">textContent</span> = <span class="string">&quot;周了&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                elem.<span class="property">textContent</span> = <span class="string">`<span class="subst">$&#123;weeks&#125;</span>周<span class="subst">$&#123;days&#125;</span>天`</span>;</span><br><span class="line">                elem.<span class="property">nextElementSibling</span>.<span class="property">textContent</span> = <span class="string">&quot;了&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (displayState === <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> [<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>] = dateStr.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>).<span class="title function_">map</span>(<span class="title class_">Number</span>);</span><br><span class="line">            <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">            now = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">getFullYear</span>(), now.<span class="title function_">getMonth</span>(), now.<span class="title function_">getDate</span>());</span><br><span class="line">            <span class="keyword">let</span> startDate;</span><br><span class="line">            <span class="keyword">if</span> (isLunar) &#123;</span><br><span class="line">                startDate = <span class="title class_">LunarDate</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                startDate = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Year</span>, <span class="title class_">Month</span> - <span class="number">1</span>, <span class="title class_">Day</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> &#123; months, days &#125; = <span class="title function_">monthsAndDaysBetween</span>(startDate, now);</span><br><span class="line">            elem.<span class="property">textContent</span> = <span class="string">`<span class="subst">$&#123;months&#125;</span>月<span class="subst">$&#123;days&#125;</span>天`</span>;</span><br><span class="line">            elem.<span class="property">nextElementSibling</span>.<span class="property">textContent</span> = <span class="string">&quot;了&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 显示目标或起始日期</span></span><br><span class="line">    <span class="keyword">const</span> targetDateElements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.target-date&quot;</span>);</span><br><span class="line">    targetDateElements.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">elem</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> dateStr = elem.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-date&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> isLunar = elem.<span class="title function_">hasAttribute</span>(<span class="string">&quot;data-lunar&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> displayMode = elem.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-display-mode&quot;</span>);</span><br><span class="line">        elem.<span class="property">textContent</span> = <span class="title function_">targetOrStartDate</span>(dateStr, isLunar, displayMode);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始页面加载</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, initializenekko);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 适配 pjax</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:complete&quot;</span>, initializenekko);</span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong> <code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/nekko.js</code></p><h3 id="8-修改配置文件">8. 修改配置文件</h3><p>在<code>_config.solitude.yml</code>中添加CSS和JS引用：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extends:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># 喵喵纪念日</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom/nekko.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">body:</span></span><br><span class="line">    <span class="comment"># 喵喵纪念日</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/nekko.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdnjs.cloudflare.com/ajax/libs/lunar-javascript/1.6.12/lunar.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-复制资源文件">9. 复制资源文件</h3><p>复制宠物图标和视频文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p solitude-latest/public/img/cats</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制图标文件（从solitude-latest-huai目录）</span></span><br><span class="line"><span class="built_in">cp</span> solitude-latest-huai/public/img/cats/*.png solitude-latest/public/img/cats/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制视频文件</span></span><br><span class="line"><span class="built_in">cp</span> solitude-latest-huai/public/mp4/cats-banner.mp4 solitude-latest/public/mp4/</span><br></pre></td></tr></table></figure><p><strong>注意：</strong> 所有文件都可以从solitude-latest-huai目录复制，无需从原始blog-solitude项目获取。</p><h2 id="功能特点详解">功能特点详解</h2><h3 id="1-Banner视频播放">1. Banner视频播放</h3><ul><li>使用HTML5 video标签实现自动播放</li><li>支持静音、循环播放、内联播放</li><li>响应式设计，适配不同屏幕尺寸</li></ul><h3 id="2-Banner响应式设置">2. Banner响应式设置</h3><ul><li><strong>桌面端</strong>：高度19rem，宽度100%，与相册集页面保持一致</li><li><strong>移动端</strong>：高度150px，宽度95%，居中显示，左右各有2.5%边距</li><li><strong>圆角效果</strong>：12px圆角，保持美观</li><li><strong>自动居中</strong>：移动端使用<code>margin: 0 auto</code>确保居中显示</li></ul><h3 id="3-宠物纪念日卡片">3. 宠物纪念日卡片</h3><ul><li>网格布局，响应式设计</li><li>悬停动画效果</li><li>支持自定义颜色和图标</li><li>显示宠物名称和纪念日信息</li></ul><h3 id="4-时间计算功能">4. 时间计算功能</h3><ul><li><strong>天数模式</strong>：显示已经过去的天数</li><li><strong>周数模式</strong>：显示已经过去的周数和天数</li><li><strong>月数模式</strong>：显示已经过去的月数和天数</li><li>点击卡片可切换显示模式</li></ul><h3 id="5-农历支持">5. 农历支持</h3><ul><li>使用lunar-javascript库进行农历计算</li><li>支持农历日期转换</li><li>自动处理农历日期边界情况</li></ul><h3 id="6-响应式设计">6. 响应式设计</h3><ul><li>移动端优化</li><li>卡片布局自适应</li><li>字体大小和间距调整</li></ul><h2 id="与相册集页面的一致性">与相册集页面的一致性</h2><p>为了保持页面风格的一致性，猫の日页面的banner设置与相册集页面完全一致：</p><h3 id="Banner设置对比">Banner设置对比</h3><table><thead><tr><th>设置项</th><th>相册集页面</th><th>猫の日页面</th><th>说明</th></tr></thead><tbody><tr><td>页面类型</td><td><code>type: album</code></td><td><code>type: nekko</code></td><td>不同的页面类型</td></tr><tr><td>Banner视频</td><td><code>/mp4/album-banner.mp4</code></td><td><code>/mp4/cats-banner.mp4</code></td><td>不同的视频文件</td></tr><tr><td>桌面端高度</td><td>19rem</td><td>19rem</td><td>完全一致</td></tr><tr><td>桌面端宽度</td><td>100%</td><td>100%</td><td>完全一致</td></tr><tr><td>桌面端圆角</td><td>12px</td><td>12px</td><td>完全一致</td></tr><tr><td>移动端高度</td><td>150px</td><td>150px</td><td>完全一致</td></tr><tr><td>移动端宽度</td><td>95%</td><td>95%</td><td>完全一致</td></tr><tr><td>移动端居中</td><td>是</td><td>是</td><td>完全一致</td></tr></tbody></table><h3 id="模板结构对比">模板结构对比</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 相册集页面模板</span><br><span class="line">include ../widgets/page/banner</span><br><span class="line">include ../widgets/page/album/content</span><br><span class="line"></span><br><span class="line">// 猫の日页面模板</span><br><span class="line">include ../widgets/page/banner</span><br><span class="line">include ../widgets/page/nekko/content</span><br></pre></td></tr></table></figure><p>两个页面都使用相同的banner模板，确保视觉效果的一致性。</p><h2 id="配置说明">配置说明</h2><h3 id="nekko-yml-数据结构">nekko.yml 数据结构</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">&quot;分组名称&quot;</span>           <span class="comment"># 分组标题</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">&quot;分组描述&quot;</span>           <span class="comment"># 分组说明</span></span><br><span class="line">  <span class="attr">anniversaries:</span>                   <span class="comment"># 纪念日列表</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;宠物名称&quot;</span>             <span class="comment"># 宠物名字</span></span><br><span class="line">      <span class="attr">date:</span> <span class="string">&#x27;YYYY-MM-DD&#x27;</span>          <span class="comment"># 纪念日日期</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">&#x27;/path/to/icon.png&#x27;</span>   <span class="comment"># 宠物图标</span></span><br><span class="line">      <span class="attr">lunar:</span> <span class="literal">false</span>                <span class="comment"># 是否农历日期</span></span><br><span class="line">      <span class="attr">color:</span> <span class="string">&#x27;#colorcode&#x27;</span>         <span class="comment"># 卡片背景色</span></span><br><span class="line">      <span class="attr">display_mode:</span> <span class="string">&quot;elapsed&quot;</span>     <span class="comment"># 显示模式</span></span><br><span class="line">      <span class="attr">show_copyright:</span> <span class="literal">false</span>       <span class="comment"># 是否显示版权</span></span><br><span class="line">      <span class="attr">copyright_name:</span> <span class="string">&quot;版权名称&quot;</span>   <span class="comment"># 版权信息</span></span><br><span class="line">      <span class="attr">copyright_link:</span> <span class="string">&quot;版权链接&quot;</span>   <span class="comment"># 版权链接</span></span><br></pre></td></tr></table></figure><h3 id="显示模式说明">显示模式说明</h3><ul><li><code>elapsed</code>：显示已经过去的时间</li><li><code>countdown</code>：显示剩余时间（未实现）</li></ul><h3 id="农历计算">农历计算</h3><ul><li><code>lunar: true</code>：使用农历日期</li><li><code>lunar: false</code>：使用公历日期</li></ul><h2 id="常见问题解决">常见问题解决</h2><h3 id="1-Banner视频不显示">1. Banner视频不显示</h3><ul><li>检查视频文件路径是否正确</li><li>确保视频文件格式为MP4</li><li>检查浏览器是否支持HTML5 video</li></ul><h3 id="2-宠物图标不显示">2. 宠物图标不显示</h3><ul><li>检查图标文件是否存在</li><li>确认文件路径正确</li><li>检查文件权限</li></ul><h3 id="3-时间计算错误">3. 时间计算错误</h3><ul><li>检查lunar-javascript库是否正确加载</li><li>确认日期格式为YYYY-MM-DD</li><li>检查农历日期设置是否正确</li></ul><h3 id="4-样式不生效">4. 样式不生效</h3><ul><li>检查CSS文件是否正确引用</li><li>确认CSS选择器正确</li><li>检查浏览器缓存</li></ul><h3 id="5-移动端banner显示异常">5. 移动端banner显示异常</h3><ul><li>检查CSS中的<code>!important</code>设置是否正确</li><li>确认移动端媒体查询是否生效</li><li>检查父容器的padding设置</li><li>确保<code>margin: 0 auto</code>居中设置正确</li></ul><h2 id="总结">总结</h2><p>通过本次移植，我们成功将blog-solitude中的猫の日页面完整移植到solitude-latest中。这个页面不仅功能丰富，而且具有很好的用户体验：</p><ul><li>✅ <strong>Banner视频播放</strong> - 可爱的猫咪视频背景</li><li>✅ <strong>Banner响应式设计</strong> - 与相册集页面保持一致，移动端优化</li><li>✅ <strong>宠物纪念日卡片</strong> - 精美的卡片设计</li><li>✅ <strong>多模式时间显示</strong> - 支持天数/周数/月数切换</li><li>✅ <strong>农历计算支持</strong> - 精确的农历日期转换</li><li>✅ <strong>响应式设计</strong> - 完美适配各种设备</li><li>✅ <strong>动画效果</strong> - 流畅的悬停和切换动画</li></ul><h3 id="重要更新">重要更新</h3><ul><li><strong>页面配置</strong>：移除了<code>container: true</code>设置，与相册集页面保持一致</li><li><strong>Banner设置</strong>：桌面端19rem高度，移动端150px高度，95%宽度</li><li><strong>响应式优化</strong>：移动端自动居中，左右边距优化</li><li><strong>视觉一致性</strong>：与相册集页面完全一致的banner样式</li></ul><p>这个功能非常适合记录宠物的重要日子，比如生日、领养日等。用户可以通过点击卡片来切换不同的时间显示模式，让纪念日更加生动有趣。</p><h2 id="相关链接">相关链接</h2><ul><li><a href="/2025/01/07/solitude-theme-album-migration/">Solitude主题魔改教程(10)-相册集页面功能完整移植</a></li><li><a href="/2025/01/07/solitude-theme-musicsheets-migration/">Solitude主题魔改教程(9)-乐谱坊页面功能完整移植</a></li><li><a href="/2025/01/07/solitude-theme-collects-migration/">Solitude主题魔改教程(8)-藏宝阁页面功能完整移植</a></li><li><a href="/2025/01/07/solitude-theme-game-migration/">Solitude主题魔改教程(7)-电玩屋页面功能完整移植</a></li></ul><hr><p><em>本文详细介绍了猫の日页面的完整移植过程，包括所有必要的文件创建、配置修改和功能实现。如果您在移植过程中遇到任何问题，欢迎在评论区留言讨论。</em></p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 猫の日 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(10)-相册集页面</title>
      <link href="/2024/11/04/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(10)-%E7%9B%B8%E5%86%8C%E9%9B%86%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/11/04/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(10)-%E7%9B%B8%E5%86%8C%E9%9B%86%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有相册集页面功能，但有时我们希望展示个人照片和相册。本文将详细介绍如何从blog-solitude项目完整移植相册集页面功能到solitude-latest，包括照片墙、相册分类、私密相册、模态框预览和响应式设计的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认没有相册集页面</li><li>缺少照片墙展示效果</li><li>无法展示个人相册和照片</li><li>缺少相册分类和私密相册功能</li><li>无法实现照片预览和模态框展示</li></ul><h3 id="期望效果">期望效果</h3><ul><li>独立的相册集页面（<code>/album/</code>）</li><li>照片墙动态展示效果</li><li>支持相册分类和标签筛选</li><li>支持私密相册密码保护</li><li>模态框照片预览功能</li><li>响应式设计，适配不同屏幕尺寸</li><li>视频Banner支持</li><li>照片保护功能（禁止右键下载）</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>页面类型缺失</strong><br>solitude-latest主题缺少album页面类型的支持</p></li><li><p><strong>模板文件缺失</strong><br>缺少album页面的模板文件和照片墙组件</p></li><li><p><strong>数据管理缺失</strong><br>缺少相册数据的配置和管理机制</p></li><li><p><strong>样式文件缺失</strong><br>缺少album页面的CSS样式文件</p></li><li><p><strong>JavaScript交互缺失</strong><br>缺少照片墙动态布局和模态框交互逻辑</p></li><li><p><strong>静态资源缺失</strong><br>缺少背景图片和照片资源</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/source/album/index.md</code></li><li><code>solitude-latest/source/_data/album.yml</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/album.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/album/content.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/album.styl</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/album-modal.css</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/album.js</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/album-modal.js</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/photo-wall.js</code></li><li><code>solitude-latest/public/img/letter.png</code></li><li><code>solitude-latest/_config.solitude.yml</code> (脚本引入配置)</li><li><code>solitude-latest/node_modules/hexo-theme-solitude/_config.yml</code> (主题配置)</li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建相册集页面配置">1. 创建相册集页面配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/album/index.md</code></p><p><strong>文件内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">相册集</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2024-11-21 16:55:25</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">album</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/album-banner.mp4</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">朝花夕拾，回忆往昔</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p><strong>配置说明：</strong></p><ul><li><code>type: album</code> - 页面类型为album</li><li><code>cover: /mp4/album-banner.mp4</code> - 设置banner视频</li><li><code>desc</code> - banner描述文字</li></ul><hr><h3 id="2-创建相册数据配置文件">2. 创建相册数据配置文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/_data/album.yml</code></p><p><strong>文件结构：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">gallery:</span></span><br><span class="line">  <span class="attr">photo_wall:</span></span><br><span class="line">    <span class="attr">class_name:</span> <span class="string">照片墙</span></span><br><span class="line">    <span class="attr">photo_list:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">可爱黑猫1</span></span><br><span class="line">        <span class="attr">imgUrl:</span> <span class="string">https://i.imgur.com/6XYUqLB.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">可爱黑猫2</span></span><br><span class="line">        <span class="attr">imgUrl:</span> <span class="string">https://i.imgur.com/e11gTUR.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">清晨阳光</span></span><br><span class="line">        <span class="attr">imgUrl:</span> <span class="string">https://i.imgur.com/P6NLpMD.jpeg</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">午日阳光</span></span><br><span class="line">        <span class="attr">imgUrl:</span> <span class="string">https://i.imgur.com/6pq7dg2.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">白月光</span></span><br><span class="line">        <span class="attr">imgUrl:</span> <span class="string">https://i.imgur.com/aX0Isw8.png</span></span><br><span class="line">  <span class="attr">album:</span></span><br><span class="line">    <span class="attr">class_name:</span> <span class="string">相册</span></span><br><span class="line">    <span class="attr">album_list:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">我怀念的</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/XUirRGd.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/PCBmac3.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">实习经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/nT7KMiY.jpeg</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">自习室</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">体育课</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">运动会</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">空手道社团</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">支教活动</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">团建</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">大学</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">两个人的时光</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">7UJM&#x27;ujm</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">浪漫</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看电影</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看猫咪迷因</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">九寨沟之行</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">7UJM&#x27;ujm</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">旅行</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看电影</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看猫咪迷因</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">富士急乐园</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">日常</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大学时光</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">大厂经历</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">爬富士山</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">7UJM&#x27;ujm</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">旅游</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看电影</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看猫咪迷因</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">京都之旅</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">7UJM&#x27;ujm</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">旅游</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看电影</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看猫咪迷因</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">可乐炸鸡</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">7UJM&#x27;ujm</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">生活</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看电影</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看猫咪迷因</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">周杰伦日本演唱会</span></span><br><span class="line">        <span class="attr">cover:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">        <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">7UJM&#x27;ujm</span></span><br><span class="line">        <span class="attr">date:</span> <span class="number">2021-01-01</span></span><br><span class="line">        <span class="attr">tag:</span> <span class="string">生活</span></span><br><span class="line">        <span class="attr">album_img_list:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看电影</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">一起看猫咪迷因</span></span><br><span class="line">            <span class="attr">url:</span> <span class="string">https://i.imgur.com/2dPOSXZ.png</span></span><br></pre></td></tr></table></figure><p><strong>数据结构说明：</strong></p><ul><li><code>gallery</code> - 相册集数据结构</li><li><code>photo_wall</code> - 照片墙数据<ul><li><code>class_name</code> - 照片墙标题</li><li><code>photo_list</code> - 照片列表</li></ul></li><li><code>album</code> - 相册数据<ul><li><code>class_name</code> - 相册标题</li><li><code>album_list</code> - 相册列表<ul><li><code>name</code> - 相册名称</li><li><code>cover</code> - 相册封面</li><li><code>access</code> - 访问权限（public/private）</li><li><code>password</code> - 私密相册密码</li><li><code>date</code> - 相册日期</li><li><code>tag</code> - 相册标签</li><li><code>album_img_list</code> - 相册图片列表</li></ul></li></ul></li></ul><hr><h3 id="3-修改页面模板支持">3. 修改页面模板支持</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></p><p><strong>修改内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner(class=page.aside ? &#x27;&#x27; : &#x27;hide-aside&#x27;)</span><br><span class="line">        #page</span><br><span class="line">            case page.type</span><br><span class="line">                when &#x27;categories&#x27;</span><br><span class="line">                    include includes/page/categories</span><br><span class="line">                when &#x27;tags&#x27;</span><br><span class="line">                    include includes/page/tags</span><br><span class="line">                when &#x27;links&#x27;</span><br><span class="line">                    include includes/page/links</span><br><span class="line">                when &#x27;about&#x27;</span><br><span class="line">                    include includes/page/about</span><br><span class="line">                when &#x27;brevity&#x27;</span><br><span class="line">                    include includes/page/brevity</span><br><span class="line">                when &#x27;kit&#x27;</span><br><span class="line">                    include includes/page/kit</span><br><span class="line">                when &#x27;music&#x27;</span><br><span class="line">                    include includes/page/music</span><br><span class="line">                when &#x27;game&#x27;</span><br><span class="line">                    include includes/page/game</span><br><span class="line">                when &#x27;collects&#x27;</span><br><span class="line">                    include includes/page/collects</span><br><span class="line">                when &#x27;musicsheets&#x27;</span><br><span class="line">                    include includes/page/musicsheets</span><br><span class="line">                when &#x27;album&#x27;</span><br><span class="line">                    include includes/page/album</span><br><span class="line">                when &#x27;message&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/message&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;recentcomment&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/recentcomment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;banner&#x27;</span><br><span class="line">                    include includes/widgets/page/banner</span><br><span class="line">                    if page.container</span><br><span class="line">                        include includes/page/default</span><br><span class="line">                    else</span><br><span class="line">                        != page.content</span><br><span class="line">                default</span><br><span class="line">                    include includes/page/default</span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>添加了 <code>when 'album'</code> 条件分支，支持album页面类型。</p><hr><h3 id="4-创建相册页面模板">4. 创建相册页面模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/album.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include ../widgets/page/banner</span><br><span class="line">include ../widgets/page/album/content</span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>包含banner组件和相册内容模板。</p><hr><h3 id="5-创建相册内容模板">5. 创建相册内容模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/album/content.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 照片墙标题</span><br><span class="line">div(class=&quot;photo_wall_title&quot;)= site.data.album.gallery.photo_wall.class_name</span><br><span class="line"></span><br><span class="line">// 照片墙主容器</span><br><span class="line">div(id=&quot;photo_wall_section&quot;)</span><br><span class="line">  div(class=&quot;photo_container&quot;)</span><br><span class="line">    // 照片将由JavaScript动态生成</span><br><span class="line"></span><br><span class="line">// 相册部分主容器</span><br><span class="line">div(id=&quot;album_section&quot;)</span><br><span class="line">  div(class=&quot;album_title&quot;)= site.data.album.gallery.album.class_name</span><br><span class="line"></span><br><span class="line">  // 标签容器</span><br><span class="line">  div(class=&quot;album_tags&quot;)</span><br><span class="line">    each tag, index in site.data.album.gallery.album.album_list.map(album =&gt; album.tag).filter((v, i, a) =&gt; a.indexOf(v) === i)</span><br><span class="line">      div(class=&quot;tag&quot; data-tag=tag class=(index === 0 ? &#x27;active&#x27; : &#x27;&#x27;))= `$&#123;tag&#125;`</span><br><span class="line"></span><br><span class="line">  // 相册内容容器</span><br><span class="line">  div(class=&quot;album_container&quot;)</span><br><span class="line">    each album in site.data.album.gallery.album.album_list</span><br><span class="line">      div(class=&quot;album_card&quot; data-tag=album.tag data-images=JSON.stringify(album.album_img_list) data-access=album.access data-password=album.password)</span><br><span class="line">        div(class=&quot;image_wrapper&quot; style=(album.access === &#x27;private&#x27; ? &#x27;filter: blur(8px);&#x27; : &#x27;&#x27;))</span><br><span class="line">          img(src=album.cover alt=album.name class=&quot;album_cover&quot;)</span><br><span class="line">          if album.access === &#x27;private&#x27;</span><br><span class="line">            div(class=&quot;album_lock&quot;) 🔒</span><br><span class="line">        div(class=&quot;album_info&quot;)</span><br><span class="line">          h3(class=&quot;album_name&quot;)= album.name</span><br><span class="line">          - const formattedDate = new Date(album.date).toLocaleDateString(&#x27;zh-CN&#x27;, &#123; year: &#x27;numeric&#x27;, month: &#x27;2-digit&#x27;, day: &#x27;2-digit&#x27; &#125;);</span><br><span class="line">          p 日期: #&#123;formattedDate&#125;</span><br><span class="line"></span><br><span class="line">// 模态框容器（隐藏状态）</span><br><span class="line">div(id=&quot;album_modal&quot; class=&quot;hidden&quot;)</span><br><span class="line">  div(class=&quot;modal_content&quot;)</span><br><span class="line">    img(class=&quot;modal_main_image&quot;)</span><br><span class="line">    div(class=&quot;modal_thumbnails&quot;)</span><br></pre></td></tr></table></figure><p><strong>功能说明：</strong></p><ul><li><strong>照片墙</strong>：显示照片墙标题和容器</li><li><strong>相册分类</strong>：根据标签动态生成分类按钮</li><li><strong>相册卡片</strong>：显示相册封面、名称、日期</li><li><strong>私密相册</strong>：支持密码保护和模糊效果</li><li><strong>模态框</strong>：用于照片预览</li></ul><hr><h3 id="6-创建相册样式文件">6. 创建相册样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/album.styl</code></p><p><strong>文件内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 全局变量 */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--title-color</span>: <span class="number">#333</span>; <span class="comment">/* 默认浅色模式标题颜色 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attr">--title-color</span>: <span class="number">#fff</span>; <span class="comment">/* 深色模式标题颜色 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 照片墙主容器 */</span></span><br><span class="line"><span class="selector-id">#photo_wall_section</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">1338.49px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">450px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&#x27;/img/letter.png&#x27;</span>) center/cover no-repeat;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">visibility</span>: visible;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 照片墙标题样式 */</span></span><br><span class="line"><span class="selector-class">.photo_wall_title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--title-color);</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.photo-wall</span> <span class="selector-class">.section_title</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 照片容器样式 */</span></span><br><span class="line"><span class="selector-class">.photo_container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 单张照片样式 */</span></span><br><span class="line"><span class="selector-class">.photo</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.6s</span> ease;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.photo_img</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">400px</span>;;</span><br><span class="line">  <span class="attribute">max-height</span>: auto;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">0.5s</span> ease;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">10px</span> solid <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.photo</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.photo_img</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.2</span>) <span class="built_in">rotate</span>(<span class="number">15deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式设计：小屏幕缩放 */</span></span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">550px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#photo_wall_section</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: none;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">420px</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">320px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">20px</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.photo_container</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">220px</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.photo_img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">92vw</span>;</span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">60vw</span>;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">550px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">750px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#photo_wall_section</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.8</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 相册主容器 */</span></span><br><span class="line"><span class="selector-id">#album_section</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">1338.49px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 左侧标题 */</span></span><br><span class="line"><span class="selector-class">.album_title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--title-color);</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 标签容器样式 */</span></span><br><span class="line"><span class="selector-class">.album_tags</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_tags</span> <span class="selector-class">.tag</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#007BFF</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#007BFF</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_tags</span> <span class="selector-class">.tag</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#007BFF</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_tags</span> <span class="selector-class">.tag</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#007BFF</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 相册容器 */</span></span><br><span class="line"><span class="selector-class">.album_container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 相册卡片 */</span></span><br><span class="line"><span class="selector-class">.album_card</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span> <span class="number">1</span> <span class="built_in">calc</span>(<span class="number">20%</span> - <span class="number">16px</span>);</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="built_in">calc</span>(<span class="number">20%</span> - <span class="number">16px</span>);</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>; <span class="comment">/* 圆润边框 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">6px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>), <span class="number">0</span> <span class="number">12px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">0.3s</span> ease, box-shadow <span class="number">0.3s</span> ease;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_card</span> <span class="selector-class">.image_wrapper</span><span class="selector-attr">[style*=<span class="string">&quot;blur&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">8px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_card</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>), <span class="number">0</span> <span class="number">16px</span> <span class="number">24px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_card</span><span class="selector-class">.hidden</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_lock</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.7</span>);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 图片容器 */</span></span><br><span class="line"><span class="selector-class">.image_wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">90%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer; <span class="comment">/* 鼠标指针样式 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.image_wrapper</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: transparent;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 图片样式 */</span></span><br><span class="line"><span class="selector-class">.image_wrapper</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">object-fit</span>: cover;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">0.8s</span> ease;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.image_wrapper</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 相册信息 */</span></span><br><span class="line"><span class="selector-class">.album_info</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20%</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_info</span> <span class="selector-class">.album_name</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.8rem</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.album_info</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.7rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">550px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.album_container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: grid <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">justify-items</span>: stretch;</span><br><span class="line">    <span class="attribute">align-items</span>: stretch;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.album_card</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50vw</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">aspect-ratio</span>: unset <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">6px</span> <span class="number">16px</span> <span class="number">6px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.image_wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">38px</span>);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0px</span> <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.image_wrapper</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">object-fit</span>: cover;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f8f8f8</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="number">0.8s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">4</span>,<span class="number">0</span>,.<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.image_wrapper</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.album_info</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;                <span class="comment">/* 紧贴拍立得底部 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">6px</span> <span class="number">6px</span>;     <span class="comment">/* 顶部0，底部6px，左侧6px，右侧0 */</span></span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.8rem</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">38px</span>;             <span class="comment">/* 保证底部白边高度一致，可根据实际微调 */</span></span><br><span class="line">    <span class="attribute">justify-content</span>: space-between; <span class="comment">/* 名字和日期分布上下 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.album_info</span> <span class="selector-class">.album_name</span>,</span><br><span class="line">  <span class="selector-class">.album_info</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">clamp</span>(<span class="number">0.6rem</span>, <span class="number">3vw</span>, <span class="number">0.8rem</span>); <span class="comment">/* 根据屏幕宽度自适应字体大小 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">2px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.2</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">551px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">900px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.album_container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: grid <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">justify-items</span>: stretch;</span><br><span class="line">    <span class="attribute">align-items</span>: stretch;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.album_card</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">32vw</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">aspect-ratio</span>: unset <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">6px</span> <span class="number">16px</span> <span class="number">6px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.image_wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">38px</span>);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>; <span class="comment">/* 四个角都有圆角 */</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.image_wrapper</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">object-fit</span>: cover;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f8f8f8</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="number">0.8s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">4</span>,<span class="number">0</span>,.<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>; <span class="comment">/* 图片本身也加圆角，和外框一致 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.image_wrapper</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.album_info</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">16px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.85rem</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.album_info</span> <span class="selector-class">.album_name</span>,</span><br><span class="line">  <span class="selector-class">.album_info</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">2px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.85rem</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.2</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="number">#fff</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>样式特点：</strong></p><ul><li><strong>照片墙</strong>：动态背景和照片随机分布</li><li><strong>相册卡片</strong>：3D阴影和悬停效果</li><li><strong>标签筛选</strong>：交互式标签按钮</li><li><strong>私密相册</strong>：模糊效果和锁定图标</li><li><strong>响应式</strong>：适配移动端和桌面端</li></ul><hr><h3 id="7-创建模态框样式文件">7. 创建模态框样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/album-modal.css</code></p><p><strong>文件内容：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 模态框样式 */</span></span><br><span class="line"><span class="selector-id">#album_modal</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8</span>); <span class="comment">/* 半透明背景 */</span></span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden; <span class="comment">/* 默认隐藏 */</span></span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>; <span class="comment">/* 默认透明 */</span></span><br><span class="line">    <span class="attribute">transition</span>: opacity <span class="number">0.3s</span> ease, visibility <span class="number">0.3s</span> ease; <span class="comment">/* 淡入淡出效果 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-id">#album_modal</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.hidden</span>) &#123;</span><br><span class="line">    <span class="attribute">visibility</span>: visible;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 模态框内容区域 */</span></span><br><span class="line">  <span class="selector-id">#album_modal</span> <span class="selector-class">.modal_content</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">90%</span>; <span class="comment">/* 宽度占屏幕的 90% */</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>; <span class="comment">/* 白色背景 */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>; <span class="comment">/* 圆角 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">1rem</span>; <span class="comment">/* 内边距 */</span></span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>); <span class="comment">/* 阴影效果 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 主图片容器及透明遮罩 */</span></span><br><span class="line">  <span class="selector-class">.modal_main_image_wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.modal_main_image_wrapper</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>; <span class="comment">/* 确保遮罩在图片上方 */</span></span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* 主图片 */</span></span><br><span class="line">  <span class="selector-id">#album_modal</span> <span class="selector-class">.modal_main_image</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>; <span class="comment">/* 主图片宽度不超过容器宽度 */</span></span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">400px</span>; <span class="comment">/* 主图片高度限制 */</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>; <span class="comment">/* 圆角 */</span></span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>); <span class="comment">/* 主图片阴影 */</span></span><br><span class="line">    <span class="attribute">object-fit</span>: contain; <span class="comment">/* 保持图片比例 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 缩略图容器 */</span></span><br><span class="line">  <span class="selector-id">#album_modal</span> <span class="selector-class">.modal_thumbnails</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex; <span class="comment">/* 水平排列缩略图 */</span></span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">0.5rem</span>; <span class="comment">/* 缩略图之间的间距 */</span></span><br><span class="line">    <span class="attribute">overflow-x</span>: auto; <span class="comment">/* 横向滚动 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5rem</span>; <span class="comment">/* 内边距 */</span></span><br><span class="line">    <span class="attribute">justify-content</span>: flex-start; <span class="comment">/* 左对齐 */</span></span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">150px</span>; <span class="comment">/* 缩略图容器的最大高度 */</span></span><br><span class="line">    <span class="attribute">align-items</span>: center; <span class="comment">/* 垂直居中 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 缩略图 */</span></span><br><span class="line">  <span class="selector-id">#album_modal</span> <span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>; <span class="comment">/* 统一缩略图高度 */</span></span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">0</span>; <span class="comment">/* 防止图片被压缩 */</span></span><br><span class="line">    <span class="attribute">object-fit</span>: contain; <span class="comment">/* 保持图片比例 */</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid transparent; <span class="comment">/* 默认透明边框 */</span></span><br><span class="line">    <span class="attribute">transition</span>: border <span class="number">0.3s</span> ease, transform <span class="number">0.3s</span> ease; <span class="comment">/* 动画效果 */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>; <span class="comment">/* 缩略图圆角 */</span></span><br><span class="line">    <span class="attribute">cursor</span>: pointer; <span class="comment">/* 鼠标指针样式 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-id">#album_modal</span> <span class="selector-class">.thumbnail</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="number">#007BFF</span>; <span class="comment">/* 激活缩略图的边框颜色 */</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>); <span class="comment">/* 放大激活缩略图 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-id">#album_modal</span> <span class="selector-class">.thumbnail</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="number">#007BFF</span>; <span class="comment">/* 鼠标悬停时边框颜色 */</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>); <span class="comment">/* 鼠标悬停时放大 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.modal_main_image</span> &#123;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none; <span class="comment">/* 禁止选中文件名 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto; <span class="comment">/* 缩略图依然可以点击 */</span></span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 自适应优化 */</span></span><br><span class="line">  <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#album_modal</span> <span class="selector-class">.modal_content</span> &#123;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">95%</span>; <span class="comment">/* 更小屏幕下的模态框宽度 */</span></span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0.5rem</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="selector-id">#album_modal</span> <span class="selector-class">.modal_main_image</span> &#123;</span><br><span class="line">      <span class="attribute">max-height</span>: <span class="number">300px</span>; <span class="comment">/* 主图片高度减少 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="selector-id">#album_modal</span> <span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">80px</span>; <span class="comment">/* 缩略图高度减少 */</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>功能说明：</strong></p><ul><li><strong>全屏遮罩</strong>：半透明黑色背景</li><li><strong>内容居中</strong>：模态框内容居中显示</li><li><strong>图片预览</strong>：主图片和缩略图展示</li><li><strong>交互控制</strong>：点击缩略图切换主图片</li><li><strong>响应式</strong>：适配移动端显示</li></ul><hr><h3 id="8-创建相册交互JavaScript文件">8. 创建相册交互JavaScript文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/album.js</code></p><p><strong>文件内容：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">initializeAlbumSectionWithDelegation</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> albumSection = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#album_section&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!albumSection) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;#album_section not found!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Initializing album section with event delegation...&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 默认分类逻辑</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">applyDefaultCategory</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> activeTag = albumSection.<span class="title function_">querySelector</span>(<span class="string">&quot;.album_tags .tag.active&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> defaultTag = activeTag || albumSection.<span class="title function_">querySelector</span>(<span class="string">&quot;.album_tags .tag&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> selectedTag = defaultTag?.<span class="property">dataset</span>.<span class="property">tag</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!selectedTag) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;No default tag found!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 切换标签激活状态</span></span><br><span class="line">    albumSection.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.album_tags .tag&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">el</span>) =&gt;</span> el.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>));</span><br><span class="line">    defaultTag.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 显示与默认标签匹配的相册，隐藏其他相册</span></span><br><span class="line">    albumSection.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.album_card&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">card</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (card.<span class="property">dataset</span>.<span class="property">tag</span> === selectedTag) &#123;</span><br><span class="line">        card.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        card.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 禁止图片右键下载</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">disableImageDownload</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    albumSection.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;img&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">img</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 禁用右键菜单</span></span><br><span class="line">      img.<span class="title function_">addEventListener</span>(<span class="string">&quot;contextmenu&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        event.<span class="title function_">preventDefault</span>();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 禁用拖拽下载</span></span><br><span class="line">      img.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragstart&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        event.<span class="title function_">preventDefault</span>();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 添加 CSS 防止复制</span></span><br><span class="line">      img.<span class="property">style</span>.<span class="property">userSelect</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 应用默认分类逻辑</span></span><br><span class="line">  <span class="title function_">applyDefaultCategory</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 禁止图片右键下载</span></span><br><span class="line">  <span class="title function_">disableImageDownload</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绑定事件委托到父容器</span></span><br><span class="line">  albumSection.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 检查是否点击了标签</span></span><br><span class="line">    <span class="keyword">const</span> tagElement = event.<span class="property">target</span>.<span class="title function_">closest</span>(<span class="string">&quot;.album_tags .tag&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (tagElement) &#123;</span><br><span class="line">      <span class="keyword">const</span> selectedTag = tagElement.<span class="property">dataset</span>.<span class="property">tag</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 切换标签激活状态</span></span><br><span class="line">      albumSection.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.album_tags .tag&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">el</span>) =&gt;</span> el.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>));</span><br><span class="line">      tagElement.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 显示与选中标签匹配的相册，隐藏其他相册</span></span><br><span class="line">      albumSection.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.album_card&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">card</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (card.<span class="property">dataset</span>.<span class="property">tag</span> === selectedTag) &#123;</span><br><span class="line">          card.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          card.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Tag clicked: <span class="subst">$&#123;selectedTag&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 更新后重新禁止图片下载</span></span><br><span class="line">      <span class="title function_">disableImageDownload</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化页面逻辑</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DOM fully loaded. Initializing album section...&quot;</span>);</span><br><span class="line">  <span class="title function_">initializeAlbumSectionWithDelegation</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听页面迁移（如 pjax:success）</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:success&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Page migrated. Reinitializing album section...&quot;</span>);</span><br><span class="line">  <span class="title function_">initializeAlbumSectionWithDelegation</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>功能说明：</strong></p><ul><li><strong>标签筛选</strong>：点击标签切换相册分类</li><li><strong>默认分类</strong>：页面加载时显示默认分类</li><li><strong>图片保护</strong>：禁止右键下载和拖拽</li><li><strong>事件委托</strong>：优化性能的事件处理</li><li><strong>页面迁移</strong>：支持PJAX页面跳转</li></ul><hr><h3 id="9-创建模态框JavaScript文件">9. 创建模态框JavaScript文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/album-modal.js</code></p><p><strong>文件内容：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">initAlbumModal</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> modal = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;album_modal&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 如果模态框不存在，直接返回</span></span><br><span class="line">  <span class="keyword">if</span> (!modal) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Album modal not found, skipping initialization&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> mainImage = modal.<span class="title function_">querySelector</span>(<span class="string">&quot;.modal_main_image&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> thumbnails = modal.<span class="title function_">querySelector</span>(<span class="string">&quot;.modal_thumbnails&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 禁止右击和拖拽</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">disableImageInteractions</span> = (<span class="params">imageElement</span>) =&gt; &#123;</span><br><span class="line">    imageElement.<span class="title function_">addEventListener</span>(<span class="string">&quot;contextmenu&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    imageElement.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragstart&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 显示模态框并加载图片</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">showModal</span> = (<span class="params">images</span>) =&gt; &#123;</span><br><span class="line">    modal.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">    thumbnails.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// 清空缩略图容器</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认显示第一张图片</span></span><br><span class="line">    mainImage.<span class="property">src</span> = images[<span class="number">0</span>]?.<span class="property">url</span> || <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="title function_">disableImageInteractions</span>(mainImage);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 渲染缩略图</span></span><br><span class="line">    images.<span class="title function_">forEach</span>(<span class="function">(<span class="params">img, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> thumbnail = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">      thumbnail.<span class="property">src</span> = img.<span class="property">url</span>;</span><br><span class="line">      thumbnail.<span class="property">className</span> = <span class="string">&quot;thumbnail&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span> (index === <span class="number">0</span>) thumbnail.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 禁止缩略图右击和拖拽</span></span><br><span class="line">      <span class="title function_">disableImageInteractions</span>(thumbnail);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 点击缩略图切换主图片</span></span><br><span class="line">      thumbnail.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        mainImage.<span class="property">src</span> = img.<span class="property">url</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.thumbnail&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">thumb</span>) =&gt;</span> thumb.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>));</span><br><span class="line">        thumbnail.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 阻止事件冒泡，避免触发模态框关闭</span></span><br><span class="line">        event.<span class="title function_">stopPropagation</span>();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      thumbnails.<span class="title function_">appendChild</span>(thumbnail);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 关闭模态框</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">hideModal</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    modal.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件委托：绑定相册卡片点击事件</span></span><br><span class="line">  <span class="keyword">const</span> albumContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.album_container&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (albumContainer) &#123;</span><br><span class="line">    albumContainer.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> card = event.<span class="property">target</span>.<span class="title function_">closest</span>(<span class="string">&quot;.album_card&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (card) &#123;</span><br><span class="line">        <span class="keyword">const</span> access = card.<span class="property">dataset</span>.<span class="property">access</span>;</span><br><span class="line">        <span class="keyword">const</span> images = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(card.<span class="property">dataset</span>.<span class="property">images</span> || <span class="string">&quot;[]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 检查 access 是否为 private</span></span><br><span class="line">        <span class="keyword">if</span> (access === <span class="string">&quot;private&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">const</span> userPassword = <span class="title function_">prompt</span>(<span class="string">&quot;请输入密码以解锁相册：&quot;</span>);</span><br><span class="line">          <span class="keyword">if</span> (userPassword === card.<span class="property">dataset</span>.<span class="property">password</span>) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;解锁成功！&quot;</span>);</span><br><span class="line">            <span class="title function_">showModal</span>(images); <span class="comment">// 解锁成功后显示模态框</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;密码错误！&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 如果是公共相册直接打开</span></span><br><span class="line">          <span class="keyword">if</span> (images.<span class="property">length</span> &gt; <span class="number">0</span>) <span class="title function_">showModal</span>(images);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击模态框背景关闭模态框</span></span><br><span class="line">  modal.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (event.<span class="property">target</span> === modal) &#123;</span><br><span class="line">      <span class="title function_">hideModal</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化或页面迁移后重新绑定事件</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, initAlbumModal);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:success&quot;</span>, initAlbumModal);</span><br></pre></td></tr></table></figure><p><strong>功能说明：</strong></p><ul><li><strong>模态框控制</strong>：显示和隐藏模态框</li><li><strong>图片预览</strong>：主图片和缩略图展示</li><li><strong>私密相册</strong>：密码验证功能</li><li><strong>图片保护</strong>：禁止右键和拖拽</li><li><strong>交互控制</strong>：点击缩略图切换主图片</li></ul><hr><h3 id="10-创建照片墙JavaScript文件">10. 创建照片墙JavaScript文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/photo-wall.js</code></p><p><strong>文件内容：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;JavaScript is running!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化照片墙</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">initializePhotoWall</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Starting to initialize photo wall...&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> wrap = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;photo_wall_section&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> container = wrap?.<span class="title function_">querySelector</span>(<span class="string">&quot;.photo_container&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!wrap) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;#photo_wall_section not found!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!container) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;.photo_container not found inside #photo_wall_section!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  container.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// 清空容器内容</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 动态加载照片墙数据</span></span><br><span class="line">  <span class="keyword">const</span> photoWallData = [</span><br><span class="line">    &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://i.imgur.com/6XYUqLB.png&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;可爱黑猫1&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://i.imgur.com/e11gTUR.png&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;可爱黑猫2&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://i.imgur.com/P6NLpMD.jpeg&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;清晨阳光&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://i.imgur.com/6pq7dg2.png&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;午日阳光&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://i.imgur.com/aX0Isw8.png&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;白月光&quot;</span> &#125;,</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(photoWallData) || photoWallData.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;Photo wall data is empty or invalid.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取随机位置</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getRandomPosition</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> containerWidth = wrap.<span class="property">offsetWidth</span>;</span><br><span class="line">    <span class="keyword">const</span> containerHeight = wrap.<span class="property">offsetHeight</span>;</span><br><span class="line">    <span class="keyword">const</span> x = <span class="title class_">Math</span>.<span class="title function_">random</span>() * (containerWidth - <span class="number">200</span>);</span><br><span class="line">    <span class="keyword">const</span> y = <span class="title class_">Math</span>.<span class="title function_">random</span>() * (containerHeight - <span class="number">200</span>);</span><br><span class="line">    <span class="keyword">return</span> &#123; x, y &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 居中逻辑</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">centerPhoto</span> = (<span class="params">photoDiv</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> centerX = wrap.<span class="property">offsetWidth</span> / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> centerY = wrap.<span class="property">offsetHeight</span> / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    photoDiv.<span class="property">style</span>.<span class="property">left</span> = <span class="string">`<span class="subst">$&#123;centerX&#125;</span>px`</span>;</span><br><span class="line">    photoDiv.<span class="property">style</span>.<span class="property">top</span> = <span class="string">`<span class="subst">$&#123;centerY&#125;</span>px`</span>;</span><br><span class="line">    photoDiv.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">&quot;translate(-50%, -50%) scale(1.2) rotate(0deg)&quot;</span>;</span><br><span class="line">    photoDiv.<span class="property">style</span>.<span class="property">zIndex</span> = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 随机分布其他图片</span></span><br><span class="line">    container.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.photo&quot;</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">other</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (other !== photoDiv) &#123;</span><br><span class="line">        <span class="keyword">const</span> newPosition = <span class="title function_">getRandomPosition</span>();</span><br><span class="line">        other.<span class="property">style</span>.<span class="property">left</span> = <span class="string">`<span class="subst">$&#123;newPosition.x&#125;</span>px`</span>;</span><br><span class="line">        other.<span class="property">style</span>.<span class="property">top</span> = <span class="string">`<span class="subst">$&#123;newPosition.y&#125;</span>px`</span>;</span><br><span class="line">        other.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`rotate(<span class="subst">$&#123;<span class="built_in">Math</span>.random() * <span class="number">30</span> - <span class="number">15</span>&#125;</span>deg) scale(1)`</span>;</span><br><span class="line">        other.<span class="property">style</span>.<span class="property">zIndex</span> = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 渲染图片</span></span><br><span class="line">  photoWallData.<span class="title function_">forEach</span>(<span class="function">(<span class="params">photo, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> photoDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    photoDiv.<span class="property">className</span> = <span class="string">&quot;photo&quot;</span>;</span><br><span class="line">    photoDiv.<span class="property">id</span> = <span class="string">`photo_<span class="subst">$&#123;index&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> imgElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">    imgElement.<span class="property">src</span> = photo.<span class="property">imgUrl</span>;</span><br><span class="line">    imgElement.<span class="property">alt</span> = photo.<span class="property">name</span> || <span class="string">&quot;图片&quot;</span>;</span><br><span class="line">    imgElement.<span class="property">className</span> = <span class="string">&quot;photo_img&quot;</span>;</span><br><span class="line"></span><br><span class="line">    imgElement.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> position = <span class="title function_">getRandomPosition</span>();</span><br><span class="line">      photoDiv.<span class="property">style</span>.<span class="property">left</span> = <span class="string">`<span class="subst">$&#123;position.x&#125;</span>px`</span>;</span><br><span class="line">      photoDiv.<span class="property">style</span>.<span class="property">top</span> = <span class="string">`<span class="subst">$&#123;position.y&#125;</span>px`</span>;</span><br><span class="line">      photoDiv.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;absolute&quot;</span>;</span><br><span class="line">      photoDiv.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`rotate(<span class="subst">$&#123;<span class="built_in">Math</span>.random() * <span class="number">30</span> - <span class="number">15</span>&#125;</span>deg)`</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    imgElement.<span class="property">onerror</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Failed to load image: <span class="subst">$&#123;photo.imgUrl&#125;</span>`</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击事件：居中显示</span></span><br><span class="line">    photoDiv.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> <span class="title function_">centerPhoto</span>(photoDiv));</span><br><span class="line"></span><br><span class="line">    photoDiv.<span class="title function_">appendChild</span>(imgElement);</span><br><span class="line">    container.<span class="title function_">appendChild</span>(photoDiv);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Photo wall initialized successfully.&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听页面跳转（通过 PJAX）</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:success&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;PJAX navigation detected. Reinitializing photo wall...&quot;</span>);</span><br><span class="line">  <span class="title function_">initializePhotoWall</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// DOM 加载完成时初始化</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DOM fully loaded. Initializing photo wall...&quot;</span>);</span><br><span class="line">  <span class="title function_">initializePhotoWall</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>功能说明：</strong></p><ul><li><strong>动态布局</strong>：照片随机分布在照片墙中</li><li><strong>点击交互</strong>：点击照片可以将其居中显示</li><li><strong>旋转效果</strong>：照片有随机的旋转角度</li><li><strong>悬停动画</strong>：鼠标悬停时照片会放大和旋转</li><li><strong>响应式设计</strong>：支持移动端和桌面端</li></ul><hr><h3 id="11-配置脚本引入">11. 配置脚本引入</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extends:</span></span><br><span class="line">  <span class="attr">body:</span></span><br><span class="line">    <span class="comment"># 相册集</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/album.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/album-modal.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/photo-wall.js&quot;</span> <span class="string">defer&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>在主题配置的extends.body部分添加相册集相关脚本的引入。</p><hr><h3 id="12-添加主题配置">12. 添加主题配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/_config.yml</code></p><p><strong>修改内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --------------------------- start ---------------------------</span></span><br><span class="line"><span class="comment"># Album Page</span></span><br><span class="line"><span class="comment"># 相册集</span></span><br><span class="line"><span class="attr">album:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment"># --------------------------- end ---------------------------</span></span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --------------------------- start ---------------------------</span></span><br><span class="line"><span class="comment"># Album Page</span></span><br><span class="line"><span class="comment"># 相册集</span></span><br><span class="line"><span class="attr">album:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># --------------------------- end ---------------------------</span></span><br></pre></td></tr></table></figure><hr><h3 id="13-复制静态资源文件">13. 复制静态资源文件</h3><p><strong>背景图片文件：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制背景图片</span></span><br><span class="line">copy <span class="string">&quot;blog-solitude\public\img\letter.png&quot;</span> <span class="string">&quot;solitude-latest\public\img\letter.png&quot;</span></span><br></pre></td></tr></table></figure><p><strong>文件结构：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solitude-latest/public/</span><br><span class="line">└── img/</span><br><span class="line">    └── letter.png</span><br></pre></td></tr></table></figure><hr><h3 id="14-添加CSS样式导入">14. 添加CSS样式导入</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/index.styl</code></p><p><strong>修改内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;album.enable&#x27;</span>)</span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&quot;album.styl&quot;</span></span><br></pre></td></tr></table></figure><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code></p><p><strong>修改内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/album.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;album-modal.css&#x27;</span></span><br></pre></td></tr></table></figure><hr><h2 id="功能特性">功能特性</h2><h3 id="1-照片墙功能">1. 照片墙功能</h3><ul><li><strong>动态布局</strong>：照片随机分布在照片墙中</li><li><strong>点击交互</strong>：点击照片可以将其居中显示</li><li><strong>旋转效果</strong>：照片有随机的旋转角度</li><li><strong>悬停动画</strong>：鼠标悬停时照片会放大和旋转</li><li><strong>背景图片</strong>：使用letter.png作为照片墙背景</li><li><strong>响应式设计</strong>：支持小屏幕缩放和适配</li></ul><h3 id="2-相册分类功能">2. 相册分类功能</h3><ul><li><strong>标签筛选</strong>：根据标签分类显示相册（大学、浪漫、旅行、日常、旅游、生活）</li><li><strong>动态切换</strong>：点击标签切换相册分类</li><li><strong>默认分类</strong>：页面加载时显示默认分类</li><li><strong>响应式设计</strong>：适配不同屏幕尺寸</li></ul><h3 id="3-私密相册功能">3. 私密相册功能</h3><ul><li><strong>密码保护</strong>：私密相册需要输入密码才能查看</li><li><strong>模糊效果</strong>：私密相册封面显示模糊效果</li><li><strong>锁定图标</strong>：私密相册显示锁定图标</li><li><strong>安全验证</strong>：密码验证功能</li></ul><h3 id="4-模态框预览功能">4. 模态框预览功能</h3><ul><li><strong>图片预览</strong>：点击相册显示模态框预览</li><li><strong>缩略图切换</strong>：点击缩略图切换主图片</li><li><strong>全屏显示</strong>：模态框全屏显示图片</li><li><strong>背景关闭</strong>：点击背景关闭模态框</li><li><strong>图片保护</strong>：模态框中的图片也禁止右键下载</li></ul><h3 id="5-图片保护功能">5. 图片保护功能</h3><ul><li><strong>右键禁用</strong>：禁止右键菜单</li><li><strong>拖拽禁用</strong>：禁止拖拽下载</li><li><strong>复制禁用</strong>：禁止复制图片</li><li><strong>用户选择禁用</strong>：禁用用户选择</li></ul><h3 id="6-响应式设计">6. 响应式设计</h3><ul><li><strong>移动端适配</strong>：在小屏幕设备上正常显示（2列布局）</li><li><strong>平板端适配</strong>：中等屏幕设备适配（3列布局）</li><li><strong>桌面端适配</strong>：大屏幕设备适配（5列布局）</li><li><strong>触摸支持</strong>：支持触摸设备的操作</li><li><strong>性能优化</strong>：使用事件委托和防抖优化性能</li></ul><h3 id="7-相册数据统计">7. 相册数据统计</h3><ul><li><strong>相册总数</strong>：15个相册</li><li><strong>私密相册</strong>：7个（需要密码访问）</li><li><strong>公开相册</strong>：8个（可直接访问）</li><li><strong>照片墙照片</strong>：5张照片</li><li><strong>分类标签</strong>：6个分类（大学、浪漫、旅行、日常、旅游、生活）</li></ul><hr><h2 id="使用说明">使用说明</h2><h3 id="1-添加新相册">1. 添加新相册</h3><p>在 <code>source/_data/album.yml</code> 文件中添加新的相册：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">album_list:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">新相册</span></span><br><span class="line">    <span class="attr">cover:</span> <span class="string">https://example.com/cover.jpg</span></span><br><span class="line">    <span class="attr">access:</span> <span class="string">public</span></span><br><span class="line">    <span class="attr">date:</span> <span class="number">2024-01-01</span></span><br><span class="line">    <span class="attr">tag:</span> <span class="string">新分类</span></span><br><span class="line">    <span class="attr">album_img_list:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">照片1</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">https://example.com/photo1.jpg</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">照片2</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">https://example.com/photo2.jpg</span></span><br></pre></td></tr></table></figure><h3 id="2-添加私密相册">2. 添加私密相册</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">album_list:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">私密相册</span></span><br><span class="line">    <span class="attr">cover:</span> <span class="string">https://example.com/cover.jpg</span></span><br><span class="line">    <span class="attr">access:</span> <span class="string">private</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">your_password</span></span><br><span class="line">    <span class="attr">date:</span> <span class="number">2024-01-01</span></span><br><span class="line">    <span class="attr">tag:</span> <span class="string">私密</span></span><br><span class="line">    <span class="attr">album_img_list:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">私密照片</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">https://example.com/private.jpg</span></span><br></pre></td></tr></table></figure><h3 id="3-添加照片墙照片">3. 添加照片墙照片</h3><p>在 <code>photo-wall.js</code> 文件中修改照片数据：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> photoWallData = [</span><br><span class="line">  &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://example.com/photo1.jpg&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;照片1&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">imgUrl</span>: <span class="string">&quot;https://example.com/photo2.jpg&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;照片2&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="4-自定义样式">4. 自定义样式</h3><p>可以修改CSS样式来自定义效果：</p><ul><li>调整照片墙背景图片</li><li>修改相册卡片样式</li><li>自定义模态框效果</li><li>调整响应式布局</li></ul><hr><h2 id="常见问题解决">常见问题解决</h2><h3 id="1-照片墙背景图片不显示">1. 照片墙背景图片不显示</h3><p><strong>问题：</strong> 照片墙背景图片显示为404错误<br><strong>解决：</strong> 确保letter.png文件已正确复制到 <code>public/img/</code> 目录</p><h3 id="2-照片墙照片不显示">2. 照片墙照片不显示</h3><p><strong>问题：</strong> 照片墙照片不显示或位置异常<br><strong>解决：</strong></p><ul><li>确保photo-wall.js脚本已正确引入</li><li>检查照片URL是否可访问</li><li>检查控制台是否有JavaScript错误</li></ul><h3 id="3-相册分类不工作">3. 相册分类不工作</h3><p><strong>问题：</strong> 点击标签无法切换相册分类<br><strong>解决：</strong></p><ul><li>确保album.js脚本已正确引入</li><li>检查相册数据格式是否正确</li><li>检查标签名称是否一致</li></ul><h3 id="4-私密相册密码验证失败">4. 私密相册密码验证失败</h3><p><strong>问题：</strong> 输入正确密码仍无法解锁相册<br><strong>解决：</strong></p><ul><li>检查密码是否包含特殊字符</li><li>确保密码与配置文件中的完全一致</li><li>检查JavaScript控制台是否有错误</li></ul><h3 id="5-模态框不显示">5. 模态框不显示</h3><p><strong>问题：</strong> 点击相册无法显示模态框<br><strong>解决：</strong></p><ul><li>确保album-modal.js脚本已正确引入</li><li>检查相册图片数据是否正确</li><li>检查模态框HTML结构是否完整</li></ul><h3 id="6-移动端显示异常">6. 移动端显示异常</h3><p><strong>问题：</strong> 在移动设备上显示异常<br><strong>解决：</strong></p><ul><li>检查响应式CSS样式</li><li>确保触摸事件正常工作</li><li>测试不同屏幕尺寸的适配</li></ul><hr><h2 id="注意事项">注意事项</h2><ol><li><strong>文件路径</strong>：确保所有静态资源文件路径正确</li><li><strong>图片格式</strong>：建议使用JPG或PNG格式，确保图片质量</li><li><strong>私密相册</strong>：密码建议使用简单字符，避免特殊符号</li><li><strong>照片墙</strong>：照片数量建议控制在5-10张，避免性能问题</li><li><strong>浏览器兼容</strong>：某些效果需要现代浏览器支持</li><li><strong>性能优化</strong>：大量图片时注意性能优化</li></ol><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们成功为Solitude主题添加了完整的相册集功能。这个功能不仅提供了美观的照片墙展示效果，还具有良好的交互性和扩展性。用户可以根据自己的需求轻松添加和管理相册资源，展示个人的照片收藏和回忆。</p><h3 id="实装完成的功能">实装完成的功能</h3><p><strong>核心功能：</strong></p><ul><li>✅ 照片墙动态布局（5张照片）</li><li>✅ 相册分类系统（6个标签分类）</li><li>✅ 私密相册密码保护（7个私密相册）</li><li>✅ 模态框图片预览</li><li>✅ 响应式设计（移动端2列、平板3列、桌面5列）</li><li>✅ 图片保护功能（禁止右键下载）</li></ul><p><strong>技术实现：</strong></p><ul><li>✅ Pug模板引擎</li><li>✅ Stylus CSS预处理器</li><li>✅ 原生JavaScript交互</li><li>✅ 事件委托优化</li><li>✅ PJAX页面跳转支持</li><li>✅ CSS Grid/Flexbox响应式布局</li></ul><p><strong>数据统计：</strong></p><ul><li>✅ 15个相册（8个公开 + 7个私密）</li><li>✅ 6个分类标签（大学、浪漫、旅行、日常、旅游、生活）</li><li>✅ 5张照片墙照片</li><li>✅ 完整的响应式适配</li></ul><h3 id="技术亮点">技术亮点</h3><p>相册集功能的实现体现了现代Web开发的核心技术：</p><ul><li><strong>CSS3变换</strong>：实现精美的视觉效果和动画</li><li><strong>JavaScript交互</strong>：提供流畅的用户交互体验</li><li><strong>数据驱动</strong>：通过配置文件管理内容</li><li><strong>响应式设计</strong>：适配各种设备和屏幕尺寸</li><li><strong>安全保护</strong>：私密相册和图片保护功能</li><li><strong>性能优化</strong>：事件委托和懒加载优化</li></ul><p>这个功能为Solitude主题增添了独特的相册展示模块，丰富了博客的内容展示形式，提升了用户体验。相册集功能不仅适合个人博客使用，也可以作为摄影作品展示、旅行记录、生活分享等多种用途。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 相册集 </tag>
            
            <tag> 照片墙 </tag>
            
            <tag> 模态框 </tag>
            
            <tag> 页面移植 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(9)-乐谱坊页面</title>
      <link href="/2024/10/28/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(9)-%E4%B9%90%E8%B0%B1%E5%9D%8A%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/10/28/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(9)-%E4%B9%90%E8%B0%B1%E5%9D%8A%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有乐谱坊页面功能，但有时我们希望展示钢琴乐谱等音乐资源。本文将详细介绍如何从blog-solitude项目完整移植乐谱坊页面功能到solitude-latest，包括3D Coverflow效果、数据管理、静态资源处理和交互功能的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认没有乐谱坊页面</li><li>缺少3D Coverflow展示效果</li><li>无法展示钢琴乐谱等音乐资源</li><li>缺少乐谱数据管理和PDF链接功能</li></ul><h3 id="期望效果">期望效果</h3><ul><li>独立的乐谱坊页面（<code>/musicsheets/</code>）</li><li>3D Coverflow旋转展示效果</li><li>支持乐谱封面图片展示</li><li>支持PDF文件链接和下载</li><li>响应式设计，适配不同屏幕尺寸</li><li>视频Banner支持</li><li>键盘和鼠标交互控制</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>页面类型缺失</strong><br>solitude-latest主题缺少musicsheets页面类型的支持</p></li><li><p><strong>模板文件缺失</strong><br>缺少musicsheets页面的模板文件和3D Coverflow组件</p></li><li><p><strong>数据管理缺失</strong><br>缺少乐谱数据的配置和管理机制</p></li><li><p><strong>样式文件缺失</strong><br>缺少musicsheets页面的CSS样式文件</p></li><li><p><strong>静态资源缺失</strong><br>缺少乐谱图片和PDF文件</p></li><li><p><strong>JavaScript交互缺失</strong><br>缺少3D Coverflow的交互逻辑</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/source/musicsheets/index.md</code></li><li><code>solitude-latest/source/_data/musicsheets.yml</code></li><li><code>solitude-latest/public/js/custom/musicsheets.js</code></li><li><code>solitude-latest/public/css/index.css</code> (样式已编译)</li><li><code>solitude-latest/public/img/musicsheets/</code> (图片资源)</li><li><code>solitude-latest/public/pdf/</code> (PDF文件)</li><li><code>solitude-latest/_config.solitude.yml</code> (脚本引入配置)</li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建乐谱坊页面配置">1. 创建乐谱坊页面配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/musicsheets/index.md</code></p><p><strong>文件内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">乐谱坊</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2024-11-17 21:27:43</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">musicsheets</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/musicsheets-banner.mp4</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">钢琴乐谱分享</span></span><br><span class="line"><span class="attr">leftend:</span> <span class="string">跟</span> <span class="string">Ryan</span> <span class="string">一起聆听音乐的魅力</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p><strong>配置说明：</strong></p><ul><li><code>type: musicsheets</code> - 页面类型为musicsheets</li><li><code>cover: /mp4/musicsheets-banner.mp4</code> - 设置banner视频</li><li><code>desc</code> - banner描述文字</li><li><code>leftend</code> - banner左侧信息</li></ul><hr><h3 id="2-创建乐谱数据配置文件">2. 创建乐谱数据配置文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/_data/musicsheets.yml</code></p><p><strong>文件结构：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">musicsheets:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/六月船歌.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 1&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/水边的阿第莉娜.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 2&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/菊次郎的夏天.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 3&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/夜曲.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 4&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/月光.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 5&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/胡桃夹子.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 6&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/致爱丽丝.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;Image 7&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/The</span> <span class="string">Seasons,</span> <span class="string">Op.37a</span> <span class="bullet">-</span> <span class="string">Complete</span> <span class="string">Score</span> <span class="number">1.</span><span class="string">pdf</span></span><br></pre></td></tr></table></figure><p><strong>数据结构说明：</strong></p><ul><li><code>musicsheets</code> - 乐谱数据数组</li><li><code>image</code> - 乐谱封面图片路径</li><li><code>alt</code> - 图片替代文本</li><li><code>albumLink</code> - 对应的PDF文件链接</li></ul><p><strong>注意事项：</strong></p><ul><li>图片路径使用相对路径，从public目录开始</li><li>PDF文件路径需要包含空格处理</li><li>建议使用PNG格式的乐谱封面图片</li><li>图片尺寸建议保持一致（300x400px）</li></ul><hr><h3 id="3-创建3D-Coverflow-JavaScript文件">3. 创建3D Coverflow JavaScript文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/public/js/custom/musicsheets.js</code></p><p><strong>文件内容：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">initializeCoverflowWithDelegation</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> coverflowContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.coverflow&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> albumButton = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.album-button&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!coverflowContainer || !albumButton) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> currentPosition;</span><br><span class="line">  <span class="keyword">let</span> images = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">calculateInitialPosition</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> totalImages = images.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">return</span> totalImages % <span class="number">2</span> === <span class="number">0</span> ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(totalImages / <span class="number">2</span>) : <span class="title class_">Math</span>.<span class="title function_">ceil</span>(totalImages / <span class="number">2</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">updateCoverflow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coverflowContainer.<span class="property">dataset</span>.<span class="property">coverflowPosition</span> = currentPosition;</span><br><span class="line"></span><br><span class="line">    images.<span class="title function_">forEach</span>(<span class="function">(<span class="params">img, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> offset = index + <span class="number">1</span> - currentPosition;</span><br><span class="line">      <span class="keyword">const</span> translateX = offset * <span class="number">150</span>;</span><br><span class="line">      <span class="keyword">const</span> scale = <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="number">0.8</span>, <span class="number">1</span> - <span class="title class_">Math</span>.<span class="title function_">abs</span>(offset) * <span class="number">0.2</span>);</span><br><span class="line">      <span class="keyword">const</span> rotateY = offset * -<span class="number">25</span>;</span><br><span class="line">      <span class="keyword">const</span> opacity = <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="number">0.5</span>, <span class="number">1</span> - <span class="title class_">Math</span>.<span class="title function_">abs</span>(offset) * <span class="number">0.3</span>);</span><br><span class="line">      <span class="keyword">const</span> zIndex = <span class="number">50</span> - <span class="title class_">Math</span>.<span class="title function_">abs</span>(offset) * <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">      img.<span class="property">style</span>.<span class="property">transform</span> = <span class="string">`translateX(<span class="subst">$&#123;translateX&#125;</span>px) scale(<span class="subst">$&#123;scale&#125;</span>) rotateY(<span class="subst">$&#123;rotateY&#125;</span>deg)`</span>;</span><br><span class="line">      img.<span class="property">style</span>.<span class="property">opacity</span> = opacity;</span><br><span class="line">      img.<span class="property">style</span>.<span class="property">zIndex</span> = zIndex;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新按钮链接</span></span><br><span class="line">    <span class="keyword">const</span> activeImage = images[currentPosition - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (activeImage) &#123;</span><br><span class="line">      <span class="keyword">const</span> albumLink = activeImage.<span class="property">dataset</span>.<span class="property">album</span> || <span class="string">&quot;#&quot;</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Album link for current image: <span class="subst">$&#123;albumLink&#125;</span>`</span>);</span><br><span class="line">      albumButton.<span class="title function_">setAttribute</span>(<span class="string">&quot;data-album&quot;</span>, albumLink);</span><br><span class="line">      albumButton.<span class="property">onclick</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (albumLink &amp;&amp; albumLink !== <span class="string">&quot;#&quot;</span>) &#123;</span><br><span class="line">          <span class="variable language_">window</span>.<span class="title function_">open</span>(albumLink, <span class="string">&quot;_blank&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">alert</span>(<span class="string">&quot;No album link available for this image.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> prevArrow = coverflowContainer.<span class="title function_">querySelector</span>(<span class="string">&quot;.prev-arrow&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> nextArrow = coverflowContainer.<span class="title function_">querySelector</span>(<span class="string">&quot;.next-arrow&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (prevArrow &amp;&amp; nextArrow) &#123;</span><br><span class="line">      prevArrow.<span class="property">style</span>.<span class="property">display</span> = currentPosition === <span class="number">1</span> ? <span class="string">&quot;none&quot;</span> : <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      nextArrow.<span class="property">style</span>.<span class="property">display</span> = currentPosition === images.<span class="property">length</span> ? <span class="string">&quot;none&quot;</span> : <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">moveToNext</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (currentPosition &lt; images.<span class="property">length</span>) &#123;</span><br><span class="line">      currentPosition++;</span><br><span class="line">      <span class="title function_">updateCoverflow</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">moveToPrev</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (currentPosition &gt; <span class="number">1</span>) &#123;</span><br><span class="line">      currentPosition--;</span><br><span class="line">      <span class="title function_">updateCoverflow</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">moveToClickedImage</span> = (<span class="params">clickedIndex</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (clickedIndex + <span class="number">1</span> !== currentPosition) &#123;</span><br><span class="line">      currentPosition = clickedIndex + <span class="number">1</span>;</span><br><span class="line">      <span class="title function_">updateCoverflow</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleCoverflowClick</span> = (<span class="params">event</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = event.<span class="property">target</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;prev-arrow&quot;</span>)) &#123;</span><br><span class="line">      <span class="title function_">moveToPrev</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;next-arrow&quot;</span>)) &#123;</span><br><span class="line">      <span class="title function_">moveToNext</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;coverflow__image&quot;</span>)) &#123;</span><br><span class="line">      <span class="keyword">const</span> clickedIndex = images.<span class="title function_">indexOf</span>(target);</span><br><span class="line">      <span class="keyword">if</span> (clickedIndex !== -<span class="number">1</span>) <span class="title function_">moveToClickedImage</span>(clickedIndex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">initializeCoverflowImages</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    images = <span class="title class_">Array</span>.<span class="title function_">from</span>(coverflowContainer.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.coverflow__image&quot;</span>));</span><br><span class="line">    currentPosition = <span class="title function_">calculateInitialPosition</span>();</span><br><span class="line">    <span class="title function_">updateCoverflow</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 初始化 Coverflow 并绑定事件委托</span></span><br><span class="line">  <span class="title function_">initializeCoverflowImages</span>();</span><br><span class="line">  coverflowContainer.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, handleCoverflowClick);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听键盘事件</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;keydown&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">key</span> === <span class="string">&quot;ArrowLeft&quot;</span>) <span class="title function_">moveToPrev</span>();</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">key</span> === <span class="string">&quot;ArrowRight&quot;</span>) <span class="title function_">moveToNext</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果有动态加载图片，可以用 MutationObserver 或手动调用重新初始化</span></span><br><span class="line">  <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">initializeCoverflowImages</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  observer.<span class="title function_">observe</span>(coverflowContainer, &#123; <span class="attr">childList</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绑定到页面加载和页面迁移事件</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, initializeCoverflowWithDelegation);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:success&quot;</span>, initializeCoverflowWithDelegation);</span><br></pre></td></tr></table></figure><p><strong>功能说明：</strong></p><ul><li><strong>3D变换计算</strong>：根据图片位置计算translateX、scale、rotateY等变换参数</li><li><strong>事件委托</strong>：使用事件委托优化性能，处理点击和键盘事件</li><li><strong>动态更新</strong>：根据当前选中位置动态更新所有图片的3D效果</li><li><strong>按钮控制</strong>：更新&quot;欣赏乐谱&quot;按钮的链接和点击事件</li><li><strong>键盘支持</strong>：支持左右箭头键导航</li><li><strong>响应式</strong>：支持动态内容变化时的重新初始化</li></ul><hr><h3 id="4-配置脚本引入">4. 配置脚本引入</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extends:</span></span><br><span class="line">  <span class="attr">body:</span></span><br><span class="line">    <span class="comment"># 乐谱集</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/custom/musicsheets.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>在主题配置的extends.body部分添加musicsheets.js脚本的引入，确保3D Coverflow功能正常工作。</p><hr><h3 id="5-复制静态资源文件">5. 复制静态资源文件</h3><p><strong>乐谱图片文件：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制乐谱图片</span></span><br><span class="line"><span class="built_in">cp</span> -r blog-solitude/public/img/musicsheets solitude-latest/public/img/</span><br></pre></td></tr></table></figure><p><strong>PDF文件：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制PDF文件</span></span><br><span class="line"><span class="built_in">cp</span> -r blog-solitude/public/pdf solitude-latest/public/</span><br></pre></td></tr></table></figure><p><strong>文件结构：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">solitude-latest/public/</span><br><span class="line">├── img/musicsheets/</span><br><span class="line">│   ├── 六月船歌.png</span><br><span class="line">│   ├── 水边的阿第莉娜.png</span><br><span class="line">│   ├── 菊次郎的夏天.png</span><br><span class="line">│   ├── 夜曲.png</span><br><span class="line">│   ├── 月光.png</span><br><span class="line">│   ├── 胡桃夹子.png</span><br><span class="line">│   └── 致爱丽丝.png</span><br><span class="line">└── pdf/</span><br><span class="line">    └── The Seasons, Op.37a - Complete Score 1.pdf</span><br></pre></td></tr></table></figure><hr><h3 id="6-样式文件说明">6. 样式文件说明</h3><p><strong>CSS样式已编译到：</strong><br><code>solitude-latest/public/css/index.css</code></p><p><strong>主要样式特点：</strong></p><ul><li><strong>3D透视</strong>：使用<code>perspective: 1000px</code>创建3D空间</li><li><strong>变换效果</strong>：使用<code>transform</code>实现旋转、缩放、位移</li><li><strong>过渡动画</strong>：使用<code>transition</code>实现平滑的动画效果</li><li><strong>层级管理</strong>：使用<code>z-index</code>控制图片层级</li><li><strong>响应式</strong>：适配不同屏幕尺寸</li></ul><p><strong>关键样式类：</strong></p><ul><li><code>.coverflow</code> - 3D容器</li><li><code>.coverflow__image</code> - 乐谱图片</li><li><code>.prev-arrow/.next-arrow</code> - 导航箭头</li><li><code>.album-button</code> - 欣赏乐谱按钮</li></ul><hr><h2 id="功能特性">功能特性</h2><h3 id="1-3D-Coverflow效果">1. 3D Coverflow效果</h3><ul><li><strong>3D旋转</strong>：乐谱以3D方式旋转展示</li><li><strong>深度效果</strong>：通过perspective和rotateY创建深度感</li><li><strong>缩放效果</strong>：中心图片最大，两侧逐渐缩小</li><li><strong>透明度</strong>：根据位置动态调整透明度</li></ul><h3 id="2-交互控制">2. 交互控制</h3><ul><li><strong>鼠标点击</strong>：点击图片或箭头进行导航</li><li><strong>键盘控制</strong>：支持左右箭头键导航</li><li><strong>按钮控制</strong>：点击&quot;欣赏乐谱&quot;按钮打开PDF</li></ul><h3 id="3-数据管理">3. 数据管理</h3><ul><li><strong>YAML配置</strong>：使用YAML文件管理乐谱数据</li><li><strong>图片管理</strong>：支持PNG格式的乐谱封面</li><li><strong>PDF链接</strong>：支持PDF文件的链接和下载</li></ul><h3 id="4-响应式设计">4. 响应式设计</h3><ul><li><strong>移动端适配</strong>：在小屏幕设备上正常显示</li><li><strong>触摸支持</strong>：支持触摸设备的滑动操作</li><li><strong>性能优化</strong>：使用事件委托和防抖优化性能</li></ul><hr><h2 id="使用说明">使用说明</h2><h3 id="1-添加新乐谱">1. 添加新乐谱</h3><p>在 <code>source/_data/musicsheets.yml</code> 文件中添加新的乐谱：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">musicsheets:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">/img/musicsheets/新乐谱.png</span></span><br><span class="line">    <span class="attr">alt:</span> <span class="string">&quot;新乐谱&quot;</span></span><br><span class="line">    <span class="attr">albumLink:</span> <span class="string">/pdf/新乐谱.pdf</span></span><br></pre></td></tr></table></figure><h3 id="2-添加乐谱图片">2. 添加乐谱图片</h3><p>将乐谱封面图片放入 <code>public/img/musicsheets/</code> 目录：</p><ul><li>建议尺寸：300x400px</li><li>格式：PNG（推荐）或JPG</li><li>命名：使用中文或英文名称</li></ul><h3 id="3-添加PDF文件">3. 添加PDF文件</h3><p>将PDF文件放入 <code>public/pdf/</code> 目录：</p><ul><li>文件名避免包含空格（可能导致URL编码问题）</li><li>建议使用英文命名</li><li>确保文件路径在配置中正确引用</li></ul><h3 id="4-自定义样式">4. 自定义样式</h3><p>可以修改CSS样式来自定义3D效果：</p><ul><li>调整<code>perspective</code>值改变3D深度</li><li>修改<code>rotateY</code>值改变旋转角度</li><li>调整<code>scale</code>值改变缩放比例</li></ul><hr><h2 id="常见问题解决">常见问题解决</h2><h3 id="1-图片显示404">1. 图片显示404</h3><p><strong>问题：</strong> 乐谱图片显示为404错误<br><strong>解决：</strong> 确保图片文件已正确复制到 <code>public/img/musicsheets/</code> 目录</p><h3 id="2-PDF链接无法访问">2. PDF链接无法访问</h3><p><strong>问题：</strong> 点击&quot;欣赏乐谱&quot;按钮无法打开PDF<br><strong>解决：</strong></p><ul><li>检查PDF文件是否存在</li><li>确保文件名不包含特殊字符</li><li>检查文件路径是否正确</li></ul><h3 id="3-3D效果不显示">3. 3D效果不显示</h3><p><strong>问题：</strong> 乐谱没有3D旋转效果<br><strong>解决：</strong></p><ul><li>确保musicsheets.js脚本已正确引入</li><li>检查浏览器是否支持CSS3 3D变换</li><li>检查控制台是否有JavaScript错误</li></ul><h3 id="4-移动端显示异常">4. 移动端显示异常</h3><p><strong>问题：</strong> 在移动设备上显示异常<br><strong>解决：</strong></p><ul><li>检查响应式CSS样式</li><li>确保触摸事件正常工作</li><li>测试不同屏幕尺寸的适配</li></ul><hr><h2 id="注意事项">注意事项</h2><ol><li><strong>文件路径</strong>：确保所有静态资源文件路径正确</li><li><strong>文件名</strong>：避免使用包含空格或特殊字符的文件名</li><li><strong>图片格式</strong>：建议使用PNG格式，确保透明背景效果</li><li><strong>PDF文件</strong>：确保PDF文件可以正常打开和下载</li><li><strong>浏览器兼容</strong>：3D效果需要现代浏览器支持</li><li><strong>性能优化</strong>：大量图片时注意性能优化</li></ol><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们成功为Solitude主题添加了完整的乐谱坊功能。这个功能不仅提供了美观的3D Coverflow展示效果，还具有良好的交互性和扩展性。用户可以根据自己的需求轻松添加和管理乐谱资源，展示个人的音乐收藏和品味。</p><p>乐谱坊功能的实现体现了现代Web开发的核心技术：</p><ul><li><strong>CSS3 3D变换</strong>：实现精美的3D视觉效果</li><li><strong>JavaScript交互</strong>：提供流畅的用户交互体验</li><li><strong>数据驱动</strong>：通过配置文件管理内容</li><li><strong>响应式设计</strong>：适配各种设备和屏幕尺寸</li></ul><p>这个功能为Solitude主题增添了独特的音乐展示模块，丰富了博客的内容展示形式，提升了用户体验。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 乐谱坊 </tag>
            
            <tag> 3D Coverflow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从零开始butterfly博客的魔改教程(二)</title>
      <link href="/2024/10/25/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8Bbutterfly%E5%8D%9A%E5%AE%A2%E7%9A%84%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(%E4%BA%8C)/"/>
      <url>/2024/10/25/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8Bbutterfly%E5%8D%9A%E5%AE%A2%E7%9A%84%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h1>前言</h1><p>上一篇文章主要解决了关于如何搭建hexo博客和使用butterfly主题的问题。这篇文章开始我们将一步一步改良我们的博客，内容可能比较分散，但我尽可能的把大纲梳理清楚，写在最前面。</p><h1>修改内容</h1><h2 id="终端ASCII字符自定义">终端ASCII字符自定义</h2><p>首先定位到这次需要我们修改的地方<br>[BlogRoot]\themes\butterfly\scripts\events\welcome.js</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hexo.on(&#x27;ready&#x27;<span class="punctuation">,</span> () =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  const <span class="punctuation">&#123;</span> version <span class="punctuation">&#125;</span> = require(&#x27;../../package.json&#x27;)</span><br><span class="line">  hexo.log.info(`</span><br><span class="line">  ===================================================================</span><br><span class="line">      #####  #    # ##### ##### ###### #####  ###### #      #   #</span><br><span class="line">      #    # #    #   #     #   #      #    # #      #       # #</span><br><span class="line">      #####  #    #   #     #   #####  #    # #####  #        #</span><br><span class="line">      #    # #    #   #     #   #      #####  #      #        #</span><br><span class="line">      #    # #    #   #     #   #      #   #  #      #        #</span><br><span class="line">      #####   ####    #     #   ###### #    # #      ######   #</span><br><span class="line">                            $<span class="punctuation">&#123;</span>version<span class="punctuation">&#125;</span></span><br><span class="line">  ===================================================================`)</span><br><span class="line"><span class="punctuation">&#125;</span>)</span><br></pre></td></tr></table></figure><p>如何自定义我们想要使用的ASCII字符呢？我们可以在下面这个网站里选择自己喜欢的字符：<br><a href="https://patorjk.com/software/taag">ASCII 生成器</a>,画面如下：<br><img src="https://i.imgur.com/UWT9hqT.png" alt="ASCII 生成器"><br>修改[BlogRoot]\themes\butterfly\scripts\events\welcome.js文件</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hexo.on(&#x27;ready&#x27;<span class="punctuation">,</span> () =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  const <span class="punctuation">&#123;</span> version <span class="punctuation">&#125;</span> = require(&#x27;../../package.json&#x27;)</span><br><span class="line">  hexo.log.info(`</span><br><span class="line">  ===================================================================</span><br><span class="line">        ███████╗██╗   ██╗███╗   ███╗███╗   ███╗███████╗██████╗ </span><br><span class="line">        ██╔════╝██║   ██║████╗ ████║████╗ ████║██╔════╝██╔══██╗</span><br><span class="line">        ███████╗██║   ██║██╔████╔██║██╔████╔██║█████╗  ██████╔╝</span><br><span class="line">        ╚════██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██╔══██╗</span><br><span class="line">        ███████║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║  ██║</span><br><span class="line">        ╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝</span><br><span class="line">                            $<span class="punctuation">&#123;</span>version<span class="punctuation">&#125;</span></span><br><span class="line">  ===================================================================`)</span><br><span class="line"><span class="punctuation">&#125;</span>)</span><br></pre></td></tr></table></figure><p>重新执行Hexo三板斧，搞定！<br><img src="https://i.imgur.com/FBZw5T8.png" alt="ASCII 自定义成功"></p><h2 id="语雀同款链接卡片">语雀同款链接卡片</h2><h3 id="创建数据">创建数据</h3><ul><li>创建 <code>[blogRoot]/themes/butterfly/scripts/tag/link.js</code> 文件，并新增以下内容</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * link</span></span><br><span class="line"><span class="comment"> * &#123;% link url,title,favicon,desc %&#125;</span></span><br><span class="line"><span class="comment"> * &#123;% link 链接,标题,图标,介绍 %&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> defaultIcon = <span class="string">&#x27;&lt;svg t=&quot;1670307855063&quot; viewBox=&quot;0 0 1024 1024&quot; version=&quot;1.1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; p-id=&quot;19066&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;&lt;path d=&quot;M504.064 516.608m-384.256 0a384.256 384.256 0 1 0 768.512 0 384.256 384.256 0 1 0-768.512 0Z&quot; fill=&quot;#009CF5&quot; p-id=&quot;19068&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M746.112 270.464L472.448 485.12l63.104 63.104L750.08 274.56c2.304-2.688-1.28-6.144-3.968-4.096z&quot; fill=&quot;#FF4C3A&quot; p-id=&quot;19069&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M262.016 762.752l273.664-214.528-63.104-63.104-214.656 273.536c-2.176 2.688 1.28 6.144 4.096 4.096z&quot; fill=&quot;#FFFFFF&quot; p-id=&quot;19070&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M505.216 155.136c-3.2 0-5.888 2.56-5.888 5.888v53.504c0 3.2 2.56 5.888 5.888 5.888s5.888-2.56 5.888-5.888v-53.504c-0.128-3.2-2.688-5.888-5.888-5.888zM442.368 160.512c-3.2 0.512-5.376 3.584-4.736 6.784l9.344 52.736c0.512 3.2 3.584 5.376 6.784 4.736 3.2-0.512 5.376-3.584 4.736-6.784l-9.344-52.736c-0.512-3.2-3.584-5.376-6.784-4.736zM396.288 234.368c1.152 3.072 4.48 4.608 7.552 3.456 3.072-1.152 4.608-4.48 3.456-7.552l-18.304-50.304c-1.152-3.072-4.48-4.608-7.552-3.456-3.072 1.152-4.608 4.48-3.456 7.552l18.304 50.304zM348.928 257.408c1.664 2.816 5.248 3.712 7.936 2.176s3.712-5.248 2.176-7.936l-26.752-46.336c-1.664-2.816-5.248-3.712-7.936-2.176-2.816 1.664-3.712 5.248-2.176 7.936l26.752 46.336zM306.304 288.256c2.048 2.432 5.76 2.816 8.192 0.768 2.432-2.048 2.816-5.76 0.768-8.192l-34.432-40.96c-2.048-2.432-5.76-2.816-8.192-0.768-2.432 2.048-2.816 5.76-0.768 8.192l34.432 40.96zM269.696 326.144c2.432 2.048 6.144 1.792 8.192-0.768 2.048-2.432 1.792-6.144-0.768-8.192l-40.96-34.432c-2.432-2.048-6.144-1.792-8.192 0.768-2.048 2.432-1.792 6.144 0.768 8.192l40.96 34.432zM193.792 342.912l46.336 26.752c2.816 1.664 6.4 0.64 7.936-2.176 1.664-2.816 0.64-6.4-2.176-8.064L199.552 332.8c-2.816-1.664-6.4-0.64-7.936 2.176-1.664 2.688-0.64 6.272 2.176 7.936zM168.32 399.488l50.304 18.304c3.072 1.152 6.4-0.512 7.552-3.456 1.152-3.072-0.512-6.4-3.456-7.552l-50.304-18.304c-3.072-1.152-6.4 0.512-7.552 3.456-1.152 3.072 0.384 6.4 3.456 7.552zM207.872 457.344l-52.736-9.344c-3.2-0.512-6.272 1.536-6.784 4.736-0.512 3.2 1.536 6.272 4.736 6.784l52.736 9.344c3.2 0.512 6.272-1.536 6.784-4.736 0.512-3.2-1.536-6.272-4.736-6.784zM201.984 509.568H148.48c-3.2 0-5.888 2.56-5.888 5.888 0 3.2 2.56 5.888 5.888 5.888h53.504c3.2 0 5.888-2.56 5.888-5.888 0-3.2-2.56-5.888-5.888-5.888zM205.44 562.176l-52.736 9.344c-3.2 0.512-5.376 3.584-4.736 6.784 0.512 3.2 3.584 5.376 6.784 4.736l52.736-9.344c3.2-0.512 5.376-3.584 4.736-6.784s-3.584-5.248-6.784-4.736zM217.856 613.376l-50.304 18.304c-3.072 1.152-4.608 4.48-3.456 7.552 1.152 3.072 4.48 4.608 7.552 3.456l50.304-18.304c3.072-1.152 4.608-4.48 3.456-7.552-1.152-3.072-4.48-4.608-7.552-3.456zM238.976 661.504l-46.336 26.752c-2.816 1.664-3.712 5.248-2.176 8.064 1.664 2.816 5.248 3.712 8.064 2.176l46.336-26.752c2.816-1.664 3.712-5.248 2.176-8.064-1.664-2.816-5.248-3.712-8.064-2.176zM268.16 705.408l-40.96 34.432c-2.432 2.048-2.816 5.76-0.768 8.192 2.048 2.432 5.76 2.816 8.192 0.768l40.96-34.432c2.432-2.048 2.816-5.76 0.768-8.192-1.92-2.56-5.632-2.816-8.192-0.768zM304.512 743.424l-34.432 40.96c-2.048 2.432-1.792 6.144 0.768 8.192 2.432 2.048 6.144 1.792 8.192-0.768l34.432-40.96c2.048-2.432 1.792-6.144-0.768-8.192-2.304-1.92-6.016-1.664-8.192 0.768zM347.008 774.656l-26.752 46.336c-1.664 2.816-0.64 6.4 2.176 7.936 2.816 1.664 6.4 0.64 8.064-2.176l26.752-46.336c1.664-2.816 0.64-6.4-2.176-7.936-2.816-1.536-6.4-0.64-8.064 2.176zM394.24 798.08l-18.304 50.304c-1.152 3.072 0.512 6.4 3.456 7.552 3.072 1.152 6.4-0.512 7.552-3.456l18.304-50.304c1.152-3.072-0.512-6.4-3.456-7.552-3.072-1.152-6.528 0.384-7.552 3.456zM440.192 872.32c3.2 0.512 6.272-1.536 6.784-4.736l9.344-52.736c0.512-3.2-1.536-6.272-4.736-6.784-3.2-0.512-6.272 1.536-6.784 4.736l-9.344 52.736c-0.64 3.2 1.536 6.272 4.736 6.784zM502.912 878.08c3.2 0 5.888-2.56 5.888-5.888v-53.504c0-3.2-2.56-5.888-5.888-5.888-3.2 0-5.888 2.56-5.888 5.888v53.504c0 3.2 2.688 5.888 5.888 5.888zM549.632 815.232l9.344 52.736c0.512 3.2 3.584 5.376 6.784 4.736 3.2-0.512 5.376-3.584 4.736-6.784l-9.344-52.736c-0.512-3.2-3.584-5.376-6.784-4.736-3.2 0.512-5.248 3.584-4.736 6.784zM600.832 802.816l18.304 50.304c1.152 3.072 4.48 4.608 7.552 3.456 3.072-1.152 4.608-4.48 3.456-7.552L611.84 798.72c-1.152-3.072-4.48-4.608-7.552-3.456-3.072 1.152-4.608 4.48-3.456 7.552zM649.088 781.696l26.752 46.336c1.664 2.816 5.248 3.712 8.064 2.176 2.816-1.664 3.712-5.248 2.176-8.064l-26.88-46.336c-1.664-2.816-5.248-3.712-8.064-2.176-2.816 1.664-3.712 5.248-2.048 8.064zM692.864 752.384l34.432 40.96c2.048 2.432 5.76 2.816 8.192 0.768 2.432-2.048 2.816-5.76 0.768-8.192l-34.432-40.96c-2.048-2.432-5.76-2.816-8.192-0.768-2.56 2.048-2.816 5.76-0.768 8.192zM730.88 716.032l40.96 34.432c2.432 2.048 6.144 1.792 8.192-0.768 2.048-2.432 1.792-6.144-0.768-8.192l-40.96-34.432c-2.432-2.048-6.144-1.792-8.192 0.768-1.92 2.432-1.664 6.144 0.768 8.192zM762.112 673.664l46.336 26.752c2.816 1.664 6.4 0.64 8.064-2.176 1.664-2.816 0.64-6.4-2.176-7.936L768 663.552c-2.816-1.664-6.4-0.64-8.064 2.176-1.536 2.688-0.64 6.272 2.176 7.936zM785.536 626.432l50.304 18.304c3.072 1.152 6.4-0.512 7.552-3.456 1.152-3.072-0.512-6.4-3.456-7.552l-50.304-18.304c-3.072-1.152-6.4 0.512-7.552 3.456-1.152 3.072 0.384 6.4 3.456 7.552zM800.256 575.872l52.736 9.344c3.2 0.512 6.272-1.536 6.784-4.736 0.512-3.2-1.536-6.272-4.736-6.784l-52.736-9.344c-3.2-0.512-6.272 1.536-6.784 4.736-0.512 3.2 1.536 6.272 4.736 6.784zM800.256 517.76c0 3.2 2.56 5.888 5.888 5.888h53.504c3.2 0 5.888-2.56 5.888-5.888 0-3.2-2.56-5.888-5.888-5.888h-53.504c-3.328 0-5.888 2.56-5.888 5.888zM802.688 471.04l52.736-9.344c3.2-0.512 5.376-3.584 4.736-6.784-0.512-3.2-3.584-5.376-6.784-4.736l-52.736 9.344c-3.2 0.512-5.376 3.584-4.736 6.784 0.512 3.2 3.584 5.248 6.784 4.736zM790.272 419.84l50.304-18.304c3.072-1.152 4.608-4.48 3.456-7.552-1.152-3.072-4.48-4.608-7.552-3.456l-50.304 18.304c-3.072 1.152-4.608 4.48-3.456 7.552 1.152 2.944 4.48 4.608 7.552 3.456zM769.152 371.584l46.336-26.752c2.816-1.664 3.712-5.248 2.176-7.936-1.664-2.816-5.248-3.712-8.064-2.176l-46.336 26.752c-2.816 1.664-3.712 5.248-2.176 8.064 1.664 2.688 5.248 3.712 8.064 2.048zM739.84 327.808l40.96-34.432c2.432-2.048 2.816-5.76 0.768-8.192-2.048-2.432-5.76-2.816-8.192-0.768l-40.96 34.432c-2.432 2.048-2.816 5.76-0.768 8.192 2.048 2.56 5.76 2.816 8.192 0.768zM703.488 289.664l34.432-40.96c2.048-2.432 1.792-6.144-0.768-8.192-2.432-2.048-6.144-1.792-8.192 0.768l-34.432 40.96c-2.048 2.432-1.792 6.144 0.768 8.192 2.432 2.048 6.144 1.792 8.192-0.768zM661.12 258.56l26.752-46.336c1.664-2.816 0.64-6.4-2.176-7.936-2.816-1.664-6.4-0.64-8.064 2.176l-26.752 46.336c-1.664 2.816-0.64 6.4 2.176 7.936 2.816 1.536 6.4 0.64 8.064-2.176zM613.888 235.136l18.304-50.304c1.152-3.072-0.512-6.4-3.456-7.552-3.072-1.152-6.4 0.512-7.552 3.456L602.88 231.168c-1.152 3.072 0.512 6.4 3.456 7.552 3.072 1.024 6.4-0.512 7.552-3.584zM556.544 225.152c3.2 0.512 6.272-1.536 6.784-4.736l9.344-52.736c0.512-3.2-1.536-6.272-4.736-6.784-3.2-0.512-6.272 1.536-6.784 4.736l-9.344 52.736c-0.512 3.2 1.536 6.144 4.736 6.784zM273.536 290.432c2.432 2.432 6.528 2.432 8.96 0 2.432-2.432 2.432-6.528 0-8.96l-21.12-21.12c-2.432-2.432-6.528-2.432-8.96 0-2.432 2.432-2.432 6.528 0 8.96l21.12 21.12zM237.824 333.824c2.944 2.048 6.912 1.28 8.832-1.536 2.048-2.944 1.28-6.912-1.536-8.832l-24.448-17.152c-2.944-2.048-6.912-1.28-8.832 1.536s-1.28 6.912 1.536 8.832l24.448 17.152zM183.04 370.176l27.136 12.672c3.2 1.536 7.04 0.128 8.448-3.072 1.536-3.2 0.128-7.04-3.072-8.448l-27.136-12.672c-3.2-1.536-7.04-0.128-8.448 3.072-1.536 3.2-0.128 7.04 3.072 8.448zM194.688 423.68l-28.928-7.68c-3.456-0.896-6.912 1.152-7.808 4.48-0.896 3.456 1.152 6.912 4.48 7.808l28.928 7.68c3.456 0.896 6.912-1.152 7.808-4.48 0.896-3.456-1.152-6.912-4.48-7.808zM183.168 478.72l-29.824-2.56c-3.456-0.256-6.656 2.304-6.912 5.76-0.256 3.456 2.304 6.656 5.76 6.912l29.824 2.56c3.456 0.256 6.656-2.304 6.912-5.76 0.384-3.456-2.176-6.528-5.76-6.912zM181.504 535.04l-29.824 2.56c-3.456 0.256-6.144 3.456-5.76 6.912 0.256 3.456 3.456 6.144 6.912 5.76l29.824-2.56c3.456-0.256 6.144-3.456 5.76-6.912-0.256-3.456-3.328-6.016-6.912-5.76zM191.36 590.72l-28.928 7.68c-3.456 0.896-5.376 4.352-4.48 7.808 0.896 3.456 4.352 5.376 7.808 4.48l28.928-7.68c3.456-0.896 5.376-4.352 4.48-7.808-0.896-3.328-4.352-5.376-7.808-4.48zM207.232 644.224l-27.136 12.672c-3.2 1.536-4.608 5.248-3.072 8.448 1.536 3.2 5.248 4.608 8.448 3.072l27.136-12.672c3.2-1.536 4.608-5.248 3.072-8.448-1.408-3.2-5.248-4.48-8.448-3.072zM233.984 693.888l-24.448 17.152c-2.944 2.048-3.584 6.016-1.536 8.832 2.048 2.944 6.016 3.584 8.832 1.536l24.448-17.152c2.944-2.048 3.584-6.016 1.536-8.832-2.048-2.944-6.016-3.584-8.832-1.536zM310.912 775.552L293.76 800c-2.048 2.944-1.28 6.912 1.536 8.832 2.944 2.048 6.912 1.28 8.832-1.536l17.152-24.448c2.048-2.944 1.28-6.912-1.536-8.832-2.816-2.048-6.912-1.408-8.832 1.536zM349.184 840.704c3.2 1.536 7.04 0.128 8.448-3.072l12.672-27.136c1.536-3.2 0.128-7.04-3.072-8.448-3.2-1.536-7.04-0.128-8.448 3.072l-12.672 27.136c-1.408 3.2-0.128 6.912 3.072 8.448zM407.808 862.72c3.456 0.896 6.912-1.152 7.808-4.48l7.68-28.928c0.896-3.456-1.152-6.912-4.48-7.808-3.456-0.896-6.912 1.152-7.808 4.48l-7.68 28.928c-0.896 3.328 1.152 6.912 4.48 7.808zM469.376 874.112c3.456 0.256 6.656-2.304 6.912-5.76l2.56-29.824c0.256-3.456-2.304-6.656-5.76-6.912-3.456-0.256-6.656 2.304-6.912 5.76l-2.56 29.824c-0.256 3.584 2.304 6.656 5.76 6.912zM522.496 839.168l2.56 29.824c0.256 3.456 3.456 6.144 6.912 5.76 3.456-0.256 6.144-3.456 5.76-6.912l-2.56-29.824c-0.256-3.456-3.456-6.144-6.912-5.76-3.456 0.256-6.016 3.328-5.76 6.912zM578.176 830.976l7.68 28.928c0.896 3.456 4.352 5.376 7.808 4.48 3.456-0.896 5.376-4.352 4.48-7.808l-7.68-28.928c-0.896-3.456-4.352-5.376-7.808-4.48-3.328 0.896-5.376 4.48-4.48 7.808zM631.68 813.312l12.672 27.136c1.536 3.2 5.248 4.608 8.448 3.072 3.2-1.536 4.608-5.248 3.072-8.448l-12.672-27.136c-1.536-3.2-5.248-4.608-8.448-3.072-3.2 1.536-4.48 5.248-3.072 8.448zM681.344 786.688l17.152 24.448c2.048 2.944 6.016 3.584 8.832 1.536 2.944-2.048 3.584-6.016 1.536-8.832l-17.152-24.448c-2.048-2.944-6.016-3.584-8.832-1.536-2.944 1.92-3.584 5.888-1.536 8.832zM725.504 751.744l21.12 21.12c2.432 2.432 6.528 2.432 8.96 0 2.432-2.432 2.432-6.528 0-8.96l-21.12-21.12c-2.432-2.432-6.528-2.432-8.96 0-2.432 2.432-2.432 6.528 0 8.96zM763.008 709.76l24.448 17.152c2.944 2.048 6.912 1.28 8.832-1.536 2.048-2.944 1.28-6.912-1.536-8.832l-24.448-17.152c-2.944-2.048-6.912-1.28-8.832 1.536-2.048 2.816-1.408 6.784 1.536 8.832zM792.576 661.888l27.136 12.672c3.2 1.536 7.04 0.128 8.448-3.072 1.536-3.2 0.128-7.04-3.072-8.448l-27.136-12.672c-3.2-1.536-7.04-0.128-8.448 3.072-1.536 3.2-0.128 6.912 3.072 8.448zM813.44 609.536l28.928 7.68c3.456 0.896 6.912-1.152 7.808-4.48 0.896-3.456-1.152-6.912-4.48-7.808l-28.928-7.68c-3.456-0.896-6.912 1.152-7.808 4.48-0.896 3.456 1.024 6.912 4.48 7.808zM824.832 554.368l29.824 2.56c3.456 0.256 6.656-2.304 6.912-5.76 0.256-3.456-2.304-6.656-5.76-6.912l-29.824-2.56c-3.456-0.256-6.656 2.304-6.912 5.76-0.256 3.584 2.304 6.656 5.76 6.912zM826.624 498.176l29.824-2.56c3.456-0.256 6.144-3.456 5.76-6.912-0.256-3.456-3.456-6.144-6.912-5.76l-29.824 2.56c-3.456 0.256-6.144 3.456-5.76 6.912 0.256 3.456 3.328 6.016 6.912 5.76zM818.432 442.368l28.928-7.68c3.456-0.896 5.376-4.352 4.48-7.808-0.896-3.456-4.352-5.376-7.808-4.48l-28.928 7.68c-3.456 0.896-5.376 4.352-4.48 7.808 0.896 3.456 4.48 5.376 7.808 4.48zM800.768 388.992l27.136-12.672c3.2-1.536 4.608-5.248 3.072-8.448-1.536-3.2-5.248-4.608-8.448-3.072l-27.136 12.672c-3.2 1.536-4.608 5.248-3.072 8.448 1.536 3.072 5.248 4.48 8.448 3.072zM774.144 339.328l24.448-17.152c2.944-2.048 3.584-6.016 1.536-8.832-2.048-2.944-6.016-3.584-8.832-1.536L766.848 328.96c-2.944 2.048-3.584 6.016-1.536 8.832 1.92 2.816 5.888 3.584 8.832 1.536zM697.216 257.664l17.152-24.448c2.048-2.944 1.28-6.912-1.536-8.832-2.944-2.048-6.912-1.28-8.832 1.536l-17.152 24.448c-2.048 2.944-1.28 6.912 1.536 8.832 2.816 2.048 6.784 1.408 8.832-1.536zM658.944 192.512c-3.2-1.536-7.04-0.128-8.448 3.072l-12.672 27.136c-1.536 3.2-0.128 7.04 3.072 8.448 3.2 1.536 7.04 0.128 8.448-3.072l12.672-27.136c1.408-3.2 0-7.04-3.072-8.448zM600.192 170.496c-3.456-0.896-6.912 1.152-7.808 4.48l-7.68 28.928c-0.896 3.456 1.152 6.912 4.48 7.808 3.456 0.896 6.912-1.152 7.808-4.48l7.68-28.928c1.024-3.328-1.024-6.912-4.48-7.808zM534.912 201.6c3.456 0.256 6.656-2.304 6.912-5.76l2.56-29.824c0.256-3.456-2.304-6.656-5.76-6.912-3.456-0.256-6.656 2.304-6.912 5.76l-2.56 29.824c-0.256 3.456 2.304 6.528 5.76 6.912zM476.032 158.464c-3.456 0.256-6.144 3.456-5.76 6.912l2.56 29.824c0.256 3.456 3.456 6.144 6.912 5.76 3.456-0.256 6.144-3.456 5.76-6.912l-2.56-29.824c-0.256-3.456-3.328-6.016-6.912-5.76zM422.144 173.312c-0.896-3.456-4.352-5.376-7.808-4.48-3.456 0.896-5.376 4.352-4.48 7.808l7.68 28.928c0.896 3.456 4.352 5.376 7.808 4.48 3.456-0.896 5.376-4.352 4.48-7.808l-7.68-28.928zM376.448 219.776l-12.672-27.136c-1.536-3.2-5.248-4.608-8.448-3.072-3.2 1.536-4.608 5.248-3.072 8.448L364.8 225.28c1.536 3.2 5.248 4.608 8.448 3.072 3.2-1.536 4.608-5.376 3.2-8.576zM316.416 253.824c2.048 2.944 6.016 3.584 8.832 1.536 2.944-2.048 3.584-6.016 1.536-8.832l-17.152-24.448c-2.048-2.944-6.016-3.584-8.832-1.536-2.944 2.048-3.584 6.016-1.536 8.832l17.152 24.448z&quot; fill=&quot;#FFFFFF&quot; p-id=&quot;19071&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">link</span>(<span class="params">args</span>) &#123;</span><br><span class="line">    args = args.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>).<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">    <span class="comment">// 获取参数</span></span><br><span class="line">    <span class="keyword">let</span> url = (args[<span class="number">0</span>] || <span class="string">&#x27;&#x27;</span>).<span class="title function_">trim</span>(),</span><br><span class="line">        title = (args[<span class="number">1</span>] || <span class="string">&#x27;点击直达链接&#x27;</span>).<span class="title function_">trim</span>(),</span><br><span class="line">        favicon = (args[<span class="number">2</span>] ? <span class="string">`&lt;img src=&quot;<span class="subst">$&#123;args[<span class="number">2</span>]&#125;</span>&quot; class=&quot;no-lightbox&quot;&gt;`</span> : defaultIcon).<span class="title function_">trim</span>(),</span><br><span class="line">        desc = (args[<span class="number">3</span>] || <span class="string">&#x27;&#x27;</span>).<span class="title function_">trim</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;a href=&quot;<span class="subst">$&#123;url&#125;</span>&quot; <span class="subst">$&#123;url.includes(<span class="string">&#x27;http&#x27;</span>)?<span class="string">&#x27;target=&quot;_blank&quot;&#x27;</span>:<span class="string">&#x27;&#x27;</span>&#125;</span> title=&quot;<span class="subst">$&#123;title&#125;</span>&quot; referrerPolicy=&quot;no-referrer&quot; class=&quot;link_card&quot;&gt;&lt;div class=&quot;link_icon&quot;&gt;<span class="subst">$&#123;favicon&#125;</span>&lt;/div&gt;&lt;div class=&quot;link_content&quot;&gt;&lt;div class=&quot;link_title&quot;&gt;<span class="subst">$&#123;title&#125;</span>&lt;/div&gt;<span class="subst">$&#123;desc?<span class="string">`&lt;div class=&quot;link_desc&quot;&gt;<span class="subst">$&#123;desc&#125;</span>&lt;/div&gt;`</span>:<span class="string">&#x27;&#x27;</span>&#125;</span>&lt;/div&gt;&lt;/a&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&#x27;link&#x27;</span>, link, &#123; <span class="attr">ends</span>: <span class="literal">false</span> &#125;)</span><br></pre></td></tr></table></figure><ul><li>创建 <code>[blogRoot]/themes/butterfly/source/css/_tags/link.styl</code> 样式文件，并新增以下内容</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.link_card</span></span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line">  margin: <span class="number">10px</span> <span class="number">0</span></span><br><span class="line">  color: <span class="built_in">var</span>(--font-color) <span class="meta">!important</span></span><br><span class="line">  text-decoration: none <span class="meta">!important</span></span><br><span class="line">  background: <span class="built_in">var</span>(--icat-background)</span><br><span class="line">  border-radius: <span class="number">8px</span></span><br><span class="line">  border: <span class="built_in">var</span>(--style-border)</span><br><span class="line">  padding: <span class="number">12px</span></span><br><span class="line">  &amp;:hover</span><br><span class="line">    background: <span class="built_in">var</span>(--icat-theme)</span><br><span class="line">    color: white <span class="meta">!important</span></span><br><span class="line">  .link_icon,.link_content</span><br><span class="line">    height: <span class="number">4rem</span></span><br><span class="line">  .link_icon</span><br><span class="line">    img,svg</span><br><span class="line">      height: <span class="number">4rem</span></span><br><span class="line">      width: <span class="number">4rem</span></span><br><span class="line">      border-radius: <span class="number">6px</span> <span class="meta">!important</span></span><br><span class="line">  .link_content</span><br><span class="line">    margin-left: <span class="number">1rem</span></span><br><span class="line">    width: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">6rem</span>)</span><br><span class="line">    overflow: hidden</span><br><span class="line">    line-height: <span class="number">1.5</span></span><br><span class="line">    display: flex</span><br><span class="line">    flex-direction: column</span><br><span class="line">    justify-content: center</span><br><span class="line">    .link_title</span><br><span class="line">      font-weight: bold</span><br><span class="line">      font-size: <span class="number">1.2rem</span></span><br><span class="line">    .link_title,.link_desc</span><br><span class="line">      word-break: break-all</span><br><span class="line">      overflow:hidden</span><br><span class="line">      text-overflow: ellipsis</span><br><span class="line">    &amp;:<span class="built_in">not</span>(:<span class="built_in">has</span>(.link_desc)) .link_title</span><br><span class="line">      display:-webkit-box</span><br><span class="line">      -webkit-box-orient:vertical</span><br><span class="line">      -webkit-line-clamp:<span class="number">2</span></span><br><span class="line">    .link_desc</span><br><span class="line">      opacity: .<span class="number">6</span></span><br><span class="line">    .link_desc,&amp;:<span class="built_in">has</span>(.link_desc) .link_title</span><br><span class="line">      white-space: nowrap</span><br></pre></td></tr></table></figure><h3 id="使用参数">使用参数</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用html是为了高亮代码，不必在意 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 参数如下： --&gt;</span></span><br><span class="line">&#123;% link 链接,标题,图标,介绍 %&#125;</span><br><span class="line"><span class="comment">&lt;!-- 示例如下： --&gt;</span></span><br><span class="line">&#123;% link https://meuicat.com/,MeuiCat,https://meuicat.com/media/favicon.ico,有肉有猫有生活. %&#125;</span><br><span class="line"><span class="comment">&lt;!-- 你也可以什么都不填，将会全部使用默认值，如下： --&gt;</span></span><br><span class="line">&#123;% card %&#125;</span><br><span class="line"><span class="comment">&lt;!-- 你也可以省略部分内容，如下： --&gt;</span></span><br><span class="line">&#123;% link https://meuicat.com/ %&#125;</span><br><span class="line"><span class="comment">&lt;!-- 位置在后面的参数不填的话可以直接省略，但是如果中间的不想填必须留空，如下： --&gt;</span></span><br><span class="line">&#123;% link https://meuicat.com/,,,有肉有猫有生活. %&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从零开始butterfly博客的魔改教程(一)</title>
      <link href="/2024/10/25/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8Bbutterfly%E5%8D%9A%E5%AE%A2%E7%9A%84%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(%E4%B8%80)/"/>
      <url>/2024/10/25/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8Bbutterfly%E5%8D%9A%E5%AE%A2%E7%9A%84%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h1>前言</h1><p>这是一篇从零开始构建butterfly博客的教程，主要面向的完全不知道如何构建Hexo博客的小白，这篇教程会从构建hexo博客开始，初步目标是给Hexo安装上本次的主人公butterfly主题。</p><h1>Hexo的依赖要求</h1><ul><li><strong>Node.js</strong> (Node.js 版本需不低于 10.13，建议使用 Node.js 12.0 及以上版本)</li><li><strong>Git</strong></li></ul><h2 id="1-安装Git">1. 安装Git</h2><p>这里我们将介绍不同操作系统的安装方式。</p><ul><li>Windows: 去指定官网<a href="https://git-scm.com/downloads/win">Git官网</a>下载安装包安装。</li><li>Linux: 一般Linux系统都自带Git，如果没有，可以用包管理器安装。<ul><li>Ubuntu/Debian: <code>sudo apt-get install git</code></li><li>CentOS/Red Hat/Fedora: <code>sudo yum install git</code></li><li>Arch Linux: <code>sudo pacman -S git</code></li></ul></li><li>macOS: 去指定官网<a href="https://sourceforge.net/projects/git-osx-installer/">Git官网</a>下载安装包安装。</li></ul><h2 id="2-安装Node-js">2. 安装Node.js</h2><p>这里我们将介绍不同操作系统的安装方式。</p><ul><li>Windows: 去指定官网<a href="https://nodejs.org/en/download/">Node.js官网</a>下载安装包安装。</li><li>Linux: 一般Linux系统都自带Node.js，如果没有，可以用包管理器安装。<ul><li>Ubuntu/Debian: <code>sudo apt-get install nodejs</code></li><li>CentOS/Red Hat/Fedora: <code>sudo yum install nodejs</code></li><li>Arch Linux: <code>sudo pacman -S nodejs</code></li></ul></li><li>macOS: 去指定官网<a href="https://nodejs.org/en/download/">Node.js官网</a>下载安装包安装。</li></ul><h1>安装 Hexo</h1><p>所有必备的应用程序安装完成后，即可使用 npm 安装 Hexo。</p><h2 id="1-安装Hexo客户端">1. 安装Hexo客户端</h2><ul><li>Windows: 在命令提示符中运行 <code>npm install -g hexo-cli</code></li><li>Linux: 在终端中运行 <code>sudo npm install -g hexo-cli</code></li><li>macOS： 在终端中运行 <code>sudo -s npm install -g hexo-cli</code></li></ul><h2 id="2-执行Hexo命令">2. 执行Hexo命令</h2><ul><li>Linux以外执行<code>npx hexo &lt;command&gt;</code></li><li>Linux用户可以将 Hexo 所在的目录下的 node_modules 添加到环境变量之中即可直接使用<code>npx hexo &lt;command&gt;</code><br><code>echo 'PATH=&quot;$PATH:./node_modules/.bin&quot;' &gt;&gt; ~/.profile</code></li></ul><h2 id="3-安装-Hexo-完成后，需要再指定文件夹内新增文件，执行hexo-init命令，Hexo会在指定文件夹内生成所需文件。">3. 安装 Hexo 完成后，需要再指定文件夹内新增文件，执行<code>hexo init</code>命令，Hexo会在指定文件夹内生成所需文件。</h2><ol><li><code>$ hexo init &lt;folder&gt;</code></li><li><code>cd &lt;folder&gt;</code></li><li><code>npm install</code> macOS用户安装需要开启管理员，所以需要在终端中运行<code>sudo npm install</code></li></ol><p>初始化后，您的项目文件夹将如下所示：<br>.<br>├── _config.yml<br>├── package.json<br>├── scaffolds<br>├── source<br>|   ├── _drafts<br>|   └── _posts<br>└── themes</p><h2 id="4-执行Hexo三板斧">4. 执行Hexo三板斧</h2><ol><li><code>hexo cl</code><br>在终端中运行<code>hexo cl</code>命令，确认刺青。(<code>hexo cl</code>是<code>hexo clean</code>的简写)</li><li><code>hexo g</code><br>在终端中运行<code>hexo g</code>命令，生成静态文件。(<code>hexo g</code>是<code>hexo generate</code>的简写)</li><li><code>hexo s</code><br>在终端中运行<code>hexo s</code>命令，启动本地服务器。(<code>hexo s</code>是<code>hexo server</code>的简写)</li></ol><p>在<a href="http://localhost:4000/">本地端口</a>确认Hexo博客是否正常运行。</p><p>若成功运行则会显示成下图这样:</p><p><img src="https://i.imgur.com/C80Biuy.png" alt="hexo成功运行"></p><p>接下来，我们可以开始安装butterfly主题了。</p><h1>安装butterfly主题</h1><h2 id="1-通过Git获取源代码">1. 通过Git获取源代码</h2><p>Stable branch [recommend]:<br><code>git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</code></p><p>Dev branch:<br><code>git clone -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</code></p><h2 id="2-NPM安装Butterfly主题">2. NPM安装Butterfly主题</h2><p>在终端中运行<code>npm install hexo-theme-butterfly --save</code>命令，安装Butterfly主题。<br>（macOS用户需要开启管理员，所以需要在终端中运行<code>sudo npm install hexo-theme-butterfly --save</code>）</p><h2 id="3-修改Hexo配置文件">3. 修改Hexo配置文件</h2><p>打开Hexo配置文件<code>_config.yml</code>，找到<code>theme</code>项，将<code>theme</code>的值修改为<code>butterfly</code>。</p><p>如果你没有pug和stylus renderer，请在终端中运行以下代码:<br><code>npm install hexo-renderer-pug hexo-renderer-stylus --save</code>命令安装。<br>(macOS用户需要开启管理员，所以需要在终端中运行<code>sudo npm install hexo-renderer-pug hexo-renderer-stylus --save</code>)</p><h2 id="4-启用Butterfly主题">4. 启用Butterfly主题</h2><p>执行hexo三板斧命令，确认无误后，在浏览器中访问<a href="http://localhost:4000/">本地端口</a>，即可看到Butterfly主题的博客页面。</p><p>如果成功安装，你将看到如下画面:</p><p><img src="https://i.imgur.com/U2HhcyD.png" alt="butterfly安装成功"></p><h1>总结</h1><p>以上就是butterfly主题的傻瓜式安装教程，如果你遇到了问题，欢迎在评论区留言，希望能帮助到大家。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown从小白到精通</title>
      <link href="/2024/10/25/Markdown%E4%BB%8E%E5%B0%8F%E7%99%BD%E5%88%B0%E7%B2%BE%E9%80%9A/"/>
      <url>/2024/10/25/Markdown%E4%BB%8E%E5%B0%8F%E7%99%BD%E5%88%B0%E7%B2%BE%E9%80%9A/</url>
      
        <content type="html"><![CDATA[<h1><strong>前言</strong></h1><p>相信很多人在看技术博客，做笔记时都经常接触Typora呀熊掌记等一系列笔记软件，这些软件都有着很强大的Markdown语法支持，让我们可以快速、轻松地进行排版。由于Hexo等静态博客主要通过对Markdown文件进行解析来渲染出很多让人眼前一亮的画面效果，所以我觉得在正式开始博客搭建之前，有必要让大家对Markdown语法有一个基本的了解。本文将介绍一些常用的Markdown语法，希望能帮助大家快速上手。废话不多说啦，开始干活！</p><h1><strong>基本语法</strong></h1><table><thead><tr><th>元素</th><th>Markdown 语法</th></tr></thead><tbody><tr><td>标题（Heading）</td><td><code># H1</code><br><code>## H2</code><br><code>### H3</code></td></tr><tr><td>粗体（Bold）</td><td><code>**bold text**</code></td></tr><tr><td>斜体（Italic）</td><td><code>*italicized text*</code></td></tr><tr><td>引用块（Blockquote）</td><td><code>&gt; blockquote</code></td></tr><tr><td>有序列表（Ordered List）</td><td><code>1. First item</code><br><code>2. Second item</code><br><code>3. Third item</code></td></tr><tr><td>无序列表（Unordered List）</td><td><code>- First item</code><br><code>- Second item</code><br><code>- Third item</code></td></tr><tr><td>代码（Code）</td><td><code>code</code></td></tr><tr><td>分隔线（Horizontal Rule）</td><td><code>---</code></td></tr><tr><td>链接（Link）</td><td><code>[title](https://www.example.com)</code></td></tr><tr><td>图片（Image)</td><td><code>![alt text](image.jpg)</code></td></tr></tbody></table><h1><strong>扩展语法</strong></h1><table><thead><tr><th>元素</th><th>Markdown 语法</th></tr></thead><tbody><tr><td>表格（Table）</td><td>| Syntax      | Description |<br>| ----------- | ----------- |<br>| Header      | Title       |<br>| Paragraph   | Tex.      |</td></tr><tr><td>代码块（Fenced Code Block）</td><td><code>&lt;br&gt;&#123;&lt;br&gt;  &quot;firstName&quot;: &quot;John&quot;,&lt;br&gt;  &quot;lastName&quot;: &quot;Smith&quot;,&lt;br&gt;  &quot;age&quot;: 25&lt;br&gt;&#125;&lt;br&gt;</code></td></tr><tr><td>脚注（Footnote）</td><td><code>Here's a sentence with a footnote. [^1]</code><br><code>[^1]: This is the footnote.</code></td></tr><tr><td>标题编号（Heading ID）</td><td><code>### My Great Heading &#123;#custom-id&#125;</code></td></tr><tr><td>定义列表（Definition List）</td><td><code>term</code><br><code>: definition</code></td></tr><tr><td>删除线（Strikethrough）</td><td><code>~~The world is flat.~~</code></td></tr><tr><td>任务列表（Task List）</td><td><code>- [x] Write the press release</code><br><code>- [ ] Update the website</code><br><code>- [ ] Contact the media</code></td></tr></tbody></table><!-- # 目录- [标题语法](#标题语法)- [段落语法](#段落语法)- [换行语法](#换行语法)- [强调语法](#强调语法)- [引用语法](#引用语法)- [列表语法](#列表语法)- [代码语法](#代码语法)- [分隔线语法](#分隔线语法)- [链接语法](#链接语法)- [图片语法](#图片语法)- [转义字符语法](#转义字符语法)- [内嵌HTML语法](#内嵌HTML语法)# 语法详解## 标题语法要创建标题，请在单词或短语前面添加井号 (`#`)。`#`的数量代表了标题的级别。例如，添加三个`#`表示创建一个三级标题(`<h3>`)(例如：`### My Header`)。| Markdown语法            | HTML                       |     |------------------------|----------------------------||`# Heading level 1`     |`<h1>Heading level 1</h1>`  | |`## Heading level 2`    | `<h2>Heading level 2</h2>` | |`### Heading level 3`   | `<h3>Heading level 3</h3>` | |`#### Heading level 4`  | `<h4>Heading level 4</h4>` | |`##### Heading level 5` | `<h5>Heading level 5</h5>` | |`###### Heading level 6`| `<h6>Heading level 6</h6>` | ## 段落语法要创建段落，请使用空白行将一行或多行文本进行分隔。| Markdown语法            | HTML                       ||------------------------|----------------------------||`I really like using Markdown.`<br><br>`I think I'll use it to format all of my documents from now on.` | `<p>I really like using Markdown.</p>`<br><br>`<p>I think I'll use it to format all of my documents from now on.</p>` |## 换行语法在一行的末尾添加两个或多个空格，然后按回车键,即可创建一个换行(`<br>`)。| Markdown语法 |HTML ||--------------|------||`This is the first line.`<br>`And this is the second line.`|`<p>This is the first line. <br>`<br>`And this is the second line.</p>`|## 强调语法通过将文本设置为粗体或斜体来强调其重要性。1. 粗体（Bold）要加粗文本，请在单词或短语的前后各添加两个星号（asterisks）或下划线（underscores）。如需加粗一个单词或短语的中间部分用以表示强调的话，请在要加粗部分的两侧各添加两个星号（asterisks）。| Markdown语法 |HTML ||--------------|------||`I really **love** writing in Markdown.`|`<p>I really <strong>love</strong> writing in Markdown.</p>`||`I really __love__ writing in Markdown.`|`<p>I really <strong>love</strong> writing in Markdown.</p>`||`I really **love** writing in __Markdown__`|`<p>I really <strong>love</strong> writing in <strong>Markdown</strong></p>`|2. 斜体（Italic）要用斜体显示文本，请在单词或短语前后添加一个星号（asterisk）或下划线（underscore）。要斜体突出单词的中间部分，请在字母前后各添加一个星号，中间不要带空格。| Markdown语法 |HTML ||--------------|------||`IItalicized text is the *cat's meow*.`|`Italicized text is the <em>cat's meow</em>.`||`Italicized text is the _cat's meow_.`|`Italicized text is the <em>cat's meow</em>.`||`A*cat*meow`|`A<em>cat</em>meow`|`Acatmeow`|3. 粗体（Bold）和斜体（Italic）要同时使用粗体和斜体，请在要加粗的单词或短语前后各添加三个星号（asterisks）或下划线（underscores）。要加粗并用斜体显示单词或短语的中间部分，请在要突出显示的部分前后各添加三个星号，中间不要带空格。| Markdown语法 |HTML ||--------------|------||`This text is ***really important***.`|`This text is <strong><em>really important</em></strong>.`||`This text is ___really important___.`  |`This text is <strong><em>really important</em></strong>.`||`This text is **_really_** important.`|`This text is <strong><em>really</em> important</strong>.`||`This text is __*really important*__.`  |`This text is <strong><em>really important</em></strong>.`|## 引用语法要创建块引用，请在段落前添加一个 `>` 符号。`>  Dorothy followed her through many of the beautiful rooms in her castle.`渲染效果如下所示：> Dorothy followed her through many of the beautiful rooms in her castle.1. 多个段落的块引用块引用可以包含多个段落。为段落之间的空白行添加一个 `>` 符号。`> Dorothy followed her through many of the beautiful rooms in her castle.``>``> The Witch bade her clean the pots and kettles and sweep the floor and keep the fire fed with wood.`渲染效果如下：> Dorothy followed her through many of the beautiful rooms in her castle.> > The Witch bade her clean the pots and kettles and sweep the floor and keep the fire fed with wood.2. 嵌套块引用块引用可以嵌套。在要嵌套的段落前添加一个 `>>` 符号。`> Dorothy followed her through many of the beautiful rooms in her castle.``>``>> The Witch bade her clean the pots and kettles and sweep the floor and keep the fire fed with wood.`渲染效果如下：> Dorothy followed her through many of the beautiful rooms in her castle.>> The Witch bade her clean the pots and kettles and sweep the floor and keep the fire fed with wood.3. 带有其它元素的块引用块引用可以包含其他 Markdown 格式的元素。并非所有元素都可以使用，你需要进行实验以查看哪些元素有效。`> #### The quarterly results look great!``>``> - Revenue was off the chart.``> - Profits were higher than ever.``>``>> *Everything* is going according to **plan**.`渲染效果如下：> #### The quarterly results look great!> > - Revenue was off the chart.> - Profits were higher than ever.> >> *Everything* is going according to **plan**.## 列表语法可以将多个条目组织成有序或无序列表。1. 有序列表要创建有序列表，请在每个列表项前添加数字并紧跟一个英文句点。数字不必按数学顺序排列，但是列表应当以数字 1 起始。要创建有序列表，请在每个列表项前添加数字并紧跟一个英文句点。数字不必按数学顺序排列，但是列表应当以数字 1 起始。| Markdown语法 |HTML ||--------------|------||`1. First item`<br>`2. Second item`<br>`3. Third item`|`<ol>`<br>`<li>First item</li>`<br>`<li>Second item</li>`<br>`<li>Third item</li>`<br>`</ol>`|2. 无序列表要创建无序列表，请在每个列表项前面添加破折号 (-)、星号 (*) 或加号 (+) 。缩进一个或多个列表项可创建嵌套列表。| Markdown语法 |HTML ||--------------|------||`- First item`<br>`- Second item`<br>`- Third item`|`<ul>`<br>`<li>First item</li>`<br>`<li>Second item</li>`<br>`<li>Third item</li>`<br>`</ul>`||`* First item`<br>`* Second item`<br>`* Third item`|`<ul>`<br>`<li>First item</li>`<br>`<li>Second item</li>`<br>`<li>Third item</li>`<br>`</ul>`||`+ First item`<br>`+ Second item`<br>`+ Third item`|`<ul>`<br>`<li>First item</li>`<br>`<li>Second item</li>`<br>`<li>Third item</li>`<br>`</ul>`|3. 在列表中嵌套其他元素要在保留列表连续性的同时在列表中添加另一种元素，请将该元素缩进四个空格或一个制表符，如下例所示：  ### 段落  `*   This is the first list item.`  `*   Here's the second list item.`  `    I need to add another paragraph below the second list item.`  `*   And here's the third list item.`  渲染效果如下：  *   This is the first list item.  *   Here's the second list item.      I need to add another paragraph below the second list item.  *   And here's the third list item.  ### 引用块  `*   This is the first list item.`  `*   Here's the second list item.`  `    > A blockquote would look great below the second list item.`  `*   And here's the third list item.`  渲染效果如下：  *   This is the first list item.  *   Here's the second list item.      > A blockquote would look great below the second list item.  *   And here's the third list item.  ### 代码块  `*   Open the file.`  `*   Find the following code block on line 21:`          `&lt;html>`          `&lt;head>`            `&lt;title>Test&lt;/title>`          `&lt;/head>`  `*   Update the title to match the name of your website.`  渲染效果如下：  *   Open the file.  *   Find the following code block on line 21:          &lt;html>          &lt;head>            &lt;title>Test&lt;/title>          &lt;/head>  *   Update the title to match the name of your website.  ### 图片  `*   Open the file containing the Linux mascot.`  `*   Marvel at its beauty.`      `![Tux, the Linux mascot](/assets/images/tux.png)`  `*   Close the file.`  渲染效果如下：  *   Open the file containing the Linux mascot.  *   Marvel at its beauty.      ![Tux, the Linux mascot](/assets/images/tux.png)  *   Close the file.  ### 列表  `*   First item`  `*   Second item`      `- Indented item`      `- Indented item`  `*   Third item`  渲染效果如下：  *   First item  *   Second item      - Indented item      - Indented item  *   Third item -->]]></content>
      
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(8)-藏宝阁页面</title>
      <link href="/2024/10/21/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(8)-%E8%97%8F%E5%AE%9D%E9%98%81%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/10/21/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(8)-%E8%97%8F%E5%AE%9D%E9%98%81%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有藏宝阁页面功能，但有时我们希望展示个人收藏的番剧、小说、电影、漫画等内容。本文将详细介绍如何从blog-solitude项目完整移植藏宝阁页面功能到solitude-latest，包括页面配置、模板创建、数据管理和样式设计的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认没有藏宝阁页面</li><li>缺少收藏展示和分类功能</li><li>无法展示个人收藏的番剧、小说、电影等</li><li>缺少收藏数据管理机制</li></ul><h3 id="期望效果">期望效果</h3><ul><li>独立的藏宝阁页面（<code>/collects/</code>）</li><li>支持收藏分类展示（番剧、小说、电影、漫画等）</li><li>每个收藏包含封面、名称、评分、标签、描述</li><li>支持豆瓣链接跳转</li><li>响应式设计，适配不同屏幕尺寸</li><li>视频Banner支持</li><li>悬停效果和动画</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>页面类型缺失</strong><br>solitude-latest主题缺少collects页面类型的支持</p></li><li><p><strong>模板文件缺失</strong><br>缺少collects页面的模板文件和内容组件</p></li><li><p><strong>数据管理缺失</strong><br>缺少收藏数据的配置和管理机制</p></li><li><p><strong>样式文件缺失</strong><br>缺少collects页面的CSS样式文件</p></li><li><p><strong>路由配置缺失</strong><br>页面路由中缺少collects类型的处理</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/source/collects/index.md</code></li><li><code>solitude-latest/source/_data/collects.yml</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/collects.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/collects.styl</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code></li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建藏宝阁页面配置">1. 创建藏宝阁页面配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/collects/index.md</code></p><p><strong>文件内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">藏宝阁</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2025-01-01 14:00:00</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">collects</span></span><br><span class="line"><span class="attr">data:</span> <span class="string">collects</span></span><br><span class="line"><span class="attr">banner:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/collects-banner.mp4</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">这里收集了一些我喜欢的东西</span></span><br><span class="line"><span class="attr">leftend:</span> <span class="string">看看</span> <span class="string">Ryan</span> <span class="string">都收集些什么奇奇怪怪的东西吧！</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p><strong>配置说明：</strong></p><ul><li><code>type: collects</code> - 页面类型为collects</li><li><code>data: collects</code> - 数据源为collects.yml</li><li><code>banner: true</code> - 启用banner显示</li><li><code>cover: /mp4/collects-banner.mp4</code> - 设置banner视频</li><li><code>desc</code> - banner描述文字</li><li><code>leftend</code> - banner左侧信息</li></ul><hr><h3 id="2-创建收藏数据配置文件">2. 创建收藏数据配置文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/_data/collects.yml</code></p><p><strong>文件结构：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">📺</span> <span class="string">番剧</span></span><br><span class="line">  <span class="attr">item_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">间谍过家家</span> <span class="string">第一季</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">https://i.imgur.com/XUirRGd.png/cover</span></span><br><span class="line">      <span class="attr">rating:</span> <span class="number">8.9</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">fab</span> <span class="string">fa-bilibili</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">番剧</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2022</span><span class="string">/04/09</span></span><br><span class="line">      <span class="attr">tags:</span> [<span class="string">&quot;治愈&quot;</span>, <span class="string">&quot;可爱&quot;</span>]</span><br><span class="line">      <span class="attr">tag_colors:</span> [<span class="string">&quot;#007BFF&quot;</span>, <span class="string">&quot;#FF5733&quot;</span>]</span><br><span class="line">      <span class="attr">description:</span> <span class="string">为了潜入名校,西国能力最强的间谍&quot;黄昏&quot;被下令组建家庭...</span></span><br><span class="line">      <span class="attr">douban_link:</span> <span class="string">&quot;https://movie.douban.com/subject/35258427/&quot;</span></span><br></pre></td></tr></table></figure><p><strong>数据结构说明：</strong></p><ul><li><code>class_name</code> - 分类名称（支持emoji）</li><li><code>item_list</code> - 该分类下的收藏列表</li><li><code>name</code> - 收藏名称</li><li><code>image</code> - 封面图片链接</li><li><code>rating</code> - 评分（0-10分）</li><li><code>icon</code> - Font Awesome图标类名</li><li><code>type</code> - 收藏类型</li><li><code>date</code> - 创建日期</li><li><code>tags</code> - 标签数组</li><li><code>tag_colors</code> - 标签颜色数组</li><li><code>description</code> - 详细描述</li><li><code>douban_link</code> - 豆瓣链接</li></ul><p><strong>注意事项：</strong></p><ul><li>日期格式建议使用 <code>YYYY/MM/DD</code> 或 <code>YYYY-MM-DD</code></li><li>图片链接建议使用HTTPS</li><li>标签和颜色数组需要一一对应</li><li>描述文字避免过长，建议控制在合理长度</li></ul><hr><h3 id="3-修改页面路由配置">3. 修改页面路由配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></p><p><strong>修改内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">when &#x27;game&#x27;</span><br><span class="line">    include includes/page/game</span><br><span class="line">when &#x27;collects&#x27;</span><br><span class="line">    include includes/page/collects</span><br><span class="line">when &#x27;message&#x27;</span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>在页面路由中添加collects类型的处理，确保访问 <code>/collects/</code> 时能正确渲染collects页面。</p><hr><h3 id="4-创建藏宝阁页面模板">4. 创建藏宝阁页面模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/collects.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">- var $data = page.data</span><br><span class="line">if page.banner</span><br><span class="line">    include ../widgets/page/banner</span><br><span class="line">.collects.article-container</span><br><span class="line">    if site.data[$data]</span><br><span class="line">        each collect in site.data[$data]</span><br><span class="line">            .collect-section</span><br><span class="line">                h2.collect-title= collect.class_name</span><br><span class="line">                .collects</span><br><span class="line">                    each item in (collect.item_list || [])</span><br><span class="line">                        .collect_box(style=`background-image: url($&#123;item.image&#125;);`)</span><br><span class="line">                            .collect_top</span><br><span class="line">                                div.collect_icon</span><br><span class="line">                                    i(class=item.icon)</span><br><span class="line">                                div.collect_category= item.type</span><br><span class="line">                            .collect_bottom</span><br><span class="line">                                div.collect_name= item.name</span><br><span class="line">                                if typeof item.date === &#x27;string&#x27; &amp;&amp; item.date.includes(&#x27;/&#x27;)</span><br><span class="line">                                    div.collect_date 创建日期: #&#123;item.date.split(&#x27; &#x27;)[0]&#125;</span><br><span class="line">                                else</span><br><span class="line">                                    div.collect_date 创建日期: 未知</span><br><span class="line">                                div.collect_rating</span><br><span class="line">                                    each i in Array(Math.floor(item.rating / 2))</span><br><span class="line">                                        i.fa-solid.fa-star</span><br><span class="line">                                    if (item.rating % 2) &gt;= 1</span><br><span class="line">                                        i.fa-solid.fa-star-half</span><br><span class="line">                                    each i in Array(5 - Math.ceil(item.rating / 2))</span><br><span class="line">                                        i.fa-regular.fa-star</span><br><span class="line">                                    span.collect_score= item.rating</span><br><span class="line">                                div.collect_tags</span><br><span class="line">                                    each tag, index in (item.tags || [])</span><br><span class="line">                                        span.collect_tag(style=`background-color: $&#123;item.tag_colors[index] || &#x27;#007BFF&#x27;&#125;;`)= tag</span><br><span class="line">                                if item.description</span><br><span class="line">                                    p.collect_description #&#123;item.description&#125;</span><br><span class="line">                                div.collect_douban</span><br><span class="line">                                    a(href=item.douban_link target=&quot;_blank&quot; title=&quot;豆瓣链接&quot;)</span><br><span class="line">                                        div.douban-icon</span><br><span class="line">    != page.content</span><br></pre></td></tr></table></figure><p><strong>模板逻辑说明：</strong></p><ul><li>动态加载数据：<code>site.data[$data]</code> 根据页面配置的data字段加载对应数据</li><li>条件渲染banner：根据 <code>page.banner</code> 决定是否显示banner</li><li>分类展示：遍历每个分类（<code>collect</code>）和其下的收藏项（<code>item</code>）</li><li>评分显示：使用Font Awesome星星图标显示评分</li><li>标签展示：动态设置标签颜色</li><li>豆瓣链接：提供跳转到豆瓣的链接</li></ul><hr><h3 id="5-创建藏宝阁样式文件">5. 创建藏宝阁样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/collects.styl</code></p><p><strong>文件内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.collects</span></span><br><span class="line">  <span class="attribute">display</span>: grid</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="built_in">minmax</span>(<span class="number">300px</span>, <span class="number">1</span>fr))</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.collect-section</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">40px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.collect-title</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">1.5em</span></span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">20px</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--font-color)</span><br><span class="line">      <span class="attribute">border-bottom</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--theme-color)</span><br><span class="line">      <span class="attribute">padding-bottom</span>: <span class="number">10px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.collects</span></span><br><span class="line">      <span class="attribute">display</span>: grid</span><br><span class="line">      <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="built_in">minmax</span>(<span class="number">280px</span>, <span class="number">1</span>fr))</span><br><span class="line">      <span class="attribute">gap</span>: <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.collect_box</span></span><br><span class="line">        <span class="attribute">position</span>: relative</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">400px</span></span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">15px</span></span><br><span class="line">        <span class="attribute">overflow</span>: hidden</span><br><span class="line">        <span class="attribute">background-size</span>: cover</span><br><span class="line">        <span class="attribute">background-position</span>: center</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease</span><br><span class="line">        <span class="attribute">cursor</span>: pointer</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">5px</span>)</span><br><span class="line">          <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.collect_top</span></span><br><span class="line">          <span class="attribute">position</span>: absolute</span><br><span class="line">          <span class="attribute">top</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">15px</span></span><br><span class="line">          <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">180deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8</span>) <span class="number">0%</span>, transparent <span class="number">100%</span>)</span><br><span class="line">          <span class="attribute">display</span>: flex</span><br><span class="line">          <span class="attribute">justify-content</span>: space-between</span><br><span class="line">          <span class="attribute">align-items</span>: center</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_icon</span></span><br><span class="line">            <span class="selector-tag">i</span></span><br><span class="line">              <span class="attribute">font-size</span>: <span class="number">1.2em</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_category</span></span><br><span class="line">            <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">0.9em</span></span><br><span class="line">            <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">            <span class="attribute">padding</span>: <span class="number">4px</span> <span class="number">8px</span></span><br><span class="line">            <span class="attribute">border-radius</span>: <span class="number">4px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.collect_bottom</span></span><br><span class="line">          <span class="attribute">position</span>: absolute</span><br><span class="line">          <span class="attribute">bottom</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">20px</span></span><br><span class="line">          <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.9</span>) <span class="number">0%</span>, transparent <span class="number">100%</span>)</span><br><span class="line">          <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_name</span></span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">1.2em</span></span><br><span class="line">            <span class="attribute">font-weight</span>: bold</span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span></span><br><span class="line">            <span class="attribute">line-height</span>: <span class="number">1.3</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_date</span></span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">0.8em</span></span><br><span class="line">            <span class="attribute">opacity</span>: <span class="number">0.8</span></span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_rating</span></span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span></span><br><span class="line"></span><br><span class="line">            <span class="selector-tag">i</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="number">#FFD700</span></span><br><span class="line">              <span class="attribute">margin-right</span>: <span class="number">2px</span></span><br><span class="line"></span><br><span class="line">            <span class="selector-class">.collect_score</span></span><br><span class="line">              <span class="attribute">margin-left</span>: <span class="number">5px</span></span><br><span class="line">              <span class="attribute">font-weight</span>: bold</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_tags</span></span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span></span><br><span class="line"></span><br><span class="line">            <span class="selector-class">.collect_tag</span></span><br><span class="line">              <span class="attribute">display</span>: inline-block</span><br><span class="line">              <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">8px</span></span><br><span class="line">              <span class="attribute">margin-right</span>: <span class="number">5px</span></span><br><span class="line">              <span class="attribute">margin-bottom</span>: <span class="number">5px</span></span><br><span class="line">              <span class="attribute">border-radius</span>: <span class="number">12px</span></span><br><span class="line">              <span class="attribute">font-size</span>: <span class="number">0.8em</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_description</span></span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">0.9em</span></span><br><span class="line">            <span class="attribute">line-height</span>: <span class="number">1.4</span></span><br><span class="line">            <span class="attribute">opacity</span>: <span class="number">0.9</span></span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span></span><br><span class="line">            <span class="attribute">display</span>: -webkit-box</span><br><span class="line">            -webkit-line-clamp: <span class="number">3</span></span><br><span class="line">            -webkit-<span class="attribute">box-orient</span>: vertical</span><br><span class="line">            <span class="attribute">overflow</span>: hidden</span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.collect_douban</span></span><br><span class="line">            <span class="attribute">text-align</span>: right</span><br><span class="line"></span><br><span class="line">            <span class="selector-tag">a</span></span><br><span class="line">              <span class="attribute">display</span>: inline-block</span><br><span class="line">              <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span></span><br><span class="line">              <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>)</span><br><span class="line">              <span class="attribute">border-radius</span>: <span class="number">4px</span></span><br><span class="line">              <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line">              <span class="attribute">text-decoration</span>: none</span><br><span class="line">              <span class="attribute">font-size</span>: <span class="number">0.8em</span></span><br><span class="line">              <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease</span><br><span class="line"></span><br><span class="line">              <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">                <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line">              <span class="selector-class">.douban-icon</span></span><br><span class="line">                <span class="attribute">width</span>: <span class="number">16px</span></span><br><span class="line">                <span class="attribute">height</span>: <span class="number">16px</span></span><br><span class="line">                <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&#x27;data:image/svg+xml,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;white&quot;&gt;&lt;path d=&quot;M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z&quot;/&gt;&lt;/svg&gt;&#x27;</span>) no-repeat center</span><br><span class="line">                <span class="attribute">background-size</span>: contain</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应式设计</span></span><br><span class="line"><span class="function"><span class="title">maxWidth768</span><span class="params">()</span></span></span><br><span class="line">  <span class="selector-class">.collects</span></span><br><span class="line">    <span class="selector-class">.collects</span></span><br><span class="line">      <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="built_in">minmax</span>(<span class="number">250px</span>, <span class="number">1</span>fr))</span><br><span class="line">      <span class="attribute">gap</span>: <span class="number">15px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.collect_box</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">350px</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.collect_bottom</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">15px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.collect_name</span></span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">1.1em</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.collect_description</span></span><br><span class="line">          -webkit-line-clamp: <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">maxWidth480</span><span class="params">()</span></span></span><br><span class="line">  <span class="selector-class">.collects</span></span><br><span class="line">    <span class="selector-class">.collects</span></span><br><span class="line">      <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr</span><br><span class="line">      <span class="attribute">gap</span>: <span class="number">15px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.collect_box</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">320px</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.collect_bottom</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">12px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.collect_name</span></span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">1em</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.collect_description</span></span><br><span class="line">          -webkit-line-clamp: <span class="number">2</span></span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">0.8em</span></span><br></pre></td></tr></table></figure><p><strong>样式特点：</strong></p><ul><li>网格布局：使用CSS Grid实现响应式布局</li><li>卡片设计：每个收藏项以卡片形式展示</li><li>悬停效果：鼠标悬停时有上移和阴影效果</li><li>渐变背景：顶部和底部使用渐变背景确保文字可读性</li><li>评分显示：使用星星图标显示评分</li><li>标签系统：彩色标签展示分类信息</li><li>响应式：适配不同屏幕尺寸</li></ul><hr><h3 id="6-导入样式文件">6. 导入样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code></p><p><strong>修改内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/game.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/collects.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_mode/*&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>在主题的样式入口文件中导入collects样式，确保样式生效。</p><hr><h2 id="功能特性">功能特性</h2><h3 id="1-数据管理">1. 数据管理</h3><ul><li>支持YAML格式的数据文件</li><li>分类管理：番剧、小说、电影、漫画等</li><li>详细信息：封面、评分、标签、描述、豆瓣链接</li></ul><h3 id="2-展示效果">2. 展示效果</h3><ul><li>卡片式布局，美观大方</li><li>悬停动画效果</li><li>评分星级显示</li><li>彩色标签系统</li><li>响应式设计</li></ul><h3 id="3-交互功能">3. 交互功能</h3><ul><li>豆瓣链接跳转</li><li>分类筛选展示</li><li>移动端适配</li></ul><h3 id="4-扩展性">4. 扩展性</h3><ul><li>易于添加新的收藏分类</li><li>支持自定义标签和颜色</li><li>灵活的数据结构</li></ul><hr><h2 id="使用说明">使用说明</h2><h3 id="1-添加新收藏">1. 添加新收藏</h3><p>在 <code>source/_data/collects.yml</code> 文件中添加新的收藏项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">新收藏名称</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">封面图片链接</span></span><br><span class="line">  <span class="attr">rating:</span> <span class="string">评分</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">图标类名</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">类型</span></span><br><span class="line">  <span class="attr">date:</span> <span class="string">日期</span></span><br><span class="line">  <span class="attr">tags:</span> [<span class="string">&quot;标签1&quot;</span>, <span class="string">&quot;标签2&quot;</span>]</span><br><span class="line">  <span class="attr">tag_colors:</span> [<span class="string">&quot;#颜色1&quot;</span>, <span class="string">&quot;#颜色2&quot;</span>]</span><br><span class="line">  <span class="attr">description:</span> <span class="string">描述文字</span></span><br><span class="line">  <span class="attr">douban_link:</span> <span class="string">&quot;豆瓣链接&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2-添加新分类">2. 添加新分类</h3><p>在数据文件中添加新的分类：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">🎵</span> <span class="string">音乐</span></span><br><span class="line">  <span class="attr">item_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">音乐收藏项</span></span><br><span class="line">      <span class="comment"># ... 其他属性</span></span><br></pre></td></tr></table></figure><h3 id="3-自定义样式">3. 自定义样式</h3><p>可以修改 <code>_page/collects.styl</code> 文件来自定义样式效果。</p><hr><h2 id="注意事项">注意事项</h2><ol><li><strong>YAML格式</strong>：确保数据文件的YAML格式正确，避免缩进错误</li><li><strong>图片链接</strong>：建议使用HTTPS链接，确保图片能正常显示</li><li><strong>日期格式</strong>：建议使用标准日期格式，避免解析错误</li><li><strong>标签颜色</strong>：确保标签数组和颜色数组长度一致</li><li><strong>描述长度</strong>：建议控制描述文字长度，避免影响布局</li></ol><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们成功为Solitude主题添加了完整的藏宝阁功能。这个功能不仅提供了美观的收藏展示界面，还具有良好的扩展性和维护性。用户可以根据自己的需求轻松添加和管理收藏内容，展示个人的兴趣爱好和品味。</p><p>藏宝阁功能的实现体现了Hexo主题开发的核心思想：通过数据驱动的方式实现内容的动态展示，通过模板化的方式实现界面的统一管理，通过样式化的方式实现视觉效果的精美呈现。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 藏宝阁 </tag>
            
            <tag> 收藏展示 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(7)-电玩屋页面</title>
      <link href="/2024/10/14/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(7)-%E7%94%B5%E7%8E%A9%E5%B1%8B%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/10/14/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(7)-%E7%94%B5%E7%8E%A9%E5%B1%8B%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认没有电玩屋页面功能，但有时我们希望展示游戏评测和推荐。本文将详细介绍如何从blog-solitude项目完整移植电玩屋页面功能到solitude-latest，包括页面配置、模板创建、数据管理和样式设计的完整实现方案。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认没有电玩屋页面</li><li>缺少游戏展示和分类功能</li><li>无法展示游戏评测和推荐</li><li>缺少游戏数据管理机制</li></ul><h3 id="期望效果">期望效果</h3><ul><li>独立的电玩屋页面（<code>/game/</code>）</li><li>支持游戏分类展示（MMORPG/MOBA、单机游戏等）</li><li>每个游戏包含封面、名称、规格、描述</li><li>支持外部链接跳转和评论功能</li><li>响应式设计，适配不同屏幕尺寸</li><li>视频Banner支持</li><li>悬停效果和交互功能</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>页面类型缺失</strong><br>solitude-latest主题缺少game页面类型的支持</p></li><li><p><strong>模板文件缺失</strong><br>缺少game页面的模板文件和内容组件</p></li><li><p><strong>数据管理缺失</strong><br>缺少游戏数据的配置和管理机制</p></li><li><p><strong>样式文件缺失</strong><br>缺少game页面的CSS样式文件</p></li><li><p><strong>路由配置缺失</strong><br>页面路由中缺少game类型的处理</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/source/game/index.md</code></li><li><code>solitude-latest/source/_data/game.yml</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/game.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/game/content.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/game.styl</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code></li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-创建电玩屋页面配置">1. 创建电玩屋页面配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/game/index.md</code></p><p><strong>文件内容：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">电玩城</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2025-01-07 10:00:00</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">game</span></span><br><span class="line"><span class="attr">data:</span> <span class="string">game</span></span><br><span class="line"><span class="attr">banner:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/game-banner.mp4</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">品电子毒药💊，享游戏人生🕹️</span></span><br><span class="line"><span class="attr">leftend:</span> <span class="string">跟</span> <span class="string">Ryan</span> <span class="string">一起体验冒险的旅程吧！</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p><strong>配置说明：</strong></p><ul><li><code>type: game</code> - 页面类型为game</li><li><code>data: game</code> - 数据源为game.yml</li><li><code>banner: true</code> - 启用banner显示</li><li><code>cover: /mp4/game-banner.mp4</code> - 设置banner视频</li><li><code>desc</code> - banner描述文字</li><li><code>leftend</code> - banner左侧信息</li></ul><hr><h3 id="2-创建游戏数据配置文件">2. 创建游戏数据配置文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/source/_data/game.yml</code></p><p><strong>文件结构：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">MMORPG，MOBA</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">全球最大死宅网恋中心开业啦</span></span><br><span class="line">  <span class="attr">game_list:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">魔兽世界</span></span><br><span class="line">        <span class="attr">specification:</span> <span class="number">80</span><span class="string">,90后的记忆。什么？00？你为啥想不开玩这个？</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">自CTM入坑,退坑于BFA,自从全地图飞行要声望崇拜才可以,肝度飙升,至今还是走地鸡,后续剧情真的一般,部落PVP法王。</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">https://i.imgur.com/K3ggfhp.jpeg</span></span><br><span class="line">        <span class="attr">link:</span> <span class="string">https://worldofwarcraft.blizzard.com/en-us/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">最终幻想XIV</span></span><br><span class="line">        <span class="attr">specification:</span> <span class="string">多人在线世纪佳缘,可恶,被撩走的永远都是团友。。</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">新世代MMORPG的神！3.0和5.0是完美版本,7.0是什么鬼？许多自闭症死宅的脱单利器,高难,钓鱼,装修,RP,总有一款适合你。</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">https://i.imgur.com/fO18ReB.png</span></span><br><span class="line">        <span class="attr">link:</span> <span class="string">https://jp.finalfantasyxiv.com/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Dota2</span></span><br><span class="line">        <span class="attr">specification:</span> <span class="string">大学记忆之一,MOBA只推Dota2,其他的都是垃圾。</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">擅长屠夫,米拉娜,祈求者,米波。屠夫的钩子,米拉娜的穿云箭,祈求者天火,让队友啧啧称奇让对手怒砸键盘的效率型ganker。</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">https://i.imgur.com/Tez2mB2.jpeg</span></span><br><span class="line">        <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/570/Dota_2/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">王者荣耀</span></span><br><span class="line">        <span class="attr">specification:</span> <span class="string">这游戏实在是太好玩啦,王者荣耀是最好玩的游戏！</span></span><br><span class="line">        <span class="attr">description:</span> <span class="string">三路都废,本命西施,只要是个女角色我都废。玩什么什么削弱的苦逼仔,把把败方MVP,一边嘴臭BB策划一边买皮肤的牢玩家。建议删策划</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">https://i.imgur.com/HPjGKS7.png</span></span><br><span class="line">        <span class="attr">link:</span> <span class="string">https://pvp.qq.com/web202311/index.html</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">单机游戏</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">那些年自己玩过的游戏</span></span><br><span class="line">  <span class="attr">game_list:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">黑神话:悟空</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">中国第一款大型3D大作,不多说了,猿神启动！</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">游戏难度介于动作冒险游戏和魂类游戏之间,不会让你打不过,但也绝对没那么轻松,风格全世界独一份,音乐很棒！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/jNtY3tA.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/2358720/_/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">侠盗猎车手5</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">游戏2013年出的,到底是谁还在买GTA5？</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">开放世界自由度拉满,车辆操控感很好,一边听着电台歌,一边载着一个迷糊的乘客前往利他教,感觉棒极了！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/FSMf1y0.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/271590/Grand_Theft_Auto_V/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">女神异闻录5</span> <span class="string">皇家版</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">成功实现九艘跳,好的我的周可儿越来越渣了。</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">非常独树一帜的画风,精良的角色设计,超绝的音乐演出,唯一缺点就是学妹的上场时间太短了,学妹党大失败。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/JgIzQ3a.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1687950/Persona_5_Royal/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">只狼:影逝二度</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">初见只管叮叮当,后期才知道爽上的意义。</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">著名打铁游戏,金石之音里光速变菜,向前一小步,通关一大步的完美诠释。犹豫就会败北,果断就会白给。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/qjfa224.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/814380/Sekiro_Shadows_Die_Twice__GOTY_Edition/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">尼尔:机械纪元</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">人類に栄光あれ！</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">非常出彩的音乐。角色可以自爆,造成伤害并且爆衣,加分,必须加分。游乐园正门雕像持续刮痧可以打爆获取巨多经验秒升99不是梦。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/psVgaHe.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/524220/NieRAutomata/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">赛博朋克2077</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">怕痛吗？那就电子纹身,身体改造</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">真男人从不沉迷性偶,只想与真爱帕南解锁坦震。杰洛特什么马震、云震到后来的船震都弱爆辣,玩的花还得是你波兰蠢驴。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/a6zS6Er.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1091500/Cyberpunk_2077/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">文明6</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">他们只是不（想）喜（要）欢（宣）您（战）。</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">文明系列的通病之一就是一局游戏耗时很长且很容易让人上瘾,此游戏已获得第一届STEAM大赏的&quot;再五分钟就好了&quot;奖。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/A4j41WK.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/289070/Sid_Meiers_Civilization_VI/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">鬼泣5</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">玩的越久你就会越发现只有但丁能带给你快乐</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">希望各位男性玩家不要成为那个像个沙雕一样为了找你弟弟单挑,所以把你儿子的手臂卸了的那位中二大人。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/Zmz0eNp.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/601150/Devil_May_Cry_5/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">艾尔登法环</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">请叫我《艾尔登法环》，好的老头环！</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">前有好物但危险！牢玩家告知各位新手玩家绅士一点，陌生的女性胖次不要乱捡,尤其是名为菲雅的少女所穿的&quot;死眠长裤&quot;！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/RVLtr0O.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1245620/ELDEN_RING/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">最终幻想7重制版</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">呜呜呜~儿时经典再现，泰裤辣！</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">这是一个卖相很好但一点都不好玩的游戏,也就卖卖情怀了,新玩家慎玩。优点:女角色塑造的不错,Tifa是3D区永远滴神,xp得到空前满足。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/QZFW5mT.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1462040/FINAL_FANTASY_VII_REMAKE_INTERGRADE/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">怪物猎人:世界</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">我的aibo除了吃就是惹事,我要隔壁龙人族姐妹花</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">即便不是系列最佳，那也是系列最为大胆的一作，它呈现了无比新颖的画面,作为怪猎作初入坑的我表示,出后续可能会再玩。比曙光强！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/ucM17bY.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/582010/Monster_Hunter_World/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">黑暗之魂3</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">在攻其阴睾的恶意世界里,最重要的还是活在裆下</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">毛多弱火,体大弱门,重甲弱雷,体胖弱菊,受苦游戏的代表作,对于我来讲根本不苦,因为还有同作品系列更苦的。我嘞个抖M之魂啊!就离谱！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/xXMovdt.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/374320/DARK_SOULS_III/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">巫师3:狂猎</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">昆特3:狂赌</span> <span class="string">朋友，不来一把昆特牌吗？</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">女术士打桩机但老寒腿,动不动摔死,3m的高度难倒英雄汉。风花雪月不妨碍拔x无情,各种震开创者。见人就拜,有个神奇马儿,最怕神器草叉！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/8jWp6sl.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/292030/The_Witcher_3_Wild_Hunt/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">上古卷轴5</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">我以前也是个冒险家，直到我的膝盖中了一箭。</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">进新手村要夹起尾巴做人,不要惹鸡神,游戏的审美并不重要,打上MOD就是我的审美!少女卷轴名不虚传。别人笑我抓根宝,我笑别人后宫少!</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/cPqWmxj.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/489830/The_Elder_Scrolls_V_Skyrim_Special_Edition/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">看门狗2</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">沙盒+高自由度+黑客+各种高科技无人机</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">你的手机终端可以操控一切，小到开门、开车，大到控飞机、炸建筑。偷看别人的隐私我一点都没兴趣,可以滴滴打车我可太有兴趣了！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/UWQte2u.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/447040/Watch_Dogs_2/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">全面战争:战锤2</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">拔剑泰哥真正做到了心中无女人,拔剑自然神</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">全战系列里最好玩的版本没有之一,充分展示了种族的多样性,让吸血鬼大军对抗古墓王成为可能。你也可以选择当反派。妙啊妙啊。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/xhPh7XZ.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/594570/Total_War_WARHAMMER_II/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">全面战争:三国</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">什么忠于旧主，还是小命要紧...</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">最初满脑子想着匡扶汉室,后来发现还是学曹操强夺别人老婆更有效率,再到后来甚至皇叔祭天法力无边,献祭流蜀汉真是tql。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/sZMmQtw.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/779340/Total_War_THREE_KINGDOMS/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Arma</span> <span class="number">3</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">硬核，真的是太硬核了...</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">作为一款让我到现在为止都还没摸明白所有快捷键怎么使用的游戏,对萌新属实不太友好。游戏中很明显就能体会中国国力提升2333</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/hhMIyb8.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/107410/Arma_3/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Hades</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">玩到最后谁还在乎老妈的花园</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">好感度主要来自于游戏的操作性设计和创意灵感,伴随着音乐加持使Roguelike脱胎换骨,有趣的角色对话也是亮点之一。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/Ku4wD7t.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1145360/Hades/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">幻兽帕鲁</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">白天大厂搬砖，晚上当赛博老板</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">在游戏中利益体会黑心资本家的资本原始积累,开放世界的宝可梦游戏很新颖很有趣,但是疯狂压榨员工让我有点罪恶的无力感。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/UI9VE2w.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1623730/Palworld/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">无主之地2</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">完美的词条,总是伴随着肝到破碎的心</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">肝，实在是太肝了！家人们谁懂啊我在游戏爆肝一周刷不出想要装备的感觉。感觉身体被掏空，没朋友一起玩不要轻易尝试。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/zcmSwJ6.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/49520/Borderlands_2/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">古墓丽影:前传</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">三部曲之一，作为系列终结很不错</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">主要描述了幼年劳拉踏上古墓寻宝的经历，其中贯穿了和圣三一的命运纠缠，解密要素少，动作收集要素多，总体还不错。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/yXBi5b8.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/203160/Tomb_Raider/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">古墓丽影:崛起</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">三部曲之二，作为系列终结很不错</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">继上一作和圣三一的纠葛，再次踏上寻找古墓的旅途，优化了生存类要素的设计加入了潜行偷袭元素，总体还不错。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/KFZXpgR.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/391220/Rise_of_the_Tomb_Raider/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">古墓丽影:暗影</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">三部曲之三，作为系列终结差一点</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">作为三部曲的收官作属实有点拉跨，画质虽然提升了，但是叙事的节奏感上有点差，难度曲线不合理，让人如鲠在喉。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/MbCWaID.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/750920/Shadow_of_the_Tomb_Raider_Definitive_Edition/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生化危机6</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">个人认为生化系列最好作品</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">三条故事线的设计真心不错，每条线的玩法都不一样，赞👍🏻。个人偏向玩艾达线，疯狂寻找通风口钻，谁懂啊！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/6c2JaOR.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/221040/Resident_Evil_6/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Bayonetta</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">漂亮女人很多，能称得上美魔女的只有贝姐一人</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">顶级的战斗、丰富多样且异想天开的武器、无与伦比的华丽风格依然熠熠生辉。喜欢看贝姐处刑，我不对劲.jpg</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/zvhUCTU.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/460790/Bayonetta/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">刺客信条:大革命</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">AI确定不是小聋瞎🦞？</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">系列中细节最为丰富的一座城市,不仅拥有许多美丽的建筑,也拥有最多可以进入的房屋。糟心的是会因为BUG卡关。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/sachMgH.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/289650/Assassins_Creed_Unity/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">刺客信条:枭雄</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">油炸姐弟花，解放全靠杀</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">可以和历史名人互动是亮点,剧情马马虎虎,处决动画花样百出,但没什么用,任务重复性高,双人物还是姐姐有意思。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/PxxSvmU.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/368500/Assassins_Creed_Syndicate/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">刺客信条:起源</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">埃及城管的执法之旅</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">画面让人耳目一新，就是巴爷和他老婆的结局让人摸不到小脑袋瓜，缺点：任务重复性一如既往的高。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/kSCbOvn.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/582160/Assassins_Creed_Origins/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">歧路旅人</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">较高的游戏售价让我苦等一年</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">主线流程有点简略,它采用了一种舞台剧的风格,较新颖。画面精致感觉不可思议,需要靠接触NPC才能深挖剧情。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/keaMWwq.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1971650/OCTOPATH_TRAVELER_II/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">茶杯头</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">打了几个小时自己开启了狂暴模式,我是boss？</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">千万不要被这款画面酷似猫和老鼠的游戏欺骗了,很硬核,相当的硬核。为什么我黑魂都过了这个过不去？</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/1s1v2VA.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/268910/Cuphead/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">小梦魇</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">黑暗幻想恐怖风小游戏</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">游戏的角色很可爱,但是没什么用。本来对恐怖类的就有点怕怕的😥,现在真被这种主打渲染氛围沉浸感的秒杀了。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/4w4nYmP.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/424840/Little_Nightmares/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">动物园之星</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">在家养国宝🐼可太酷了</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">足不出门可以接触各种各样的动物,比较适合静下心的玩家游玩。看看动物的习性，甚至看动物拉屎💩有时也是极好的。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/GHyt3QD.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/703080/Planet_Zoo/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">饥荒</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">你注视着深渊，深渊也在注视着你</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">这款游戏的特点在于孤独与生存,一个人在一片不知名的土地上苦苦挣扎的活下去。但是抱歉,SAN值的存在让我很难玩下去。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/o5BeKyH.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/219740/Dont_Starve/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">以撒的结合:重生</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">最最最经典Roguelike游戏</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">看不见走位走位,手里干。更多是像弹幕游戏一样需要妖艳风骚的走位。只要你跟包租公一样会扭动，你就是这个游戏的神。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/aF5cjiw.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/250900/The_Binding_of_Isaac_Rebirth/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">命运石之门</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">神作，还要啥解释？！</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">懒得置评了,字越少分量越重。别找评论了,先玩了好吗？</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/eW6Yee8.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/412830/STEINSGATE/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Alan</span> <span class="string">Wake</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">解秘恐怖动作风游戏</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">名副其实的氛围动作类恐怖游戏，主人公小说家的角色很讨喜。有在看美剧的感觉。这种直击心灵的恐怖氛围的佳作其实不多。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/IEvswlk.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/108710/Alan_Wake/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">辐射4</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">开局一人一狗，装备全靠捡</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">谁跟你讲捡垃圾会使你一无所有的，游戏里我富得流油！兄弟们，又捡到破烂啦。这是一款能切实体验讲师美国生活的好游戏。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/8kf9tYw.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/377160/Fallout_4/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">光之子</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">离谱吧，竟然是育碧做的</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">育碧少有的2D横版卷轴游戏,整个游戏世界都是由水彩风的物件所构成的,一草一木都显得清新而精致。啧啧啧,居然是育碧做的。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/p3wgp6h.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/256290/Child_of_Light/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">弹丸论破</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">我被狛枝同学整怕了</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">作为超高校级的Gamer,推理类文字游戏一直是我的心头好，成功使推理游戏从有声电子书的刻板印象里拉出来。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/2qZf0aV.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/413410/Danganronpa_Trigger_Happy_Havoc/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">我的世界</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">弟弟把我账号借走后再没还我.jpg</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">一个开放世界沙盒的生存类游戏，大多数人都是被电脑的渣渣配置所限制。大佬们都在搞建筑设计了，我还在防古力帕。没救了。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/Yq4UlqW.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://www.minecraft.net/ja-jp</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Transistor</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">《堡垒》的制作团队倾情打造</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">科幻主题动作RPG游戏,充分诠释了浪漫理性四个字的含义,主人公的歌声太赞了,有点偏回合制,可能喜恶参半。</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/xrHpQdy.jpeg</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/237930/Transistor/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">模拟人生4</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">我的小人云生活</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">可能这个游戏吸引我的一直不是社交对话，搞社交不是我的天赋，但是论设计建筑我是真的强啊！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/5PkB5HT.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/1222670/The_Sims_4/</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">欲神幻想</span></span><br><span class="line">       <span class="attr">specification:</span> <span class="string">真男人只会在色色游戏里修行！</span></span><br><span class="line">       <span class="attr">description:</span> <span class="string">你没看错,就是色色的小黄油。但其实是一个超硬核战斗游戏,嘘,别说话,把衣服穿以来。朕在修行！</span></span><br><span class="line">       <span class="attr">image:</span> <span class="string">https://i.imgur.com/3m6HwxL.png</span></span><br><span class="line">       <span class="attr">link:</span> <span class="string">https://store.steampowered.com/app/2346550/Rise_of_Eros/</span></span><br></pre></td></tr></table></figure><p><strong>数据结构说明：</strong></p><ul><li><code>class_name</code> - 游戏分类名称</li><li><code>description</code> - 分类描述</li><li><code>game_list</code> - 该分类下的游戏列表</li><li><code>name</code> - 游戏名称</li><li><code>specification</code> - 游戏规格/简介</li><li><code>description</code> - 详细描述/评测</li><li><code>image</code> - 游戏封面图片链接</li><li><code>link</code> - 游戏官方链接</li></ul><p><strong>注意事项：</strong></p><ul><li>图片链接建议使用HTTPS</li><li>描述文字可以包含个人评测和体验</li><li>链接可以是官方链接或Steam等平台链接</li><li>支持多个游戏分类</li></ul><hr><h3 id="3-修改页面路由配置">3. 修改页面路由配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/page.pug</code></p><p><strong>修改内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner(class=page.aside ? &#x27;&#x27; : &#x27;hide-aside&#x27;)</span><br><span class="line">        #page</span><br><span class="line">            case page.type</span><br><span class="line">                when &#x27;categories&#x27;</span><br><span class="line">                    include includes/page/categories</span><br><span class="line">                when &#x27;tags&#x27;</span><br><span class="line">                    include includes/page/tags</span><br><span class="line">                when &#x27;links&#x27;</span><br><span class="line">                    include includes/page/links</span><br><span class="line">                when &#x27;about&#x27;</span><br><span class="line">                    include includes/page/about</span><br><span class="line">                when &#x27;brevity&#x27;</span><br><span class="line">                    include includes/page/brevity</span><br><span class="line">                when &#x27;kit&#x27;</span><br><span class="line">                    include includes/page/kit</span><br><span class="line">                when &#x27;music&#x27;</span><br><span class="line">                    include includes/page/music</span><br><span class="line">                when &#x27;game&#x27;</span><br><span class="line">                    include includes/page/game</span><br><span class="line">                when &#x27;message&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/message&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;recentcomment&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/recentcomment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;banner&#x27;</span><br><span class="line">                    include includes/widgets/page/banner</span><br><span class="line">                    if page.container</span><br><span class="line">                        include includes/page/default</span><br><span class="line">                    else</span><br><span class="line">                        != page.content</span><br><span class="line">                default</span><br><span class="line">                    include includes/page/default</span><br><span class="line">            if page.comment</span><br><span class="line">                - var comment_js = true</span><br><span class="line">                include includes/widgets/third-party/comments/comment</span><br><span class="line">        if page.aside</span><br><span class="line">            include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>在页面路由中添加game类型的处理，确保访问 <code>/game/</code> 时能正确渲染game页面。</p><hr><h3 id="4-创建电玩屋页面模板">4. 创建电玩屋页面模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/page/game.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner(class=page.aside ? &#x27;&#x27; : &#x27;hide-aside&#x27;)</span><br><span class="line">        #page</span><br><span class="line">            case page.type</span><br><span class="line">                when &#x27;categories&#x27;</span><br><span class="line">                    include includes/page/categories</span><br><span class="line">                when &#x27;tags&#x27;</span><br><span class="line">                    include includes/page/tags</span><br><span class="line">                when &#x27;links&#x27;</span><br><span class="line">                    include includes/page/links</span><br><span class="line">                when &#x27;about&#x27;</span><br><span class="line">                    include includes/page/about</span><br><span class="line">                when &#x27;brevity&#x27;</span><br><span class="line">                    include includes/page/brevity</span><br><span class="line">                when &#x27;kit&#x27;</span><br><span class="line">                    include includes/page/kit</span><br><span class="line">                when &#x27;music&#x27;</span><br><span class="line">                    include includes/page/music</span><br><span class="line">                when &#x27;game&#x27;</span><br><span class="line">                    include includes/page/game</span><br><span class="line">                when &#x27;message&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/message&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;recentcomment&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/recentcomment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;banner&#x27;</span><br><span class="line">                    include includes/widgets/page/banner</span><br><span class="line">                    if page.container</span><br><span class="line">                        include includes/page/default</span><br><span class="line">                    else</span><br><span class="line">                        != page.content</span><br><span class="line">                default</span><br><span class="line">                    include includes/page/default</span><br><span class="line">            if page.comment</span><br><span class="line">                - var comment_js = true</span><br><span class="line">                include includes/widgets/third-party/comments/comment</span><br><span class="line">        if page.aside</span><br><span class="line">            include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>使用include结构引入banner和content组件，保持模板的模块化。</p><hr><h3 id="5-创建游戏内容组件">5. 创建游戏内容组件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/game/content.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner(class=page.aside ? &#x27;&#x27; : &#x27;hide-aside&#x27;)</span><br><span class="line">        #page</span><br><span class="line">            case page.type</span><br><span class="line">                when &#x27;categories&#x27;</span><br><span class="line">                    include includes/page/categories</span><br><span class="line">                when &#x27;tags&#x27;</span><br><span class="line">                    include includes/page/tags</span><br><span class="line">                when &#x27;links&#x27;</span><br><span class="line">                    include includes/page/links</span><br><span class="line">                when &#x27;about&#x27;</span><br><span class="line">                    include includes/page/about</span><br><span class="line">                when &#x27;brevity&#x27;</span><br><span class="line">                    include includes/page/brevity</span><br><span class="line">                when &#x27;kit&#x27;</span><br><span class="line">                    include includes/page/kit</span><br><span class="line">                when &#x27;music&#x27;</span><br><span class="line">                    include includes/page/music</span><br><span class="line">                when &#x27;game&#x27;</span><br><span class="line">                    include includes/page/game</span><br><span class="line">                when &#x27;message&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/message&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;recentcomment&#x27;</span><br><span class="line">                    !=partial(&#x27;includes/page/recentcomment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">                when &#x27;banner&#x27;</span><br><span class="line">                    include includes/widgets/page/banner</span><br><span class="line">                    if page.container</span><br><span class="line">                        include includes/page/default</span><br><span class="line">                    else</span><br><span class="line">                        != page.content</span><br><span class="line">                default</span><br><span class="line">                    include includes/page/default</span><br><span class="line">            if page.comment</span><br><span class="line">                - var comment_js = true</span><br><span class="line">                include includes/widgets/third-party/comments/comment</span><br><span class="line">        if page.aside</span><br><span class="line">            include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>模板逻辑说明：</strong></p><ul><li>数据遍历：遍历<code>site.data.game</code>中的每个分类和游戏</li><li>分类展示：显示分类名称和描述</li><li>游戏卡片：每个游戏以卡片形式展示</li><li>交互功能：点击游戏名称复制、详情链接、评论功能</li><li>条件判断：根据链接类型显示不同的按钮文本</li></ul><hr><h3 id="6-创建电玩屋样式文件">6. 创建电玩屋样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/game.styl</code></p><p><strong>文件内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#game</span></span><br><span class="line">  <span class="attribute">margin-top</span> <span class="number">26px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.game-item</span></span><br><span class="line">    <span class="selector-class">.game-item-title</span></span><br><span class="line">      <span class="attribute">line-height</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.game-item-description</span></span><br><span class="line">      <span class="attribute">line-height</span> <span class="number">1</span></span><br><span class="line">      <span class="attribute">margin</span> <span class="number">4px</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">color</span> <span class="built_in">var</span>(--efu-secondtext)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.game-item-content</span></span><br><span class="line">      <span class="attribute">display</span> flex</span><br><span class="line">      <span class="attribute">flex-direction</span> row</span><br><span class="line">      <span class="attribute">flex-wrap</span> wrap</span><br><span class="line">      <span class="attribute">margin</span> <span class="number">0</span> -<span class="number">8px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.game-item-content-item</span></span><br><span class="line">      <span class="attribute">width</span> <span class="built_in">calc</span>(<span class="number">25%</span> - <span class="number">12px</span>)</span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">12px</span></span><br><span class="line">      <span class="attribute">border</span> <span class="built_in">var</span>(--style-border-always)</span><br><span class="line">      <span class="attribute">overflow</span> hidden</span><br><span class="line">      <span class="attribute">margin</span> <span class="number">8px</span> <span class="number">6px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="built_in">var</span>(--efu-card-bg)</span><br><span class="line">      <span class="attribute">box-shadow</span> <span class="built_in">var</span>(--efu-shadow-border)</span><br><span class="line">      <span class="attribute">min-height</span> <span class="number">400px</span></span><br><span class="line">      <span class="attribute">position</span> relative</span><br><span class="line">      <span class="attribute">user-select</span> none</span><br><span class="line"></span><br><span class="line">      +<span class="built_in">maxWidth1200</span>()</span><br><span class="line">        <span class="attribute">width</span> <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">12px</span>)</span><br><span class="line"></span><br><span class="line">      +<span class="built_in">maxWidth768</span>()</span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.game-item-content-item-cover</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">        <span class="attribute">background</span> <span class="built_in">var</span>(--efu-secondbg)</span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">justify-content</span> center</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.game-item-content-item-image</span></span><br><span class="line">          <span class="attribute">object-fit</span> cover</span><br><span class="line">          <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.game-item-content-item-info</span></span><br><span class="line">        <span class="attribute">padding</span> <span class="number">8px</span> <span class="number">16px</span> <span class="number">16px</span> <span class="number">16px</span></span><br><span class="line">        <span class="attribute">margin-top</span> <span class="number">12px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.game-item-content-item-name</span></span><br><span class="line">          <span class="attribute">font-size</span> <span class="number">18px</span></span><br><span class="line">          <span class="attribute">font-weight</span> <span class="number">700</span></span><br><span class="line">          <span class="attribute">line-height</span> <span class="number">1</span></span><br><span class="line">          <span class="attribute">margin-bottom</span> <span class="number">8px</span></span><br><span class="line">          <span class="attribute">white-space</span> nowrap</span><br><span class="line">          <span class="attribute">text-overflow</span> ellipsis</span><br><span class="line">          <span class="attribute">width</span> fit-content</span><br><span class="line"></span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="attribute">color</span> <span class="built_in">var</span>(--efu-vip)</span><br><span class="line">            <span class="attribute">cursor</span> pointer</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.game-item-content-item-specification</span></span><br><span class="line">          <span class="attribute">font-size</span> <span class="number">12px</span></span><br><span class="line">          <span class="attribute">color</span> <span class="built_in">var</span>(--efu-secondtext)</span><br><span class="line">          <span class="attribute">line-height</span> <span class="number">1</span></span><br><span class="line">          <span class="attribute">margin-bottom</span> <span class="number">12px</span></span><br><span class="line">          <span class="attribute">white-space</span> nowrap</span><br><span class="line">          <span class="attribute">overflow</span> hidden</span><br><span class="line">          <span class="attribute">text-overflow</span> ellipsis</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.game-item-content-item-description</span></span><br><span class="line">          <span class="attribute">line-height</span> <span class="number">20px</span></span><br><span class="line">          <span class="attribute">color</span> <span class="built_in">var</span>(--efu-secondtext)</span><br><span class="line">          <span class="attribute">height</span> <span class="number">60px</span></span><br><span class="line">          <span class="attribute">display</span> -webkit-box</span><br><span class="line">          <span class="attribute">overflow</span> hidden</span><br><span class="line">          -webkit-line-clamp <span class="number">3</span></span><br><span class="line">          -webkit-<span class="attribute">box-orient</span> vertical</span><br><span class="line">          <span class="attribute">font-size</span> <span class="number">14px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.game-item-content-item-toolbar</span></span><br><span class="line">          <span class="attribute">display</span> flex</span><br><span class="line">          <span class="attribute">justify-content</span> space-between</span><br><span class="line">          <span class="attribute">position</span> absolute</span><br><span class="line">          <span class="attribute">bottom</span> <span class="number">12px</span></span><br><span class="line">          <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          <span class="attribute">padding</span> <span class="number">0</span> <span class="number">16px</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.game-item-content-item-link</span></span><br><span class="line">            <span class="attribute">font-size</span> <span class="number">12px</span></span><br><span class="line">            <span class="attribute">background</span> <span class="built_in">var</span>(--efu-gray-op)</span><br><span class="line">            <span class="attribute">padding</span> <span class="number">4px</span> <span class="number">8px</span></span><br><span class="line">            <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line">            <span class="attribute">cursor</span> pointer</span><br><span class="line"></span><br><span class="line">            <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">              <span class="attribute">background</span> <span class="built_in">var</span>(--efu-main)</span><br><span class="line">              <span class="attribute">color</span> <span class="built_in">var</span>(--efu-white)</span><br></pre></td></tr></table></figure><p><strong>样式特点：</strong></p><ul><li>响应式布局：桌面端4列，平板端2列，手机端1列</li><li>卡片设计：圆角边框，阴影效果，悬停交互</li><li>图片展示：固定高度，object-fit cover保持比例</li><li>文字处理：名称悬停变色，规格单行省略，描述3行截断</li><li>工具栏：底部固定位置，详情链接和评论按钮</li></ul><hr><h3 id="7-导入样式文件">7. 导入样式文件</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/index.styl</code></p><p><strong>修改内容：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@charset</span> <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;css_prefix&#x27;</span>)</span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;nib&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;third_party/snackbar.min.css&quot;</span></span><br><span class="line"><span class="comment">// project</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;var.styl&quot;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_global/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_layout/*&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/index.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_post/index.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/game.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_page/collects.styl&#x27;</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_mode/*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// highlight</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_highlight/index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// search</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;search.enable&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;search.type&#x27;</span>) == <span class="string">&#x27;algolia&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;_search/algolia-search&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;search.type&#x27;</span>) == <span class="string">&#x27;local&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;_search/local-search&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tags plugin</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;_tags/*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// comment</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;comment.use&#x27;</span>)</span><br><span class="line">  <span class="keyword">@import</span> <span class="string">&#x27;_comments/comment.styl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// components</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;_components/index&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br>在主题的样式入口文件中导入game样式，确保样式生效。</p><hr><h2 id="功能特性">功能特性</h2><h3 id="1-数据管理">1. 数据管理</h3><ul><li>支持YAML格式的数据文件</li><li>分类管理：MMORPG/MOBA、单机游戏等</li><li>详细信息：游戏名称、规格、描述、封面、链接</li></ul><h3 id="2-展示效果">2. 展示效果</h3><ul><li>卡片式布局，美观大方</li><li>响应式设计，适配不同屏幕</li><li>悬停交互效果</li><li>图片展示优化</li></ul><h3 id="3-交互功能">3. 交互功能</h3><ul><li>点击游戏名称复制</li><li>详情链接跳转</li><li>评论功能</li><li>外部链接支持</li></ul><h3 id="4-扩展性">4. 扩展性</h3><ul><li>易于添加新的游戏分类</li><li>支持自定义游戏信息</li><li>灵活的数据结构</li></ul><hr><h2 id="使用说明">使用说明</h2><h3 id="1-添加新游戏">1. 添加新游戏</h3><p>在 <code>source/_data/game.yml</code> 文件中添加新的游戏：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">新游戏名称</span></span><br><span class="line">  <span class="attr">specification:</span> <span class="string">游戏规格/简介</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">详细描述/评测</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">游戏封面图片链接</span></span><br><span class="line">  <span class="attr">link:</span> <span class="string">游戏官方链接</span></span><br></pre></td></tr></table></figure><h3 id="2-添加新分类">2. 添加新分类</h3><p>在数据文件中添加新的游戏分类：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">新分类名称</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">分类描述</span></span><br><span class="line">  <span class="attr">game_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">游戏名称</span></span><br><span class="line">      <span class="comment"># ... 其他属性</span></span><br></pre></td></tr></table></figure><h3 id="3-自定义样式">3. 自定义样式</h3><p>可以修改 <code>_page/game.styl</code> 文件来自定义样式效果。</p><hr><h2 id="注意事项">注意事项</h2><ol><li><strong>YAML格式</strong>：确保数据文件的YAML格式正确，避免缩进错误</li><li><strong>图片链接</strong>：建议使用HTTPS链接，确保图片能正常显示</li><li><strong>描述长度</strong>：建议控制描述文字长度，避免影响布局</li><li><strong>链接格式</strong>：确保链接格式正确，支持外部链接判断</li><li><strong>CSS选择器</strong>：使用<code>#game</code>作为根选择器，确保样式正确应用</li></ol><hr><h2 id="总结">总结</h2><p>通过以上步骤，我们成功为Solitude主题添加了完整的电玩屋功能。这个功能不仅提供了美观的游戏展示界面，还具有良好的扩展性和维护性。用户可以根据自己的需求轻松添加和管理游戏内容，展示个人的游戏体验和推荐。</p><p>电玩屋功能的实现体现了Hexo主题开发的核心思想：通过数据驱动的方式实现内容的动态展示，通过模板化的方式实现界面的统一管理，通过样式化的方式实现视觉效果的精美呈现。</p><p>主要特性包括：</p><ul><li>🎮 完整的游戏展示页面</li><li>📱 响应式设计，适配不同屏幕</li><li>🎥 视频Banner支持</li><li>🔗 外部链接跳转</li><li>💬 评论功能</li><li>✨ 悬停效果和交互</li><li>📊 分类管理游戏数据</li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 页面移植 </tag>
            
            <tag> 电玩屋 </tag>
            
            <tag> 游戏展示 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(6)-Banner视频播放功能移植与移动端优化</title>
      <link href="/2024/10/07/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(6)-Banner%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%8A%9F%E8%83%BD%E7%A7%BB%E6%A4%8D%E4%B8%8E%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%BC%98%E5%8C%96/"/>
      <url>/2024/10/07/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(6)-Banner%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%8A%9F%E8%83%BD%E7%A7%BB%E6%A4%8D%E4%B8%8E%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>Solitude主题默认支持图片banner，但有时我们希望使用视频banner来增加页面的动态效果和视觉冲击力。本文将详细介绍如何从blog-solitude项目移植Banner视频播放功能到solitude-latest，并针对移动端进行响应式优化，让你的博客banner更加生动有趣。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>Solitude主题默认只支持图片banner</li><li>页面banner无法播放视频文件</li><li>移动端banner高度固定，在小屏幕上显示效果不佳</li><li>缺少banner控制配置，无法灵活切换图片/视频模式</li></ul><h3 id="期望效果">期望效果</h3><ul><li>Banner支持视频播放（自动播放、循环、静音）</li><li>支持图片/视频模式切换</li><li>移动端banner高度自适应</li><li>响应式设计，适配不同屏幕尺寸</li><li>通过配置文件控制banner类型</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>功能缺失</strong><br>solitude-latest主题缺少视频播放相关的模板和JavaScript支持</p></li><li><p><strong>配置不完整</strong><br><code>_config.solitude.yml</code> 中缺少banner控制配置项</p></li><li><p><strong>响应式设计不足</strong><br>CSS样式未针对移动端进行优化，banner高度固定</p></li><li><p><strong>模板限制</strong><br>页面banner模板中height写死，无法实现响应式</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/_config.solitude.yml</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/banner.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/home/topGroup.pug</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/banner-video.js</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/other.styl</code></li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-添加Banner控制配置">1. 添加Banner控制配置</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改前：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hometop:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">banner:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">分享技术&lt;br</span> <span class="string">&gt;与科技生活</span></span><br><span class="line">    <span class="attr">desc:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">一个热爱生活的人</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">我只是一个普通的程序员</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">但我有一个不平凡的梦想</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">我希望能够改变世界</span></span><br><span class="line">  <span class="attr">group:</span></span><br><span class="line">    <span class="comment"># 热门: /tags/Fire/ || fas fa-fire || linear-gradient(to right,#f65,#ffbf37)</span></span><br><span class="line">  <span class="attr">recommendList:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">sup:</span> <span class="string">置顶</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">Solitude</span> <span class="string">官方文档</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://solitude.js.org/</span></span><br><span class="line">    <span class="attr">img:</span> <span class="string">/img/default.avif</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">video</span></span><br><span class="line">    <span class="attr">media:</span> <span class="string">/mp4/recommend-banner/recommend-banner7.mp4</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hometop:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">banner:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">分享技术&lt;br</span> <span class="string">&gt;与科技生活</span></span><br><span class="line">    <span class="attr">desc:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">一个热爱生活的人</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">我只是一个普通的程序员</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">但我有一个不平凡的梦想</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">我希望能够改变世界</span></span><br><span class="line">  <span class="attr">group:</span></span><br><span class="line">    <span class="comment"># 热门: /tags/Fire/ || fas fa-fire || linear-gradient(to right,#f65,#ffbf37)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Banner 控制配置</span></span><br><span class="line">  <span class="comment"># Banner Control Configuration</span></span><br><span class="line">  <span class="attr">banner_control:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 是否启用banner控制 / Enable banner control</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">video</span> <span class="comment"># img / video</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">recommendList:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">sup:</span> <span class="string">置顶</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">Solitude</span> <span class="string">官方文档</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://solitude.js.org/</span></span><br><span class="line">    <span class="attr">img:</span> <span class="string">/img/default.avif</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">video</span></span><br><span class="line">    <span class="attr">media:</span> <span class="string">/mp4/recommend-banner/recommend-banner7.mp4</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-创建Banner视频播放JavaScript">2. 创建Banner视频播放JavaScript</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/js/custom/banner-video.js</code></p><p><strong>文件内容：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> video = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;banner-video&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (video) &#123;</span><br><span class="line">    video.<span class="property">muted</span> = <span class="literal">true</span>;</span><br><span class="line">    video.<span class="property">playsInline</span> = <span class="literal">true</span>;</span><br><span class="line">    video.<span class="title function_">play</span>().<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;Autoplay failed:&#x27;</span>, err);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><h3 id="3-修改页面Banner模板">3. 修改页面Banner模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/page/banner.pug</code></p><p><strong>修改前：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.author-content.author-content-item.single.sharePage(style=`background: url($&#123;page.cover&#125;) no-repeat center; background-size: cover;`)</span><br><span class="line">    .card-content</span><br><span class="line">        .author-content-item-tips= page.desc</span><br><span class="line">        span.author-content-item-title= page.title</span><br><span class="line">        .content-bottom</span><br><span class="line">            if page.leftend</span><br><span class="line">                .tips= page.leftend</span><br><span class="line">            if page.rightend</span><br><span class="line">                .tips= page.rightend</span><br><span class="line">        if page.rightbtn</span><br><span class="line">            .banner-button-group</span><br><span class="line">                - const isInternalLink = page.rightbtnlink.startsWith(&#x27;/&#x27;)</span><br><span class="line">                a.banner-button(onclick=isInternalLink ? `pjax.loadUrl(&quot;$&#123;page.rightbtnlink&#125;&quot;)`: null, href=isInternalLink ? null : url_for(page.rightbtnlink), target=isInternalLink ? null : &quot;_blank&quot;)</span><br><span class="line">                    i.solitude.fas.fa-circle-chevron-right</span><br><span class="line">                    span.banner-button-text= page.rightbtn</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">script(src=url_for(&#x27;/js/custom/banner-video.js&#x27;))</span><br><span class="line">.author-content.author-content-item.single.sharePage(style=&quot;position: relative; width: 100%; overflow: hidden;&quot;)</span><br><span class="line">    if theme.hometop.banner_control &amp;&amp; theme.hometop.banner_control.enable &amp;&amp; theme.hometop.banner_control.type === &#x27;video&#x27; &amp;&amp; page.cover &amp;&amp; page.cover.endsWith(&#x27;.mp4&#x27;)</span><br><span class="line">        video#banner-video(</span><br><span class="line">            autoplay</span><br><span class="line">            muted</span><br><span class="line">            loop</span><br><span class="line">            playsinline</span><br><span class="line">            preload=&quot;auto&quot;</span><br><span class="line">            style=&quot;position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;&quot;</span><br><span class="line">            )</span><br><span class="line">            source(src=page.cover type=&quot;video/mp4&quot;)</span><br><span class="line">    else</span><br><span class="line">        .image-container(style=&quot;position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden;&quot;)</span><br><span class="line">            img(src=page.cover, style=&quot;width: 100%; height: 100%; object-fit: cover;&quot;)</span><br><span class="line">    .card-content(style=&quot;position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none;&quot;)</span><br><span class="line">        .author-content-item-tips= page.desc</span><br><span class="line">        span.author-content-item-title= page.title</span><br><span class="line">        .content-bottom</span><br><span class="line">            if page.leftend</span><br><span class="line">                .tips= page.leftend</span><br><span class="line">            if page.rightend</span><br><span class="line">                .tips= page.rightend</span><br><span class="line">        if page.rightbtn</span><br><span class="line">            .banner-button-group</span><br><span class="line">                - const isInternalLink = page.rightbtnlink.startsWith(&#x27;/&#x27;)</span><br><span class="line">                a.banner-button(onclick=isInternalLink ? `pjax.loadUrl(&quot;$&#123;page.rightbtnlink&#125;&quot;)`: null, href=isInternalLink ? null : url_for(page.rightbtnlink), target=isInternalLink ? null : &quot;_blank&quot;)</span><br><span class="line">                    i.solitude.fas.fa-circle-chevron-right</span><br><span class="line">                    span.banner-button-text= page.rightbtn</span><br></pre></td></tr></table></figure><hr><h3 id="4-修改首页推荐卡片模板">4. 修改首页推荐卡片模板</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/includes/widgets/home/topGroup.pug</code></p><p><strong>修改前：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if theme.hometop.recommendList.type === &#x27;video&#x27;</span><br><span class="line">    .todayCard-cover.nolazyload</span><br><span class="line">        video.todayCard-video(</span><br><span class="line">            src=theme.hometop.recommendList.media, </span><br><span class="line">            autoplay=true, </span><br><span class="line">            loop=true, </span><br><span class="line">            muted=true, </span><br><span class="line">            playsinline=true, </span><br><span class="line">            style=&quot;width: 100%; height: 100%; object-fit: cover;&quot;)</span><br><span class="line">else</span><br><span class="line">    .todayCard-cover.nolazyload(style=`background: url(&#x27;$&#123;theme.hometop.recommendList.img&#125;&#x27;) no-repeat center /cover`)</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if theme.hometop.banner_control &amp;&amp; theme.hometop.banner_control.enable &amp;&amp; theme.hometop.banner_control.type === &#x27;video&#x27; &amp;&amp; theme.hometop.recommendList.type === &#x27;video&#x27;</span><br><span class="line">    .todayCard-cover.nolazyload</span><br><span class="line">        video.todayCard-video(</span><br><span class="line">            src=theme.hometop.recommendList.media, </span><br><span class="line">            autoplay=true, </span><br><span class="line">            loop=true, </span><br><span class="line">            muted=true, </span><br><span class="line">            playsinline=true, </span><br><span class="line">            style=&quot;width: 100%; height: 100%; object-fit: cover;&quot;)</span><br><span class="line">else</span><br><span class="line">    .todayCard-cover.nolazyload(style=`background: url(&#x27;$&#123;theme.hometop.recommendList.img&#125;&#x27;) no-repeat center /cover`)</span><br></pre></td></tr></table></figure><hr><h3 id="5-添加响应式CSS样式">5. 添加响应式CSS样式</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/source/css/_page/other.styl</code></p><p><strong>修改前：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.sharePage</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">19rem</span></span><br><span class="line">  <span class="attribute">background-size</span> cover</span><br><span class="line">  <span class="attribute">color</span> <span class="built_in">var</span>(--efu-white)</span><br><span class="line">  <span class="attribute">overflow</span> hidden</span><br><span class="line">  <span class="attribute">margin-top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">12px</span></span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.sharePage</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">300px</span></span><br><span class="line">  <span class="attribute">background-size</span> cover</span><br><span class="line">  <span class="attribute">color</span> <span class="built_in">var</span>(--efu-white)</span><br><span class="line">  <span class="attribute">overflow</span> hidden</span><br><span class="line">  <span class="attribute">margin-top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">12px</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 移动端高度调整</span></span><br><span class="line">  +<span class="built_in">maxWidth768</span>()</span><br><span class="line">    <span class="attribute">height</span> <span class="number">150px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">var</span>(--efu-black)</span><br><span class="line">    <span class="attribute">opacity</span> .<span class="number">3</span></span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">1</span></span><br><span class="line">    <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 针对single类的banner高度控制</span></span><br><span class="line"><span class="selector-class">.author-content</span><span class="selector-class">.author-content-item</span><span class="selector-class">.single</span><span class="selector-class">.sharePage</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">300px</span></span><br><span class="line"></span><br><span class="line">  +<span class="built_in">maxWidth768</span>()</span><br><span class="line">    <span class="attribute">height</span> <span class="number">150px</span></span><br></pre></td></tr></table></figure><hr><h2 id="效果对比">效果对比</h2><h3 id="修改前">修改前</h3><ul><li>❌ Banner只支持图片显示</li><li>❌ 无法播放视频文件</li><li>❌ 移动端banner高度固定，显示效果差</li><li>❌ 缺少banner控制配置</li></ul><h3 id="修改后">修改后</h3><ul><li>✅ Banner支持视频播放（自动播放、循环、静音）</li><li>✅ 支持图片/视频模式切换</li><li>✅ 移动端banner高度自适应（电脑端300px，手机端150px）</li><li>✅ 响应式设计，适配不同屏幕尺寸</li><li>✅ 通过配置文件控制banner类型</li></ul><hr><h2 id="配置说明">配置说明</h2><h3 id="Banner控制配置">Banner控制配置</h3><p>在 <code>_config.solitude.yml</code> 中可以通过以下配置控制banner：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hometop:</span></span><br><span class="line">  <span class="attr">banner_control:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment"># 是否启用banner控制</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">video</span>   <span class="comment"># img / video</span></span><br></pre></td></tr></table></figure><h3 id="页面Banner配置">页面Banner配置</h3><p>在文章的front-matter中设置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">文章标题</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/mp4/recommend-banner/recommend-banner7.mp4</span>  <span class="comment"># 视频文件路径</span></span><br><span class="line"><span class="attr">desc:</span> <span class="string">Banner描述</span></span><br><span class="line"><span class="attr">leftend:</span> <span class="string">左侧信息</span></span><br><span class="line"><span class="attr">rightend:</span> <span class="string">右侧信息</span></span><br><span class="line"><span class="attr">rightbtn:</span> <span class="string">按钮文字</span></span><br><span class="line"><span class="attr">rightbtnlink:</span> <span class="string">/about/</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><hr><h2 id="故障排查">故障排查</h2><ol><li><p><strong>视频不播放？</strong></p><ul><li>检查视频文件路径是否正确</li><li>确认 <code>banner_control.enable: true</code></li><li>确认 <code>banner_control.type: video</code></li><li>检查视频文件格式是否为mp4</li></ul></li><li><p><strong>移动端显示异常？</strong></p><ul><li>清理缓存：<code>hexo clean &amp;&amp; hexo g</code></li><li>检查CSS样式是否正确加载</li></ul></li><li><p><strong>JavaScript报错？</strong></p><ul><li>确认 <code>banner-video.js</code> 文件存在</li><li>检查浏览器控制台是否有其他错误</li></ul></li></ol><hr><h2 id="总结">总结</h2><p>通过本次魔改，你可以让Solitude主题的Banner支持视频播放功能，并针对移动端进行了响应式优化。视频Banner不仅增加了页面的动态效果，也让博客更加生动有趣。</p><p>主要特性：</p><ul><li>🎥 支持视频自动播放、循环播放、静音播放</li><li>📱 移动端响应式设计，高度自适应</li><li>⚙️ 灵活的配置控制，支持图片/视频切换</li><li>🎨 保持原有的视觉效果和交互功能</li></ul><p>如需进一步个性化视频Banner样式，可参考CSS样式文件进行自定义修改。</p><hr><h2 id="相关链接">相关链接</h2><ul><li><a href="https://solitude.js.org/">Solitude主题官方文档</a></li><li><a href="https://hexo.io/">Hexo官方文档</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video">HTML5 Video API文档</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> Banner </tag>
            
            <tag> 视频播放 </tag>
            
            <tag> 响应式设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(5)-统计图功能修复与增强</title>
      <link href="/2024/09/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(5)-%E7%BB%9F%E8%AE%A1%E5%9B%BE%E5%8A%9F%E8%83%BD%E4%BF%AE%E5%A4%8D%E4%B8%8E%E5%A2%9E%E5%BC%BA/"/>
      <url>/2024/09/30/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(5)-%E7%BB%9F%E8%AE%A1%E5%9B%BE%E5%8A%9F%E8%83%BD%E4%BF%AE%E5%A4%8D%E4%B8%8E%E5%A2%9E%E5%BC%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在使用Solitude主题时，归档、标签、分类页面本应支持文章统计图（如折线图、柱状图、饼图），但有时会遇到统计图不显示或功能失效的问题。本文将详细介绍如何修复和增强Solitude主题的统计图功能，让你的博客数据一目了然，提升专业感和交互体验。</p><hr><h2 id="现象与需求">现象与需求</h2><h3 id="现象">现象</h3><ul><li>归档、标签、分类页面本应有统计图，但页面未显示任何图表</li><li>控制台无明显报错，或仅有部分依赖缺失提示</li><li>主题配置和页面模板未见明显异常</li></ul><h3 id="期望效果">期望效果</h3><ul><li>归档页面显示文章发布趋势折线图</li><li>标签页面显示标签分布柱状图</li><li>分类页面显示分类分布饼图</li><li>图表可交互，点击跳转到对应归档/标签/分类</li></ul><hr><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><ol><li><p><strong>主题配置缺失</strong><br><code>_config.solitude.yml</code> 中未启用统计图功能（缺少 <code>page.echart: true</code> 配置项）</p></li><li><p><strong>页面模板未包含统计图容器</strong><br>分类页面模板 <code>category.pug</code> 缺少统计图的HTML容器</p></li><li><p><strong>依赖未安装</strong><br>主题统计图脚本依赖 <code>cheerio</code>，未安装时会导致生成失败</p></li></ol><hr><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>solitude-latest/_config.solitude.yml</code></li><li><code>solitude-latest/node_modules/hexo-theme-solitude/layout/category.pug</code></li><li><code>solitude-latest/package.json</code>（依赖安装）</li></ul><hr><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-启用统计图功能">1. 启用统计图功能</h3><p><strong>文件路径：</strong><br><code>solitude-latest/_config.solitude.yml</code></p><p><strong>修改前：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">page:</span></span><br><span class="line">  <span class="attr">error:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># Default value</span></span><br><span class="line">  <span class="attr">default:</span></span><br><span class="line">    <span class="attr">cover:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/img/default.avif</span></span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">page:</span></span><br><span class="line">  <span class="attr">error:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">echart:</span> <span class="literal">true</span>   <span class="comment"># ← 新增，启用统计图</span></span><br><span class="line">  <span class="attr">default:</span></span><br><span class="line">    <span class="attr">cover:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/img/default.avif</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-分类页面添加统计图容器">2. 分类页面添加统计图容器</h3><p><strong>文件路径：</strong><br><code>solitude-latest/node_modules/hexo-theme-solitude/layout/category.pug</code></p><p><strong>修改前：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner</span><br><span class="line">        #category</span><br><span class="line">            #category-bar</span><br><span class="line">                include includes/widgets/home/categoryBar</span><br><span class="line">            .recent-posts#recent-posts</span><br><span class="line">                each post,index in page.posts.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">                    include includes/widgets/home/postList</span><br><span class="line">                include includes/mixins/pagination</span><br><span class="line">            if theme.comment.hot_tip.enable</span><br><span class="line">                include ./includes/widgets/third-party/hot/index.pug</span><br><span class="line">        include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">    main.layout#content-inner</span><br><span class="line">        #category</span><br><span class="line">            &lt;div id=&quot;categories-chart&quot; data-parent=&quot;false&quot; style=&quot;height: 300px; padding: 10px;&quot;&gt;&lt;/div&gt;  // ← 新增</span><br><span class="line">            #category-bar</span><br><span class="line">                include includes/widgets/home/categoryBar</span><br><span class="line">            .recent-posts#recent-posts</span><br><span class="line">                each post,index in page.posts.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">                    include includes/widgets/home/postList</span><br><span class="line">                include includes/mixins/pagination</span><br><span class="line">            if theme.comment.hot_tip.enable</span><br><span class="line">                include ./includes/widgets/third-party/hot/index.pug</span><br><span class="line">        include includes/widgets/aside/aside</span><br></pre></td></tr></table></figure><hr><h3 id="3-安装依赖">3. 安装依赖</h3><p><strong>命令行操作：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cheerio</span><br></pre></td></tr></table></figure><p><strong>说明：</strong><br><code>cheerio</code> 是主题统计图脚本所需的依赖，缺失会导致 <code>hexo generate</code> 时报错。</p><hr><h2 id="效果对比">效果对比</h2><h3 id="修改前">修改前</h3><ul><li>❌ 归档、标签、分类页面无统计图</li><li>❌ 页面数据分布不可视化</li></ul><h3 id="修改后">修改后</h3><ul><li>✅ 归档页面有文章发布趋势折线图</li><li>✅ 标签页面有标签分布柱状图</li><li>✅ 分类页面有分类分布饼图/旭日图</li><li>✅ 图表可交互，点击跳转</li><li>✅ 数据一目了然，提升专业感</li></ul><hr><h2 id="故障排查">故障排查</h2><ol><li><p><strong>统计图仍不显示？</strong></p><ul><li>检查 <code>_config.solitude.yml</code> 是否有 <code>page.echart: true</code></li><li>检查页面模板是否有统计图容器</li><li>检查 <code>cheerio</code> 是否已安装</li></ul></li><li><p><strong>生成时报错？</strong></p><ul><li>多为依赖缺失，执行 <code>npm install cheerio</code> 解决</li></ul></li><li><p><strong>页面样式错乱？</strong></p><ul><li>清理缓存，重新生成：<code>hexo clean &amp;&amp; hexo g</code></li></ul></li></ol><hr><h2 id="总结">总结</h2><p>通过本次魔改，你可以让Solitude主题的归档、标签、分类页面都拥有美观、实用的统计图功能。数据可视化不仅提升了博客的专业度，也让访客更直观地了解你的内容分布。<br>如需进一步个性化统计图样式，可参考ECharts官方文档进行自定义。</p><hr><h2 id="相关链接">相关链接</h2><ul><li><a href="https://solitude.js.org/">Solitude主题官方文档</a></li><li><a href="https://hexo.io/">Hexo官方文档</a></li><li><a href="https://echarts.apache.org/zh/index.html">ECharts官方文档</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> ECharts </tag>
            
            <tag> 数据可视化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(4)-文章页波浪线效果自定义修改</title>
      <link href="/2024/09/23/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(4)-%E6%96%87%E7%AB%A0%E9%A1%B5%E6%B3%A2%E6%B5%AA%E7%BA%BF%E6%95%88%E6%9E%9C%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%AE%E6%94%B9/"/>
      <url>/2024/09/23/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(4)-%E6%96%87%E7%AB%A0%E9%A1%B5%E6%B3%A2%E6%B5%AA%E7%BA%BF%E6%95%88%E6%9E%9C%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%AE%E6%94%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在使用Solitude主题时，文章页面的post-info下方默认使用简单的圆角矩形分隔线。这种静态效果虽然简洁，但缺乏动感和视觉吸引力。本教程将详细介绍如何将默认的分隔线替换为动态的波浪线效果，让文章页面更加生动美观。</p><h2 id="问题描述">问题描述</h2><h3 id="现象">现象</h3><ul><li>文章页面post-info下方显示简单的圆角矩形分隔线</li><li>视觉效果较为单调，缺乏动感</li><li>希望实现类似旧版本的动态波浪线效果</li></ul><h3 id="当前版本显示效果">当前版本显示效果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌─────────────────────────────────────┐</span><br><span class="line">│          文章标题                    │</span><br><span class="line">│          文章信息                    │</span><br><span class="line">└─────────────────────────────────────┘</span><br><span class="line">    ████████████████████████████████</span><br><span class="line">    ████████████████████████████████</span><br></pre></td></tr></table></figure><h3 id="期望效果">期望效果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌─────────────────────────────────────┐</span><br><span class="line">│          文章标题                    │</span><br><span class="line">│          文章信息                    │</span><br><span class="line">└─────────────────────────────────────┘</span><br><span class="line">    ~~~~~~~~~~~~~  ~~~~~~~~~~~~~</span><br><span class="line">   ~~~~~~~~~~~~~~  ~~~~~~~~~~~~~~</span><br><span class="line">  ~~~~~~~~~~~~~~~  ~~~~~~~~~~~~~~~</span><br><span class="line"> ~~~~~~~~~~~~~~~~~  ~~~~~~~~~~~~~~~~~</span><br></pre></td></tr></table></figure><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><p>通过对比新版本和旧版本的代码实现，发现了关键差异：</p><h4 id="新版本（当前实现）：">新版本（当前实现）：</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">&amp;::after</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">32px</span></span><br><span class="line">  <span class="attribute">background</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">16px</span> <span class="number">16px</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h4 id="旧版本（期望的实现）：">旧版本（期望的实现）：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">section.main-hero-waves-area.waves-area</span><br><span class="line">    svg.waves-svg(xmlns=&quot;http://www.w3.org/2000/svg&quot;, xlink=&quot;http://www.w3.org/1999/xlink&quot;, viewBox=&quot;0 24 150 28&quot;, preserveAspectRatio=&quot;none&quot;, shape-rendering=&quot;auto&quot;)</span><br><span class="line">        defs</span><br><span class="line">            path#gentle-wave(d=&quot;M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z&quot;)</span><br><span class="line">        g.parallax</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;0&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;3&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;5&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;7&quot;)</span><br></pre></td></tr></table></figure><h3 id="关键差异">关键差异</h3><ol><li><p><strong>实现方式不同</strong>：</p><ul><li>新版本：使用CSS <code>::after</code> 伪元素创建圆角矩形</li><li>旧版本：使用SVG创建动态波浪线</li></ul></li><li><p><strong>动画效果不同</strong>：</p><ul><li>新版本：静态效果，无动画</li><li>旧版本：多层波浪，不同延迟和持续时间</li></ul></li><li><p><strong>视觉效果不同</strong>：</p><ul><li>新版本：简单的圆角矩形分隔线</li><li>旧版本：动态的波浪线效果</li></ul></li></ol><h2 id="解决方案">解决方案</h2><h3 id="修改文件清单">修改文件清单</h3><ul><li><code>node_modules/hexo-theme-solitude/layout/includes/widgets/post/wave.pug</code> - 波浪线模板文件</li><li><code>node_modules/hexo-theme-solitude/layout/includes/widgets/post/postMeta.pug</code> - 文章元信息模板</li><li><code>node_modules/hexo-theme-solitude/source/css/_post/meta.styl</code> - 文章元信息样式</li><li><code>node_modules/hexo-theme-solitude/source/css/_global/animation.styl</code> - 动画定义文件</li><li><code>node_modules/hexo-theme-solitude/source/css/_layout/article-container.styl</code> - 文章容器样式</li><li><code>node_modules/hexo-theme-solitude/source/css/_layout/aside.styl</code> - 侧边栏样式</li><li><code>node_modules/hexo-theme-solitude/source/css/_global/index.styl</code> - 全局样式</li></ul><h3 id="详细修改步骤">详细修改步骤</h3><h4 id="1-创建波浪线模板文件">1. 创建波浪线模板文件</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/layout/includes/widgets/post/wave.pug</code></p><p><strong>文件内容：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">section.main-hero-waves-area.waves-area</span><br><span class="line">    svg.waves-svg(xmlns=&quot;http://www.w3.org/2000/svg&quot;, xlink=&quot;http://www.w3.org/1999/xlink&quot;, viewBox=&quot;0 24 150 28&quot;, preserveAspectRatio=&quot;none&quot;, shape-rendering=&quot;auto&quot;)</span><br><span class="line">        defs</span><br><span class="line">            path#gentle-wave(d=&quot;M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z&quot;)</span><br><span class="line">        g.parallax</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;0&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;3&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;5&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;7&quot;)</span><br></pre></td></tr></table></figure><p><strong>文件作用：</strong> 定义波浪线的SVG结构和路径</p><h4 id="2-修改文章元信息模板">2. 修改文章元信息模板</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/layout/includes/widgets/post/postMeta.pug</code></p><p><strong>修改前：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.coverdiv#coverdiv</span><br><span class="line">    img#post-cover.nolazyload(src=url_for(page.cover), alt=page.title)</span><br><span class="line">include ./postInfo</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.coverdiv#coverdiv</span><br><span class="line">    img#post-cover.nolazyload(src=url_for(page.cover), alt=page.title)</span><br><span class="line">include ./postInfo</span><br><span class="line">include ./wave</span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong> 在文章元信息模板中引入波浪线组件</p><h4 id="3-修改文章元信息样式">3. 修改文章元信息样式</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/source/css/_post/meta.styl</code></p><p><strong>找到以下代码段：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main-hero-waves-area</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">bottom</span> -<span class="number">11px</span></span><br></pre></td></tr></table></figure><p><strong>替换为：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main-hero-waves-area</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">bottom</span> -<span class="number">11px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.waves-area</span> <span class="selector-class">.waves-svg</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">60px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span></span><br><span class="line">  <span class="attribute">animation</span> move-forever <span class="number">30s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">55</span>, .<span class="number">5</span>, .<span class="number">45</span>, .<span class="number">5</span>) infinite</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">2s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">7s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">3s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">10s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">4s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">13s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">5s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">20s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong> 定义波浪线的样式和动画效果</p><h4 id="4-添加波浪动画定义">4. 添加波浪动画定义</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/source/css/_global/animation.styl</code></p><p><strong>在文件末尾添加：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> move-forever</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translate3d</span>(-<span class="number">90px</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  <span class="number">100%</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translate3d</span>(<span class="number">85px</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong> 定义波浪线的移动动画</p><h4 id="5-调整文章内容区域间距">5. 调整文章内容区域间距</h4><p>为了让文章内容与波浪线保持适当距离，需要调整间距：</p><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/source/css/_layout/article-container.styl</code></p><p><strong>修改文章内容区域的padding：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.post</span> &amp;</span><br><span class="line">  <span class="attribute">padding</span> <span class="number">2rem</span> <span class="number">2rem</span> <span class="number">1rem</span> <span class="number">2rem</span></span><br><span class="line">  +<span class="built_in">maxWidth768</span>()</span><br><span class="line">    <span class="attribute">padding</span> <span class="number">1.5rem</span> .<span class="number">5rem</span> <span class="number">1rem</span> .<span class="number">5rem</span></span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong> 增加文章内容区域的顶部间距</p><h4 id="6-调整侧边栏间距">6. 调整侧边栏间距</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/source/css/_layout/aside.styl</code></p><p><strong>修改侧边栏的margin-top：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#aside-content</span></span><br><span class="line">  <span class="attribute">display</span> flex</span><br><span class="line">  <span class="attribute">flex-direction</span> column</span><br><span class="line">  <span class="attribute">gap</span> <span class="built_in">var</span>(--gap)</span><br><span class="line">  <span class="attribute">animation</span> slide-in .<span class="number">6s</span> .<span class="number">3s</span> backwards</span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">10</span></span><br><span class="line">  <span class="attribute">margin-top</span> <span class="number">1rem</span></span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong> 为侧边栏添加顶部间距，与文章内容保持一致</p><h4 id="7-调整文章容器间距">7. 调整文章容器间距</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/source/css/_global/index.styl</code></p><p><strong>修改文章容器的padding：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="selector-id">#post</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">1rem</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>修改说明：</strong> 为文章容器添加顶部间距</p><h2 id="代码详解">代码详解</h2><h3 id="SVG波浪线结构">SVG波浪线结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">section.main-hero-waves-area.waves-area</span><br><span class="line">    svg.waves-svg(xmlns=&quot;http://www.w3.org/2000/svg&quot;, xlink=&quot;http://www.w3.org/1999/xlink&quot;, viewBox=&quot;0 24 150 28&quot;, preserveAspectRatio=&quot;none&quot;, shape-rendering=&quot;auto&quot;)</span><br><span class="line">        defs</span><br><span class="line">            path#gentle-wave(d=&quot;M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z&quot;)</span><br><span class="line">        g.parallax</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;0&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;3&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;5&quot;)</span><br><span class="line">            use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;7&quot;)</span><br></pre></td></tr></table></figure><p><strong>关键参数说明：</strong></p><ul><li><code>viewBox=&quot;0 24 150 28&quot;</code>：定义SVG的视口大小</li><li><code>preserveAspectRatio=&quot;none&quot;</code>：不保持宽高比，允许拉伸</li><li><code>shape-rendering=&quot;auto&quot;</code>：自动优化形状渲染</li><li><code>d=&quot;M -160 44 c 30 0 58 -18 88 -18...&quot;</code>：定义波浪路径</li></ul><h3 id="CSS动画样式">CSS动画样式</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span></span><br><span class="line">  <span class="attribute">animation</span> move-forever <span class="number">30s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">55</span>, .<span class="number">5</span>, .<span class="number">45</span>, .<span class="number">5</span>) infinite</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">2s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">7s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">5</span></span><br></pre></td></tr></table></figure><p><strong>关键参数说明：</strong></p><ul><li><code>animation move-forever 30s</code>：使用move-forever动画，持续30秒</li><li><code>cubic-bezier(.55, .5, .45, .5)</code>：缓动函数，创建平滑的动画效果</li><li><code>animation-delay -2s</code>：动画延迟2秒开始</li><li><code>animation-duration 7s</code>：动画持续7秒</li><li><code>fill var(--efu-background)</code>：填充颜色使用主题背景色</li></ul><h3 id="动画定义">动画定义</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> move-forever</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translate3d</span>(-<span class="number">90px</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  <span class="number">100%</span></span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">translate3d</span>(<span class="number">85px</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><strong>关键参数说明：</strong></p><ul><li><code>translate3d(-90px, 0, 0)</code>：初始位置，向左偏移90px</li><li><code>translate3d(85px, 0, 0)</code>：结束位置，向右偏移85px</li><li>使用3D变换提高性能</li></ul><h2 id="自定义扩展">自定义扩展</h2><h3 id="1-调整波浪线颜色">1. 调整波浪线颜色</h3><p>如果想要自定义波浪线颜色，可以修改fill属性：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">2s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">7s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="number">#4a90e2</span>  // 自定义颜色</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">5</span></span><br></pre></td></tr></table></figure><h3 id="2-调整波浪线高度">2. 调整波浪线高度</h3><p>如果想要调整波浪线的高度，可以修改SVG的viewBox：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svg.waves-svg(xmlns=&quot;http://www.w3.org/2000/svg&quot;, xlink=&quot;http://www.w3.org/1999/xlink&quot;, viewBox=&quot;0 24 150 40&quot;, preserveAspectRatio=&quot;none&quot;, shape-rendering=&quot;auto&quot;)</span><br></pre></td></tr></table></figure><h3 id="3-调整动画速度">3. 调整动画速度</h3><p>如果想要调整动画速度，可以修改动画持续时间：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span></span><br><span class="line">  <span class="attribute">animation</span> move-forever <span class="number">20s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">55</span>, .<span class="number">5</span>, .<span class="number">45</span>, .<span class="number">5</span>) infinite  // 从<span class="number">30s</span>改为<span class="number">20s</span></span><br></pre></td></tr></table></figure><h3 id="4-添加更多波浪层">4. 添加更多波浪层</h3><p>如果想要添加更多波浪层，可以在SVG中添加更多use元素：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g.parallax</span><br><span class="line">    use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;0&quot;)</span><br><span class="line">    use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;3&quot;)</span><br><span class="line">    use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;5&quot;)</span><br><span class="line">    use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;7&quot;)</span><br><span class="line">    use(href=&quot;#gentle-wave&quot;, x=&quot;48&quot;, y=&quot;9&quot;)  // 添加第五层</span><br></pre></td></tr></table></figure><p>然后在CSS中添加对应的样式：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parallax</span> &gt; <span class="selector-tag">use</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>)</span><br><span class="line">  <span class="attribute">animation-delay</span> -<span class="number">6s</span></span><br><span class="line">  <span class="attribute">animation-duration</span> <span class="number">25s</span></span><br><span class="line">  <span class="attribute">fill</span> <span class="built_in">var</span>(--efu-background)</span><br><span class="line">  <span class="attribute">opacity</span> .<span class="number">9</span></span><br></pre></td></tr></table></figure><h2 id="效果对比">效果对比</h2><h3 id="修改前">修改前</h3><ul><li>❌ 使用简单的圆角矩形分隔线</li><li>❌ 静态效果，无动画</li><li>❌ 视觉效果较为单调</li></ul><h3 id="修改后">修改后</h3><ul><li>✅ 使用动态的SVG波浪线</li><li>✅ 多层波浪，不同延迟和持续时间</li><li>✅ 视觉效果更加生动美观</li><li>✅ 与主题背景色自动适配</li></ul><h2 id="技术要点">技术要点</h2><h3 id="SVG路径定义">SVG路径定义</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path#gentle-wave(d=&quot;M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z&quot;)</span><br></pre></td></tr></table></figure><p><strong>路径命令说明：</strong></p><ul><li><code>M -160 44</code>：移动到起始点</li><li><code>c 30 0 58 -18 88 -18</code>：三次贝塞尔曲线</li><li><code>s 58 18 88 18</code>：平滑三次贝塞尔曲线</li><li><code>v 44</code>：垂直向下移动44单位</li><li><code>h -352</code>：水平向左移动352单位</li><li><code>Z</code>：闭合路径</li></ul><h3 id="CSS动画优化">CSS动画优化</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">animation</span> move-forever <span class="number">30s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">55</span>, .<span class="number">5</span>, .<span class="number">45</span>, .<span class="number">5</span>) infinite</span><br></pre></td></tr></table></figure><p><strong>优化要点：</strong></p><ul><li>使用<code>cubic-bezier</code>缓动函数创建平滑动画</li><li>使用<code>translate3d</code>启用硬件加速</li><li>设置<code>infinite</code>实现无限循环</li></ul><h3 id="响应式设计">响应式设计</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+<span class="built_in">maxWidth768</span>()</span><br><span class="line">  <span class="attribute">display</span> none</span><br></pre></td></tr></table></figure><p><strong>响应式处理：</strong></p><ul><li>在移动端隐藏波浪线效果</li><li>避免在小屏幕上影响性能</li><li>保持移动端的简洁性</li></ul><h2 id="注意事项">注意事项</h2><ol><li><p><strong>文件位置</strong>：</p><ul><li>修改的是 <code>node_modules</code> 中的文件</li><li>重新安装依赖时会丢失修改</li><li>建议备份修改后的文件</li></ul></li><li><p><strong>性能考虑</strong>：</p><ul><li>SVG动画在低端设备上可能影响性能</li><li>建议在移动端禁用波浪线效果</li><li>可以根据设备性能动态调整</li></ul></li><li><p><strong>兼容性</strong>：</p><ul><li>SVG动画需要现代浏览器支持</li><li>某些老旧浏览器可能显示异常</li><li>建议添加降级方案</li></ul></li><li><p><strong>主题适配</strong>：</p><ul><li>波浪线颜色使用主题变量</li><li>自动适配明暗主题切换</li><li>保持与整体设计风格一致</li></ul></li></ol><h2 id="故障排除">故障排除</h2><h3 id="常见问题">常见问题</h3><ol><li><p><strong>波浪线不显示</strong></p><ul><li>检查SVG文件是否正确创建</li><li>确认postMeta.pug中已引入wave.pug</li><li>检查CSS样式是否正确加载</li></ul></li><li><p><strong>动画不流畅</strong></p><ul><li>检查动画定义是否正确</li><li>确认浏览器支持CSS动画</li><li>考虑降低动画复杂度</li></ul></li><li><p><strong>颜色不匹配</strong></p><ul><li>确认使用主题变量<code>var(--efu-background)</code></li><li>检查主题色值是否正确</li><li>测试明暗主题切换效果</li></ul></li><li><p><strong>间距不合适</strong></p><ul><li>调整文章容器的padding值</li><li>修改侧边栏的margin值</li><li>平衡视觉效果和内容可读性</li></ul></li></ol><h3 id="调试方法">调试方法</h3><ol><li><p><strong>浏览器开发者工具</strong>：</p><ul><li>检查元素是否正确渲染</li><li>查看CSS样式是否生效</li><li>监控动画性能</li></ul></li><li><p><strong>控制台日志</strong>：</p><ul><li>检查是否有JavaScript错误</li><li>确认文件路径是否正确</li><li>验证依赖是否正确加载</li></ul></li></ol><h2 id="总结">总结</h2><p>通过这次修改，我们成功将Solitude主题文章页面的静态分隔线升级为动态的波浪线效果。这个修改不仅提升了视觉效果，还增加了页面的生动性和交互感。</p><p>关键是要理解SVG路径的定义、CSS动画的原理和响应式设计的考虑。同时要注意保持代码的简洁性和功能的完整性，确保在不同设备和浏览器上都能正常显示。</p><p>希望这个教程能帮助用户更好地个性化自己的Hexo博客主题，创造出更加美观和独特的文章页面效果。</p><h2 id="相关链接">相关链接</h2><ul><li><a href="https://solitude.js.org/">Solitude主题官方文档</a></li><li><a href="https://hexo.io/">Hexo官方文档</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths">SVG路径教程</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations">CSS动画指南</a></li><li><a href="https://pugjs.org/api/getting-started.html">Pug模板语法</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 动画效果 </tag>
            
            <tag> CSS </tag>
            
            <tag> SVG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(3)-ASCII码自定义修改</title>
      <link href="/2024/09/16/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(3)-ASCII%E7%A0%81%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%AE%E6%94%B9/"/>
      <url>/2024/09/16/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(3)-ASCII%E7%A0%81%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%AE%E6%94%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在使用Solitude主题时，每次运行Hexo命令都会在终端显示主题的ASCII码Logo。新版本使用的是简单的圆点符号，而老版本使用的是更美观的Unicode字符。本教程将详细介绍如何自定义ASCII码显示，让终端启动界面更加个性化。</p><h2 id="问题描述">问题描述</h2><h3 id="现象">现象</h3><ul><li>运行 <code>hexo clean</code>、<code>hexo generate</code>、<code>hexo server</code> 等命令时</li><li>终端会显示Solitude主题的ASCII码Logo</li><li>新版本显示的是简单的圆点符号样式</li><li>老版本显示的是更美观的Unicode字符样式</li></ul><h3 id="当前版本显示效果">当前版本显示效果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=====================[ Hexo Theme - Solitude ]=====================</span><br><span class="line">       ●●●●●  ●●●●  ●     ●●●●●  ●●●●●● ●     ● ●●●●●●   ●●●●●●</span><br><span class="line">      ●      ●    ● ●       ●      ●    ●     ● ●      ● ●</span><br><span class="line">       ●●●●● ●    ● ●       ●      ●    ●     ● ●      ● ●●●●●●</span><br><span class="line">           ● ●    ● ●       ●      ●    ●     ● ●      ● ●</span><br><span class="line">      ●●●●●●  ●●●●  ●●●●● ●●●●●    ●      ●●●   ●●●●●●   ●●●●●●</span><br><span class="line">                         version: 3.0.19</span><br><span class="line">===================================================================</span><br><span class="line">         GitHub: https://github.com/everfu/hexo-theme-solitude</span><br></pre></td></tr></table></figure><h3 id="期望效果">期望效果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">===================================================================</span><br><span class="line">        ███████╗██╗   ██╗███╗   ███╗███╗   ███╗███████╗██████╗ </span><br><span class="line">        ██╔════╝██║   ██║████╗ ████║████╗ ████║██╔════╝██╔══██╗</span><br><span class="line">        ███████╗██║   ██║██╔████╔██║██╔████╔██║█████╗  ██████╔╝</span><br><span class="line">        ╚════██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██╔══██╗</span><br><span class="line">        ███████║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║  ██║</span><br><span class="line">        ╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝</span><br><span class="line">                            version: 3.0.19</span><br><span class="line">===================================================================</span><br><span class="line">GitHub: https://github.com/everfu/hexo-theme-solitude</span><br></pre></td></tr></table></figure><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><p>通过对比新版本和老版本的代码实现，发现了关键差异：</p><h4 id="新版本（当前实现）：">新版本（当前实现）：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> logo = <span class="string">`</span></span><br><span class="line"><span class="string">       #####  ####  #     #####  ###### #     # ######   ######</span></span><br><span class="line"><span class="string">      #      #    # #       #      #    #     # #      # #</span></span><br><span class="line"><span class="string">       ##### #    # #       #      #    #     # #      # ######</span></span><br><span class="line"><span class="string">           # #    # #       #      #    #     # #      # #</span></span><br><span class="line"><span class="string">      ######  ####  ##### #####    #      ###   ######   ######</span></span><br><span class="line"><span class="string">    `</span>.<span class="title function_">replace</span>(<span class="regexp">/#/g</span>, <span class="string">&#x27;●&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> message = <span class="string">`</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m=====================[ Hexo Theme - Solitude ]=====================\x1b[0m</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m<span class="subst">$&#123;logo&#125;</span>\x1b[0m</span></span><br><span class="line"><span class="string">                         \x1b[38;5;45m version: <span class="subst">$&#123;version&#125;</span>\x1b[0m</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m===================================================================\x1b[0m</span></span><br><span class="line"><span class="string">         \x1b[38;5;45mGitHub: https://github.com/everfu/hexo-theme-solitude\x1b[0m</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">    hexo.<span class="property">log</span>.<span class="title function_">info</span>(message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="老版本（期望的实现）：">老版本（期望的实现）：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line">    hexo.<span class="property">log</span>.<span class="title function_">info</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  =====================[ Hexo Theme - Solitude ]=====================</span></span><br><span class="line"><span class="string">        ███████╗██╗   ██╗███╗   ███╗███╗   ███╗███████╗██████╗ </span></span><br><span class="line"><span class="string">        ██╔════╝██║   ██║████╗ ████║████╗ ████║██╔════╝██╔══██╗</span></span><br><span class="line"><span class="string">        ███████╗██║   ██║██╔████╔██║██╔████╔██║█████╗  ██████╔╝</span></span><br><span class="line"><span class="string">        ╚════██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██╔══██╗</span></span><br><span class="line"><span class="string">        ███████║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║  ██║</span></span><br><span class="line"><span class="string">        ╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝</span></span><br><span class="line"><span class="string">                            <span class="subst">$&#123;version&#125;</span></span></span><br><span class="line"><span class="string">  ===================================================================</span></span><br><span class="line"><span class="string">  GitHub: https://github.com/everfu/hexo-theme-solitude</span></span><br><span class="line"><span class="string">  `</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="关键差异">关键差异</h3><ol><li><p><strong>字符样式不同</strong>：</p><ul><li>新版本：使用 <code>#</code> 字符 + <code>.replace(/#/g, '●')</code> 替换为圆点</li><li>老版本：直接使用Unicode字符 <code>█</code>、<code>╗</code>、<code>║</code> 等</li></ul></li><li><p><strong>颜色处理不同</strong>：</p><ul><li>新版本：使用ANSI颜色代码 <code>\x1b[38;5;45m</code> 和 <code>\x1b[0m</code></li><li>老版本：不使用颜色代码，保持默认颜色</li></ul></li><li><p><strong>布局结构不同</strong>：</p><ul><li>新版本：使用模板字符串拼接</li><li>老版本：使用多行字符串直接定义</li></ul></li></ol><h2 id="解决方案">解决方案</h2><h3 id="修改文件清单">修改文件清单</h3><ul><li><code>node_modules/hexo-theme-solitude/scripts/event/welcome.js</code> - 主题欢迎脚本文件</li></ul><h3 id="详细修改步骤">详细修改步骤</h3><h4 id="1-定位文件">1. 定位文件</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/scripts/event/welcome.js</code></p><p><strong>文件作用：</strong> 控制Hexo启动时终端显示的ASCII码Logo</p><h4 id="2-备份原文件">2. 备份原文件</h4><p>在修改前，建议备份原文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> node_modules/hexo-theme-solitude/scripts/event/welcome.js node_modules/hexo-theme-solitude/scripts/event/welcome.js.backup</span><br></pre></td></tr></table></figure><h4 id="3-修改文件内容">3. 修改文件内容</h4><p><strong>修改前：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> logo = <span class="string">`</span></span><br><span class="line"><span class="string">       #####  ####  #     #####  ###### #     # ######   ######</span></span><br><span class="line"><span class="string">      #      #    # #       #      #    #     # #      # #</span></span><br><span class="line"><span class="string">       ##### #    # #       #      #    #     # #      # ######</span></span><br><span class="line"><span class="string">           # #    # #       #      #    #     # #      # #</span></span><br><span class="line"><span class="string">      ######  ####  ##### #####    #      ###   ######   ######</span></span><br><span class="line"><span class="string">    `</span>.<span class="title function_">replace</span>(<span class="regexp">/#/g</span>, <span class="string">&#x27;●&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> message = <span class="string">`</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m=====================[ Hexo Theme - Solitude ]=====================\x1b[0m</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m<span class="subst">$&#123;logo&#125;</span>\x1b[0m</span></span><br><span class="line"><span class="string">                         \x1b[38;5;45m version: <span class="subst">$&#123;version&#125;</span>\x1b[0m</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m===================================================================\x1b[0m</span></span><br><span class="line"><span class="string">         \x1b[38;5;45mGitHub: https://github.com/everfu/hexo-theme-solitude\x1b[0m</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">    hexo.<span class="property">log</span>.<span class="title function_">info</span>(message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line">    hexo.<span class="property">log</span>.<span class="title function_">info</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  ===================================================================</span></span><br><span class="line"><span class="string">        ███████╗██╗   ██╗███╗   ███╗███╗   ███╗███████╗██████╗ </span></span><br><span class="line"><span class="string">        ██╔════╝██║   ██║████╗ ████║████╗ ████║██╔════╝██╔══██╗</span></span><br><span class="line"><span class="string">        ███████╗██║   ██║██╔████╔██║██╔████╔██║█████╗  ██████╔╝</span></span><br><span class="line"><span class="string">        ╚════██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██╔══██╗</span></span><br><span class="line"><span class="string">        ███████║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║  ██║</span></span><br><span class="line"><span class="string">        ╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝</span></span><br><span class="line"><span class="string">                            <span class="subst">$&#123;version&#125;</span></span></span><br><span class="line"><span class="string">  ===================================================================</span></span><br><span class="line"><span class="string">  GitHub: https://github.com/everfu/hexo-theme-solitude</span></span><br><span class="line"><span class="string">  `</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="修改说明">修改说明</h3><ol><li><p><strong>移除颜色代码</strong>：</p><ul><li>删除 <code>\x1b[38;5;45m</code> 和 <code>\x1b[0m</code> 颜色控制代码</li><li>使用默认终端颜色，提高兼容性</li></ul></li><li><p><strong>替换字符样式</strong>：</p><ul><li>将圆点符号 <code>●</code> 替换为Unicode字符</li><li>使用 <code>█</code>、<code>╗</code>、<code>║</code>、<code>╝</code>、<code>╚</code> 等字符创建更美观的Logo</li></ul></li><li><p><strong>简化代码结构</strong>：</p><ul><li>移除 <code>logo</code> 变量和 <code>message</code> 变量</li><li>直接使用 <code>hexo.log.info()</code> 输出多行字符串</li></ul></li><li><p><strong>保持功能完整</strong>：</p><ul><li>保留版本号显示 <code>$&#123;version&#125;</code></li><li>保留GitHub链接信息</li></ul></li></ol><h2 id="自定义扩展">自定义扩展</h2><h3 id="1-使用在线ASCII生成器">1. 使用在线ASCII生成器</h3><p>如果想要使用其他样式的ASCII码，可以使用在线工具：</p><p><strong>推荐网站：</strong></p><ul><li><a href="https://patorjk.com/software/taag/">ASCII Art Generator</a></li><li><a href="https://www.ascii-art-generator.org/">Text to ASCII Art Generator</a></li></ul><p><strong>使用步骤：</strong></p><ol><li>访问ASCII生成器网站</li><li>输入 “SOLITUDE” 或其他文字</li><li>选择合适的字体样式</li><li>复制生成的ASCII码</li><li>替换到welcome.js文件中</li></ol><h3 id="2-添加颜色支持">2. 添加颜色支持</h3><p>如果想要保持颜色效果，可以这样修改：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line">    hexo.<span class="property">log</span>.<span class="title function_">info</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m===================================================================\x1b[0m</span></span><br><span class="line"><span class="string">        \x1b[38;5;45m███████╗██╗   ██╗███╗   ███╗███╗   ███╗███████╗██████╗ \x1b[0m</span></span><br><span class="line"><span class="string">        \x1b[38;5;45m██╔════╝██║   ██║████╗ ████║████╗ ████║██╔════╝██╔══██╗\x1b[0m</span></span><br><span class="line"><span class="string">        \x1b[38;5;45m███████╗██║   ██║██╔████╔██║██╔████╔██║█████╗  ██████╔╝\x1b[0m</span></span><br><span class="line"><span class="string">        \x1b[38;5;45m╚════██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██╔══██╗\x1b[0m</span></span><br><span class="line"><span class="string">        \x1b[38;5;45m███████║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║  ██║\x1b[0m</span></span><br><span class="line"><span class="string">        \x1b[38;5;45m╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝\x1b[0m</span></span><br><span class="line"><span class="string">                            \x1b[38;5;45m<span class="subst">$&#123;version&#125;</span>\x1b[0m</span></span><br><span class="line"><span class="string">  \x1b[38;5;45m===================================================================\x1b[0m</span></span><br><span class="line"><span class="string">         \x1b[38;5;45mGitHub: https://github.com/everfu/hexo-theme-solitude\x1b[0m</span></span><br><span class="line"><span class="string">  `</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-添加动画效果">3. 添加动画效果</h3><p>如果想要添加简单的动画效果，可以使用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 简单的加载动画</span></span><br><span class="line">    <span class="keyword">const</span> frames = [<span class="string">&#x27;⠋&#x27;</span>, <span class="string">&#x27;⠙&#x27;</span>, <span class="string">&#x27;⠹&#x27;</span>, <span class="string">&#x27;⠸&#x27;</span>, <span class="string">&#x27;⠼&#x27;</span>, <span class="string">&#x27;⠴&#x27;</span>, <span class="string">&#x27;⠦&#x27;</span>, <span class="string">&#x27;⠧&#x27;</span>, <span class="string">&#x27;⠇&#x27;</span>, <span class="string">&#x27;⠏&#x27;</span>]</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> interval = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        process.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">`\r<span class="subst">$&#123;frames[i]&#125;</span> Loading Solitude Theme...`</span>)</span><br><span class="line">        i = (i + <span class="number">1</span>) % frames.<span class="property">length</span></span><br><span class="line">    &#125;, <span class="number">80</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(interval)</span><br><span class="line">        process.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">        hexo.<span class="property">log</span>.<span class="title function_">info</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  ===================================================================</span></span><br><span class="line"><span class="string">        ███████╗██╗   ██╗███╗   ███╗███╗   ███╗███████╗██████╗ </span></span><br><span class="line"><span class="string">        ██╔════╝██║   ██║████╗ ████║████╗ ████║██╔════╝██╔══██╗</span></span><br><span class="line"><span class="string">        ███████╗██║   ██║██╔████╔██║██╔████╔██║█████╗  ██████╔╝</span></span><br><span class="line"><span class="string">        ╚════██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██╔══██╗</span></span><br><span class="line"><span class="string">        ███████║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║  ██║</span></span><br><span class="line"><span class="string">        ╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝</span></span><br><span class="line"><span class="string">                            <span class="subst">$&#123;version&#125;</span></span></span><br><span class="line"><span class="string">  ===================================================================</span></span><br><span class="line"><span class="string">  GitHub: https://github.com/everfu/hexo-theme-solitude</span></span><br><span class="line"><span class="string">  `</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="效果对比">效果对比</h2><h3 id="修改前">修改前</h3><ul><li>❌ 使用简单的圆点符号</li><li>❌ 颜色代码可能在某些终端不兼容</li><li>❌ 视觉效果较为单调</li></ul><h3 id="修改后">修改后</h3><ul><li>✅ 使用美观的Unicode字符</li><li>✅ 兼容性更好，不依赖颜色代码</li><li>✅ 视觉效果更加专业</li><li>✅ 保持功能完整性</li></ul><h2 id="技术要点">技术要点</h2><h3 id="Unicode字符的使用">Unicode字符的使用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常用的Unicode字符</span></span><br><span class="line"><span class="string">&#x27;█&#x27;</span>  <span class="comment">// 实心方块</span></span><br><span class="line"><span class="string">&#x27;╗&#x27;</span>  <span class="comment">// 右上角</span></span><br><span class="line"><span class="string">&#x27;║&#x27;</span>  <span class="comment">// 竖线</span></span><br><span class="line"><span class="string">&#x27;╝&#x27;</span>  <span class="comment">// 右下角</span></span><br><span class="line"><span class="string">&#x27;╚&#x27;</span>  <span class="comment">// 左下角</span></span><br><span class="line"><span class="string">&#x27;═&#x27;</span>  <span class="comment">// 双横线</span></span><br></pre></td></tr></table></figure><h3 id="多行字符串的格式化">多行字符串的格式化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">log</span>.<span class="title function_">info</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  第一行内容</span></span><br><span class="line"><span class="string">  第二行内容</span></span><br><span class="line"><span class="string">  第三行内容</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure><h3 id="版本号动态获取">版本号动态获取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; version &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>)</span><br><span class="line"><span class="comment">// 自动获取主题版本号</span></span><br></pre></td></tr></table></figure><h2 id="注意事项">注意事项</h2><ol><li><p><strong>文件位置</strong>：</p><ul><li>修改的是 <code>node_modules</code> 中的文件</li><li>重新安装依赖时会丢失修改</li><li>建议备份修改后的文件</li></ul></li><li><p><strong>字符编码</strong>：</p><ul><li>确保终端支持Unicode字符显示</li><li>某些老旧终端可能显示异常</li></ul></li><li><p><strong>兼容性</strong>：</p><ul><li>移除颜色代码提高兼容性</li><li>在不同操作系统下测试效果</li></ul></li><li><p><strong>备份建议</strong>：</p><ul><li>修改前备份原文件</li><li>记录修改内容便于恢复</li></ul></li></ol><h2 id="总结">总结</h2><p>通过这次修改，我们成功将Solitude主题的ASCII码Logo从简单的圆点符号升级为美观的Unicode字符样式。这个修改不仅提升了视觉效果，还提高了终端显示的兼容性。</p><p>关键是要理解ASCII码的生成原理和Unicode字符的使用方法，同时要注意保持代码的简洁性和功能的完整性。希望这个教程能帮助用户更好地个性化自己的Hexo博客主题。</p><h2 id="相关链接">相关链接</h2><ul><li><a href="https://solitude.js.org/">Solitude主题官方文档</a></li><li><a href="https://hexo.io/">Hexo官方文档</a></li><li><a href="https://patorjk.com/software/taag/">ASCII Art Generator</a></li><li><a href="https://unicode-table.com/">Unicode字符表</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> ASCII </tag>
            
            <tag> 终端美化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(2)-背景图片透明度问题修复</title>
      <link href="/2024/09/09/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(2)-%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87%E9%80%8F%E6%98%8E%E5%BA%A6%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D/"/>
      <url>/2024/09/09/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(2)-%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87%E9%80%8F%E6%98%8E%E5%BA%A6%E9%97%AE%E9%A2%98%E4%BF%AE%E5%A4%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在使用Solitude主题的新版本时，发现背景图片功能存在透明度问题：当开启背景功能并设置透明度时，不仅背景图片变透明，整个页面的内容也跟着变透明了。本教程将详细分析这个问题的原因，并提供正确的解决方案。</p><h2 id="问题描述">问题描述</h2><h3 id="现象">现象</h3><ul><li>开启背景功能后，设置透明度（如 <code>opacity: 0.5</code>）</li><li>背景图片正确显示，但页面内容（文字、卡片等）也变透明了</li><li>老版本中只有背景图片变透明，页面内容保持不透明</li></ul><h3 id="影响">影响</h3><ol><li><strong>可读性降低</strong>：页面内容变透明导致文字难以阅读</li><li><strong>用户体验差</strong>：视觉效果不符合预期</li><li><strong>功能异常</strong>：背景功能无法正常使用</li></ol><h2 id="问题分析">问题分析</h2><h3 id="根本原因">根本原因</h3><p>通过对比老版本和新版本的CSS实现，发现了关键差异：</p><h4 id="老版本（正确的实现）：">老版本（正确的实现）：</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.enable&#x27;</span>)</span><br><span class="line">  <span class="selector-id">#global_bg</span></span><br><span class="line">    <span class="attribute">position</span> fixed</span><br><span class="line">    <span class="attribute">z-index</span> -<span class="number">1</span> // 将背景放到所有内容之下</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">pointer-events</span> none</span><br><span class="line">    <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;background.light&#x27;</span>))</span><br><span class="line">      <span class="attribute">background-size</span> cover</span><br><span class="line">      <span class="attribute">background-position</span> center</span><br><span class="line">      <span class="attribute">background-repeat</span> no-repeat</span><br><span class="line">      <span class="attribute">opacity</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.opacity&#x27;</span>) // 背景透明度独立</span><br><span class="line">      <span class="attribute">transition</span> opacity <span class="number">0.3s</span> ease</span><br></pre></td></tr></table></figure><h4 id="新版本（有问题的实现）：">新版本（有问题的实现）：</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.enable&#x27;</span>)</span><br><span class="line">  <span class="selector-id">#global_bg</span></span><br><span class="line">    <span class="attribute">position</span> fixed</span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">999</span> // 背景层级太高</span><br><span class="line">    <span class="attribute">opacity</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.opacity&#x27;</span>) // 整个元素都透明了</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;background.light&#x27;</span>))</span><br><span class="line">    <span class="attribute">background-size</span> cover</span><br><span class="line">    <span class="attribute">background-position</span> center</span><br><span class="line">    <span class="attribute">pointer-events</span> none</span><br><span class="line">    <span class="attribute">background-repeat</span> no-repeat</span><br></pre></td></tr></table></figure><h3 id="关键差异">关键差异</h3><ol><li><p><strong>z-index层级错误</strong>：</p><ul><li>老版本：<code>z-index: -1</code>（背景在内容下方）</li><li>新版本：<code>z-index: 999</code>（背景在内容上方）</li></ul></li><li><p><strong>透明度应用位置错误</strong>：</p><ul><li>老版本：只对 <code>::before</code> 伪元素应用透明度</li><li>新版本：对整个背景元素应用透明度</li></ul></li><li><p><strong>实现方式不同</strong>：</p><ul><li>老版本：使用 <code>::before</code> 伪元素设置背景</li><li>新版本：直接设置背景</li></ul></li></ol><h2 id="解决方案">解决方案</h2><h3 id="修改文件清单">修改文件清单</h3><ul><li><code>node_modules/hexo-theme-solitude/source/css/_global/index.styl</code> - 主题CSS文件</li><li><code>_config.solitude.yml</code> - 主题配置文件</li></ul><h3 id="详细修改步骤">详细修改步骤</h3><h4 id="1-修改CSS文件">1. 修改CSS文件</h4><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/source/css/_global/index.styl</code></p><p><strong>修改位置：</strong> 背景相关的CSS代码（约第446行）</p><p><strong>修改前：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.enable&#x27;</span>)</span><br><span class="line">  <span class="selector-id">#global_bg</span></span><br><span class="line">    <span class="attribute">position</span> fixed</span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">999</span></span><br><span class="line">    <span class="attribute">opacity</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.opacity&#x27;</span>)</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;background.light&#x27;</span>))</span><br><span class="line">    <span class="attribute">background-size</span> cover</span><br><span class="line">    <span class="attribute">background-position</span> center</span><br><span class="line">    <span class="attribute">pointer-events</span> none</span><br><span class="line">    <span class="attribute">background-repeat</span> no-repeat</span><br><span class="line"></span><br><span class="line">    <span class="selector-attr">[data-theme=dark]</span> &amp;</span><br><span class="line">      <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;background.dark&#x27;</span>))</span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.enable&#x27;</span>)</span><br><span class="line">  <span class="selector-id">#global_bg</span></span><br><span class="line">    <span class="attribute">position</span> fixed</span><br><span class="line">    <span class="attribute">z-index</span> -<span class="number">1</span> // 将背景放到所有内容之下</span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">pointer-events</span> none</span><br><span class="line">    <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;background.light&#x27;</span>)) // 默认背景图片</span><br><span class="line">      <span class="attribute">background-size</span> cover</span><br><span class="line">      <span class="attribute">background-position</span> center</span><br><span class="line">      <span class="attribute">background-repeat</span> no-repeat</span><br><span class="line">      <span class="attribute">opacity</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.opacity&#x27;</span>) // 背景透明度独立</span><br><span class="line">      <span class="attribute">transition</span> opacity <span class="number">0.3s</span> ease // 添加平滑过渡效果</span><br><span class="line"></span><br><span class="line">    <span class="selector-attr">[data-theme=dark]</span> <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">      <span class="attribute">background-image</span> <span class="built_in">url</span>(<span class="built_in">hexo-config</span>(<span class="string">&#x27;background.dark&#x27;</span>)) // 暗色模式背景图片</span><br></pre></td></tr></table></figure><h4 id="2-修改配置文件">2. 修改配置文件</h4><p><strong>文件路径：</strong> <code>_config.solitude.yml</code></p><p><strong>修改位置：</strong> <code>background</code> 部分</p><p><strong>修改前：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">background:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">.5</span></span><br><span class="line">  <span class="attr">dark:</span> <span class="string">https://i.imgur.com/aX0Isw8.png</span></span><br><span class="line">  <span class="attr">light:</span> <span class="string">https://i.imgur.com/P6NLpMD.jpeg</span></span><br></pre></td></tr></table></figure><p><strong>修改后：</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">background:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span></span><br><span class="line">  <span class="attr">dark:</span> <span class="string">https://i.imgur.com/aX0Isw8.png</span></span><br><span class="line">  <span class="attr">light:</span> <span class="string">https://i.imgur.com/P6NLpMD.jpeg</span></span><br></pre></td></tr></table></figure><h3 id="修改说明">修改说明</h3><ol><li><p><strong>z-index调整</strong>：</p><ul><li>从 <code>999</code> 改为 <code>-1</code>，确保背景在页面内容下方</li></ul></li><li><p><strong>使用伪元素</strong>：</p><ul><li>改用 <code>::before</code> 伪元素来设置背景</li><li>只对背景图片应用透明度，不影响页面内容</li></ul></li><li><p><strong>添加过渡效果</strong>：</p><ul><li>增加 <code>transition opacity 0.3s ease</code> 实现平滑的透明度变化</li></ul></li><li><p><strong>开启背景功能</strong>：</p><ul><li>将 <code>enable</code> 设置为 <code>true</code></li></ul></li></ol><h2 id="效果对比">效果对比</h2><h3 id="修改前">修改前</h3><ul><li>❌ 页面内容变透明</li><li>❌ 文字难以阅读</li><li>❌ 背景层级错误</li></ul><h3 id="修改后">修改后</h3><ul><li>✅ 只有背景图片变透明</li><li>✅ 页面内容保持不透明</li><li>✅ 文字清晰可读</li><li>✅ 背景正确显示在内容下方</li></ul><h2 id="技术要点">技术要点</h2><h3 id="CSS伪元素的使用">CSS伪元素的使用</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">&amp;::before</span></span><br><span class="line">  <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span>           // 创建伪元素</span><br><span class="line">  <span class="attribute">position</span> absolute    // 绝对定位</span><br><span class="line">  <span class="attribute">opacity</span> <span class="number">0.5</span>         // 只对背景应用透明度</span><br></pre></td></tr></table></figure><h3 id="z-index层级管理">z-index层级管理</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">z-index</span> -<span class="number">1</span>            // 确保背景在最底层</span><br></pre></td></tr></table></figure><h3 id="透明度独立控制">透明度独立控制</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">opacity</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;background.opacity&#x27;</span>)  // 只影响背景图片</span><br></pre></td></tr></table></figure><h2 id="总结">总结</h2><p>通过这次修改，我们成功解决了Solitude主题新版本中背景图片透明度的问题。关键是要理解CSS中层级和透明度的应用方式，确保背景图片的透明度只影响背景本身，而不影响页面内容。</p><p>这种修改方式保持了与老版本的兼容性，同时提供了更好的用户体验。希望这个教程能帮助遇到类似问题的用户快速解决问题。</p><h2 id="相关链接">相关链接</h2><ul><li><a href="https://solitude.js.org/">Solitude主题官方文档</a></li><li><a href="https://hexo.io/">Hexo官方文档</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Pseudo-elements">CSS伪元素教程</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solitude主题魔改教程(1)-首页右侧推荐卡片支持视频显示</title>
      <link href="/2024/09/02/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(1)-%E9%A6%96%E9%A1%B5%E5%8F%B3%E4%BE%A7%E6%8E%A8%E8%8D%90%E5%8D%A1%E7%89%87%E6%94%AF%E6%8C%81%E8%A7%86%E9%A2%91%E6%98%BE%E7%A4%BA/"/>
      <url>/2024/09/02/Solitude%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B(1)-%E9%A6%96%E9%A1%B5%E5%8F%B3%E4%BE%A7%E6%8E%A8%E8%8D%90%E5%8D%A1%E7%89%87%E6%94%AF%E6%8C%81%E8%A7%86%E9%A2%91%E6%98%BE%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>在Solitude主题中，首页的推荐卡片（recommendList）默认只支持图片背景。本教程将介绍如何扩展这个功能，使其支持视频背景，让推荐卡片更加生动有趣。</p><h2 id="修改理由">修改理由</h2><ol><li><strong>增强视觉效果</strong>：视频比静态图片更能吸引用户注意力</li><li><strong>提升用户体验</strong>：动态内容让网站更加现代化</li><li><strong>保持兼容性</strong>：保留原有的图片功能，同时添加视频支持</li><li><strong>灵活配置</strong>：通过配置文件轻松切换图片/视频模式</li></ol><h2 id="修改文件清单">修改文件清单</h2><ul><li><code>_config.solitude.yml</code> - 主题配置文件</li><li><code>node_modules/hexo-theme-solitude/layout/includes/widgets/home/topGroup.pug</code> - 推荐卡片模板文件</li></ul><h2 id="详细修改步骤">详细修改步骤</h2><h3 id="1-修改配置文件">1. 修改配置文件</h3><p><strong>文件路径：</strong> <code>_config.solitude.yml</code></p><p><strong>修改位置：</strong> <code>hometop.recommendList</code> 部分</p><h4 id="修改前：">修改前：</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">recommendList:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sup:</span> <span class="string">置顶</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Solitude</span> <span class="string">官方文档</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://solitude.js.org/</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/default.avif</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure><h4 id="修改后：">修改后：</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例配置：</span></span><br><span class="line"><span class="comment"># 图片模式：</span></span><br><span class="line"><span class="comment">#   type: image</span></span><br><span class="line"><span class="comment">#   img: /img/default.avif</span></span><br><span class="line"><span class="comment">#   media: (留空)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 视频模式：</span></span><br><span class="line"><span class="comment">#   type: video</span></span><br><span class="line"><span class="comment">#   img: (可选，作为视频加载失败时的备用图片)</span></span><br><span class="line"><span class="comment">#   media: /mp4/recommend-banner/recommend-banner7.mp4</span></span><br><span class="line"><span class="attr">recommendList:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sup:</span> <span class="string">置顶</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Solitude</span> <span class="string">官方文档</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://solitude.js.org/</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/default.avif</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">video</span> <span class="comment"># image / video</span></span><br><span class="line">  <span class="attr">media:</span> <span class="string">/mp4/recommend-banner/recommend-banner7.mp4</span> <span class="comment"># 视频文件路径，当type为video时使用，例如：/mp4/recommend-banner/recommend-banner7.mp4</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure><h4 id="配置说明：">配置说明：</h4><ul><li><code>type</code>: 设置显示类型，支持 <code>image</code>（图片）和 <code>video</code>（视频）</li><li><code>media</code>: 当 <code>type</code> 为 <code>video</code> 时，指定视频文件路径</li><li><code>img</code>: 图片路径，在图片模式下使用，视频模式下可作为备用图片</li></ul><h3 id="2-修改模板文件">2. 修改模板文件</h3><p><strong>文件路径：</strong> <code>node_modules/hexo-theme-solitude/layout/includes/widgets/home/topGroup.pug</code></p><p><strong>修改位置：</strong> <code>todayCardContent</code> mixin 中的封面显示部分</p><h4 id="修改前：-2">修改前：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mixin todayCardContent</span><br><span class="line">    .todayCard-info</span><br><span class="line">        .todayCard-tips= theme.hometop.recommendList.sup</span><br><span class="line">        .todayCard-title= theme.hometop.recommendList.title</span><br><span class="line">    .todayCard-cover.nolazyload(style=`background: url(&#x27;$&#123;theme.hometop.recommendList.img&#125;&#x27;) no-repeat center /cover`)</span><br><span class="line">    if filteredPosts.length &gt; 0</span><br><span class="line">        .banner-button-group</span><br><span class="line">            a.banner-button(onclick=&quot;window.event.cancelBubble=true;sco.hideTodayCard();&quot;)</span><br><span class="line">                i.solitude.fas.fa-circle-plus</span><br><span class="line">                span.banner-button-text= _p(&#x27;home.recommendmore&#x27;)</span><br></pre></td></tr></table></figure><h4 id="修改后：-2">修改后：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mixin todayCardContent</span><br><span class="line">    .todayCard-info</span><br><span class="line">        .todayCard-tips= theme.hometop.recommendList.sup</span><br><span class="line">        .todayCard-title= theme.hometop.recommendList.title</span><br><span class="line"></span><br><span class="line">    if theme.hometop.recommendList.type === &#x27;video&#x27;</span><br><span class="line">        .todayCard-cover.nolazyload</span><br><span class="line">            video.todayCard-video(</span><br><span class="line">                src=theme.hometop.recommendList.media, </span><br><span class="line">                autoplay=true, </span><br><span class="line">                loop=true, </span><br><span class="line">                muted=true, </span><br><span class="line">                playsinline=true, </span><br><span class="line">                style=&quot;width: 100%; height: 100%; object-fit: cover;&quot;)</span><br><span class="line">    else</span><br><span class="line">        .todayCard-cover.nolazyload(style=`background: url(&#x27;$&#123;theme.hometop.recommendList.img&#125;&#x27;) no-repeat center /cover`)</span><br><span class="line"></span><br><span class="line">    if filteredPosts.length &gt; 0</span><br><span class="line">        .banner-button-group</span><br><span class="line">            a.banner-button(onclick=&quot;window.event.cancelBubble=true;sco.hideTodayCard();&quot;)</span><br><span class="line">                i.solitude.fas.fa-circle-plus</span><br><span class="line">                span.banner-button-text= _p(&#x27;home.recommendmore&#x27;)</span><br></pre></td></tr></table></figure><h4 id="代码说明：">代码说明：</h4><ol><li><strong>条件判断</strong>：使用 <code>if theme.hometop.recommendList.type === 'video'</code> 判断显示类型</li><li><strong>视频播放器</strong>：当类型为视频时，使用 <code>&lt;video&gt;</code> 标签显示视频</li><li><strong>视频属性</strong>：<ul><li><code>autoplay=true</code>：自动播放</li><li><code>loop=true</code>：循环播放</li><li><code>muted=true</code>：静音播放（浏览器要求自动播放必须静音）</li><li><code>playsinline=true</code>：内联播放，适配移动端</li><li><code>object-fit: cover</code>：保持视频比例并填充容器</li></ul></li></ol><h2 id="使用方法">使用方法</h2><h3 id="图片模式配置">图片模式配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">recommendList:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sup:</span> <span class="string">置顶</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">我的博客</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://example.com</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/banner.jpg</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">image</span></span><br><span class="line">  <span class="attr">media:</span> <span class="comment"># 留空</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure><h3 id="视频模式配置">视频模式配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">recommendList:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sup:</span> <span class="string">置顶</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">我的博客</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://example.com</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/banner.jpg</span> <span class="comment"># 可选，作为备用图片</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">video</span></span><br><span class="line">  <span class="attr">media:</span> <span class="string">/mp4/banner-video.mp4</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure><h2 id="注意事项">注意事项</h2><ol><li><strong>视频格式</strong>：建议使用 MP4 格式，兼容性最好</li><li><strong>文件大小</strong>：视频文件不宜过大，建议压缩到合理大小</li><li><strong>自动播放限制</strong>：现代浏览器要求自动播放的视频必须静音</li><li><strong>移动端适配</strong>：使用 <code>playsinline</code> 属性确保在移动端正常播放</li><li><strong>备用方案</strong>：建议在视频模式下也设置 <code>img</code> 作为加载失败时的备用图片</li></ol><h2 id="效果预览">效果预览</h2><p>修改完成后，推荐卡片将根据配置显示不同的内容：</p><ul><li><strong>图片模式</strong>：显示静态背景图片</li><li><strong>视频模式</strong>：显示自动播放的循环视频</li></ul><h2 id="总结">总结</h2><p>通过这次魔改，我们成功为Solitude主题的推荐卡片功能添加了视频支持，使其更加灵活和现代化。修改过程保持了向后兼容性，原有的图片功能完全不受影响。</p><p>这个功能可以用于：</p><ul><li>展示产品演示视频</li><li>播放宣传片或介绍视频</li><li>展示动态内容或动画效果</li><li>提升网站的视觉吸引力</li></ul><p>希望这个教程对你有帮助！如果有任何问题，欢迎在评论区讨论。</p>]]></content>
      
      
      <categories>
          
          <category> 魔改教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 魔改教程 </tag>
            
            <tag> Solitude </tag>
            
            <tag> Hexo </tag>
            
            <tag> 前端开发 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
